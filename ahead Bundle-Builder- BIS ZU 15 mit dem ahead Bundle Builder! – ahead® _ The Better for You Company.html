<!DOCTYPE html>
<!-- saved from url=(0095)https://www.ahead-nutrition.com/pages/bundle-builder-new?currentFlow=byob&page=addProductsPage1 -->
<html class="js bundle-1 gbbBundle-HTML" lang="de" data-google-analytics-opt-out="" style="visibility: visible; --gbb-product-card-bg-color: #fff; --gbb-product-card-text-color: #1d1d1d; --gbb-product-card-final-price-visibility: block; --gbb-product-card-compare-at-price-visibility: block; --gbb-product-card-button-color: #CB33FB; --gbb-product-card-button-text-color: #ffffff; --gbb-product-card-allow-only-one-quantity: block; --gbb-navigation-banner-title-color: #ffffff; --gbb-navigation-banner-text-color: #ffffff; --gbb-navigation-banner-step-completion-color: #1d1d1d; --gbb-navigation-banner-step-done-color: #ffffff; --gbb-navigation-banner-step-text-color: #1d1d1d; --gbb-cart-footer-bg-color: #f1f2f3; --gbb-cart-footer-show-hide-prices: visible; --gbb-cart-footer-text-color: #1d1d1d; --gbb-cart-footer-back-button-color: #6d7175; --gbb-cart-footer-back-button-text-color: #ffffff; --gbb-cart-footer-next-button-text-color: #ffffff; --gbb-cart-footer-next-button-color: #1d1d1d; --gbb-cart-footer-discount-text-color: #1d1d1d; --gbb-cart-footer-discount-text-visibility: visible;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    
    
    
    
    
      
      
    
  
    <script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bat.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/destination"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/awin-shopify-integration-code.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/client-script.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/shopify_v3.2.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/reconvert_script_tags.mini.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/store_reconvert_node.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/toolbar.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/trustedshops_shopify.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/app.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/gtranslate.js.download"></script><script type="text/javascript" charset="UTF-8" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/state.js.download"></script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/clarity.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/js"></script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/ptrnuypd08"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/destination(1)"></script><script type="text/javascript" async="" src="https://analytics.tiktok.com/i18n/pixel/events.js?sdkid=C6ACNE8CRSBOA6BGKTHG&amp;lib=ttq"></script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/uc.js.download" id="Cookiebot"></script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/gtm.js.download"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/trekkie.storefront.63fa514cc5b1f7c3e0ff0cd45925a6686a523fe8.min.js.download"></script><script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/51000511.js.download"><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/script.js.download"></script></script>
    <script>
      (function () {
        var a = document.createElement('script');
        (a.type = 'text/javascript'),
          (a.async = !0),
          (a.src = 'https://1134347635.ahead-nutrition.com/javascript/script.js'),
          document.getElementsByTagName('script')[0].appendChild(a);
      })();
    </script>

    <script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/eatms.js.download"></script>

    <meta name="facebook-domain-verification" content="sanjn9b4sf4wqean61m1aa0vr6qhgm">
    <meta name="uri-translation" content="on">

    <!--Cookiebot-->
    
    <!--Cookiebot Style -->
    <style type="text/css">
      a#CybotCookiebotDialogPoweredbyCybot,
      div#CybotCookiebotDialogPoweredByText {
        display: none;
      }

      #CookiebotWidget .CookiebotWidget-body .CookiebotWidget-main-logo {
        display: none;
      }
    </style>
    <!--Ende Cookiebot Style -->

    <!--
<script>
	(function(e,g,o,s,r,v) {
        if (e[o+'_plugin'] && e[o]) return;
        e[o]=e[o]||[];
        e[o].transport_url='https://serverside-tracking.ew.r.appspot.com';
        e[o].init=s;
        e.ego_key=o;
      	e[o].user = (function() {
      		var user = false;
          	
            
          	
            return user;
      	})()
        e[o].user_attributes = (function() {
        	var u = false;
            
            
            return u;       
        })()
        r=g.createElement('script');
        r.src=e[o].transport_url+'/web/global';
        v=g.getElementsByTagName('script')[0];
        v.parentNode.insertBefore(r,v);
    })(window,document,'ego','mfsahead');
  
  ego.push({
    event: "page_view",
  })
</script>

<script>
	//Additional Events
  if (window.location.href.indexOf("coach-result") !== -1) {
    ego.push({
      event: "submit_application",
      content_name: 'Coaching Application Submit',
      category: {
        Category: "Lead",
        action: 'Coaching Application Submit',
      },
    });
  }
</script>
-->

    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="">
    <link rel="canonical" href="https://www.ahead-nutrition.com/pages/bundle-builder-new?page=addproductspage1">
    <link rel="preconnect" href="https://cdn.shopify.com/" crossorigin=""><link rel="icon" type="image/png" href="https://www.ahead-nutrition.com/cdn/shop/files/Ahead-Logo_0873dc01-73c7-462b-9273-5ea90bb9c8cc.png?crop=center&amp;height=32&amp;v=1665756074&amp;width=32"><link rel="preconnect" href="https://fonts.shopifycdn.com/" crossorigin=""><title>
      ahead Bundle-Builder- BIS ZU 15% SPAREN !! Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!
 – ahead® | The Better for You Company</title>

    
      <meta name="description" content="Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!">
    

    

<meta property="og:site_name" content="ahead® | The Better for You Company">
<meta property="og:url" content="https://www.ahead-nutrition.com/pages/bundle-builder-new?page=addproductspage1">
<meta property="og:title" content="ahead Bundle-Builder- BIS ZU 15% SPAREN !! Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!">
<meta property="og:type" content="website">
<meta property="og:description" content="Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!"><meta property="og:image" content="http://www.ahead-nutrition.com/cdn/shop/files/ahead_f7d60c88-001f-4fda-9e02-b1cbb800aec1.png?height=628&amp;pad_color=fff&amp;v=1665666535&amp;width=1200">
  <meta property="og:image:secure_url" content="https://www.ahead-nutrition.com/cdn/shop/files/ahead_f7d60c88-001f-4fda-9e02-b1cbb800aec1.png?height=628&amp;pad_color=fff&amp;v=1665666535&amp;width=1200">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="628"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ahead Bundle-Builder- BIS ZU 15% SPAREN !! Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!">
<meta name="twitter:description" content="Such dir deine Lieblingsprodukte aus und spare bis zu 15% mit dem ahead Bundle Builder!">


    <script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/global.js.download" defer="defer"></script>

    <!-- START SCRIPT -->
    
    <style>#customerReferenceId { display: none; }</style>
    <!-- END SCRIPT -->
    
<script>window.performance && window.performance.mark && window.performance.mark('shopify.content_for_header.start');</script><meta name="robots" content="noindex,nofollow">
<meta id="shopify-digital-wallet" name="shopify-digital-wallet" content="/21363937/digital_wallets/dialog">
<meta name="shopify-requires-components" content="true" product-ids="8567402627336">
<meta name="shopify-checkout-api-token" content="074531a1bee4c0e502e14ac76c96d05b">
<meta id="in-context-paypal-metadata" data-shop-id="21363937" data-venmo-supported="false" data-environment="production" data-locale="de_DE" data-paypal-v4="true" data-currency="INR">
<script async="async" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/preloads.js.download"></script>
<script id="apple-pay-shop-capabilities" type="application/json">{"shopId":21363937,"countryCode":"DE","currencyCode":"INR","merchantCapabilities":["supports3DS"],"merchantId":"gid:\/\/shopify\/Shop\/21363937","merchantName":"ahead® | The Better for You Company","requiredBillingContactFields":["postalAddress","email"],"requiredShippingContactFields":["postalAddress","email"],"shippingType":"shipping","supportedNetworks":["visa","maestro","masterCard","amex"],"total":{"type":"pending","label":"ahead® | The Better for You Company","amount":"1.00"},"shopifyPaymentsEnabled":true,"supportsSubscriptions":false}</script>
<script id="shopify-features" type="application/json">{"accessToken":"074531a1bee4c0e502e14ac76c96d05b","betas":["rich-media-storefront-analytics"],"domain":"www.ahead-nutrition.com","predictiveSearch":true,"shopId":21363937,"smart_payment_buttons_url":"https:\/\/www.ahead-nutrition.com\/cdn\/shopifycloud\/payment-sheet\/assets\/latest\/spb.de.js","dynamic_checkout_cart_url":"https:\/\/www.ahead-nutrition.com\/cdn\/shopifycloud\/payment-sheet\/assets\/latest\/dynamic-checkout-cart.de.js","locale":"de"}</script>
<script>var Shopify = Shopify || {};
Shopify.shop = "ahead-nutrition.myshopify.com";
Shopify.locale = "de";
Shopify.currency = {"active":"INR","rate":"92.190048"};
Shopify.country = "IN";
Shopify.theme = {"name":"Valentinsbox","id":176676897032,"schema_name":"Dawn","schema_version":"6.0.2","theme_store_id":887,"role":"main"};
Shopify.theme.handle = "null";
Shopify.theme.style = {"id":null,"handle":null};
Shopify.cdnHost = "www.ahead-nutrition.com/cdn";
Shopify.routes = Shopify.routes || {};
Shopify.routes.root = "/";</script>
<script type="module">!function(o){(o.Shopify=o.Shopify||{}).modules=!0}(window);</script>
<script>!function(o){function n(){var o=[];function n(){o.push(Array.prototype.slice.apply(arguments))}return n.q=o,n}var t=o.Shopify=o.Shopify||{};t.loadFeatures=n(),t.autoloadFeatures=n()}(window);</script>
<script id="shop-js-analytics" type="application/json">{"pageType":"page"}</script>
<script>(function() {
  function asyncLoad() {
    var urls = ["https:\/\/gtranslate.io\/shopify\/gtranslate.js?shop=ahead-nutrition.myshopify.com","https:\/\/sdk.owids.com\/js\/app.js?shop=ahead-nutrition.myshopify.com#id=c8up3mpba1frgoj38rhg","https:\/\/cdn.shopify.com\/s\/files\/1\/2136\/3937\/t\/156\/assets\/trustedshops_shopify.js?v=1692608643\u0026shop=ahead-nutrition.myshopify.com","https:\/\/s2.affiliatly.com\/af-1064943\/toolbar.js?t=1698842576\u0026shop=ahead-nutrition.myshopify.com","https:\/\/reconvert-cdn.com\/assets\/js\/store_reconvert_node.js?v=2\u0026scid=NWI2M2ZmYWI1ZGFmYzg3NDMyMTk2YjJkYzRhMzUxOGUuOGM5MDllYmExYzQ5YTMwNjlmZTkxODQxN2IyYTgwNjI=\u0026shop=ahead-nutrition.myshopify.com","https:\/\/reconvert-cdn.com\/assets\/js\/reconvert_script_tags.mini.js?scid=NWI2M2ZmYWI1ZGFmYzg3NDMyMTk2YjJkYzRhMzUxOGUuOGM5MDllYmExYzQ5YTMwNjlmZTkxODQxN2IyYTgwNjI=\u0026shop=ahead-nutrition.myshopify.com","https:\/\/static.affiliatly.com\/shopify\/v3\/shopify_v3.2.js?affiliatly_code=AF-1064943\u0026s=2\u0026shop=ahead-nutrition.myshopify.com","https:\/\/cs.cdn.linkster.co\/main\/scripts\/shopify\/client-script.js?shop=ahead-nutrition.myshopify.com","https:\/\/dr4qe3ddw9y32.cloudfront.net\/awin-shopify-integration-code.js?aid=109748\u0026v=shopifyApp_5.0.0\u0026ts=1734451607529\u0026shop=ahead-nutrition.myshopify.com"];
    for (var i = 0; i < urls.length; i++) {
      var s = document.createElement('script');
      s.type = 'text/javascript';
      s.async = true;
      s.src = urls[i];
      var x = document.getElementsByTagName('script')[0];
      x.parentNode.insertBefore(s, x);
    }
  };
  if(window.attachEvent) {
    window.attachEvent('onload', asyncLoad);
  } else {
    window.addEventListener('load', asyncLoad, false);
  }
})();</script>
<script id="__st">var __st={"a":21363937,"offset":3600,"reqid":"8752657a-778f-4777-9085-52b8f28a0177-1739173748","pageurl":"www.ahead-nutrition.com\/pages\/bundle-builder-new?currentFlow=byob\u0026page=addProductsPage1","s":"pages-120349360392","t":"prospect","u":"214a5189a406","p":"page","rtyp":"page","rid":120349360392};</script>
<script>window.ShopifyPaypalV4VisibilityTracking = true;</script>
<script id="form-persister">!function(){'use strict';const t='contact',e='new_comment',n=[[t,t],['blogs',e],['comments',e],[t,'customer']],o='password',r='form_key',c=['recaptcha-v3-token','g-recaptcha-response','h-captcha-response',o],s=()=>{try{return window.sessionStorage}catch{return}},i='__shopify_v',u=t=>t.elements[r],a=function(){const t=[...n].map((([t,e])=>`form[action*='/${t}']:not([data-nocaptcha='true']) input[name='form_type'][value='${e}']`)).join(',');var e;return e=t,()=>e?[...document.querySelectorAll(e)].map((t=>t.form)):[]}();function m(t){const e=u(t);a().includes(t)&&(!e||!e.value)&&function(t){try{if(!s())return;!function(t){const e=s();if(!e)return;const n=u(t);if(!n)return;const o=n.value;o&&e.removeItem(o)}(t);const e=Array.from(Array(32),(()=>Math.random().toString(36)[2])).join('');!function(t,e){u(t)||t.append(Object.assign(document.createElement('input'),{type:'hidden',name:r})),t.elements[r].value=e}(t,e),function(t,e){const n=s();if(!n)return;const r=[...t.querySelectorAll(`input[type='${o}']`)].map((({name:t})=>t)),u=[...c,...r],a={};for(const[o,c]of new FormData(t).entries())u.includes(o)||(a[o]=c);n.setItem(e,JSON.stringify({[i]:1,action:t.action,data:a}))}(t,e)}catch(e){console.error('failed to persist form',e)}}(t)}const f=t=>{if('true'===t.dataset.persistBound)return;const e=function(t,e){const n=function(t){return'function'==typeof t.submit?t.submit:HTMLFormElement.prototype.submit}(t).bind(t);return function(){let t;return()=>{t||(t=!0,(()=>{try{e(),n()}catch(t){(t=>{console.error('form submit failed',t)})(t)}})(),setTimeout((()=>t=!1),250))}}()}(t,(()=>{m(t)}));!function(t,e){if('function'==typeof t.submit&&'function'==typeof e)try{t.submit=e}catch{}}(t,e),t.addEventListener('submit',(t=>{t.preventDefault(),e()})),t.dataset.persistBound='true'};!function(){function t(t){const e=(t=>{const e=t.target;return e instanceof HTMLFormElement?e:e&&e.form})(t);e&&m(e)}document.addEventListener('submit',t),document.addEventListener('DOMContentLoaded',(()=>{const e=a();for(const t of e)f(t);var n;n=document.body,new window.MutationObserver((t=>{for(const e of t)if('childList'===e.type&&e.addedNodes.length)for(const t of e.addedNodes)1===t.nodeType&&'FORM'===t.tagName&&a().includes(t)&&f(t)})).observe(n,{childList:!0,subtree:!0,attributes:!1}),document.removeEventListener('submit',t)}))}()}();</script>
<script integrity="sha256-EGCDRYTvIEOXsReXgqGwkAR+5Dl8tickSrieA/ZcQwc=" data-source-attribution="shopify.loadfeatures" defer="defer" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/load_feature-1060834584ef204397b1179782a1b090047ee4397cb627244ab89e03f65c4307.js.download" crossorigin="anonymous"></script>
<script data-source-attribution="shopify.dynamic_checkout.dynamic.init">var Shopify=Shopify||{};Shopify.PaymentButton=Shopify.PaymentButton||{isStorefrontPortableWallets:!0,init:function(){window.Shopify.PaymentButton.init=function(){};var t=document.createElement("script");t.src="https://www.ahead-nutrition.com/cdn/shopifycloud/portable-wallets/latest/portable-wallets.de.js",t.type="module",document.head.appendChild(t)}};
</script>
<script data-source-attribution="shopify.dynamic_checkout.buyer_consent">
  function portableWalletsHideBuyerConsent(e){var t=document.getElementById("shopify-buyer-consent"),n=document.getElementById("shopify-subscription-policy-button");t&&n&&(t.classList.add("hidden"),t.setAttribute("aria-hidden","true"),n.removeEventListener("click",e))}function portableWalletsShowBuyerConsent(e){var t=document.getElementById("shopify-buyer-consent"),n=document.getElementById("shopify-subscription-policy-button");t&&n&&(t.classList.remove("hidden"),t.removeAttribute("aria-hidden"),n.addEventListener("click",e))}window.Shopify?.PaymentButton&&(window.Shopify.PaymentButton.hideBuyerConsent=portableWalletsHideBuyerConsent,window.Shopify.PaymentButton.showBuyerConsent=portableWalletsShowBuyerConsent);
</script>
<script data-source-attribution="shopify.dynamic_checkout.cart.bootstrap">document.addEventListener("DOMContentLoaded",(function(){function t(){return document.querySelector("shopify-accelerated-checkout-cart, shopify-accelerated-checkout")}if(t())Shopify.PaymentButton.init();else{new MutationObserver((function(e,n){t()&&(Shopify.PaymentButton.init(),n.disconnect())})).observe(document.body,{childList:!0,subtree:!0})}}));
</script>
<script id="sections-script" data-sections="header" defer="defer" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/scripts.js.download"></script>
<link rel="stylesheet" media="screen" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/accelerated-checkout-backwards-compat.css" crossorigin="anonymous">

<style id="shopify-accelerated-checkout-cart">
        #shopify-buyer-consent {
  margin-top: 1em;
  display: inline-block;
  width: 100%;
}

#shopify-buyer-consent.hidden {
  display: none;
}

#shopify-subscription-policy-button {
  background: none;
  border: none;
  padding: 0;
  text-decoration: underline;
  font-size: inherit;
  cursor: pointer;
}

#shopify-subscription-policy-button::before {
  box-shadow: none;
}

      </style>
<script>window.performance && window.performance.mark && window.performance.mark('shopify.content_for_header.end');</script>

    
    <style>
      .LoyaltyWidget-prefix {
            z-index: 3 !important;
            position: absolute;
      }
      </style>
      
    <style>
      .header--middle-left.header--middle-left {
        max-height: 87px !important;
      }
    </style>
    <style data-shopify="">
      @font-face {
  font-family: Nunito;
  font-weight: 400;
  font-style: normal;
  font-display: swap;
  src: url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.eeda324bc2f350e5c92cf5ef4a0712035386bd19.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=867e2ecd667e51ddcae5edfb35a6a2337d7b57e0019ed233af229fde69656538") format("woff2"),
       url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.510d96f4fbdd1b53fb60bf060c2e23e85d391444.woff?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=7bc1cd35ae2f187412f245e1800d6d7e28842cc0ab6940a63aab60ad7cf6c0d5") format("woff");
}

      @font-face {
  font-family: Nunito;
  font-weight: 700;
  font-style: normal;
  font-display: swap;
  src: url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n7.11fe4cbfacf531cf735c34b0201089187174544c.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=151520956e2b9e7806e686f746b24ae73cee5b8521860f8b741791df81007e69") format("woff2"),
       url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n7.020eae217066713ac7fdef90e29cdc906697a02f.woff?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=fd223e1721f2ab8e46338c9411ec6be066f4c93eefe1280fbd638163aed86644") format("woff");
}

      @font-face {
  font-family: Nunito;
  font-weight: 400;
  font-style: italic;
  font-display: swap;
  src: url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_i4.dbaca638c505ec148af97f053d848593eba2f0b4.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=2289b5b642241caa40ac6a6eb9bfdd9e41b05ab94fd5a580bc2beedca4be2f34") format("woff2"),
       url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_i4.30fd4764a73b8d42cc49848e358ad40d27278c54.woff?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=47cf31398cc08693bc5eae6a3495574cc62dcc6563819ea62c4f82b483633217") format("woff");
}

      @font-face {
  font-family: Nunito;
  font-weight: 700;
  font-style: italic;
  font-display: swap;
  src: url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_i7.2d10e1abe8ee167824bd81cffcfe2cdc382a5961.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=6497e5181bbec0d2934b1e1c35cc3ea1af915473a10c7569a1af9bdae9036448") format("woff2"),
       url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_i7.ef707341e7b30e253c3e6841a27f272b46a45ca5.woff?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=787656988b2a2fb9645fdff0ae74305e5be1d2da5e7c1ccbe503d9b0c646dcda") format("woff");
}

      @font-face {
  font-family: Nunito;
  font-weight: 400;
  font-style: normal;
  font-display: swap;
  src: url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.eeda324bc2f350e5c92cf5ef4a0712035386bd19.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=867e2ecd667e51ddcae5edfb35a6a2337d7b57e0019ed233af229fde69656538") format("woff2"),
       url("//www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.510d96f4fbdd1b53fb60bf060c2e23e85d391444.woff?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&h3=YWhlYWQtbnV0cml0aW9uLml0&h4=YWhlYWQtbnV0cml0aW9uLmZy&h5=YWhlYWQtbnV0cml0aW9uLmVz&hmac=7bc1cd35ae2f187412f245e1800d6d7e28842cc0ab6940a63aab60ad7cf6c0d5") format("woff");
}


      :root {
        --font-body-family: Nunito, sans-serif;
        --font-body-style: normal;
        --font-body-weight: 400;
        --font-body-weight-bold: 700;

        --font-heading-family: Nunito, sans-serif;
        --font-heading-style: normal;
        --font-heading-weight: 400;

        --font-body-scale: 1.0;
        --font-heading-scale: 1.0;

        --color-base-text: 29, 29, 29;
        --color-shadow: 29, 29, 29;
        --color-base-background-1: 241, 233, 222;
        --color-base-background-2: 241, 255, 0;
        --color-base-solid-button-labels: 255, 255, 255;
        --color-base-outline-button-labels: 29, 29, 29;
        --color-base-accent-1: 0, 0, 0;
        --color-base-accent-2: 255, 255, 255;
        --payment-terms-background-color: #f1e9de;

        --gradient-base-background-1: #f1e9de;
        --gradient-base-background-2: #f1ff00;
        --gradient-base-accent-1: #000000;
        --gradient-base-accent-2: #ffffff;

        --media-padding: px;
        --media-border-opacity: 0.05;
        --media-border-width: 1px;
        --media-radius: 0px;
        --media-shadow-opacity: 0.0;
        --media-shadow-horizontal-offset: 0px;
        --media-shadow-vertical-offset: 4px;
        --media-shadow-blur-radius: 5px;
        --media-shadow-visible: 0;

        --page-width: 154rem;
        --page-width-margin: 0rem;

        --card-image-padding: 0.0rem;
        --card-corner-radius: 0.0rem;
        --card-text-alignment: left;
        --card-border-width: 0.0rem;
        --card-border-opacity: 0.1;
        --card-shadow-opacity: 0.0;
        --card-shadow-visible: 0;
        --card-shadow-horizontal-offset: 0.0rem;
        --card-shadow-vertical-offset: 0.4rem;
        --card-shadow-blur-radius: 0.5rem;

        --badge-corner-radius: 4.0rem;

        --popup-border-width: 1px;
        --popup-border-opacity: 0.1;
        --popup-corner-radius: 0px;
        --popup-shadow-opacity: 0.0;
        --popup-shadow-horizontal-offset: 0px;
        --popup-shadow-vertical-offset: 4px;
        --popup-shadow-blur-radius: 5px;

        --drawer-border-width: 1px;
        --drawer-border-opacity: 0.1;
        --drawer-shadow-opacity: 0.0;
        --drawer-shadow-horizontal-offset: 0px;
        --drawer-shadow-vertical-offset: 4px;
        --drawer-shadow-blur-radius: 5px;

        --spacing-sections-desktop: 0px;
        --spacing-sections-mobile: 0px;

        --grid-desktop-vertical-spacing: 8px;
        --grid-desktop-horizontal-spacing: 8px;
        --grid-mobile-vertical-spacing: 4px;
        --grid-mobile-horizontal-spacing: 4px;

        --text-boxes-border-opacity: 0.1;
        --text-boxes-border-width: 0px;
        --text-boxes-radius: 0px;
        --text-boxes-shadow-opacity: 0.0;
        --text-boxes-shadow-visible: 0;
        --text-boxes-shadow-horizontal-offset: 0px;
        --text-boxes-shadow-vertical-offset: 4px;
        --text-boxes-shadow-blur-radius: 5px;

        --buttons-radius: 0px;
        --buttons-radius-outset: 0px;
        --buttons-border-width: 0px;
        --buttons-border-opacity: 1.0;
        --buttons-shadow-opacity: 0.0;
        --buttons-shadow-visible: 0;
        --buttons-shadow-horizontal-offset: 0px;
        --buttons-shadow-vertical-offset: 0px;
        --buttons-shadow-blur-radius: 0px;
        --buttons-border-offset: 0px;

        --inputs-radius: 40px;
        --inputs-border-width: 1px;
        --inputs-border-opacity: 0.55;
        --inputs-shadow-opacity: 0.0;
        --inputs-shadow-horizontal-offset: 0px;
        --inputs-margin-offset: 0px;
        --inputs-shadow-vertical-offset: 4px;
        --inputs-shadow-blur-radius: 5px;
        --inputs-radius-outset: 41px;

        --variant-pills-radius: 40px;
        --variant-pills-border-width: 1px;
        --variant-pills-border-opacity: 0.55;
        --variant-pills-shadow-opacity: 0.0;
        --variant-pills-shadow-horizontal-offset: 0px;
        --variant-pills-shadow-vertical-offset: 4px;
        --variant-pills-shadow-blur-radius: 5px;
      }

      *,
      *::before,
      *::after {
        box-sizing: inherit;
      }

      html {
        box-sizing: border-box;
        font-size: calc(var(--font-body-scale) * 62.5%);
        height: 100%;
      }

      body {
        display: grid;
        grid-template-rows: auto auto 1fr auto;
        grid-template-columns: 100%;
        min-height: 100%;
        margin: 0;
        font-size: 14px;
        font-family: var(--font-body-family);
        font-style: var(--font-body-style);
        font-weight: var(--font-body-weight);
      }
      @font-face {
        font-family: 'zufo';
        src: url(https://cdn.shopify.com/s/files/1/2136/3937/files/Zufo-Bold.woff2?v=1719911950) format('woff2');
      }

      @media screen and (min-width: 750px) {
        body {
          font-size: 18px;
          line-height: 28px;
        }
      }
    </style>

    <link rel="preload stylesheet" href="https://www.ahead-nutrition.com/cdn/shop/t/312/assets/base.css?v=8792069903125958031738669749" as="style">
    <style>
.fullWidth{width:100%;height:auto}.buttonClass{border-radius:50px;text-decoration:unset;display:inline-block;font-weight:700}footer.footer{overflow-x:hidden}@media screen and (max-width:749px){.mobileHide{display:none!important}.product-recommendations .product-grid{grid-template-columns:repeat(4,calc(50vw - 8px));display:grid;overflow-x:scroll}.product-recommendations .product-grid li{width:100%!important;max-width:unset}}@media screen and (min-width:990px){.header--middle-left{grid-template-areas:unset;grid-template-columns:1fr 1fr;column-gap:2rem}.header__heading{position:absolute;left:50%;transform:translateX(-50%)}}a,button{cursor:pointer!important}@media screen and (min-width:750px) and (max-width:1260px){.headingClass{font-size:40px!important;line-height:50px!important}.smallTextTablet .headingClass,.subheadingClass{font-size:30px!important;line-height:40px!important}.textClass{font-size:16px!important;line-height:20px!important}.headingClass br,.subheadingClass br,.textClass br{display:none!important}.footer .page-width-desktop,.page-width{padding:0 15px!important}.header__inline-menu .list-menu li,.header__search{margin-right:20px!important}summary.list-menu__item{padding-right:0!important}.announcement-bar-container{grid-template-columns:26% 1fr 26%!important}.columnsHolder,.perksHolder{grid-template-columns:repeat(2,1fr)!important}.smallTextTablet .subheadingClass{font-size:20px!important;line-height:30px!important}.smallTextTablet .textClass{font-size:14px!important;line-height:16px!important}.featuredProductsDiv{gap:10px!important}.columnsHolder,.footerTop{gap:20px!important}.columnsHolder{display:grid}.text-image-component-2 .textImageHolder{grid-template-columns:50% 66%!important}.footerNews{padding-right:15px!important}.footerMenu{padding-left:15px!important}.footerNav{grid-template-columns:1fr!important}.product__info-wrapper--extra-padding.product__info-wrapper--extra-padding{padding-left:20px}.header{padding-top:20px!important;padding-bottom:20px!important}.collectionProducts{grid-template-columns:repeat(3,1fr)!important}.collectionTop{grid-template-columns:1fr!important;place-items:center}.announcement-bar-container.announcement-bar-container>div{display:block}}@media screen and (min-width:750px) and (max-width:1030px){.featuredProductsDiv{grid-template-columns:repeat(2,1fr)!important;gap:30px!important}}@media screen and (min-width:750px) and (max-width:1000px){.footerContainer{grid-template-columns:1fr!important}.footer .page-width-desktop{padding:0!important}.footerContainer>div{padding:88px 15px!important}.product__info-container{max-width:340px!important}}@media screen and (min-width:1260px){.newsletter-form__field-wrapper .field{width:calc(100% + 50px)}}.productItemAdd[disabled]{opacity:.5}.grid.product-grid .grid__item{display:flex}
</style>
    <style>
            .viewBundle {
              margin: 0;
              font-size: 12px;
              display: table;
              cursor: pointer;
              position: relative;
            }
            .viewBundle:after {
              content: '';
              position: absolute;
              top: 50%;
              right: -20px;
              border-bottom: 1px solid #000;
              border-right: 1px solid #000;
              transform: translateY(-50%) rotate(45deg);
              width: 7px;
              height: 7px;
              transition: transform .3s ease-out;
            }
            .bundleOpened .viewBundle:after {
              transform: translateY(-50%) rotate(-135deg);
            }
            .bundleProducts {
              margin-bottom: 15px;
              display: none;
            }
            .bundleOpened .bundleProducts {
              display: block;
            }
            .bundleProducts p {
              margin: 0;
              font-size: 10px;
            }
</style>
<style>
.giftProgress{display:flex;flex-direction:column;justify-content:center}.cartDiv,.my-cart{overflow-y:scroll}.cartItem,.itemImage,.itemImage img,.itemInfo,.itemRec img,.my-cart{width:100%}.my-cart,.my-cart *{font-family:Nunito!important}body.js-my-cart-open{overflow:hidden}body.js-my-cart-open .backgroundBlur{display:block;position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:4;background-color:#2f2f314d; overflow-y: hidden !important;}
.my-cart{transform: translateX(100%);position:fixed;z-index:999999999;background:#fff;transition:transform 0.2s ease-in-out;opacity:1;top:0;right:0;max-width:567px;box-shadow:rgba(0,0,0,.15) 0 0 20px 0;height:100%;y-overflow:hidden;}
.js-my-cart-open .my-cart {
  transform: translateX(0);
}
.cartTop{display:grid;grid-template-columns:50px 1fr 50px;padding:20px 15.5px 20px 17px}.cartTop div{display:grid;place-items:center}.closeCart{cursor:pointer;display:block;height:24px;width:24px}.closeCart svg{height:24px;width:24px}.cartTitle,.cartTitle p{margin:0;font-weight:900;font-size:20px;line-height:28px;color:#000}.cartDiv{padding:0px 32px 0;display:flex;flex-direction:column;justify-content:space-between;height:calc(100% - 50px);overflow-x: hidden;}.cartHeader{font-size:20px;font-weight:600;padding-bottom:30px;border-bottom:1px solid #e2e2e2}.freeShipping{padding:0;border-bottom:0;min-height:60px}.freeShippingBarEmpty{margin-top:6px;width:100%;background:#fff;border-radius:50px;height:4px}.freeShippingBarFull{height:6px;background:#3cffd0;border-radius:50px;position:relative;top:-1px}.freeShippingBarFull:after{position:absolute;content:'';top:50%;transform:translateY(-50%);right:0;height:12px;width:12px;background:#3cffd0;border:2px solid #f3f3f3;border-radius:50%;transition:width 1.6s ease-out,height 1.6s ease-out}.emptyCart{padding:30px 0;background-color:#e8e8e8;text-align:center;font-weight:500;font-size:20px;margin-top:20px}.itemMinus.itemMinus,.itemQty{background:#f1f1f1}.giftTextRight span,.itemRemove,.itemRemove svg{display:block}.cartItem{display:grid;grid-template-columns:63px 1fr;gap:1px;padding:10px 0 16px;border-bottom:1px solid #f3f3f3}.cartItem:first-of-type,.dynamicSuggestions .itemPrice{padding-top:0}.my-cart__items{min-height:45vh;padding:20px 0;overflow-y:scroll;overflow-x:hidden;height:calc(100% - 86px)}.itemImage img{border-radius:3px}.topCartItem{display:grid;grid-template-columns:1fr 14px;gap:14px}.subType{font-weight:800;font-size:12px;line-height:16px;letter-spacing:.06em;text-transform:uppercase;color:#737373;display:flex;align-items:center}.properties,.properties *{display:block;text-decoration:unset;font-size:12px;font-weight:400}.btnAddRec,.itemTitle a{text-decoration:unset!important}.itemInfo{padding-left:15px}.itemRemove{height:16px}.itemTitlePrice{display:flex;justify-content:space-between;margin-bottom:12px}.compareCart,.normalCart{text-transform:uppercase;display:block;font-weight:700}.itemPrice{padding-top:13px}.compareCart{font-size:12px;line-height:14px;text-decoration-line:line-through;color:#eb001b}.normalCart{font-size:14px;line-height:15px;color:#29282c}.itemTitle{font-weight:500;line-height:18px}.btnAddRec,.shippingMessage{font-weight:600;text-align:center}.itemTitle a{font-weight:700;font-size:16px;line-height:28px;text-transform:capitalize;color:#1d1d1b;padding-right:10px}.itemQty{display:flex;border-radius:50px;width:95px;padding:6px;height:32px}.itemMinus.itemMinus svg path{fill:#C4C3C8}.itemPlus.itemPlus{background-color:#000!important}.itemPlus.itemPlus svg path{fill:#fff}.itemQty input{width:45px;text-align:center;border:0;font-weight:700;font-size:11px;line-height:9px;color:#1d1d1b}.itemQty .quantity__button{width:20px;border-radius:50px;height:20px;}.itemQty .quantity__button.itemPlus.itemPlus{margin-right:6px}.itemQtyWord{font-size:14px;margin-bottom:10px}.bottomCart{padding:20px 32px 32px;background:#f1e9de;min-width:calc(100% + 64px);margin-left:-32px}.bottomCart button{width:100%;padding:14px;border-radius:50px;transition:.5s ease-in-out;text-align:center;font-weight:800;font-size:16px;line-height:32px;color:#fff;border:0;margin-top:0px;cursor:pointer;background: #CB33FB;}.dynamicSuggestions{display:grid;overflow-x:hidden;grid-template-columns:100%;gap:15px}.itemRec{width:calc(33% - 5px);margin-right:10px}.itemRec:nth-of-type(3){margin-right:0}.itemRecTitle{font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.btnAddRec{padding:9px 14px;background:0 0;white-space:nowrap;font-size:10px;line-height:14px;border:1px solid #1d1d1b;border-radius:50px;color:#1d1d1b;display:inline-block;margin-top:12px}.shippingMessage{margin: 16px 0;font-size:14px;line-height:24px;color:#737373;font-weight:400}.dynamicSuggestions .itemTitlePrice{margin-bottom:0}.dynamicSuggestions .cartItem{padding-bottom:14px;border:unset}.relatedProducts{border-bottom:1.5px solid #d9d9d9}.relatedProducts>p{font-weight:700;font-size:14px;line-height:18px;color:#1d1d1b;margin:0}.giftText{display:grid;grid-template-columns:1fr 1fr;gap:79px}.giftTextLeft{font-weight:400;font-size:12px;line-height:16px;color:#1d1d1b}.giftTextRight,.textAfterLeft{font-weight:700;color:#1d1d1b}.giftTextLeft p,.textAfterLeft p{margin:0}.giftTextRight{font-size:12px;line-height:16px;text-align:right}.giftTextIcon{display:grid;grid-template-columns:54px 1fr;gap:16px}.giftTextIcon svg,.giftTextIcon img{height:auto;width:100%;display:block}.freeGiftHolder{width:calc(100% + 64px);margin-left:-32px;padding:16px 32px;background-color:#f1e9de;overflow:hidden;position:relative}.runAnimation .freeShippingBarFull:after{width:667px;height:667px;transform:translate(100px,-50%)}.textAfter{padding:14px 15px;grid-template-columns:1fr 32px;gap:25px;position:absolute;top:0;left:0;width:100%;height:100%;place-items:center;display:none;z-index:2}.textAfterLeft{font-size:16px;line-height:24px}.textAfterRight svg{width:32px;height:auto}@media only screen and (max-width:1100px){.my-cart,.my-cart__items{overflow-y:scroll;overflow-x:hidden}.cartDiv,.my-cart,.my-cart__items{overflow-x:hidden}.my-cart{top:0;right:0;left:0;width:100%;max-width:unset;height:100dvh;max-height:unset}.my-cart__items{min-height:35vh;padding:30px 0;height:calc(100% - 60px)}.runAnimation .freeShippingBarFull:after{width:520px;height:520px}.cartProductsDiv{height:calc(100% - 254px)!important}}
</style>
<style>
.my-cart__items::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.my-cart__items {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}
@media only screen and (max-width: 1100px) {
.my-cart, .my-cart * {
  font-family: "Nunito"!important;
}
body.js-my-cart-open {
  overflow: hidden;
}
body.js-my-cart-open .backgroundBlur {
  display: block;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 9999999;
  background-color: #2f2f314d;
  overflow-y: hidden;
}
.my-cart {
    transform: translateX(100%);
	position: fixed;
  	z-index: 999999999;
  	background: white;
    transition: transform 0.2s ease-in-out;;
    opacity: 1;
    top: 0px;
    right: 0;
    width: 100%;
    max-width: 567px;
    background-color: #ffffff;
    box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 20px 0px;
  	overflow-y: scroll;
}
.js-my-cart-open .my-cart {
  transform: translateX(0);
}
.cartTop {
  display: grid;
  grid-template-columns: 50px 1fr 50px;
  padding: 12px 0;
}
.cartTop div {
  display: grid;
  place-items: center;
}
.closeCart {
	cursor: pointer;
    display: block;
    height: 20px;
    width: 20px;
}
.closeCart svg {
  height: 20px;
  width: 20px;
}
.cartTitle, .cartTitle p {
  margin: 0;
  font-weight: 900;
  font-size: 18px;
  line-height: 24px;
  color: #000000;
}
.cartDiv {
	padding: 0px 15px 0;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: calc(100% - 50px);
    overflow-y: scroll;
}
.cartHeader {
	font-size: 20px;
  	font-weight: 600;
  	padding-bottom: 30px;
  	border-bottom: 1px solid #e2e2e2;
}
.freeShipping {
	padding: 0;
  	border-bottom: 0;
    min-height: 60px;
}
.freeShippingBarEmpty {
  	margin-top: 2px;
	width: 100%;
  	background: #FFFFFF;
    border-radius: 50px;
  	height: 4px;
}
.freeShippingBarFull {
  	background-color: #000;
  	height: 6px;
    background: #3CFFD0;
    border-radius: 50px;
    position: relative;
    top: -1px;
}
.freeShippingBarFull:after {
  position: absolute;
  content: '';
  top: 50%;
  transform: translateY(-50%);
  right: 0;
  height: 12px;
  width: 12px;
  background: #3CFFD0;
  border: 2px solid #F3F3F3;
  border-radius: 50%;
  transition: width 1.6s ease-out, height 1.6s ease-out;
}
.emptyCart {
	padding: 30px 0;
  	background-color: #e8e8e8;
  	text-align: center;
  	font-weight: 500;
  	font-size: 20px;
    margin-top: 20px;
}

.cartItem {
	width: 100%;
  	display: grid;
    grid-template-columns: 50px 1fr;
    gap: 0px;
  	padding: 10px 0 10px;
  	border-bottom: 1px solid #f3f3f3;
}
.cartItem:nth-of-type(1) {
	padding-top: 0;
}
.my-cart__items {
  	min-height: 45vh;
	padding: 30px 0;
  	overflow-y: hidden;
    overflow-x: hidden;
    height: calc(100% - 60px);
}
.itemImage {
	width: 100%;
}
.itemImage img {
	width: 100%;
    border-radius: 3px;
}
.topCartItem {
  display: grid;
  grid-template-columns: 1fr 14px;
  gap: 14px;
}
.subType {
  font-weight: 800;
  font-size: 10px;
  line-height: 14px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #737373;
  display: flex;
  align-items: center;
}
.properties, .properties * {
  display: block;
  text-decoration: unset;
  font-size: 12px;
  font-weight: 400;
}
.itemInfo {
  	padding-left: 12px;
	width: 100%;
}
.itemRemove {
  height: 16px;
}
.itemRemove, .itemRemove svg {
  display: block;
}
.itemTitlePrice {
	display: flex;
  	justify-content: space-between;
  	margin-bottom: 6px;
}
.itemPrice {
  padding-top: 13px;
}
.compareCart {
  font-weight: 700;
  font-size: 12px;
  line-height: 14px;
  text-decoration-line: line-through;
  text-transform: uppercase;
  color: #EB001B;
  display: block;
}
.normalCart {
  font-weight: 700;
  font-size: 12px;
  line-height: 16px;
  text-transform: uppercase;
  color: #29282C;
  display: block;
}
.itemTitle {
    font-size: 12px;
	font-weight: 500;
    line-height: 16px;
}
.itemTitle a {
  font-weight: 700;
  font-size: 12px;
  line-height: 16px;
  text-transform: capitalize;
  color: #1D1D1B;
  padding-right: 10px;
  text-decoration: unset!important;
}
.itemQty {
  display: flex;
  background: #F1F1F1;
  border-radius: 50px;
  width: 95px;
  padding: 4px;
  height: 28px;
}
.itemMinus.itemMinus {
  background: #F1F1F1;
}
.itemMinus.itemMinus svg path {
  fill: #C4C3C8;
}
.itemPlus.itemPlus {
  background-color: #000!important;
}
.itemPlus.itemPlus svg path {
  fill: #fff;
}
.itemQty input {
	width: 45px;
  	text-align: center;
  	border: 0;
    font-weight: 700;
    font-size: 11px;
    line-height: 9px;
    color: #1D1D1B;
}
.itemQty .quantity__button {
  width: 20px;
  border-radius: 50px;
  height: 20px;
}
.itemQty .quantity__button .itemPlus.itemPlus {
  margin-right: 4px;
}
.itemQtyWord {
	font-size: 14px;
  	margin-bottom: 10px;
}
.bottomCart {
	padding: 12px 15px 20px;
  	background: #f1e9de;
    min-width: calc(100% + 30px);
    margin-left: -15px;
}
.bottomCart button {
	width: 100%;
  	padding: 14px;
  	color: #fff;
  	background: #CB33FB;
    border-radius: 50px;
  	transition: all .5s ease-in-out;
  	text-align: center;
  	font-weight: 800;
    font-size: 16px;
    line-height: 32px;
    color: #FFFFFF;
    border: 0;
  	margin-top: 0px;
  	cursor: pointer;
}
.bottomCart button:hover {
	background: #CB33FB;
}
.dynamicSuggestions {
	display: grid;
  	overflow-x: hidden;
    grid-template-columns: 100%;
    gap: 15px;
}
.itemRec {
	width: calc(33% - 5px);
  	margin-right: 10px;
}
.itemRec:nth-of-type(3){
	margin-right: 0;
}
.itemRec img {
	width: 100%;
}
.itemRecTitle {
	font-size: 13px;
  	white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.btnAddRec {
  	padding: 10px;
  	background: transparent;
  	color: #000;
  	white-space: nowrap;
  	font-weight: 600; 
    font-size: 11px;
    line-height: 15px;
    border: 1px solid #1D1D1B;
    border-radius: 50px;
    color: #1D1D1B;
  	display: inline-block;
  	margin-top: 6px;
  	text-align: center;
    padding: 5px 21px;
    text-decoration: unset!important;
}
.shippingMessage {
  font-weight: 400;
  font-size: 12px;
  line-height: 16px;
  text-align: center;
  color: #000;
}
.dynamicSuggestions .itemPrice {
  padding-top: 0;
}
.dynamicSuggestions .itemTitlePrice {
  margin-bottom: 0;
}
.dynamicSuggestions .cartItem {
  padding-bottom: 14px;
  border: unset;
  margin-top: 2px;
}
.relatedProducts {
  border-bottom: 1.5px solid #D9D9D9;
}
.relatedProducts > p {
  font-weight: 700;
  font-size: 14px;
  line-height: 18px;
  color: #1D1D1B;
  margin: 0;
}
.belowThreshold:nth-of-type(2){
  
}
.giftText {
  display: grid;
  grid-template-columns: 1fr 54px;
  gap: 50px;
}
.giftTextLeft {
  font-weight: 400;
  font-size: 12px;
  line-height: 16px;
  color: #1D1D1B;
}
.giftTextLeft p {
  margin: 0;
}
.giftTextRight {
  font-weight: 700;
  font-size: 12px;
  line-height: 16px;
  text-align: right;
  color: #1D1D1B;
}
.giftTextRight span {
  display: block;
}
.giftTextIcon {
  display: grid;
  grid-template-columns: 38px 1fr;
  gap: 10px;
}
.freeGiftHolder {
  width: calc(100% + 30px);
  margin-left: -15px;
  padding: 6px 15px;
  background-color: #f1e9de;
  overflow: hidden;
  position: relative;
  min-height: 60px;
}
.runAnimation .freeShippingBarFull:after {
  width: 667px;
  height: 667px;
  transform: translate(100px, -50%);
}
.textAfter {
  padding: 4px 15px;
  display: grid;
  grid-template-columns: 1fr 20px;
  gap: 30px;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  place-items: center;
  display: none;
  z-index: 2;
}
.textAfterLeft {
  font-weight: 700;
  font-size: 12px;
  line-height: 16px;
  color: #1D1D1B;
}
.textAfterLeft p {
  margin: 0;
}
.textAfterRight svg {
  width: 26px;
  height: 26px;
}
}
@media only screen and (max-width: 1100px) {
    .my-cart,
    .my-cart__items {
        overflow-y: scroll;
        overflow-x: hidden;
    }
    .cartDiv,
    .my-cart,
    .my-cart__items {
        overflow-x: hidden;
    }
    .my-cart {
        top: 0;
        right: 0;
        left: 0;
        width: 100%;
        max-width: 100%;
        height: 100dvh;
        max-height: unset;
    }
    .my-cart__items {
        min-height: 35vh;
        padding: 16px 0;
        height: calc(100% - 60px);
    }
    .runAnimation .freeShippingBarFull:after {
        width: 520px;
        height: 520px;
    }
    .cartProductsDiv {
        height: calc(100% - 254px) !important;
    }
}
@media only screen and (min-width: 1100px) {
.cartProductsDiv {
  height: calc(100% - 274px)!important;
}
}
@supports not (height: 100dvh) {
  .my-cart {
        height: calc(100vh - 100px);
    }
}

</style>
    <style> 
.minimumPopupClass {
  position: relative; 
  margin-top: 20px;
  background-color: #fff; 
  color: #000; 
  padding: 15px 20px; 
  border: 2px solid #000; 
  border-radius: 5px; 
  z-index: 9999; 
  font-weight: bold;
  text-align: center;
}




  
/* Properties */
.propertiesx {
    display: none !important;
}
#docapp-int-21749 {
    display: none !important;
}
.docapp-cart-with-coupon-summary--summary {
    display: none;
}

/* Progress Bar */
.progress-bar-containerx {
    width: 49%;
    height: 10px;
    background-color: #e0e0e0;
    overflow: hidden;
    position: absolute;
    top: 52px;
    margin-left: -62px;
}
.progress-bar-fillx {
    height: 100%;
    background-color: #02B701;
    transition: width 0.2s ease-in-out;
}

/* Savings Container */
.savings-container {
    font-size: 16px;
    color: #1d1d1d;
    line-height: 20px;
    margin: 0px -34px;
    display: flex;
    background: transparent;
    padding: 2px 0;
}

/* Green Background */
.greenBackgroundx {
    background-color: #02B701 !important;
    transition: width 0.4s ease-in-out;
}

/* Keyframes */
@keyframes shift {
    from {
        background-position: 200% 0;
    }
    to {
        background-position: -200% 0;
    }
}

/* Free Gift Holder */
div.freeGiftHolderx:nth-child(1) > div:nth-child(1) {
    width: 24%;
    margin-left: 0px;
}

/* Gift Progress */
.giftProgressx {
    display: block;
    text-align: center;
    margin: 10px 0px 0px 0px;
}

/* Cart */
.cartDivx,
.my-cartx {
    overflow-y: hidden;
}
.cartItemx,
.itemImagex,
.itemImagex img,
.itemInfox,
.itemRecx img,
.my-cartx {
    width: 100%;
}
.my-cartx,
.my-cartx * {
    font-family: Nunito !important;
}
body.js-my-cart-open {
    overflow: hidden;
}
body.js-my-cart-open .backgroundBlurx {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 99999999;
    background-color: #2f2f314d;
    overflow-y: hidden !important;
    cursor: nw-resize;
}

/* Bottom Cart */
.bottomCartx button,
.bottomCartx button:hover {
    background: #cb33fb;
}
.my-cartx {
    transform: translateX(100%);
    position: fixed;
    z-index: 999999999;
    background: #fff;
    transition: transform 0.2s ease-in-out;
    opacity: 1;
    top: 0;
    right: 0;
    max-width: 567px;
    box-shadow: rgba(0, 0, 0, .15) 0 0 20px 0;
    height: 100%;
    overflow-y: hidden;
}
.js-my-cart-open .my-cartx {
    transform: translateX(0);
}
.closeCart-arrow {
    display: none;
}
.closeCartx {
    cursor: pointer !important;
    display: block;
    position: absolute;
    right: 15px;
    top: 15px;
}
.closeCartx svg {
    height: 28px;
    width: 28px;
    display: flex;
    margin: auto;
}

/* Cart Title */
.cartTitlex,
.cartTitlex p {
    margin: 0;
    font-weight: 900;
    font-size: 20px;
    line-height: 28px;
    color: #000;
}

/* Cart Division */
.cartDivx {
    padding: 0px 32px 0;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: calc(100% - 0px);
    overflow-x: hidden;
}

/* Cart Header */
.cartHeaderx {
    font-size: 20px;
    font-weight: 600;
    padding-bottom: 30px;
    border-bottom: 1px solid #e2e2e2;
}

/* Free Shipping */
.freeShippingx {
    padding: 0px 0px 0px 0px;
    border-bottom: 0;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    margin: 10px -32px 0px;
    background-color: #F1E9DE;
    z-index: 9;
}

/* Cart Item */
.cartItemx:first-of-type {
    margin-top: 0px;
}
.cartItemx.recommendx:first-of-type {
    min-width: 300px;
}

/* Free Shipping Header */
.freeShippingHeaderx {
    display: block;
    text-align: center;
    margin: 0px -40px;
    color: #CA32F9;
    font-weight: 700;
    font-size: 20px;
    padding-top: 25px;
    padding-bottom: 5px;
    background: #F1E9DE;
}
  .freeShippingHeaderx-3 {
    display: block;
    text-align: center;
    margin: 0px -40px;
    color: #CA32F9;
    font-weight: 700;
    font-size: 20px;
    padding-top: 25px;
    padding-bottom: 5px;
    background: #F1E9DE;
}
.freeShippingHeaderx-2 {
    display: block;
    text-align: center;
    margin: 0px -40px;
    color: #CA32F9;
    font-weight: 700;
    font-size: 20px;
    padding-top: 25px;
    padding-bottom: 25px;
    background: #F1E9DE;
}
.freeshippingfurther {
    font-size: 18px;
    line-height: 28px;
    color: #1d1d1d;
    font-weight: 400;
  }
.freeShippingHeaderxb {
    display: block;
    text-align: center;
    margin: 0px -40px;
    color: #1d1d1d;
    font-weight: 700;
    font-size: 20px;
    padding-top: 10px;
    padding-bottom: 10px;
    background: #F1E9DE;
}

.empty-cart {
  text-align: center;
  font-weight: 400;
  color: #1d1d1d;
  padding: 25px;
}
.empty-cart .warenkorb-leer {
  text-align: center;
  font-weight: 900;
  color: #1d1d1d;
  font-size: 20px;
  padding-top: 25px;
  padding-bottom: 5px;
  padding: 10px;
}

/* Gift Difference */
.giftDifferencex {
    display: block;
    text-align: center;
    margin: -5px -32px -10px -32px;
    color: #1D1D1C;
    font-weight: 400;
    background: #F1E9DE;
    padding: 0px 42px;
}

/* Free Shipping Header with Arrows */
.freeShippingHeaderx-3.arrowsx {
    display: flex;
    text-align: center;
    background: #F1E9DE;
    margin: auto;
    color: #CA32F9;
    font-weight: 700;
    padding-top: 5px;
    padding-bottom: 5px;
}

/* Free Shipping Bar */
.freeShippingBarEmptyx {
    position: relative;
    width: 80px;
    height: 80px;
    border-radius: 50%;
    overflow: hidden;
    margin: auto;
}
.freeShippingBarFullx {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.freeShippingBarFull1x {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
.progress-ring__circlex {
    stroke: green;
    stroke-width: 6;
    transition: stroke-dashoffset 0.5s ease-out;
}

/* Cart Item Recommend */
.cartItemx.recommendx {
    padding-top: 10px;
    min-width: 300px;
    margin-top: 0;
    scroll-snap-align: start;
    flex: 0 0 auto;
}
.cartItemx.recommendxb {
    padding-top: 10px;
    margin-top: 0;
    grid-template-columns: 63px 1fr 0px;
}

/* Empty Cart */
.emptyCartx {
    padding: 30px 0;
    background-color: #e8e8e8;
    text-align: center;
    font-weight: 500;
    font-size: 20px;
    margin-top: 20px;
}

/* Item Remove */
.itemRemovex,
.itemRemovex svg {
    display: inline;
    vertical-align: middle;
}
    .itemPricex {
        margin-left: 4px;
        line-height: 0;
    }
  .itemTitlePricex .itemPricex {
    text-align: right;
  }

/* Pfand Item */
.pfand-item {
    display: flex;
    padding: 2px 0 2px;
    border-bottom: 0px;
    justify-content: space-between;
    margin: auto;
}
.pfand-item2 {
    display: grid;
    grid-template-columns: 63px 1fr auto;
    gap: 20px;
    padding: 10px 0 16px;
    border-bottom: 0px;
}

/* Cart Item */
.cartItemx {
    display: grid;
    grid-template-columns: 63px 1fr 0px;
    gap: 1px;
    padding: 10px 0 16px;
    border-bottom: 1px solid #f3f3f3;
}

/* Cart Items */
.my-cartx__items {
    min-height: 45vh;
    padding: 20px 0;
    overflow-y: scroll;
    overflow-x: hidden;
    height: calc(100% - 190px);
    margin-top: -10px;
}

/* Item Image */
.itemImagex img {
    border-radius: 3px;
}

/* Top Cart Item */
.topCartItemx {
    display: grid;
    grid-template-columns: 1fr 14px;
    gap: 14px;
}

/* Sub Type */
.subTypex {
    font-weight: 800;
    font-size: 12px;
    line-height: 16px;
    letter-spacing: .06em;
    text-transform: uppercase;
    color: #737373;
    display: flex;
    align-items: center;
}

/* Properties */
.propertiesx,
.propertiesx * {
    display: block;
    text-decoration: unset;
    font-size: 12px;
    font-weight: 400;
}

/* Button Add */
.btnAddRecx,
.itemTitlex a {
    text-decoration: unset !important;
}

/* Item Info */
.itemInfox {
    padding-left: 15px;
}

/* Item Remove */
.itemRemovex {
    height: 18px;
}

/* Item Title Price */
.itemTitlePricex {
    display: flex;
    justify-content: space-between;
    margin-bottom: 2px;
}

/* Compare Cart */
.compareCartx,
.normalCartx {
    text-transform: uppercase;
    display: inline-flex;
    font-weight: 700;
}
.compareCartx {
    font-size: 14px;
    line-height: 14px;
    text-decoration-line: line-through;
    color: #eb001b;
}
.normalCartx {
    font-size: 16px;
    line-height: 16px;
    color: #29282c;
}

/* Item Title */
.itemTitlex {
    font-weight: 500;
    line-height: 18px;
    width: 300px;
}

/* Button Add Recommendation */
.btnAddRecx,
.shippingMessagex {
    font-weight: 600;
    text-align: center;
    margin: 10px 0;
}

/* Item Title Link */
.itemTitlex a {
    font-weight: 700;
    font-size: 14px;
    line-height: 14px;
    text-transform: capitalize;
    color: #1d1d1b;
}

/* Item Quantity */

.itemQtyx {
  background:#f1f1f1;
      display: flex;
    border-radius: 50px;
    width: 95px;
    padding: 6px;
}

.itemMinusx.itemMinusx svg path {
    fill: #C4C3C8;
}
.itemPlusx.itemPlusx {
    background-color: #000 !important;
}
.itemPlusx.itemPlusx svg path {
    fill: #fff;
}
.itemQtyx input {
    width:45px;
    text-align:center;
    border:0;
    font-weight:700;
    font-size:11px;
    line-height:9px;
    color:#1d1d1b;
}
.itemQtyx .quantity__button {
    width: 20px;
    border-radius: 50px;
    height: 20px;
}
.itemQtyx .quantity__button.itemPlusx.itemPlusx {
    margin-right: 4px;
}
.itemQtyWordx {
    font-size: 14px;
    margin-bottom: 10px;
}

/* Bottom Cart */
.bottomCartx {
    padding: 10px 32px 10px;
    background: #f1e9de;
    min-width: calc(100% + 64px);
    margin-left: -32px;
    z-index: 1;
}
.bottomCartx button {
    width: 100%;
    padding: 14px;
    border-radius: 50px;
    transition: .5s ease-in-out;
    text-align: center;
    font-weight: 800;
    font-size: 16px;
    line-height: 32px;
    color: #fff;
    border: 0;
    margin-top: 4px;
    cursor: pointer;
}

/* Dynamic Suggestions */
.dynamicSuggestionsx {
    display: grid;
    gap: 15px;
    overflow-x: auto;
    grid-auto-flow: column;
    width: 100%;
    scroll-snap-type: x mandatory;
    scrollbar-width: thin;
    scroll-behavior: smooth;
}
.dynamicSuggestionsxb {
    display: grid;
    grid-template-columns: repeat(3, 100%) auto;
    gap: 0px;
    overflow-x: unset;
    grid-auto-flow: column;
    width: 100%;
    scrollbar-width: thin;
    scroll-behavior: smooth;
}
.itemRecx:nth-of-type(3) {
    margin-right: 0;
}
.itemRecTitlex {
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
    .buttonaddcontainer {
        display: flex;
        margin: auto;
        padding: 0px 15px 0 0;
        margin-left: -70px;
    }
.btnAddRecx {
        background: transparent;
        font-weight: 900 !important;
        font-size: 30px !important;
        border-radius: 50px;
        color: #fff;
        display: flex;
        text-align: center;
        text-decoration: unset !important;
        background: #CB33FB;
        margin: auto !important;
        padding: 0px 12px;
}
.shippingMessagex {
    margin: 5px 0;
    font-size: 14px;
    line-height: 24px;
    color: #737373;
    font-weight: 400;
}
.dynamicSuggestionsx .itemTitlePricex {
    margin-bottom: 0;
}
.dynamicSuggestionsx .cartItemx {
    padding-bottom: 14px;
    border: unset;
}
.dynamicSuggestionsxb .itemTitlePricex {
    margin-bottom: 0;
}
.dynamicSuggestionsxb .cartItemx {
    padding-bottom: 14px;
    border: unset;
}

/* Related Products */
.relatedProductsx {
    border-bottom: 1.5px solid #d9d9d9;
    margin-top: -5px;
    font-size: 20px;
}
.relatedProductsx > p {
    font-weight: 700;
    font-size: 14px;
    line-height: 18px;
    color: #1d1d1b;
    margin: 0;
}

/* Gift Text */
.giftTextx {
    display: block;
}
.giftTextLeftx {
    font-weight: 400;
    font-size: 12px;
    line-height: 12px;
    color: #1d1d1b;
    text-align: center;
}
.giftTextRightx,
.textAfterLeftx {
    font-weight: 700;
    color: #1d1d1b;
}
.giftTextLeftx p,
.textAfterLeftx p {
    margin: 0;
}

/* Gift Text Right */
.giftTextRightx {
    font-weight: 400;
    font-size: 10px;
    line-height: 12px;
    text-align: center;
    color: #1D1D1B;
    margin-top: 2px;
}

/* Nur Noch */
.nurNochx {
    display: block;
    font-weight: 700;
    font-size: 14px;
    line-height: 14px;
    text-align: center;
    color: #CA32F9;
}

/* Gift Text Freigeschaltet */
.giftTextfreigeschaltetx {
    display: block;
    font-weight: 700;
    font-size: 14px;
    line-height: 14px;
    text-align: center;
    color: #02B701;
    margin-top: 10px;
}

/* Gift Icon */
.giftIconx {
    position: absolute;
    width: 80px;
    height: 80px;
    border: 5px solid transparent;
    margin: auto;
}
.giftIconx img {
    width: 100%;
    border-radius: 50%;
}

/* Top Cart Item Recommend */
.topCartItemx.recommend {
    grid-row: 2 !important;
    grid-template-columns: 1fr 1fr !important;
    margin: auto !important;
    gap: 40px !important;
    margin-top: 0;
}

/* Gift Text Icon */
.giftTextIconx {
    display: block;
    position: relative;
    z-index: 1;
    margin: auto;
}
.giftTextIconx svg,
.giftTextIconx img {
    height: auto;
    width: 100%;
    display: block;
}

/* Free Gift Holder */
.freeGiftHolderx {
    width: calc(100% + 64px);
    margin-left: -32px;
    padding: 16px 32px;
    background-color: #F1E9DE;
    position: relative;
    text-align: center;
    justify-content: center;
}

/* Run Animation */
.runAnimationx .textAfterx {
    padding: 14px 15px;
    grid-template-columns: 1fr 32px;
    gap: 25px;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    place-items: center;
    display: none;
    z-index: 2;
}
.textAfterLeftx {
    font-size: 16px;
    line-height: 24px;
}
.textAfterRightx svg {
    width: 32px;
    height: auto;
}

/* Media Queries */
@media only screen and (max-width: 1100px) {
    .savings-container {
        margin: auto;
        font-size: 14px;
        line-height: 16px;
    }
    .btnAddRecx.recommendx.desktopx {
        display: none;
    }
    .my-cartx, .my-cartx * {
        font-family: "Nunito" !important;
    }
    body.js-my-cart-open {
        overflow: hidden;
    }
    body.js-my-cart-open .backgroundBlurx {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: 9999999; /* Ensure it appears above other elements */
        background-color: rgba(47, 47, 49, 0.3); /* Background blur effect */
        overflow-y: hidden;
    }
    .my-cartx {
        transform: translateX(100%);
        position: fixed;
        z-index: 999999999;
        background: white;
        transition: transform 0.2s ease-in-out;
        opacity: 1;
        top: 0px;
        right: 0;
        width: 100%;
        max-width: 567px;
        background-color: #ffffff;
        box-shadow: rgba(0, 0, 0, 0.15) 0px 0px 20px 0px;
        overflow-y: scroll;
    }
.closeCartx {
    cursor: !important;
    display: block;
    position: absolute;
    right: 15px;
    top: 15px;
    z-index: 9999999999; /* Ensure it appears above other elements */
}
.closeCartx svg {
    height: 28px;
    width: 28px;
    display: flex;
    margin: auto;
}
    .closeCart-arrow {
        cursor: pointer;
        display: block;
        position: absolute;
        left: 10px;
        top: 25px;
    }
    .closeCart-arrow svg {
        height: 24px;
        width: 24px;
        display: flex;
        margin: auto;
    }
    .cartTitlex, .cartTitlex p {
        margin: 0;
        font-weight: 900;
        font-size: 18px;
        line-height: 24px;
        color: #000000;
    }
    .cartDivx {
        padding: 0px 15px 0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
        overflow-y: scroll;
    }
    .cartHeaderx {
        font-size: 20px;
        font-weight: 600;
        padding-bottom: 30px;
        border-bottom: 1px solid #e2e2e2;
    }
    .freeShippingHeaderx {
        display: block;
        text-align: center;
        margin: 0px -40px;
        color: #1d1d1d;
        font-weight: 700;
        font-size: 20px;
        padding-top: 5px;
        background: #F1E9DE;
    }
    .freeShippingHeaderx-3 {
        display: block;
        text-align: center;
        margin: 0px -40px;
        color: #1d1d1d;
        font-weight: 700;
        font-size: 20px;
        padding-top: 5px;
        background: #F1E9DE;
    }
    .freeShippingHeaderx-2 {
        display: block;
        text-align: center;
        margin: 0px -40px;
        color: #CA32F9;
        font-weight: 700;
        font-size: 18px;
        padding: 10px 60px;
        background: #F1E9DE;      
    }
    .freeshippingfurther {
      font-size: 14px;
      line-height: 14px !important;
      color: #1d1d1d;
      font-weight: 400;
    }
    .freeShippingHeaderxb {
        display: block;
        text-align: center;
        margin: 0px -40px;
        color: #1d1d1d;
        font-weight: 700;
        font-size: 20px;
        padding-top: 5px;
        background: #F1E9DE;
    }
    .freeShippingx {
        padding: 0px;
        border-bottom: 0;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        margin: 0px -15px 0px;
        background-color: #F1E9DE;
        z-index: 9;
    }
    .giftDifferencex {
        display: block;
        text-align: center;
        margin: 0 -15px;
        color: #1D1D1C;
        font-weight: 400;
        font-size: 14px;
        line-height: 14px;
        background: #F1E9DE;
        padding: 0px 34px 5px;
    }
    .freeShippingBarEmptyx {
        position: relative;
        width: 70px;
        height: 70px;
        border-radius: 50%;
        overflow: hidden;
        margin: auto;
        font-size: 18px;
    }
    .freeShippingBarFullx {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    .freeShippingBarFull1x {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    .progress-ring__circlex {
        stroke: green;
        stroke-width: 6;
        cx: 25;
        cy: 25;
        r: 23;
        transition: stroke-dashoffset 0.5s ease-out;
    }
    .giftIconx {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 70px;
        height: 70px;
        transform: translate(-50%, -50%);
    }
    .giftIconx img {
        width: 100%;
        border-radius: 50%;
    }
    .emptyCartx {
        padding: 30px 0;
        background-color: #e8e8e8;
        text-align: center;
        font-weight: 500;
        font-size: 20px;
        margin-top: 20px;
    }
    .js-my-cart-open .my-cartx {
        transform: translateX(0);
    }
    .pfand-item {
        display: flex;
        border-bottom: 0px;
        justify-content: space-between;
        margin: auto;
        padding: 2px 0 2px;
        margin-left: 60px;
    }
    .pfand-item2 {
        width: 100%;
        display: grid;
        grid-template-columns: 50px 1fr auto;
        gap: 10px;
        padding: 10px 0 10px;
    }
    .cartItemx {
        width: 100%;
        display: grid;
        gap: 0px;
        padding: 10px 0 10px;
        border-bottom: 1px solid #f3f3f3;
    }
    .cartItemx.recommendx {
        padding-top: 0px;
        width: auto;
        margin-top: 0;
        scroll-snap-align: start;
        flex: 0 0 auto;
    }
    .cartItemx.recommendxb {
        padding-top: 0px;
        margin-top: 0;
    }
    .my-cartx__itemsx {
        min-height: 45vh;
        padding: 30px 0;
        overflow-y: hidden;
        overflow-x: hidden;
        height: calc(100% - 100px);
    }
    .itemImagex {
        width: 100%;
    }
    .itemImagex img {
        width: 100%;
        border-radius: 3px;
    }
    .topCartItemx {
        display: grid;
        grid-template-columns: 1fr 14px;
        gap: 14px;
    }
    .subTypex {
        font-weight: 800;
        font-size: 10px;
        line-height: 14px;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: #737373;
        display: flex;
        align-items: center;
    }
    .propertiesx, .propertiesx * {
        display: block;
        text-decoration: unset;
        font-size: 12px;
        font-weight: 400;
    }
    .itemInfox {
        padding-left: 12px;
        width: 100%;
    }
    .itemRemovex {
        height: 18px;
    }
    .itemRemovex, .itemRemovex svg {
        display: inline;
        vertical-align: middle;
    }
    .itemTitlePricex {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0px;
    }
    .itemPricex {
        margin-left: 4px;
        line-height: 0;
    }
    .itemTitlePricex .itemPricex {
      text-align: right;
    }
    .compareCartx {
        font-weight: 700;
        font-size: 14px;
        line-height: 14px;
        text-decoration-line: line-through;
        text-transform: uppercase;
        color: #EB001B;
        display: inline-flex;
    }
    .normalCartx {
        font-weight: 700;
        font-size: 14px;
        line-height: 14px;
        text-transform: uppercase;
        color: #29282C;
        display: inline-flex;
    }
    .itemTitlex {
        font-size: 14px;
        font-weight: 500;
        line-height: 14px;
        width: auto;
    }
    .itemTitlex a {
        font-weight: 700;
        font-size: 14px;
        line-height: 14px;
        text-transform: capitalize;
        color: #1D1D1B;
        text-decoration: unset !important;
    }
    .itemQtyx {
      display: flex;
      background: #F1F1F1;
      border-radius: 50px;
      width: 95px;
      padding: 4px;
      height: 28px;
    }
    .itemMinusx.itemMinusx {
        background: #F1F1F1;
    }
    .itemMinusx.itemMinusx svg path {
        fill: #C4C3C8;
    }
    .itemPlusx.itemPlusx {
        background-color: #000 !important;
    }
    .itemPlusx.itemPlusx svg path {
        fill: #fff;
    }
    .itemQtyx input {
    	width: 45px;
      	text-align: center;
      	border: 0;
        font-weight: 700;
        font-size: 11px;
        line-height: 9px;
        color: #1D1D1B;
    }
    .itemQtyx .quantity__button {
      width: 20px;
      border-radius: 50px;
      height: 20px;
    }
    .itemQtyx .quantity__button .itemPlus.itemPlus {
      margin-right: 4px;
    }
    .itemQtyxWord {
    	font-size: 14px;
      	margin-bottom: 10px;
    }
    .bottomCartx {
        padding: 5px 15px 10px;
        background: #f1e9de;
        min-width: calc(100% + 30px);
        margin-left: -15px;
        z-index: 1;
    }
    .bottomCartx button {
        width: 100%;
        padding: 10px;
        color: #fff;
        background: #CB33FB;
        border-radius: 50px;
        transition: all .5s ease-in-out;
        text-align: center;
        font-weight: 800;
        font-size: 16px;
        line-height: 32px;
        color: #FFFFFF;
        border: 0;
        margin-top: 2px;
        cursor: pointer;
    }
    .bottomCartx button:hover {
        background: #CB33FB;
    }
    .dynamicSuggestionsx {
        display: grid;
        grid-template-columns: auto;
        gap: 0px;
        overflow-x: auto;
        grid-auto-flow: column;
        width: 100%;
        scrollbar-width: thin;
        scroll-behavior: smooth;
    }
    .dynamicSuggestionsxb {
        display: grid;
        grid-template-columns: repeat(3, 100%) auto;
        gap: 0px;
        overflow-x: unset;
        grid-auto-flow: column;
        width: 100%;
        scrollbar-width: thin;
        scroll-behavior: smooth;
    }
    .itemRecx {
        width: calc(33% - 5px);
        margin-right: 10px;
    }
    .itemRecx:nth-of-type(3) {
        margin-right: 0;
    }
    .itemRecx img {
        width: 100%;
    }
    .itemRecTitlex {
        font-size: 13px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    .buttonaddcontainer {
        display: flex;
        margin: auto;
        padding: 0px 15px 0 0;
        margin-left: -70px;
    }
    .btnAddRecx {
        font-weight: 900 !important;
        font-size: 30px !important;
        border-radius: 50px;
        color: #fff;
        display: flex;
        text-align: center;
        text-decoration: unset !important;
        background: #CB33FB;
        margin: auto !important;
    }
    .topCartItemx.recommendx {
        grid-row: 2 !important;
        grid-template-columns: 1fr 1fr !important;
        margin: auto !important;
        gap: 30px !important;
        margin-top: -10px;
    }
    .cartItemx:first-of-type {
        margin-top: 2px;
    }
    .cartItemx.recommendx:first-of-type {
        width: auto;
       min-width: 300px;
    }
    .shippingMessagex {
        font-weight: 400;
        font-size: 10px;
        line-height: 12px;
        text-align: center;
        color: #000;
        margin: 10px 0px;
    }
    .dynamicSuggestionsx .itemPricex {
        padding-top: 0;
        text-aling: left;
    }
    .dynamicSuggestionsx .itemTitlePricex {
        margin-bottom: 0;
    }
    .dynamicSuggestionsx .cartItemx {
        padding-bottom: 0px;
        border: unset;
        margin-top: 0px;
    }
    .dynamicSuggestionsxb .itemPricex {
        padding-top: 0;
       text-aling: left;
    }
    .dynamicSuggestionsxb .itemTitlePricex {
        margin-bottom: 0;
    }
    .dynamicSuggestionsxb .cartItemx {
        padding-bottom: 5px;
        border: unset;
        margin-top: 0px;
    }
    .relatedProductsx {
        border-bottom: 1.5px solid #D9D9D9;
    }
    .relatedProductsx > p {
        font-weight: 700;
        font-size: 14px;
        line-height: 18px;
        color: #1D1D1B;
        margin: 0;
    }
    .belowThresholdx:nth-of-type(2) {}
    .giftTextx {
        display: block;
        text-align: center;
    }
    .giftTextLeftx {
        font-weight: 400;
        font-size: 8px;
        line-height: 10px;
        color: #1D1D1B;
        text-align: center;
        margin-top: 4px
    }
    .giftTextRightx {
        font-weight: 400;
        font-size: 8px;
        line-height: 10px;
        text-align: center;
        color: #1D1D1B;
        margin-top: 2px;
    }
    .nurNochx {
        display: block;
        font-weight: 700;
        font-size: 14px;
        text-align: center;
        color: #CA32F9;
    }
    .giftTextfreigeschaltetx {
        display: block;
        font-weight: 700;
        font-size: 10px;
        line-height: 10px;
        text-align: center;
        color: #02B701;
        margin-top: 8px;
    }
    .giftTextIconx {
        position: relative;
        z-index: 1;
        margin: auto;
    }
    .freeGiftHolderx {
        padding: 0px 0px 10px;
        background-color: transparent;
        position: relative;
        text-align: right;
        width: 100%;
        margin: 10px 0px;
        background-color: #F1E9DE;
    }
    .progress-bar-containerx {
      top: 31px;
      width: calc(100% - 55px);
      height: 7px;
      margin-left: calc(-50% + 28px);
    }
    div.freeGiftHolderx:nth-child(1) > div:nth-child(1) {
        width: calc(50% - 32px);
        margin-left: 0px;
    }
    .runAnimationx .freeShippingBarFullx:after {
        width: 667px;
        height: 667px;
        transform: translate(100px, -50%);
    }
    .textAfterx {
        padding: 4px 15px;
        display: grid;
        grid-template-columns: 1fr 20px;
        gap: 30px;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        place-items: center;
        display: none;
        z-index: 2;
    }
    .textAfterLeftx {
        font-weight: 700;
        font-size: 12px;
        line-height: 16px;
        color: #1D1D1B;
    }
    .textAfterLeftx p {
        margin: 0;
    }
    .textAfterRightx svg {
        width: 26px;
        height: 26px;
    }
}

@media only screen and (max-width: 1100px) {
    .my-cartx,
    .my-cartx__itemsx {
        overflow-y: scroll;
        overflow-x: hidden;
    }
    .cartDivx,
    .my-cartx,
    .my-cartx__itemsx {
        overflow-x: hidden;
    }
    .my-cartx {
        top: 0;
        right: 0;
        left: 0;
        width: 100%;
        max-width: 100%;
        height: 100dvh;
        max-height: unset;
    }
    .my-cartx__itemsx {
        min-height: 35vh;
        padding: 16px 0;
        height: calc(100% - 75px);
    }
    .runAnimationx .freeShippingBarFullx:after {
        width: 520px;
        height: 520px;
    }
    .cartProductsDivx {
        height: 100% !important;
        overflow-y: scroll;
        scrollbar-width: none; /* For Firefox */
        -ms-overflow-style: none; /* For Internet Explorer 10+ */
    }
    .cartProductsDivx::-webkit-scrollbar {
        display: none; /* For Chrome, Safari, and Opera */
    }
}

@media only screen and (min-width: 1100px) {
    .cartProductsDivx {
        height: 100% important;
        overflow-y: scroll;
        scrollbar-width: none; /* For Firefox */
        -ms-overflow-style: none; /* For Internet Explorer 10+ */
    }
    .cartProductsDivx::-webkit-scrollbar {
        display: none; /* For Chrome, Safari, and Opera */
    }
    .btnAddRecx.recommendx.mobilex {
        display: none;
    }
}

@supports not (height: 100dvh) {
    .my-cartx {
        height: calc(100vh - 100px);
    }
}

/* Strike OG */
.strike-og {
    text-decoration: line-through;
  font-size: 12px;
}

/* Discount Field Cart */
.discount-field-cart {
    text-align: left;
    color: #fff;
    font-size: 14px;
    line-height: 18px;
    font-weight: 900;
    background: #03B701;
    border-radius: 10px 0px 10px 10px;
    padding: 0px 4px;
    margin: auto;
    display: none;
}
.discount-field-cart-absolute {
    display: flex;
    text-align: center;
    color: #fff;
    font-size: 16px;
    font-weight: 900;
    background: #03B701;
    border-radius: 50px;
    padding: 0px 10px;
    margin: auto;
}

/* Arrow */
.arrowx {
    display: flex;
    justify-content: space-between;
    color: #CA32F9;
    font-size: 20px;
}
.left-arrowx {
    left: 10px;
    cursor: pointer;
}
.right-arrowx {
    right: 10px;
    cursor: pointer;
}

/* Dynamic Suggestions */
.dynamicSuggestionsx {
    scroll-behavior: smooth;
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}
.dynamicSuggestionsx::-webkit-scrollbar {
    display: none;  /* Chrome, Safari, and Opera */
}

@media only screen and (max-width: 1100px) {
    .itemSubtitlex {
        font-size: 12px;
        font-weight: 500;
        line-height: 12px;
        margin: 0px 4px 4px 0px;
        color: #737373;
    }
      .preOrderTagx {
        font-size: 12px;
        font-weight: 500;
        line-height: 12px;
        margin: 0px 4px 4px 0px;
        color: orange;
    }  
    .arrowx {
        display: flex;
        justify-content: space-between;
        color: #CA32F9;
        font-size: 12px;
    }
    .left-arrowx {
        left: 10px;
        margin-top: 16px;
        display: none;
    }
    .right-arrowx {
        right: 10px;
        margin-top: 16px;
        display: none;
    }
}

@media only screen and (min-width: 1100px) {
    .itemSubtitlex {
        font-size: 14px;
        font-weight: 800;
        line-height: 14px;
        margin: 0;
        color: #737373;
    }
      .preOrderTagx {
        font-size: 14px;
        font-weight: 800;
        line-height: 14px;
        margin: 0;
        color: orange;
    }
}

/* Auto-Added Gift */
.auto-added-giftx {
    display: none;
}

/* Cart Items Scrollbar */
.my-cartx__items::-webkit-scrollbar {
    display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.my-cartx__items {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
}
</style>

<link rel="preload" as="font" href="https://www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.eeda324bc2f350e5c92cf5ef4a0712035386bd19.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&amp;h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&amp;h3=YWhlYWQtbnV0cml0aW9uLml0&amp;h4=YWhlYWQtbnV0cml0aW9uLmZy&amp;h5=YWhlYWQtbnV0cml0aW9uLmVz&amp;hmac=867e2ecd667e51ddcae5edfb35a6a2337d7b57e0019ed233af229fde69656538" type="font/woff2" crossorigin=""><link rel="preload" as="font" href="https://www.ahead-nutrition.com/cdn/fonts/nunito/nunito_n4.eeda324bc2f350e5c92cf5ef4a0712035386bd19.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&amp;h2=YWhlYWQtbnV0cml0aW9uLmFjY291bnQubXlzaG9waWZ5LmNvbQ&amp;h3=YWhlYWQtbnV0cml0aW9uLml0&amp;h4=YWhlYWQtbnV0cml0aW9uLmZy&amp;h5=YWhlYWQtbnV0cml0aW9uLmVz&amp;hmac=867e2ecd667e51ddcae5edfb35a6a2337d7b57e0019ed233af229fde69656538" type="font/woff2" crossorigin=""><script>
/*! jQuery v3.6.1 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,y=n.hasOwnProperty,a=y.toString,l=a.call(Object),v={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.1",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=y.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:v}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,y,s,c,v,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&v(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!y||!y.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ve(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace(B,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ye(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ve(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],y=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||y.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||y.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||y.push(".#.+[+~]"),e.querySelectorAll("\\\f"),y.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),y=y.length&&new RegExp(y.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),v=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&v(p,e)?-1:t==C||t.ownerDocument==p&&v(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!y||!y.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),v(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace($," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,y){var v="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===y?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=v!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(v){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=y)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace(B,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ye(function(){return[0]}),last:ye(function(e,t){return[t-1]}),eq:ye(function(e,t,n){return[n<0?n+t:n]}),even:ye(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ye(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ye(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ye(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,y,v,e){return y&&!y[S]&&(y=Ce(y)),v&&!v[S]&&(v=Ce(v,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?v||(e?d:l||y)?[]:t:f;if(g&&g(f,p,n,r),y){i=Te(p,u),y(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(v||d){if(v){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);v(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=v?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),v?v(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(B,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(B," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,y,v,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(y=o,m=0<(v=i).length,x=0<y.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=y[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=v[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+v.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ve(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ve(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function $(){E.removeEventListener("DOMContentLoaded",$),C.removeEventListener("load",$),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",$),C.addEventListener("load",$));var B=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)B(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):B(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),v.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",v.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,v.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=y.events)||(u=y.events=Object.create(null)),(a=y.handle)||(a=y.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=Y.hasData(e)&&Y.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||S.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(t,e){S.event.special[t]={setup:function(){return Se(this,t,Ce),!1},trigger:function(){return Se(this,t),!0},_default:function(e){return Y.get(e.target,t)},delegateType:e}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!v.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ye(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ye(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ye(r)),r.parentNode&&(n&&ie(r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(v.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ye(c),r=0,i=(o=ye(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ye(e),a=a||ye(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ye(c,"script")).length&&ve(a,!f&&ye(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return B(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return B(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ye(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=/^--/,Me=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Ie=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},We=new RegExp(ne.join("|"),"i"),Fe="[\\x20\\t\\r\\n\\f]",$e=new RegExp("^"+Fe+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Fe+"+$","g");function Be(e,t,n){var r,i,o,a,s=Re.test(t),u=e.style;return(n=n||Me(e))&&(a=n.getPropertyValue(t)||n[t],s&&(a=a.replace($e,"$1")),""!==a||ie(e)||(a=S.style(e,t)),!v.pixelBoxStyles()&&Pe.test(a)&&We.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(v,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var ze=["Webkit","Moz","ms"],Ue=E.createElement("div").style,Xe={};function Ve(e){var t=S.cssProps[e]||Xe[e];return t||(e in Ue?e:Xe[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=ze.length;while(n--)if((e=ze[n]+t)in Ue)return e}(e)||e)}var Ge=/^(none|table(?!-c[ea]).+)/,Ye={position:"absolute",visibility:"hidden",display:"block"},Qe={letterSpacing:"0",fontWeight:"400"};function Je(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ke(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Ze(e,t,n){var r=Me(e),i=(!v.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=Be(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!v.boxSizingReliable()&&i||!v.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Ke(e,t,n||(i?"border":"content"),o,r,a)+"px"}function et(e,t,n,r,i){return new et.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Be(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Re.test(t),l=e.style;if(u||(t=Ve(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Re.test(t)||(t=Ve(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Be(e,t,r)),"normal"===i&&t in Qe&&(i=Qe[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ge.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Ze(e,u,n):Ie(e,Ye,function(){return Ze(e,u,n)})},set:function(e,t,n){var r,i=Me(e),o=!v.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Ke(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Ke(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Je(0,t,s)}}}),S.cssHooks.marginLeft=_e(v.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Be(e,"marginLeft"))||e.getBoundingClientRect().left-Ie(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Je)}),S.fn.extend({css:function(e,t){return B(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Me(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=et).prototype={constructor:et,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}}).init.prototype=et.prototype,(et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[Ve(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=et.prototype.init,S.fx.step={};var tt,nt,rt,it,ot=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function st(){nt&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(st):C.setTimeout(st,S.fx.interval),S.fx.tick())}function ut(){return C.setTimeout(function(){tt=void 0}),tt=Date.now()}function lt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ct(e,t,n){for(var r,i=(ft.tweeners[t]||[]).concat(ft.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ft(o,e,t){var n,a,r=0,i=ft.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=tt||ut(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:tt||ut(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=ft.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ct,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(ft,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],ft.tweeners[n]=ft.tweeners[n]||[],ft.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ot.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(y?"hidden"in y&&(g=y.hidden):y=Y.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ct(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?ft.prefilters.unshift(e):ft.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=ft(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&at.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(lt(r,!0),e,t,n)}}),S.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),tt=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){nt||(nt=!0,st())},S.fx.stop=function(){nt=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},rt=E.createElement("input"),it=E.createElement("select").appendChild(E.createElement("option")),rt.type="checkbox",v.checkOn=""!==rt.value,v.optSelected=it.selected,(rt=E.createElement("input")).value="t",rt.type="radio",v.radioValue="t"===rt.value;var pt,dt=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return B(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?pt:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!v.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),pt={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=dt[t]||S.find.attr;dt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=dt[o],dt[o]=r,r=null!=a(e,t,n)?o:null,dt[o]=i),r}});var ht=/^(?:input|select|textarea|button)$/i,gt=/^(?:a|area)$/i;function yt(e){return(e.match(P)||[]).join(" ")}function vt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return B(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):ht.test(e.nodeName)||gt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),v.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a;return m(t)?this.each(function(e){S(this).addClass(t.call(this,e,vt(this)))}):(e=mt(t)).length?this.each(function(){if(r=vt(this),n=1===this.nodeType&&" "+yt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=yt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return m(t)?this.each(function(e){S(this).removeClass(t.call(this,e,vt(this)))}):arguments.length?(e=mt(t)).length?this.each(function(){if(r=vt(this),n=1===this.nodeType&&" "+yt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=yt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return m(t)?this.each(function(e){S(this).toggleClass(t.call(this,e,vt(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=mt(t),this.each(function(){if(s)for(o=S(this),i=0;i<e.length;i++)r=e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=vt(this))&&Y.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":Y.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+yt(vt(n))+" ").indexOf(t))return!0;return!1}});var xt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(xt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:yt(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},v.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),v.focusin="onfocusin"in C;var bt=/^(?:focusinfocus|focusoutblur)$/,wt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=y.call(e,"type")?e.type:e,h=y.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!bt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,bt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,wt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,wt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),v.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var Tt=C.location,Ct={guid:Date.now()},Et=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var St=/\[\]$/,kt=/\r?\n/g,At=/^(?:submit|button|image|reset|file)$/i,Nt=/^(?:input|select|textarea|keygen)/i;function jt(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||St.test(n)?i(n,t):jt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)jt(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&Nt.test(this.nodeName)&&!At.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var Dt=/%20/g,qt=/#.*$/,Lt=/([?&])_=[^&]*/,Ht=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ot=/^(?:GET|HEAD)$/,Pt=/^\/\//,Rt={},Mt={},It="*/".concat("*"),Wt=E.createElement("a");function Ft(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function $t(t,i,o,a){var s={},u=t===Mt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Bt(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Wt.href=Tt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Tt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":It,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Bt(Bt(e,S.ajaxSettings),t):Bt(S.ajaxSettings,e)},ajaxPrefilter:Ft(Rt),ajaxTransport:Ft(Mt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,y=S.ajaxSetup({},t),v=y.context||y,m=y.context&&(v.nodeType||v.jquery)?S(v):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=y.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Ht.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(y.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),y.url=((e||y.url||Tt.href)+"").replace(Pt,Tt.protocol+"//"),y.type=t.method||t.type||y.method||y.type,y.dataTypes=(y.dataType||"*").toLowerCase().match(P)||[""],null==y.crossDomain){r=E.createElement("a");try{r.href=y.url,r.href=r.href,y.crossDomain=Wt.protocol+"//"+Wt.host!=r.protocol+"//"+r.host}catch(e){y.crossDomain=!0}}if(y.data&&y.processData&&"string"!=typeof y.data&&(y.data=S.param(y.data,y.traditional)),$t(Rt,y,t,T),h)return T;for(i in(g=S.event&&y.global)&&0==S.active++&&S.event.trigger("ajaxStart"),y.type=y.type.toUpperCase(),y.hasContent=!Ot.test(y.type),f=y.url.replace(qt,""),y.hasContent?y.data&&y.processData&&0===(y.contentType||"").indexOf("application/x-www-form-urlencoded")&&(y.data=y.data.replace(Dt,"+")):(o=y.url.slice(f.length),y.data&&(y.processData||"string"==typeof y.data)&&(f+=(Et.test(f)?"&":"?")+y.data,delete y.data),!1===y.cache&&(f=f.replace(Lt,"$1"),o=(Et.test(f)?"&":"?")+"_="+Ct.guid+++o),y.url=f+o),y.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(y.data&&y.hasContent&&!1!==y.contentType||t.contentType)&&T.setRequestHeader("Content-Type",y.contentType),T.setRequestHeader("Accept",y.dataTypes[0]&&y.accepts[y.dataTypes[0]]?y.accepts[y.dataTypes[0]]+("*"!==y.dataTypes[0]?", "+It+"; q=0.01":""):y.accepts["*"]),y.headers)T.setRequestHeader(i,y.headers[i]);if(y.beforeSend&&(!1===y.beforeSend.call(v,T,y)||h))return T.abort();if(u="abort",b.add(y.complete),T.done(y.success),T.fail(y.error),c=$t(Mt,y,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,y]),h)return T;y.async&&0<y.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},y.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(y,T,n)),!i&&-1<S.inArray("script",y.dataTypes)&&S.inArray("json",y.dataTypes)<0&&(y.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(y,s,T,i),i?(y.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===y.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(v,[o,l,T]):x.rejectWith(v,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,y,i?o:a]),b.fireWith(v,[T,l]),g&&(m.trigger("ajaxComplete",[T,y]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var _t={0:200,1223:204},zt=S.ajaxSettings.xhr();v.cors=!!zt&&"withCredentials"in zt,v.ajax=zt=!!zt,S.ajaxTransport(function(i){var o,a;if(v.cors||zt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(_t[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var Ut,Xt=[],Vt=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Xt.pop()||S.expando+"_"+Ct.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Vt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Vt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Vt,"$1"+r):!1!==e.jsonp&&(e.url+=(Et.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,Xt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),v.createHTMLDocument=((Ut=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ut.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(v.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=yt(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return B(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=_e(v.pixelPosition,function(e,t){if(t)return t=Be(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return B(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Gt=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Gt,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Yt=C.jQuery,Qt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Qt),e&&C.jQuery===S&&(C.jQuery=Yt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
</script>

    <script>
      document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
      if (Shopify.designMode) {
        document.documentElement.classList.add('shopify-design-mode');
      }
    </script>
    <!-- SEO SNIPPET -->
    
    <!-- SEO SNIPPET -->
    <script>
      window.forceDisableDiscountYard = true;
    </script>

    <!-- Mouseflow -->
    <script type="text/javascript">
      window._mfq = window._mfq || [];
      (function() {
        var mf = document.createElement("script");
        mf.type = "text/javascript";
        mf.defer = true;
        mf.src = "//cdn.mouseflow.com/projects/86188f29-c05d-44ea-be61-b56c3ea1f8b6.js";
        document.getElementsByTagName("head")[0].appendChild(mf);
      })();
    </script><script type="text/javascript" defer="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/86188f29-c05d-44ea-be61-b56c3ea1f8b6.js.download"></script>

    
  
<!-- START SCRIPT --><script id="wgs-scripttag-prod" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/wgs.bundle.js.download" async="true"></script><style>#customerReferenceId { display: none; }</style><!-- END SCRIPT -->


<!-- BEGIN app block: shopify://apps/pagefly-page-builder/blocks/app-embed/83e179f7-59a0-4589-8c66-c0dddf959200 -->
<script type="module">
  window.PAGEFLY = {page_optimization:{assets_prefetching: false}}
  window?.PAGEFLY?.page_optimization?.assets_prefetching && console.log('PageFly enabled prefetch assets')
</script>


<!-- END app block --><!-- BEGIN app block: shopify://apps/klaviyo-email-marketing-sms/blocks/klaviyo-onsite-embed/2632fe16-c075-4321-a88b-50b567f42507 -->












  <script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/klaviyo.js.download"></script>
  <script>!function(){if(!window.klaviyo){window._klOnsite=window._klOnsite||[];try{window.klaviyo=new Proxy({},{get:function(n,i){return"push"===i?function(){var n;(n=window._klOnsite).push.apply(n,arguments)}:function(){for(var n=arguments.length,o=new Array(n),w=0;w<n;w++)o[w]=arguments[w];var t="function"==typeof o[o.length-1]?o.pop():void 0,e=new Promise((function(n){window._klOnsite.push([i].concat(o,[function(i){t&&t(i),n(i)}]))}));return e}}})}catch(n){window.klaviyo=window.klaviyo||[],window.klaviyo.push=function(){var n;(n=window._klOnsite).push.apply(n,arguments)}}}}();</script>

  




  <script>
    window.klaviyoReviewsProductDesignMode = false
  </script>







<!-- END app block --><!-- BEGIN app block: shopify://apps/elevar-conversion-tracking/blocks/dataLayerEmbed/bc30ab68-b15c-4311-811f-8ef485877ad6 -->



<script type="module" dynamic="">
  const configUrl = "/a/elevar/static/configs/9de3b7605bcb8d394c468bb927fa34ce24cecb80/config.js";
  const config = (await import(configUrl)).default;
  const scriptUrl = config.script_src_app_theme_embed;

  if (scriptUrl) {
    const { handler } = await import(scriptUrl);

    handler(
      config,
      {
        cartData: {
  marketId: "25722967",
  attributes:{"igId":"ig_ef0275d3c2f59e4b696c3534911d67e67d5a","_customerReferenceId":"752416b7-a77e-59ef-a9c0-6faa85a5dde6","_elevar__uetsid":"5d112060e52c11ef98ec1fc9c5720faa","_elevar__uetvid":"0f3882a0135511efa48a09be2089c971","_elevar__fbp":"fb.1.1733392564668.154834470","_elevar__ttp":"S_gb6V6KMUHPnGHZFRdremzrvrU","_elevar_ssn_wgs_ga_cmp":"{\u0026quot;uniqueTS\u0026quot;:1715844140,\u0026quot;userId\u0026quot;:3456456}","_elevar_ssn_wgs_ga_tid":"GS1.1.1738915236.40.1.0.60","_elevar_visitor_info":"{\u0026quot;user_id\u0026quot;:\u0026quot;ee80ceb9-75fe-41ce-b60f-f1cbbb9884dd\u0026quot;,\u0026quot;session_id\u0026quot;:\u0026quot;1738915235\u0026quot;,\u0026quot;session_count\u0026quot;:\u0026quot;101\u0026quot;,\u0026quot;consent_v2\u0026quot;:{\u0026quot;ad_storage\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;analytics_storage\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;ad_user_data\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;ad_personalization\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;functionality_storage\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;personalization_storage\u0026quot;:{\u0026quot;default\u0026quot;:false,\u0026quot;update\u0026quot;:false},\u0026quot;security_storage\u0026quot;:{\u0026quot;default\u0026quot;:true,\u0026quot;update\u0026quot;:true}},\u0026quot;market_id\u0026quot;:\u0026quot;25722967\u0026quot;,\u0026quot;referrer\u0026quot;:\u0026quot;https:\/\/www.skailama.com\/\u0026quot;}","gbbDiscountCode-Bundle Builder":"BB5-JDTXRV8WQE"},
  cartTotal: "8100.0",
  currencyCode:"INR",
  items: [{id:"010104-1",name:"Hazelnut-Cacao",
        brand:"ahead® | The Human Performance Company",
        category:"Schokoriegel",
        variant:"18 Riegel",
        price: "2700.0",
        position:1,
        quantity: "1",
        productId: "7964092072200",
        variantId: "43530481139976",
        compareAtPrice: "0.0",
        image: "//www.ahead-nutrition.com/cdn/shop/products/B09QT242YD.02.jpg?v=1682067646",
        url:"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976"},{id:"010102-1",name:"Coconut-Almond",
        brand:"ahead® | The Human Performance Company",
        category:"Schokoriegel",
        variant:"18 Riegel",
        price: "2700.0",
        position:2,
        quantity: "1",
        productId: "6610491048023",
        variantId: "39418248364119",
        compareAtPrice: "0.0",
        image: "//www.ahead-nutrition.com/cdn/shop/files/B09GRCR2DL.03.jpg?v=1688630743",
        url:"\/products\/ahead-riegel-coconut-almond?variant=39418248364119"},{id:"010104-1",name:"Hazelnut-Cacao",
        brand:"ahead® | The Human Performance Company",
        category:"Schokoriegel",
        variant:"18 Riegel",
        price: "2700.0",
        position:3,
        quantity: "1",
        productId: "7964092072200",
        variantId: "43530481139976",
        compareAtPrice: "0.0",
        image: "//www.ahead-nutrition.com/cdn/shop/products/B09QT242YD.02.jpg?v=1682067646",
        url:"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976"},]
}
,
        user: {cartTotal: "8100.0",
    currencyCode:"INR",customer: {},
}
,
        isOnCartPage:false,
        collectionView:null,
        searchResultsView:null,
        productView:null,
        checkoutComplete: null
      }
    );
  }
</script>


<!-- END app block --><script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/pagefly.js.download" type="text/javascript" defer="defer"></script>
<script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/giftBoxLogicv1.js.download" type="text/javascript" defer="defer"></script>
<link href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/giftBoxv1.css" rel="stylesheet" type="text/css" media="all">
<link href="https://monorail-edge.shopifysvc.com/" rel="dns-prefetch">
<script>(function(){if ("sendBeacon" in navigator && "performance" in window) {var session_token = document.cookie.match(/_shopify_s=([^;]*)/);function handle_abandonment_event(e) {var entries = performance.getEntries().filter(function(entry) {return /monorail-edge.shopifysvc.com/.test(entry.name);});if (!window.abandonment_tracked && entries.length === 0) {window.abandonment_tracked = true;var currentMs = Date.now();var navigation_start = performance.timing.navigationStart;var payload = {shop_id: 21363937,url: window.location.href,navigation_start,duration: currentMs - navigation_start,session_token: session_token && session_token.length === 2 ? session_token[1] : "",page_type: "page"};window.navigator.sendBeacon("https://monorail-edge.shopifysvc.com/v1/produce", JSON.stringify({schema_id: "online_store_buyer_site_abandonment/1.1",payload: payload,metadata: {event_created_at_ms: currentMs,event_sent_at_ms: currentMs}}));}}window.addEventListener('pagehide', handle_abandonment_event);}}());</script>
<script id="web-pixels-manager-setup">(function d(d,e,n,o,r,i){if(!Boolean(null===(t=null===(a=window.Shopify)||void 0===a?void 0:a.analytics)||void 0===t?void 0:t.replayQueue)){var a,t,s=function(){var d={modern:/Edge?\/(1{2}[4-9]|1[2-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|Firefox\/(1{2}[4-9]|1[2-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|Chrom(ium|e)\/(9{2}|\d{3,})\.\d+(\.\d+|)|(Maci|X1{2}).+ Version\/(15\.\d+|(1[6-9]|[2-9]\d|\d{3,})\.\d+)([,.]\d+|)( \(\w+\)|)( Mobile\/\w+|) Safari\/|Chrome.+OPR\/(9{2}|\d{3,})\.\d+\.\d+|(CPU[ +]OS|iPhone[ +]OS|CPU[ +]iPhone|CPU IPhone OS|CPU iPad OS)[ +]+(15[._]\d+|(1[6-9]|[2-9]\d|\d{3,})[._]\d+)([._]\d+|)|Android:?[ /-](13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})(\.\d+|)(\.\d+|)|Android.+Firefox\/(13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|Android.+Chrom(ium|e)\/(13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|SamsungBrowser\/([2-9]\d|\d{3,})\.\d+/,legacy:/Edge?\/(1[6-9]|[2-9]\d|\d{3,})\.\d+(\.\d+|)|Firefox\/(5[4-9]|[6-9]\d|\d{3,})\.\d+(\.\d+|)|Chrom(ium|e)\/(5[1-9]|[6-9]\d|\d{3,})\.\d+(\.\d+|)([\d.]+$|.*Safari\/(?![\d.]+ Edge\/[\d.]+$))|(Maci|X1{2}).+ Version\/(10\.\d+|(1[1-9]|[2-9]\d|\d{3,})\.\d+)([,.]\d+|)( \(\w+\)|)( Mobile\/\w+|) Safari\/|Chrome.+OPR\/(3[89]|[4-9]\d|\d{3,})\.\d+\.\d+|(CPU[ +]OS|iPhone[ +]OS|CPU[ +]iPhone|CPU IPhone OS|CPU iPad OS)[ +]+(10[._]\d+|(1[1-9]|[2-9]\d|\d{3,})[._]\d+)([._]\d+|)|Android:?[ /-](13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})(\.\d+|)(\.\d+|)|Mobile Safari.+OPR\/([89]\d|\d{3,})\.\d+\.\d+|Android.+Firefox\/(13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|Android.+Chrom(ium|e)\/(13\d|1[4-9]\d|[2-9]\d{2}|\d{4,})\.\d+(\.\d+|)|Android.+(UC? ?Browser|UCWEB|U3)[ /]?(15\.([5-9]|\d{2,})|(1[6-9]|[2-9]\d|\d{3,})\.\d+)\.\d+|SamsungBrowser\/(5\.\d+|([6-9]|\d{2,})\.\d+)|Android.+MQ{2}Browser\/(14(\.(9|\d{2,})|)|(1[5-9]|[2-9]\d|\d{3,})(\.\d+|))(\.\d+|)|K[Aa][Ii]OS\/(3\.\d+|([4-9]|\d{2,})\.\d+)(\.\d+|)/},e=d.modern,n=d.legacy,o=navigator.userAgent;return e.test(o)?"modern":(n.test(o),"legacy")}(),l=null!=i?i:{modern:"",legacy:""};window.Shopify=window.Shopify||{};var u=window.Shopify;u.analytics=u.analytics||{};var c=u.analytics;c.replayQueue=[],c.publish=function(d,e,n){return c.replayQueue.push([d,e,n]),!0};try{self.performance.mark("wpm:start")}catch(d){}var f=[n,"/wpm","/b",r,s.substring(0,1),".js"].join(""),h=l[s];!function(d){var e=d.src,n=d.async,o=void 0===n||n,r=d.onload,i=d.onerror,a=d.sri,t=document.createElement("script"),s=document.head,l=document.body;t.async=o,t.src=e,a&&(t.integrity=a,t.crossOrigin="anonymous"),r&&t.addEventListener("load",r),i&&t.addEventListener("error",i),s?s.appendChild(t):l?l.appendChild(t):console.error("Did not find a head or body element to append the script")}({src:f,async:!0,onload:function(){if(!function(){var d,e;return Boolean(null===(e=null===(d=window.Shopify)||void 0===d?void 0:d.analytics)||void 0===e?void 0:e.initialized)}()){var n=window.webPixelsManager.init(d)||void 0;if(n){e(n);var o=window.Shopify.analytics;o.replayQueue.forEach((function(d){var e=d[0],o=d[1],r=d[2];n.publishCustomEvent(e,o,r)})),o.replayQueue=[],o.publish=n.publishCustomEvent,o.visitor=n.visitor,o.initialized=!0}}},onerror:function(){var e=d.storefrontBaseUrl.replace(/\/$/,""),n="".concat(e,"/.well-known/shopify/monorail/unstable/produce_batch"),r=JSON.stringify({metadata:{event_sent_at_ms:(new Date).getTime()},events:[{schema_id:"web_pixels_manager_load/3.1",payload:{version:o||"latest",bundle_target:s,page_url:self.location.href,status:"failed",surface:d.surface,error_msg:"".concat(f," has failed to load")},metadata:{event_created_at_ms:(new Date).getTime()}}]});try{if(self.navigator.sendBeacon.bind(self.navigator)(n,r))return!0}catch(d){}var i=new XMLHttpRequest;try{return i.open("POST",n,!0),i.setRequestHeader("Content-Type","text/plain"),i.send(r),!0}catch(d){console&&console.warn&&console.warn("[Web Pixels Manager] Got an unhandled error while logging a load error.")}return!1},sri:function(d){return"string"==typeof d&&/^sha384-[A-Za-z0-9+/=]+$/.test(d)}(h)?h:""})}})({shopId: 21363937,storefrontBaseUrl: "https://www.ahead-nutrition.com",extensionsBaseUrl: "https://extensions.shopifycdn.com/cdn/shopifycloud/web-pixels-manager",surface: "storefront-renderer",enabledBetaFlags: ["6a396365"],webPixelsConfigList: [{"id":"1426817288","configuration":"{\"accountID\":\"1220658\",\"workspaceId\":\"b10d5359-c0f6-425f-96d9-851910695f0a\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"bbdf9710d2b5779316fc48c27992799c","type":"APP","apiClientId":5461967,"privacyPurposes":["ANALYTICS"]},{"id":"1425867016","configuration":"{\"advertiserId\":\"109748\",\"shopDomain\":\"ahead-nutrition.myshopify.com\",\"appVersion\":\"shopifyApp_5.0.0\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"b04639eb0d2aa44f551c9d825e2f8f7d","type":"APP","apiClientId":2887701,"privacyPurposes":["ANALYTICS","MARKETING"]},{"id":"1413316872","configuration":"{\"myshopifyDomain\":\"ahead-nutrition.myshopify.com\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"e32653096b768840c4e834ea506d7953","type":"APP","apiClientId":2775569,"privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"]},{"id":"74744072","configuration":"{\"accountID\":\"791c4ccf-170c-4b89-a10c-788eabb183ef\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"2fff8ff0ca23e8a5e8d5972a954039a2","type":"APP","apiClientId":2441839,"privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"]},{"id":"65044744","configuration":"{\"accountID\":\"AF-1064943\", \"server\": \"S2\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"6fdb3519d0fec7cd03f9f2580a9adc1b","type":"APP","apiClientId":293037,"privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"]},{"id":"50299144","configuration":"{\"config_url\": \"\/a\/elevar\/static\/configs\/9de3b7605bcb8d394c468bb927fa34ce24cecb80\/config.js\"}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"729bda3c0fe1f4fc02b6796f15b229e0","type":"APP","apiClientId":2509311,"privacyPurposes":[]},{"id":"2916616","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"29","type":"CUSTOM","privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"],"name":"EGO - Serverside App"},{"id":"3014920","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"2","type":"CUSTOM","privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"],"name":"GTAG"},{"id":"90177800","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"1","type":"CUSTOM","privacyPurposes":[],"name":"Elevar - Checkout Tracking"},{"id":"91685128","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"1","type":"CUSTOM","privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"],"name":"Mable-Pixel"},{"id":"106627336","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"1","type":"CUSTOM","privacyPurposes":["ANALYTICS"],"name":"Klar!"},{"id":"140574984","eventPayloadVersion":"1","runtimeContext":"LAX","scriptVersion":"2","type":"CUSTOM","privacyPurposes":["ANALYTICS","MARKETING","SALE_OF_DATA"],"name":"ABlyft Tracking"},{"id":"shopify-app-pixel","configuration":"{}","eventPayloadVersion":"v1","runtimeContext":"STRICT","scriptVersion":"0282","apiClientId":"shopify-pixel","type":"APP","privacyPurposes":["ANALYTICS","MARKETING"]},{"id":"shopify-custom-pixel","eventPayloadVersion":"v1","runtimeContext":"LAX","scriptVersion":"0282","apiClientId":"shopify-pixel","type":"CUSTOM","privacyPurposes":["ANALYTICS","MARKETING"]}],isMerchantRequest: false,effectiveTopLevelDomain: "",initData: {"shop":{"name":"ahead\u00ae | The Better for You Company","paymentSettings":{"currencyCode":"EUR"},"myshopifyDomain":"ahead-nutrition.myshopify.com","countryCode":"DE","storefrontUrl":"https:\/\/www.ahead-nutrition.com"},"customer":null,"cart":{"cost":{"totalAmount":{"amount":8100.0,"currencyCode":"INR"}},"lines":[{"cost":{"totalAmount":{"amount":5400.0,"currencyCode":"INR"}},"merchandise":{"price":{"amount":2700.0,"currencyCode":"INR"},"product":{"title":"Hazelnut-Cacao","vendor":"ahead\u00ae | The Human Performance Company","id":"7964092072200","untranslatedTitle":"Hazelnut-Cacao","url":"\/products\/ahead-riegel-hazelnut-cacao","type":"Schokoriegel"},"id":"43530481139976","image":{"src":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646"},"sku":"010104-1","title":"18 Riegel","untranslatedTitle":"18 Riegel"},"quantity":2},{"cost":{"totalAmount":{"amount":2700.0,"currencyCode":"INR"}},"merchandise":{"price":{"amount":2700.0,"currencyCode":"INR"},"product":{"title":"Coconut-Almond","vendor":"ahead\u00ae | The Human Performance Company","id":"6610491048023","untranslatedTitle":"Coconut-Almond","url":"\/products\/ahead-riegel-coconut-almond","type":"Schokoriegel"},"id":"39418248364119","image":{"src":"\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/B09GRCR2DL.03.jpg?v=1688630743"},"sku":"010102-1","title":"18 Riegel","untranslatedTitle":"18 Riegel"},"quantity":1}],"totalQuantity":3,"attributes":[{"key":"igId","value":"ig_ef0275d3c2f59e4b696c3534911d67e67d5a"},{"key":"_customerReferenceId","value":"752416b7-a77e-59ef-a9c0-6faa85a5dde6"},{"key":"_elevar__uetsid","value":"5d112060e52c11ef98ec1fc9c5720faa"},{"key":"_elevar__uetvid","value":"0f3882a0135511efa48a09be2089c971"},{"key":"_elevar__fbp","value":"fb.1.1733392564668.154834470"},{"key":"_elevar__ttp","value":"S_gb6V6KMUHPnGHZFRdremzrvrU"},{"key":"_elevar_ssn_wgs_ga_cmp","value":"{\"uniqueTS\":1715844140,\"userId\":3456456}"},{"key":"_elevar_ssn_wgs_ga_tid","value":"GS1.1.1738915236.40.1.0.60"},{"key":"_elevar_visitor_info","value":"{\"user_id\":\"ee80ceb9-75fe-41ce-b60f-f1cbbb9884dd\",\"session_id\":\"1738915235\",\"session_count\":\"101\",\"consent_v2\":{\"ad_storage\":{\"default\":false,\"update\":false},\"analytics_storage\":{\"default\":false,\"update\":false},\"ad_user_data\":{\"default\":false,\"update\":false},\"ad_personalization\":{\"default\":false,\"update\":false},\"functionality_storage\":{\"default\":false,\"update\":false},\"personalization_storage\":{\"default\":false,\"update\":false},\"security_storage\":{\"default\":true,\"update\":true}},\"market_id\":\"25722967\",\"referrer\":\"https:\/\/www.skailama.com\/\"}"},{"key":"gbbDiscountCode-Bundle Builder","value":"BB5-JDTXRV8WQE"},{"key":"__buddy_data","value":"[{\"promotionId\":6866,\"promotionType\":\"TEXT\",\"updatedAt\":\"2024-12-30T12:17:18.644Z\",\"isPromotionApplied\":false,\"useAbProducts\":false},{\"promotionId\":4841,\"promotionType\":\"CROSS_SELL\",\"updatedAt\":\"2024-12-30T12:17:21.469Z\",\"isPromotionApplied\":false,\"useAbProducts\":false},{\"promotionId\":7700,\"promotionType\":\"CROSS_SELL\",\"updatedAt\":\"2024-12-30T12:17:23.935Z\",\"isPromotionApplied\":true,\"useAbProducts\":false,\"enableAbTesting\":false},{\"promotionId\":9774,\"promotionType\":\"CROSS_SELL\",\"updatedAt\":\"2024-12-30T12:17:28.316Z\",\"isPromotionApplied\":true,\"useAbProducts\":false,\"enableAbTesting\":false},{\"promotionId\":10248,\"promotionType\":\"CART_LINE_EDITOR\",\"updatedAt\":\"2024-12-30T12:17:27.466Z\",\"isPromotionApplied\":false,\"useAbProducts\":false}]"}],"id":"Z2NwLWV1cm9wZS13ZXN0MzowMUo0UkE3TktBTTJKTjZZWFFNUko3RFBGMQ"},"checkout":null,"productVariants":[],"purchasingCompany":null},},function pageEvents(webPixelsManagerAPI) {webPixelsManagerAPI.publish("page_viewed", {});},"https://www.ahead-nutrition.com/cdn","9214cf0488d9716e7931fa4e043d214b5bac8616","c93fac4ewa0d30776p1feda67fm7b175787",{"modern":"","legacy":""});</script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bc93fac4ewa0d30776p1feda67fm7b175787m.js.download"></script>  <script>window.ShopifyAnalytics = window.ShopifyAnalytics || {};
window.ShopifyAnalytics.meta = window.ShopifyAnalytics.meta || {};
window.ShopifyAnalytics.meta.currency = 'INR';
var meta = {"page":{"pageType":"page","resourceType":"page","resourceId":120349360392}};
for (var attr in meta) {
  window.ShopifyAnalytics.meta[attr] = meta[attr];
}</script>
<script>window.ShopifyAnalytics.merchantGoogleAnalytics = function() {
  
};
</script>
<script class="analytics">(function () {
    var customDocumentWrite = function(content) {
      var jquery = null;

      if (window.jQuery) {
        jquery = window.jQuery;
      } else if (window.Checkout && window.Checkout.$) {
        jquery = window.Checkout.$;
      }

      if (jquery) {
        jquery('body').append(content);
      }
    };

    var hasLoggedConversion = function(token) {
      if (token) {
        return document.cookie.indexOf('loggedConversion=' + token) !== -1;
      }
      return false;
    }

    var setCookieIfConversion = function(token) {
      if (token) {
        var twoMonthsFromNow = new Date(Date.now());
        twoMonthsFromNow.setMonth(twoMonthsFromNow.getMonth() + 2);

        document.cookie = 'loggedConversion=' + token + '; expires=' + twoMonthsFromNow;
      }
    }

    var trekkie = window.ShopifyAnalytics.lib = window.trekkie = window.trekkie || [];
    if (trekkie.integrations) {
      return;
    }
    trekkie.methods = [
      'identify',
      'page',
      'ready',
      'track',
      'trackForm',
      'trackLink'
    ];
    trekkie.factory = function(method) {
      return function() {
        var args = Array.prototype.slice.call(arguments);
        args.unshift(method);
        trekkie.push(args);
        return trekkie;
      };
    };
    for (var i = 0; i < trekkie.methods.length; i++) {
      var key = trekkie.methods[i];
      trekkie[key] = trekkie.factory(key);
    }
    trekkie.load = function(config) {
      trekkie.config = config || {};
      trekkie.config.initialDocumentCookie = document.cookie;
      var first = document.getElementsByTagName('script')[0];
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.onerror = function(e) {
        var scriptFallback = document.createElement('script');
        scriptFallback.type = 'text/javascript';
        scriptFallback.onerror = function(error) {
                var Monorail = {
      produce: function produce(monorailDomain, schemaId, payload) {
        var currentMs = new Date().getTime();
        var event = {
          schema_id: schemaId,
          payload: payload,
          metadata: {
            event_created_at_ms: currentMs,
            event_sent_at_ms: currentMs
          }
        };
        return Monorail.sendRequest("https://" + monorailDomain + "/v1/produce", JSON.stringify(event));
      },
      sendRequest: function sendRequest(endpointUrl, payload) {
        // Try the sendBeacon API
        if (window && window.navigator && typeof window.navigator.sendBeacon === 'function' && typeof window.Blob === 'function' && !Monorail.isIos12()) {
          var blobData = new window.Blob([payload], {
            type: 'text/plain'
          });

          if (window.navigator.sendBeacon(endpointUrl, blobData)) {
            return true;
          } // sendBeacon was not successful

        } // XHR beacon

        var xhr = new XMLHttpRequest();

        try {
          xhr.open('POST', endpointUrl);
          xhr.setRequestHeader('Content-Type', 'text/plain');
          xhr.send(payload);
        } catch (e) {
          console.log(e);
        }

        return false;
      },
      isIos12: function isIos12() {
        return window.navigator.userAgent.lastIndexOf('iPhone; CPU iPhone OS 12_') !== -1 || window.navigator.userAgent.lastIndexOf('iPad; CPU OS 12_') !== -1;
      }
    };
    Monorail.produce('monorail-edge.shopifysvc.com',
      'trekkie_storefront_load_errors/1.1',
      {shop_id: 21363937,
      theme_id: 176676897032,
      app_name: "storefront",
      context_url: window.location.href,
      source_url: "//www.ahead-nutrition.com/cdn/s/trekkie.storefront.63fa514cc5b1f7c3e0ff0cd45925a6686a523fe8.min.js"});

        };
        scriptFallback.async = true;
        scriptFallback.src = '//www.ahead-nutrition.com/cdn/s/trekkie.storefront.63fa514cc5b1f7c3e0ff0cd45925a6686a523fe8.min.js';
        first.parentNode.insertBefore(scriptFallback, first);
      };
      script.async = true;
      script.src = '//www.ahead-nutrition.com/cdn/s/trekkie.storefront.63fa514cc5b1f7c3e0ff0cd45925a6686a523fe8.min.js';
      first.parentNode.insertBefore(script, first);
    };
    trekkie.load(
      {"Trekkie":{"appName":"storefront","development":false,"defaultAttributes":{"shopId":21363937,"isMerchantRequest":null,"themeId":176676897032,"themeCityHash":"10913542230334836816","contentLanguage":"de","currency":"INR"},"isServerSideCookieWritingEnabled":true,"monorailRegion":"shop_domain"},"Session Attribution":{},"S2S":{"facebookCapiEnabled":false,"source":"trekkie-storefront-renderer","apiClientId":580111}}
    );

    var loaded = false;
    trekkie.ready(function() {
      if (loaded) return;
      loaded = true;

      window.ShopifyAnalytics.lib = window.trekkie;

  
      var originalDocumentWrite = document.write;
      document.write = customDocumentWrite;
      try { window.ShopifyAnalytics.merchantGoogleAnalytics.call(this); } catch(error) {};
      document.write = originalDocumentWrite;

      window.ShopifyAnalytics.lib.page(null,{"pageType":"page","resourceType":"page","resourceId":120349360392,"shopifyEmitted":true});

      var match = window.location.pathname.match(/checkouts\/(.+)\/(thank_you|post_purchase)/)
      var token = match? match[1]: undefined;
      if (!hasLoggedConversion(token)) {
        setCookieIfConversion(token);
        
      }
    });


        var eventsListenerScript = document.createElement('script');
        eventsListenerScript.async = true;
        eventsListenerScript.src = "//www.ahead-nutrition.com/cdn/shopifycloud/shopify/assets/shop_events_listener-20905db421adb60b04582abab58b285362bc2e1011d17cd3eabb3bfe05798c59.js";
        document.getElementsByTagName('head')[0].appendChild(eventsListenerScript);

})();</script><script async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/shop_events_listener-20905db421adb60b04582abab58b285362bc2e1011d17cd3eabb3bfe05798c59.js.download"></script>
<script class="boomerang">
(function () {
  window.BOOMR = window.BOOMR || {};
  window.BOOMR.themeName = "Dawn";
  window.BOOMR.themeVersion = "6.0.2";
  window.BOOMR.shopId = 21363937;
  window.BOOMR.themeId = 176676897032;
})();</script>
<script defer="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/shopify-perf-kit-1.3.0.min.js.download" data-application="storefront-renderer" data-shop-id="21363937" data-render-region="gcp-europe-west3" data-page-type="page" data-theme-instance-id="176676897032" data-monorail-region="shop_domain" data-resource-timing-sampling-rate="10"></script>
<style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/fender_analytics.234f527c96efc492367d.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/static.4b8f99d71b7685ee4f53.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/runtime.5c3508ac78b96b4f763d.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/sharedUtils.9ce79bcd530dc4dd1a60.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/vendors~in_app_forms~signup_forms~atlas~onsite-triggering.a49ef971ee5fab0afe02.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/vendors~in_app_forms~signup_forms.30321f46d7549c0b04b1.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/default~in_app_forms~signup_forms~onsite-triggering.7a64e488a2e875dd465a.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/default~in_app_forms~signup_forms.4b6b09e628aed8ea59d0.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/signup_forms.cf7d7cd8bc3bfdaffaf4.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/post_identification_sync.954543127421f8ad4e39.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/vendors~in_app_forms~reviews~atlas~ClientStore.b7fdc4610cee2b3c9c0f.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/vendors~reviews.8e2dd4c912809921ca2a.js.download" crossorigin="anonymous"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/reviews.55cdab36edb1647a390b.js.download" crossorigin="anonymous"></script><link rel="stylesheet" type="text/css" id="rating-snippet-stars__css" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/style.css"><script type="module" defer="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/consent-tracking-api.js.download"></script><link rel="stylesheet" type="text/css" href="chrome-extension://enejkfhimljloggnimhebadbjajhgkad/font/Inter.css"><style type="text/css" id="CookieConsentStateDisplayStyles">.cookieconsent-optin-preferences,.cookieconsent-optin-statistics,.cookieconsent-optin-marketing,.cookieconsent-optin{display:none;}.cookieconsent-optout-preferences,.cookieconsent-optout-statistics,.cookieconsent-optout-marketing,.cookieconsent-optout{display:block;display:initial;}</style><style id="kl-custom-fonts">
@import 'https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap';
@import 'https://use.typekit.net/tuq3esj.css';

@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_italic_400.woff2);
        font-weight: 400;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_italic_700.woff2);
        font-weight: 700;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_regular_400.woff2);
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_regular_700.woff2);
        font-weight: 700;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_italic_400.woff2);
        font-weight: 400;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_italic_700.woff2);
        font-weight: 700;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_regular_400_2.woff2);
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_regular_700.woff2);
        font-weight: 700;
        font-style: normal;
        font-display: swap;
      }
</style><style id="kl-custom-fonts">
@import 'https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,200;0,300;0,400;0,600;0,700;0,800;0,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900&display=swap';
@import 'https://use.typekit.net/tuq3esj.css';

@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_italic_400.woff2);
        font-weight: 400;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_italic_700.woff2);
        font-weight: 700;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_regular_400.woff2);
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Nunito-Sans-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Nunito-Sans/latin/nunito-sans_latin_regular_700.woff2);
        font-weight: 700;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_italic_400.woff2);
        font-weight: 400;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_italic_700.woff2);
        font-weight: 700;
        font-style: italic;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_regular_400_2.woff2);
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }
@font-face {
        font-family: 'Poppins-Klaviyo-Hosted'; 
        src: url(https://static.klaviyo.com/onsite/hosted-fonts/Poppins/latin/poppins_latin_regular_700.woff2);
        font-weight: 700;
        font-style: normal;
        font-display: swap;
      }
</style><style>
                    .gbbActiveVariant {
                            background: #CB33FB !important;
                            color:#ffffff !important;
                        }
                    .gbbActiveImage {
                            border: 2px solid #CB33FB !important;
                    }    
                    .gbbBodyWrapper ::-webkit-scrollbar-thumb{
                        background: #1d1d1d !important;
                    }    
                    .gbbActiveMsgDeliveryOptions {
                        border: 1px solid #A2A2A2 !important;
                        background-color: rgb(255, 255, 255) !important;
                    }      
                    .gbbCustomerUploadButton{
                        background-color: #000000;
                        color: #ffffff;
                    }      
                    </style><link rel="dns-prefetch preconnect" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/" crossorigin=""><script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/gtm(1).js.download" async="" defer=""></script><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/polyfills.aaTJ3aJS.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/app.C8zabb0m.js" crossorigin=""><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/f.txt"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/f(1).txt"></script><script type="text/javascript" async="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/f(2).txt"></script><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/page-OnePage.Cb8tIXke.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/DeliveryMethodSelectorSection.hzZrCbQk.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/useEditorShopPayNavigation.Cw0h93Ng.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/VaultedPayment.DRPQCmxE.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/LocalizationExtensionField.DW1bO3wM.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/RememberMeDescriptionText.DLjmEmvv.js" crossorigin=""><script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/17516128.js.download" type="text/javascript" async="" data-ueto="ueto_809cc4a1d8"></script><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/ShopPayOptInDisclaimer.DBi_rQso.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/PayButtonSection.C5vf3puD.js" crossorigin=""><link rel="stylesheet" type="text/css" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/rct_cart_front.css" media="all"><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/component-ShopPayVerificationSwitch.Dx6LnZov.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/useSubscribeMessenger.hxFFRSD8.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="script" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/index.E3VshG5y.js" crossorigin=""><link rel="prefetch" fetchpriority="low" as="style" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/assets/app.CqblHuRC.css" crossorigin=""><link rel="prefetch" fetchpriority="low" as="style" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/assets/OnePage.PMX4OSBO.css" crossorigin=""><link rel="prefetch" fetchpriority="low" as="style" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/assets/DeliveryMethodSelectorSection.DmqjTkNB.css" crossorigin=""><link rel="prefetch" fetchpriority="low" as="style" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/assets/useEditorShopPayNavigation.DCOTvxC3.css" crossorigin=""><link rel="prefetch" fetchpriority="low" as="style" href="https://cdn.shopify.com/shopifycloud/checkout-web/assets/c1.de/assets/ShopPayVerificationSwitch.DW7NMDXG.css" crossorigin=""><link rel="prefetch" fetchpriority="low" as="font" type="font/woff2" href="https://fonts.shopifycdn.com/nunito_sans/nunitosans_n4.2b61d9dcf54d8ac8282cfd1ebb6964c79a7efcd1.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&amp;hmac=30675ef2f2ecb2c4f30e4016ad9d991412917326caa8e8d0090a5211833f0843" crossorigin=""><link rel="prefetch" fetchpriority="low" as="font" type="font/woff2" href="https://fonts.shopifycdn.com/nunito_sans/nunitosans_n9.16ed0845817f16697ddacf14727c578dbbe2cbd5.woff2?h1=YWhlYWQtbnV0cml0aW9uLmNvbQ&amp;hmac=8b3d2a9370df98e0e8b1885ab0cacf012b4e556eec913ed9981d0be7c45a1020" crossorigin=""><link rel="prefetch" fetchpriority="low" as="image" href="https://cdn.shopify.com/s/files/1/2136/3937/files/ahead-logo-WEB-purple-rgb_x320.png?v=1682517461" crossorigin=""></head>

  <body currentprice="810000" class="gradient js-ajax-cart-set js-ajax-cart-not-empty" data-new-gr-c-s-check-loaded="14.1221.0" data-gr-ext-installed="" data-page="addProductsPage1">
    

    <!--
<script type="text/javascript">
    var ajax_request = function(settings, data) {
        var method = typeof data === 'object'? 'POST' : "GET";
        if (settings === undefined) settings = {};
        if (settings.data !== undefined && settings.method === undefined) settings.method = 'POST';
        if (settings.method === undefined) settings.method = 'GET';
        if (settings.url === undefined) {
            console.log('AJAX: URL not defined');
            return false;
        }
        var req = new XMLHttpRequest();
        req.open(settings.method, settings.url);
        if (settings.json === true) {
            req.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        }
        req.onreadystatechange = function() {
            if (this.readyState === 4) {
                try {
                    if (settings.callback === undefined) {
                        console.log(this.responseText);
                    } else {
                        if (settings.json === true) {
                            var json_data = false;
                            try {
                                json_data = JSON.parse(this.responseText);
                                settings.callback(json_data);
                            } catch(e) {
                                console.log(e);
                            }
                        } else {
                            settings.callback(this.responseText);
                        }
                    }
                } catch(e) {
                    console.log(e);
                }
            }
        };
        if (settings.method === 'POST') req.send(JSON.stringify(data));
        else req.send();
    }
    window.ego = window.ego || [];
    document.addEventListener('DOMContentLoaded', function(event) {
        function registration_event() {
            var x = Array.from(document.querySelectorAll('form[action*="account"][id*="create_customer"]'));
            if (x.length === 0) return;

            var check = function(e,em) {
                var val = e.value;
                if (val === undefined || val === "" || val.length === 0) return false;
                if (em === true && val.indexOf('@') === -1) return false;
                return true;
            }

            var add_event = function(form) {
                var fn = form.querySelector('input[name*="first_name"]'),
                    ln = form.querySelector('input[name*="last_name"]')
                    em = form.querySelector('input[name*="email"]'),
                    ps = form.querySelector('input[name*="password"]'),
                    sb = form.querySelector('input[type="submit"]'),
                    action = 'Default';

                if (document.referrer.indexOf('club') !== -1) action = 'Insider Club';

                if (sb.getAttribute('track-enable') === true || sb.getAttribute('track-enable') === 'true') return;
                sb.addEventListener('click',function(fn,ln,em,ps,action) {
                    var ck = false;
                    ck = check(fn,false);
                    if (ck === false) return;
                    ck = check(ln,false);
                    if (ck === false) return;
                    ck = check(em,true);
                    if (ck === false) return;
                    ck = check(ps,false);
                    if (ck === false) return;

                    if (ck === true) {
                        var first_name = fn.value, last_name = ln.value, email = em.value;

                        ego.push({
                            event: 'registration',
                            registration_method: action,
                            google_analytics: {
                                category: 'Customer Account',
                                action: 'Registration',
                                label: action,
                            },
                            user: {
                                first_name: first_name,
                                last_name: last_name,
                                email: email,
                            }
                        })
                    }
                    sb.setAttribute('track-enable',true);
                }.bind(this, fn, ln, em, ps, action))
            }

            x.forEach(function(e) {
                add_event(e);
            })
        }

        function lead_generation() {
            var x = Array.from(document.querySelectorAll('form[action*="manage.kmail-lists.com\/subscriptions"]'));
            if (x.length === 0) return;

            var check = function(e,em) {
                var val = e.value;
                if (val === undefined || val === "" || val.length === 0) return false;
                if (em === true && val.indexOf('@') === -1) return false;
                return true;
            }

            var add_event = function(form) {
                var fn = form.querySelector('input[name*="FNAME"]'),
                    em = form.querySelector('input[name*="EMAIL"]'),
                    sb = form.querySelector('button[type="submit"]');

                if (window.location.href.indexOf('academy') !== -1 && (fn === null || fn === undefined)) fn = 'Academy Voucher';

                if (sb.getAttribute('track-enable') === true || sb.getAttribute('track-enable') === 'true') return;
                sb.addEventListener('click',function(fn,em) {
                    var ck = false, action;
                    if (typeof fn !== 'string') {
                        ck = check(fn,false);
                        if (ck === false) return;
                        action = 'Newsletter - Default';
                    } else {
                        action = fn;
                    }
                    ck = check(em,true);

                    if (ck === true) {
                        var first_name, email;
                        if (fn !== null && typeof fn !== 'string' && fn.value)first_name = fn.value;
                        email = em.value;
                    
                        ego.push({
                            event: 'lead',
                            content_name: action,
                            google_analytics: {
                                category: 'Lead',
                                action: action,
                                label: window.location.hostname + window.location.pathname,
                            },
                            user: {
                                first_name: first_name,
                                email: email,
                            }
                        })
                    }
                    sb.setAttribute('track-enable',true);
                }.bind(this, fn, em))
            }

            x.forEach(function(e) {
                add_event(e);
            })
        }

        if (window.location.href.indexOf('account/register') !== -1) registration_event();
        lead_generation();
    })

    window.addEventListener('load', function(){
        var set_attribute = function(d) {
            if (d === undefined) return;

            var id = d.id;
            var input = document.querySelector('#'+id);
            if (input === null) {
                var form = document.querySelector('form[action*="cart/add"]');
                if (form === null) return;

                var p = document.createElement('p');
                var input = document.createElement('input');
                input.id = d.id;
                input.type = 'hidden';
                input.name = 'attributes['+d.attribute+']';
                input.value = d.value;

                p.appendChild(input);
                form.appendChild(p);
            } else {
                input.value = d.value;
            }

            var input_2 = document.querySelector('#'+id+'_2');
            if (input_2 === null) {
                var form_2 = document.querySelector('form.cart[action*="cart"]');
                if (form_2 === null) return;

                var p_2 = document.createElement('p');
                var input_2 = document.createElement('input');
                input_2.id = d.id+'_2';
                input_2.type = 'hidden';
                input_2.name = 'attributes['+d.attribute+']';
                input_2.value = d.value;

                p_2.appendChild(input_2);
                form_2.appendChild(p_2);
            } else {
                input_2.value = d.value;
            }
        }

        var generateEventId = window.temp_track_store.generateEventId;

        var force_start = function(callback) {
            var i = 0, l = 100, c = false;
            var interval = setInterval(() => {
                try {
                    c = callback();
                } catch{};
                if (c === true || i >= l) clearInterval(interval);
                i++
            }, 100);
        }

        function getPageType() {
          
            return 'Other';
          
        }
        window.temp_store = window.temp_store || {};

      

        var cart_btn = Array.from(document.querySelectorAll('.header__icon--cart[href*="\/cart"]'));

        //Checkout Ajax Handler
        window.ego_checkout_ajax_handler = function () {
            ajax_request({
                url: "/cart.js",
                json: true,
                method: 'GET',
                callback: function(cart) {
                    if (cart.items.length === 0) return;
                    var output = {
                        item_count: cart.item_count,
                        cart_total: cart.total_price / 100,
                    }
                    var items = cart.items;
                    items = items.map((item,i) => {
                        return {
                            position: i,
                            id: item.variant_id,
                            sku: item.sku,
                            productId: item.product_id,
                            variantId: item.variant_id,
                            shopifyId: "shopify_DE_" + item.product_id + "_" + item.variant_id,
                            name: item.product_title.replace("'", ''),
                            quantity: item.quantity,
                            price: item.price / 100,
                            brand: item.vendor.replace("'", ''),
                            variant: item.variant_title
                        }
                    })

                    ego.push({
                        event: 'checkout',
                        currency: "EUR",
                        value: output.cart_total,
                        num_items: output.item_count,
                        content_type: 'product',
                        products: items,
                    })
                }
            })
        }

        if (cart_btn.length > 0) {
            cart_btn.forEach(function(cart_button) {
                cart_button.addEventListener('click', function(e) {
                    setTimeout(function() {
                        ajax_request({
                            url: "/cart.js",
                            json: true,
                            method: "GET",
                            callback: function(cart) {
                                if (cart.items.length === 0) return;
                                var output = {
                                    item_count: cart.item_count,
                                    cart_total: cart.total_price / 100,
                                }
                                var items = cart.items;
                                items = items.map((item,i) => {
                                    return {
                                        position: i,
                                        id: item.variant_id,
                                        sku: item.sku,
                                        productId: item.product_id,
                                        variantId: item.variant_id,
                                        shopifyId: "shopify_DE_" + item.product_id + "_" + item.variant_id,
                                        name: item.product_title.replace("'", ''),
                                        quantity: item.quantity,
                                        price: item.price / 100,
                                        brand: item.vendor.replace("'", ''),
                                        variant: item.variant_title
                                    }
                                })

                                ego.push({
                                    event: 'view_cart',
                                    currency: "EUR",
                                    value: output.cart_total,
                                    num_items: output.item_count,
                                    content_type: 'product',
                                    products: items,
                                })

                                //Checkout Button Click
                                /*var chck_btn = [document.querySelector("button[type*=submit]#checkout")];
                                chck_btn.push(document.querySelector('button.checkoutButton'))
                                chck_btn = chck_btn.concat(Array.from(document.querySelectorAll("[data-testid*='Pay-button']")));
                                chck_btn = chck_btn.concat(Array.from(document.querySelectorAll("form[action*='amazon']")));
                                if (chck_btn.length > 0) chck_btn.forEach(function(e) {
                                    if (e === null) return;
                                      e.addEventListener('click', function(e) {
                                          
                                          if (e === null || e.getAttribute('egot') !== null) return;
                                          ego.push({
                                              event: 'checkout',
                                              currency: "EUR",
                                              value: output.cart_total,
                                              num_items: output.item_count,
                                              content_type: 'product',
                                              products: items,
                                          })
                                          e.setAttribute('egot',1);
                                          if (window.checkout_ajax_handler) window.checkout_ajax_handler();
                                      }.bind(this,e))
                                });*/
                            }
                        })
                    },500)
                })
            })
        }

        document.addEventListener('click', function(e) {
            if (!e.target || !e.target.className || e.target.className !== 'checkoutButton') return;
            window.ego_checkout_ajax_handler();
        })

      

      

      

      

        function getClickedProductHandle(element) {
            var arr = element.href.split('/products/');
            return arr[arr.length-1];
        }
    }, false);
</script>
-->
    <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function(event) {
        function registration_event() {
            var x = Array.from(document.querySelectorAll('form[action*="account"][id*="create_customer"]'));
            if (x.length === 0) return;

            var check = function(e,em) {
                var val = e.value;
                if (val === undefined || val === "" || val.length === 0) return false;
                if (em === true && val.indexOf('@') === -1) return false;
                return true;
            }
            var sha_hash = function(value,em) {
                if (CryptoJS && CryptoJS.SHA256) {
                    value = value.trim();
                    if (em !== true) value = value.toLowerCase();
                    return CryptoJS.SHA256(value).toString();
                }
                return undefined;
            }

            var add_event = function(form) {
                var fn = form.querySelector('input[name*="first_name"]'),
                    ln = form.querySelector('input[name*="last_name"]')
                    em = form.querySelector('input[name*="email"]'),
                    ps = form.querySelector('input[name*="password"]'),
                    sb = form.querySelector('input[type="submit"]'),
                    action = 'Default';

                if (document.referrer.indexOf('club') !== -1) action = 'Insider Club';

                if (sb.getAttribute('track-enable') === true || sb.getAttribute('track-enable') === 'true') return;
                sb.addEventListener('click',function(fn,ln,em,ps,action) {
                    var ck = false;
                    ck = check(fn,false);
                    if (ck === false) return;
                    ck = check(ln,false);
                    if (ck === false) return;
                    ck = check(em,true);
                    if (ck === false) return;
                    ck = check(ps,false);
                    if (ck === false) return;

                    if (ck === true) {
                        var first_name = '', last_name = '', email = '';
                        first_name = sha_hash(fn.value,false);
                        email = sha_hash(em.value,true);
                        last_name = sha_hash(ln.value,false);
                    
                        var generateEventId = window.temp_track_store.generateEventId;
                        var event_id = generateEventId('registration');
                        window.temp_track_store.event_id['registration'] = event_id;
                    
                        window.dataLayer = window.dataLayer || [];
                        window.dataLayer.push({
                            event: 'registration',
                            category: 'Customer Account',
                            action: 'Registration',
                            label: action,
                            sha_email: email,
                            sha_fn: first_name,
                            sha_ln: last_name,
                            event_id: event_id,
                        })
                    }
                    sb.setAttribute('track-enable',true);
                }.bind(this, fn, ln, em, ps, action))
            }

            x.forEach(function(e) {
                add_event(e);
            })
        }

        function lead_generation() {
            var x = Array.from(document.querySelectorAll('form[action*="manage.kmail-lists.com\/subscriptions"]'));
            if (x.length === 0) return;

            var check = function(e,em) {
                var val = e.value;
                if (val === undefined || val === "" || val.length === 0) return false;
                if (em === true && val.indexOf('@') === -1) return false;
                return true;
            }
            var sha_hash = function(value,em) {
                if (CryptoJS && CryptoJS.SHA256) {
                    value = value.trim();
                    if (em !== true) value = value.toLowerCase();
                    return CryptoJS.SHA256(value).toString();
                }
                return undefined;
            }

            var add_event = function(form) {
                var fn = form.querySelector('input[name*="FNAME"]'),
                    em = form.querySelector('input[name*="EMAIL"]'),
                    sb = form.querySelector('button[type="submit"]');

                if (window.location.href.indexOf('academy') !== -1 && (fn === null || fn === undefined)) fn = 'Academy Voucher';

                if (sb.getAttribute('track-enable') === true || sb.getAttribute('track-enable') === 'true') return;
                sb.addEventListener('click',function(fn,em) {
                    var ck = false, action;
                    if (typeof fn !== 'string') {
                        ck = check(fn,false);
                        if (ck === false) return;
                        action = 'Newsletter - Default';
                    } else {
                        action = fn;
                    }
                    ck = check(em,true);

                    if (ck === true) {
                        var first_name, email;
                        if (fn !== null && typeof fn !== 'string' && fn.value)first_name = sha_hash(fn.value,false);
                        email = sha_hash(em.value,true);
                    
                        var generateEventId = window.temp_track_store.generateEventId;
                        var event_id = generateEventId('form_submit');
                        window.temp_track_store.event_id['form_submit'] = event_id;
                    
                        window.dataLayer = window.dataLayer || [];
                        window.dataLayer.push({
                            event: 'form_submit',
                            category: 'Lead',
                            action: action,
                            label: window.location.hostname + window.location.pathname,
                            sha_email: email,
                            sha_fn: first_name,
                            event_id: event_id,
                        })
                    }
                    sb.setAttribute('track-enable',true);
                }.bind(this, fn, em))
            }

            x.forEach(function(e) {
                add_event(e);
            })
        }

        if (window.location.href.indexOf('account/register') !== -1) registration_event();
        lead_generation();
    })
    window.addEventListener('load', function(){
        var generateEventId = window.temp_track_store.generateEventId;

        function getPageType() {
          
            return 'Other';
          
        }

      
        var event_id = generateEventId('customerData');
        window.temp_track_store.event_id['customerData'] = event_id;
        window.dataLayer.push({
            "event": "customerData",
            "visitorType": "Guest",
            "event_id": event_id,
        });
        if (sessionStorage.getItem('login_event') !== null) sessionStorage.removeItem('login_event');
      
var dataLayerData = {cart: {}};
        dataLayerData.cart.total = "8,100.00";
        dataLayerData.cart.count = 3;
        dataLayerData.cart.products = [];dataLayerData.cart.products.push({
            'name': "Hazelnut-Cacao - 18 Riegel",
            'id': 43530481139976,
            'brand': "ahead® | The Human Performance Company",
            'product_id': 7964092072200,
            'variant_id': 43530481139976,
            'quantity': 1,
            'price': "2.700.00",
            'sku': "010104-1"
        });dataLayerData.cart.products.push({
            'name': "Coconut-Almond - 18 Riegel",
            'id': 39418248364119,
            'brand': "ahead® | The Human Performance Company",
            'product_id': 6610491048023,
            'variant_id': 39418248364119,
            'quantity': 1,
            'price': "2.700.00",
            'sku': "010102-1"
        });dataLayerData.cart.products.push({
            'name': "Hazelnut-Cacao - 18 Riegel",
            'id': 43530481139976,
            'brand': "ahead® | The Human Performance Company",
            'product_id': 7964092072200,
            'variant_id': 43530481139976,
            'quantity': 1,
            'price': "2.700.00",
            'sku': "010104-1"
        });window.dataLayer.push(dataLayerData);
        window.dataLayer.push({
            "pageType": "other",
            "shopifyPageType": "page",
        });
      


      

        var cart_btn = Array.from(document.querySelectorAll('.cart_link[href*="\/cart"]'));

        //Checkout Ajax Handler
        window.checkout_ajax_handler = function () {
            jQuery.ajax({
                url: "/cart.js",
                dataType: 'json',
                async: true,
                success: function(cart) {
                    if (cart.items.length === 0) return;
                    var output = {
                        item_count: cart.item_count,
                        cart_total: cart.total_price / 100,
                    }
                    var items = cart.items;
                    items = items.map((item,i) => {
                        return {
                            position: i,
                            id: item.variant_id,
                            sku: item.sku,
                            productId: item.product_id,
                            variantId: item.variant_id,
                            shopifyId: "shopify_DE_" + item.product_id + "_" + item.variant_id,
                            name: item.product_title.replace("'", ''),
                            quantity: item.quantity,
                            price: item.price / 100,
                            brand: item.vendor.replace("'", ''),
                            variant: item.variant_title
                        }
                    })
                    var event_id = generateEventId('checkout');
                    window.temp_track_store.event_id['checkout'] = event_id;
                    window.dataLayer.push({
                        "cartTotal": output.cart_total,
                        "itemCount": output.item_count,
                        "event": "checkout",
                        "ecommerce": {
                            "currencyCode": "EUR",
                            'checkout': {
                                'actionField': {"step":1},
                                'products': items,
                            },
                        },
                        "event_id": event_id,
                    })
                }
            })
        }

        if (cart_btn.length > 0) {
            cart_btn.forEach(function(cart_button) {
                cart_button.addEventListener('click', function(e) {
                    setTimeout(function() {
                        jQuery.ajax({
                            url: "/cart.js",
                            dataType: 'json',
                            async: true,
                            success: function(cart) {
                                if (cart.items.length === 0) return;
                                var output = {
                                    item_count: cart.item_count,
                                    cart_total: cart.total_price / 100,
                                }
                                var items = cart.items;
                                items = items.map((item,i) => {
                                    return {
                                        position: i,
                                        id: item.variant_id,
                                        sku: item.sku,
                                        productId: item.product_id,
                                        variantId: item.variant_id,
                                        shopifyId: "shopify_DE_" + item.product_id + "_" + item.variant_id,
                                        name: item.product_title.replace("'", ''),
                                        quantity: item.quantity,
                                        price: item.price / 100,
                                        brand: item.vendor.replace("'", ''),
                                        variant: item.variant_title
                                    }
                                })
                                
                                var event_id = generateEventId('viewCart');
                                window.temp_track_store.event_id['viewCart'] = event_id;
                                window.dataLayer.push({
                                    "cartTotal": output.cart_total,
                                    "itemCount": output.item_count,
                                    "event": "viewCart",
                                    "ecommerce": {
                                        "currencyCode": "EUR",
                                        "actionField": { "list": "Shopping Cart" },
                                        "impressions": items,
                                    },
                                    "event_id": event_id,
                                })
                            }
                        })
                    },500)
                })
            })
        }

      

      

      

      

        function getClickedProductHandle(element) {
            var arr = element.href.split('/products/');
            return arr[arr.length-1];
        }

        function handleProductClick(event) {
            if(typeof allProducts == "undefined") return;
            var target = event.target.matches('a[href*="/products/"]')
                ? event.target
                : event.target.closest('a[href*="/products/"]');
            var handle = getClickedProductHandle(target);
            var clickedProduct = allProducts.filter(function(product) {
                return product.handle === handle;
            });
            if (clickedProduct[0]) delete clickedProduct[0].list;
            if (clickedProduct[0]) delete clickedProduct[0].handle;

            var event_id = generateEventId('productClick');
            window.temp_track_store.event_id['productClick'] = event_id;
            window.dataLayer.push({
                "event": "productClick",
                "ecommerce": {
                    currencyCode: "EUR",
                    "click": {
                        "actionField": {"list": clickedProduct.category || getPageType()},
                        "products": clickedProduct

                    }
                },
                "event_id": event_id,
            });
        }

        Array.prototype.slice.call(document.querySelectorAll('a[href*="/products/"]'))
            .forEach(function(select) {
                select.addEventListener('click', handleProductClick);
            });
    }, false);
</script>

<!-- Google Tag Manager (noscript) -->
<noscript>
  <iframe src="https://ww1.ahead-nutrition.com/ns.html?id=GTM-53ZP2XC" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
    <a class="skip-to-content-link button visually-hidden" href="https://www.ahead-nutrition.com/pages/bundle-builder-new?currentFlow=byob&amp;page=addProductsPage1#MainContent">
      Direkt zum Inhalt
    </a>
    <div class="freeShippingTest" style="display: none !important;">empty</div>

    <!-- Initialize AJAX Cart State -->
    <script type="application/json" data-ajax-cart-initial-state="">
      {"note":"","attributes":{"igId":"ig_ef0275d3c2f59e4b696c3534911d67e67d5a","_customerReferenceId":"752416b7-a77e-59ef-a9c0-6faa85a5dde6","_elevar__uetsid":"5d112060e52c11ef98ec1fc9c5720faa","_elevar__uetvid":"0f3882a0135511efa48a09be2089c971","_elevar__fbp":"fb.1.1733392564668.154834470","_elevar__ttp":"S_gb6V6KMUHPnGHZFRdremzrvrU","_elevar_ssn_wgs_ga_cmp":"{\"uniqueTS\":1715844140,\"userId\":3456456}","_elevar_ssn_wgs_ga_tid":"GS1.1.1738915236.40.1.0.60","_elevar_visitor_info":"{\"user_id\":\"ee80ceb9-75fe-41ce-b60f-f1cbbb9884dd\",\"session_id\":\"1738915235\",\"session_count\":\"101\",\"consent_v2\":{\"ad_storage\":{\"default\":false,\"update\":false},\"analytics_storage\":{\"default\":false,\"update\":false},\"ad_user_data\":{\"default\":false,\"update\":false},\"ad_personalization\":{\"default\":false,\"update\":false},\"functionality_storage\":{\"default\":false,\"update\":false},\"personalization_storage\":{\"default\":false,\"update\":false},\"security_storage\":{\"default\":true,\"update\":true}},\"market_id\":\"25722967\",\"referrer\":\"https:\/\/www.skailama.com\/\"}","gbbDiscountCode-Bundle Builder":"BB5-JDTXRV8WQE"},"original_total_price":810000,"total_price":810000,"total_discount":0,"total_weight":2034.0,"item_count":3,"items":[{"id":43530481139976,"properties":{"Bundle":"Bundle Builder","Box ID":"2"},"quantity":1,"variant_id":43530481139976,"key":"43530481139976:50c67d7edc856a032bf646c0d8681298","title":"Hazelnut-Cacao - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010104-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":7964092072200,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976","featured_image":{"aspect_ratio":1.0,"alt":"Hazelnut-Cacao","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","handle":"ahead-riegel-hazelnut-cacao","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Hazelnut-Cacao","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0},{"id":39418248364119,"properties":{"Bundle":"Bundle Builder","Box ID":"2"},"quantity":1,"variant_id":39418248364119,"key":"39418248364119:b382e936e2aa1027e3894c79f4f6c940","title":"Coconut-Almond - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010102-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":6610491048023,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-coconut-almond?variant=39418248364119","featured_image":{"aspect_ratio":1.0,"alt":"Coconut-Almond","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/B09GRCR2DL.03.jpg?v=1688630743","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/B09GRCR2DL.03.jpg?v=1688630743","handle":"ahead-riegel-coconut-almond","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Coconut-Almond","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe ✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0},{"id":43530481139976,"properties":{"Bundle":"Bundle Builder","Box ID":"1"},"quantity":1,"variant_id":43530481139976,"key":"43530481139976:f1c2ae5470a30a74cf3fc12a0d74bbf2","title":"Hazelnut-Cacao - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010104-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":7964092072200,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976","featured_image":{"aspect_ratio":1.0,"alt":"Hazelnut-Cacao","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","handle":"ahead-riegel-hazelnut-cacao","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Hazelnut-Cacao","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0}],"requires_shipping":true,"currency":"INR","items_subtotal_price":810000,"cart_level_discount_applications":[],"checkout_charge_amount":810000}
    </script>

    <!-- Import the AJAX Cart Script -->
    <script type="module">
      import '//www.ahead-nutrition.com/cdn/shop/t/312/assets/liquid-ajax-cart-v1.10.3.js?v=711574860514368811738669749';
    </script>

    <!-- Include the AJAX Cart Section -->
    <div class="my-floating-cartx">
      <div id="shopify-section-ajax-cartx" class="shopify-section"><!-- Main Form for AJAX Cart -->
<form action="https://www.ahead-nutrition.com/cart" method="post" class="my-cartx">

  <!-- Cart Top Section -->
  <div class="cartTopx">
    <!-- Hidden Cart Icon (SVG) -->
    <div class="cartIconx" style="display: none;">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17" fill="none"></svg>
    </div>
    <!-- Cart Title -->
    <div class="cartTitlex"></div>
    <!-- Close Cart Icon -->
    <div class="closeIconx">
      <a class="closeCartx" data-ajax-cart-toggle-class-button="js-my-cart-open">
                <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 17 17" fill="none">
          <line x1="1.41421" y1="1" x2="15.5563" y2="15.1421" stroke="#1d1d1d" stroke-width="2" stroke-linecap="round"></line>
          <line x1="1" y1="15.1424" x2="15.1421" y2="1.00029" stroke="#1d1d1d" stroke-width="2" stroke-linecap="round"></line>
        </svg>
      </a>
    </div>
  </div>

  <!-- Main Cart Section -->
  <div pricefinal="810000" class="cartDivx" data-ajax-cart-section="">
    <!-- Free Shipping Header -->
    <div class="freeShippingHeaderx-2" style="display: none;">Gratis Versand (DE) freigeschaltet 🚚<br><span class="freeshippingfurther">Füge weitere Produkte hinzu um Geschenke freizuschalten.</span></div>
    <div class="freeShippingHeaderx">Geschenke freischalten 🎁</div>

    
    
    
    
    <div id="giftDifferencex" class="giftDifferencex"><span style="color: #CA32F9"><strong>Alle freigeschaltet 🥳</strong></span></div>

    <div data-ajax-cart-static-element="" class="freeShippingx">
      
        
        
        
        
        
        
        <div style="display: block;" low="0" high="4900" class="freeGiftHolderx belowThresholdx reachedx">
          <div class="progress-bar-containerx">
            <div class="progress-bar-fillx" style="width: 100%;"></div>
          </div>
          <div class="giftTextIconx">
            <div class="freeShippingBarEmptyx greenBackgroundx">
              <div class="giftIconx">
                
                              <svg xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 38 38" fill="none">
                            <circle cx="19" cy="19" r="19" fill="white"></circle>
              <path d="M24.8362 15.7192H29.5472C29.803 15.7192 30.0526 15.7983 30.2617 15.9457C30.4708 16.0931 30.6291 16.3015 30.7151 16.5424L32.9281 22.7412C32.9949 22.9287 33.0157 23.1295 32.9886 23.3267C32.9614 23.524 32.8872 23.7117 32.7722 23.8742C32.6571 24.0367 32.5047 24.169 32.3277 24.2601C32.1506 24.3512 31.9543 24.3983 31.7552 24.3975H30.3085" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M17.9107 24.3975H24.8533L24.8422 13.2398C24.8422 12.911 24.7116 12.5956 24.4791 12.3631C24.2466 12.1306 23.9312 12 23.6024 12C23.6024 12 13.1134 12 11.1768 12" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M11.1987 15.7192V23.1578C11.1987 23.4866 11.3293 23.8019 11.5618 24.0344C11.7943 24.2669 12.1097 24.3975 12.4385 24.3975H14.4109" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M26.6956 25.0173C26.6956 25.5105 26.8915 25.9836 27.2402 26.3323C27.589 26.681 28.062 26.877 28.5552 26.877C29.0484 26.877 29.5214 26.681 29.8701 26.3323C30.2189 25.9836 30.4148 25.5105 30.4148 25.0173C30.4148 24.5241 30.2189 24.0511 29.8701 23.7024C29.5214 23.3536 29.0484 23.1577 28.5552 23.1577C28.062 23.1577 27.589 23.3536 27.2402 23.7024C26.8915 24.0511 26.6956 24.5241 26.6956 25.0173Z" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M14.2981 25.0173C14.2981 25.5105 14.494 25.9836 14.8428 26.3323C15.1915 26.681 15.6645 26.877 16.1577 26.877C16.6509 26.877 17.1239 26.681 17.4727 26.3323C17.8214 25.9836 18.0174 25.5105 18.0174 25.0173C18.0174 24.5241 17.8214 24.0511 17.4727 23.7024C17.1239 23.3536 16.6509 23.1577 16.1577 23.1577C15.6645 23.1577 15.1915 23.3536 14.8428 23.7024C14.494 24.0511 14.2981 24.5241 14.2981 25.0173V25.0173Z" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5 18.1987L8.71926 18.2049" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M6.85962 20.6782L8.71925 20.6844" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M8.09937 23.1577L8.71924 23.1639" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M31.6548 19.4385H24.8362" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M24.8496 24.3975H26.8109" stroke="#1D1D1B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
                
              </div>
            </div>
            <div class="giftProgressx">
              <div class="giftTextx">
                <div class="giftTextRightx">
                  <span class="nurNochx" id="dynamicThresholdx">✅</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        
        
        
        
        
        
        <div style="display: block;" low="4900" high="9900" class="freeGiftHolderx belowThresholdx reachedx">
          <div class="progress-bar-containerx">
            <div class="progress-bar-fillx" style="width: 100%;"></div>
          </div>
          <div class="giftTextIconx">
            <div class="freeShippingBarEmptyx greenBackgroundx">
              <div class="giftIconx">
                
                  <img style="width: 100%; border-radius: 50%;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/WebshopPDP_01_37bd977b-b074-4c14-b8d9-3b6dc5d82a7a_200x.jpg" loading="lazy">
                
              </div>
            </div>
            <div class="giftProgressx">
              <div class="giftTextx">
                <div class="giftTextRightx">
                  <span class="nurNochx" id="dynamicThresholdx">✅</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
        
        
        
        
        
        
        <div style="display: block;" low="9900" high="14900" class="freeGiftHolderx belowThresholdx reachedx">
          <div class="progress-bar-containerx">
            <div class="progress-bar-fillx" style="width: 100%;"></div>
          </div>
          <div class="giftTextIconx">
            <div class="freeShippingBarEmptyx greenBackgroundx">
              <div class="giftIconx">
                
                  <img style="width: 100%; border-radius: 50%;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09QT242YD.02_200x.jpg" loading="lazy">
                
              </div>
            </div>
            <div class="giftProgressx">
              <div class="giftTextx">
                <div class="giftTextRightx">
                  <span class="nurNochx" id="dynamicThresholdx">✅</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      
    </div>

    <div class="cartProductsDivx" style="height: 100%;">
      
        <div class="my-cart__itemsx" data-ajax-cart-section-scroll="">
          
            
              
                <div class="cartItemx">
                  

                  <!-- Item Image -->
                  <div class="itemImagex">
                    <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09QT242YD.02_200x@2x.jpg">
                  </div>

                  <!-- Item Info -->
                  <div class="itemInfox">
                    <div class="topCartItemx">
                      
                    </div>
                    <div class="itemTitlePricex">
                      <div class="itemTitlex">
                        <a href="https://www.ahead-nutrition.com/products/ahead-riegel-hazelnut-cacao?variant=43530481139976">
                          
                            Hazelnut-Cacao - 18 Riegel
                          
                        </a>
                        <p class="itemSubtitlex">Schokoriegel</p>
                        
<div class="propertiesx">
                            Bundle:
                            
                              Bundle Builder
                            
                          </div>
                          
                        
<div class="propertiesx">
                            Box ID:
                            
                              2
                            
                          </div>
                          
                        
                      </div>

                      <!-- Display Item Price and Discount -->
                      
                      
                        <!-- Otherwise, use the existing price/discount logic -->
                        
                          <div class="itemPricex">
                            
                            <span class="normalCartx">Rs. 2,700.00</span>
                          </div>
                        
                      
                      
                    </div>

                    <!-- Item Quantity and Remove Button -->
                    <div style="display: flex; justify-content: space-between;">
                      
                        <div class="itemQtyx">
                          <a class="itemMinus quantity__button" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=1&amp;quantity=0">
                            <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                          </a>
                          <input data-ajax-cart-quantity-input="1" name="updates[]" class="quantity__input" value="1" type="text">
                          <a class="itemPlus quantity__button" name="plus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=1&amp;quantity=2">
                            <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                          </a>
                        </div>
                        
                      
                      <a class="itemRemovex" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=1&amp;quantity=0">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M13.174 2.82617V14.3914C13.174 14.5528 13.1099 14.7076 12.9957 14.8218C12.8816 14.936 12.7267 15.0001 12.5653 15.0001H3.43487C3.27343 15.0001 3.11861 14.936 3.00445 14.8218C2.8903 14.7076 2.82617 14.5528 2.82617 14.3914V2.82617" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 2.82609V1.6087C5.26074 1.44726 5.32487 1.29244 5.43903 1.17828C5.55318 1.06413 5.708 1 5.86944 1H10.1303C10.2917 1 10.4466 1.06413 10.5607 1.17828C10.6749 1.29244 10.739 1.44726 10.739 1.6087V2.82609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M1 2.82617H15" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M8 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M10.7393 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
                      </a>
                    </div>
                    <div data-ajax-cart-messages="43530481139976:50c67d7edc856a032bf646c0d8681298"></div>
                  </div>
                </div>
              
            
          
            
              
                <div class="cartItemx">
                  

                  <!-- Item Image -->
                  <div class="itemImagex">
                    <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09GRCR2DL.03_200x@2x.jpg">
                  </div>

                  <!-- Item Info -->
                  <div class="itemInfox">
                    <div class="topCartItemx">
                      
                    </div>
                    <div class="itemTitlePricex">
                      <div class="itemTitlex">
                        <a href="https://www.ahead-nutrition.com/products/ahead-riegel-coconut-almond?variant=39418248364119">
                          
                            Coconut-Almond - 18 Riegel
                          
                        </a>
                        <p class="itemSubtitlex">Schokoriegel</p>
                        
<div class="propertiesx">
                            Bundle:
                            
                              Bundle Builder
                            
                          </div>
                          
                        
<div class="propertiesx">
                            Box ID:
                            
                              2
                            
                          </div>
                          
                        
                      </div>

                      <!-- Display Item Price and Discount -->
                      
                      
                        <!-- Otherwise, use the existing price/discount logic -->
                        
                          <div class="itemPricex">
                            
                            <span class="normalCartx">Rs. 2,700.00</span>
                          </div>
                        
                      
                      
                    </div>

                    <!-- Item Quantity and Remove Button -->
                    <div style="display: flex; justify-content: space-between;">
                      
                        <div class="itemQtyx">
                          <a class="itemMinus quantity__button" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=2&amp;quantity=0">
                            <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                          </a>
                          <input data-ajax-cart-quantity-input="2" name="updates[]" class="quantity__input" value="1" type="text">
                          <a class="itemPlus quantity__button" name="plus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=2&amp;quantity=2">
                            <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                          </a>
                        </div>
                        
                      
                      <a class="itemRemovex" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=2&amp;quantity=0">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M13.174 2.82617V14.3914C13.174 14.5528 13.1099 14.7076 12.9957 14.8218C12.8816 14.936 12.7267 15.0001 12.5653 15.0001H3.43487C3.27343 15.0001 3.11861 14.936 3.00445 14.8218C2.8903 14.7076 2.82617 14.5528 2.82617 14.3914V2.82617" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 2.82609V1.6087C5.26074 1.44726 5.32487 1.29244 5.43903 1.17828C5.55318 1.06413 5.708 1 5.86944 1H10.1303C10.2917 1 10.4466 1.06413 10.5607 1.17828C10.6749 1.29244 10.739 1.44726 10.739 1.6087V2.82609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M1 2.82617H15" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M8 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M10.7393 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
                      </a>
                    </div>
                    <div data-ajax-cart-messages="39418248364119:b382e936e2aa1027e3894c79f4f6c940"></div>
                  </div>
                </div>
              
            
          
            
              
                <div class="cartItemx">
                  

                  <!-- Item Image -->
                  <div class="itemImagex">
                    <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09QT242YD.02_200x@2x.jpg">
                  </div>

                  <!-- Item Info -->
                  <div class="itemInfox">
                    <div class="topCartItemx">
                      
                    </div>
                    <div class="itemTitlePricex">
                      <div class="itemTitlex">
                        <a href="https://www.ahead-nutrition.com/products/ahead-riegel-hazelnut-cacao?variant=43530481139976">
                          
                            Hazelnut-Cacao - 18 Riegel
                          
                        </a>
                        <p class="itemSubtitlex">Schokoriegel</p>
                        
<div class="propertiesx">
                            Bundle:
                            
                              Bundle Builder
                            
                          </div>
                          
                        
<div class="propertiesx">
                            Box ID:
                            
                              1
                            
                          </div>
                          
                        
                      </div>

                      <!-- Display Item Price and Discount -->
                      
                      
                        <!-- Otherwise, use the existing price/discount logic -->
                        
                          <div class="itemPricex">
                            
                            <span class="normalCartx">Rs. 2,700.00</span>
                          </div>
                        
                      
                      
                    </div>

                    <!-- Item Quantity and Remove Button -->
                    <div style="display: flex; justify-content: space-between;">
                      
                        <div class="itemQtyx">
                          <a class="itemMinus quantity__button" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=3&amp;quantity=0">
                            <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                          </a>
                          <input data-ajax-cart-quantity-input="3" name="updates[]" class="quantity__input" value="1" type="text">
                          <a class="itemPlus quantity__button" name="plus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=3&amp;quantity=2">
                            <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                          </a>
                        </div>
                        
                      
                      <a class="itemRemovex" name="minus" data-ajax-cart-request-button="" href="https://www.ahead-nutrition.com/cart/change?line=3&amp;quantity=0">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M13.174 2.82617V14.3914C13.174 14.5528 13.1099 14.7076 12.9957 14.8218C12.8816 14.936 12.7267 15.0001 12.5653 15.0001H3.43487C3.27343 15.0001 3.11861 14.936 3.00445 14.8218C2.8903 14.7076 2.82617 14.5528 2.82617 14.3914V2.82617" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 2.82609V1.6087C5.26074 1.44726 5.32487 1.29244 5.43903 1.17828C5.55318 1.06413 5.708 1 5.86944 1H10.1303C10.2917 1 10.4466 1.06413 10.5607 1.17828C10.6749 1.29244 10.739 1.44726 10.739 1.6087V2.82609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M1 2.82617H15" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M5.26074 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M8 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M10.7393 4.95654V12.2609" stroke="#D9D9D9" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
                      </a>
                    </div>
                    <div data-ajax-cart-messages="43530481139976:f1c2ae5470a30a74cf3fc12a0d74bbf2"></div>
                  </div>
                </div>
              
            
          
        </div>
        
          
        
          
        
          
        
      
    </div>

    
    
    
    

    <div data-ajax-cart-static-element="" class="my-cart__app-containerx"></div>
    <div class="bottomCartx">
      <div class="relatedProductsx">
        <div class="arrowx">
          <span class="left-arrowx" onclick="scrollLeft()">❮</span>
          <span class="freeShippingHeaderx-3 arrowsx">Die perfekte Ergänzung:</span>
          <span class="right-arrowx" onclick="scrollRight()">❯</span>
        </div>
        <div class="dynamicSuggestionsx" id="dynamicSuggestionsx">
          
          
          
          
          
          

          

          
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                
                
                  
                  
                    
                      
                      
                        
                          
                            
                            
                    
                    
                      <div class="cartItemx recommendx">
                        <div class="itemImagex recommendx">
                          <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B0C669859X.03_895bea85-10eb-49d7-9caa-11c567656b28_200x@2x.jpg">
                        </div>
                        <div class="itemInfox recommendx">
                          <div class="itemTitlePricex recommendx">
                            <div class="itemTitlex recommendx" style="width: auto;">
                              <a href="https://www.ahead-nutrition.com/products/soft-cookie-double-chocolate">Double Chocolate</a>
                            </div>
                          </div>
                          <p class="itemSubtitlex recommendx">Soft baked Cookie</p>

                          
                            <div class="itemPricex recommendx" style="margin-left: 0px;">
                              
                              <span class="normalCartx">Rs. 400.00</span>
                            </div>
                          
                        </div>
                        <div class="buttonaddcontainer">
                          <a class="btnAddRecx recommendx" href="https://www.ahead-nutrition.com/cart/add?id=45492506067208&amp;quantity=1" data-ajax-cart-request-button="">+</a>
                        </div>
                      </div>
                      
                    
                  
                  
                
              
            
              
                
                
                
                  
                  
                    
                      
                      
                        
                      
                        
                          
                            
                            
                    
                    
                      <div class="cartItemx recommendx">
                        <div class="itemImagex recommendx">
                          <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B0C669859X.03_95554e04-e279-4d31-8518-1f85efba7860_200x@2x.jpg">
                        </div>
                        <div class="itemInfox recommendx">
                          <div class="itemTitlePricex recommendx">
                            <div class="itemTitlex recommendx" style="width: auto;">
                              <a href="https://www.ahead-nutrition.com/products/protein-bar-peanut-caramel">Peanut Caramel</a>
                            </div>
                          </div>
                          <p class="itemSubtitlex recommendx">Proteinriegel</p>

                          
                            <div class="itemPricex recommendx" style="margin-left: 0px;">
                              
                              <span class="normalCartx">Rs. 3,000.00</span>
                            </div>
                          
                        </div>
                        <div class="buttonaddcontainer">
                          <a class="btnAddRecx recommendx" href="https://www.ahead-nutrition.com/cart/add?id=45428969668872&amp;quantity=1" data-ajax-cart-request-button="">+</a>
                        </div>
                      </div>
                      
                    
                  
                  
                
              
            
              
                
                
                
                  
                  
                    
                      
                      
                        
                      
                        
                      
                        
                          
                        
                      
                        
                          
                        
                      
                        
                          
                            
                            
                    
                    
                      <div class="cartItemx recommendx">
                        <div class="itemImagex recommendx">
                          <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B0C669859X.03_88b9bac3-fa16-4bfd-81ac-a935c87e3b23_200x@2x.jpg">
                        </div>
                        <div class="itemInfox recommendx">
                          <div class="itemTitlePricex recommendx">
                            <div class="itemTitlex recommendx" style="width: auto;">
                              <a href="https://www.ahead-nutrition.com/products/protein-bar-fudge-brownie">Fudge Brownie</a>
                            </div>
                          </div>
                          <p class="itemSubtitlex recommendx">Proteinriegel</p>

                          
                            <div class="itemPricex recommendx" style="margin-left: 0px;">
                              
                              <span class="normalCartx">Rs. 3,000.00</span>
                            </div>
                          
                        </div>
                        <div class="buttonaddcontainer">
                          <a class="btnAddRecx recommendx" href="https://www.ahead-nutrition.com/cart/add?id=45535536972040&amp;quantity=1" data-ajax-cart-request-button="">+</a>
                        </div>
                      </div>
                      
                    
                  
                  
                
              
            
              
            
              
            
              
            
              
            
          
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                
                
              
            
              
                
                
                
                  
                  
                    
                      
                      
                        
                      
                        
                      
                        
                          
                        
                      
                        
                          
                        
                      
                        
                      
                        
                          
                        
                      
                        
                          
                        
                      
                        
                          
                            
                            
                    
                    
                      <div class="cartItemx recommendx">
                        <div class="itemImagex recommendx">
                          <img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B0C669859X.03_e01bcb27-23f4-404b-9e06-4ef51165fc9c_200x@2x.jpg">
                        </div>
                        <div class="itemInfox recommendx">
                          <div class="itemTitlePricex recommendx">
                            <div class="itemTitlex recommendx" style="width: auto;">
                              <a href="https://www.ahead-nutrition.com/products/protein-bar-hazelnut-nougat">Hazelnut Nougat</a>
                            </div>
                          </div>
                          <p class="itemSubtitlex recommendx">Proteinriegel</p>

                          
                            <div class="itemPricex recommendx" style="margin-left: 0px;">
                              
                              <span class="normalCartx">Rs. 3,000.00</span>
                            </div>
                          
                        </div>
                        <div class="buttonaddcontainer">
                          <a class="btnAddRecx recommendx" href="https://www.ahead-nutrition.com/cart/add?id=45119166808328&amp;quantity=1" data-ajax-cart-request-button="">+</a>
                        </div>
                      </div>
                      
                    
                  
                  
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
            
              
            
              
            
              
            
          
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
                
                
                
              
            
              
            
              
            
              
            
              
            
          
        </div>
      </div>

      <p class="shippingMessagex shippingMessage2x">
        <span>
          <img id="dhlklima" style="margin: -3px auto;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/dhl-gogreen_2.png" alt="DHL KLIMANEUTRAL" width="16">
        </span>
        <span style="color: #7CB441;"><strong>&nbsp;Klimaneutraler</strong></span> Versand nach DE + 
        
          <span style="color: #7CB441;"><strong>Kostenlos</strong></span>
        
      </p>
      

      
        <!-- Normal checkout button -->
        <button class="checkoutButtonx checkoutButton2x" pricefinal="Rs. 8,100.00" type="submit" name="checkout">
          Zur Kasse - 
          
            Rs. 8,100.00
          
        </button>
      
    </div>
  </div>

<script>
function showMinimumPopup() {
  if (document.getElementById('minimumPopup')) return;

  const cartContainer = document.querySelector('.my-cart__itemsx');
  if (!cartContainer) return;

  const popup = document.createElement('div');
  popup.id = 'minimumPopup';
  popup.classList.add('minimumPopupClass');
  popup.innerText = 'Der Mindestbestellwert für die Gratis Aktion ist noch nicht erreicht';

  cartContainer.appendChild(popup);

  setTimeout(() => {
    if (popup && popup.parentNode) {
      popup.parentNode.removeChild(popup);
    }
  }, 3000);
}

</script>

<script>
  // Function to add spinner to a button and hide its content
  function addSpinner(button) {
    // Store the original content and background color
    const originalContent = button.innerHTML;
    const originalBackgroundColor = button.style.backgroundColor;

    // Hide the button's content and set background to #fff
    button.innerHTML = '';

    // Create spinner element
    const spinner = document.createElement('div');
    spinner.className = 'spinner';
    spinner.style.cssText = 'display:inline-block; width:20px; height:20px; border:4px solid grey; border-radius:50%; border-top:4px solid #980D84; animation: spin 1s linear infinite; background: transparent;';

    // Append spinner to button
    button.appendChild(spinner);

    // Restore button content and background color after 1.5 seconds
    setTimeout(() => {
      button.innerHTML = originalContent;
      button.style.backgroundColor = originalBackgroundColor;
    }, 1500);
  }

  // Function to initialize the spinner functionality on specific buttons
  function initializeSpinnerOnButtons() {
    // Select buttons
    const plusButtons = document.querySelectorAll('.itemPlus');
    const minusButtons = document.querySelectorAll('.itemMinus');
    const addRecxButtons = document.querySelectorAll('.btnAddRecx');
    const removexButtons = document.querySelectorAll('.itemRemovex');
    const addToCartButton = document.getElementById('addToCart'); 
    const productItemAddButtons = document.querySelectorAll('.productItemAdd');

    // Combine all buttons into one list
    const allButtons = [...plusButtons, ...minusButtons, ...addRecxButtons, ...removexButtons, ...productItemAddButtons];

    // Attach click event listeners
    allButtons.forEach(button => {
      button.addEventListener('click', () => {
        addSpinner(button);
      });
    });

    // addToCart button, if present and not a BIS trigger
    if (addToCartButton && !addToCartButton.classList.contains('klaviyo-bis-trigger')) {
      addToCartButton.addEventListener('click', () => {
        addSpinner(addToCartButton);
      });
    }
  }

  // Run init immediately
  initializeSpinnerOnButtons();

  // Also handle newly added elements (dynamic cart updates)
  document.addEventListener('click', function(event) {
    if (
      event.target.matches('.itemPlus, .itemMinus, .btnAddRecx, .itemRemovex, .productItemAdd') ||
      (event.target.id === 'addToCart' && !event.target.classList.contains('klaviyo-bis-trigger'))
    ) {
      addSpinner(event.target);
    }
  });

  // Spinner CSS animation
  const style = document.createElement('style');
  style.innerHTML =
  `
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  `;
  document.head.appendChild(style);
</script>

<script type="module">
  import { subscribeToCartStateUpdate } from '//www.ahead-nutrition.com/cdn/shop/t/312/assets/liquid-ajax-cart-v1.10.3.js?v=711574860514368811738669749';

  const giftThresholds = [{"pricex":"49","productx":"","textbx":"Versand DE","textax":""},{"pricex":"99","productx":"free-crazy-pistachio-350g","textbx":"Crazy Pistachio","textax":""},{"pricex":"149","productx":"free-hazelnut-cacao","textbx":"Hazelnut-Cacao Tray","textax":""}];

  function updateGiftText({ cart }) {
    let nextGiftThreshold = null;
    let nextGiftText = null;
    let allGiftsUnlocked = true;

    giftThresholds.forEach(block => {
      const threshold = parseFloat(block.pricex) * 100;
      if (cart.total_price < threshold) {
        if (nextGiftThreshold === null || threshold < nextGiftThreshold) {
          nextGiftThreshold = threshold;
          nextGiftText = block.textbx;
        }
        allGiftsUnlocked = false;
      }
    });

    const giftDifferenceDiv = document.getElementById('giftDifferencex');
    if (allGiftsUnlocked) {
      giftDifferenceDiv.innerHTML = '<span style="color: #CA32F9"><strong>Alle freigeschaltet 🥳</strong></span>';
    } else {
      const difference = (nextGiftThreshold - cart.total_price) / 100;
      giftDifferenceDiv.innerHTML = `Nur noch <span style="color: #CA32F9"><strong>€${difference.toFixed(2)}</strong></span> bis: <span style="color: #CA32F9"><strong>Gratis ${nextGiftText}</strong></span>`;
    }

    document.querySelectorAll('.nurNochx').forEach(el => {
      const threshold = parseInt(el.closest('.freeGiftHolderx').getAttribute('high'), 10);
      if (cart.total_price >= threshold) {
        el.innerHTML = '✅';
      } else {
        el.innerHTML = `€${(threshold / 100).toFixed(2)}`;
      }
    });

    document.querySelectorAll('.freeGiftHolderx').forEach(holder => {
      const threshold = parseInt(holder.getAttribute('high'), 10);
      const freeShippingBarEmpty = holder.querySelector('.freeShippingBarEmptyx');
      if (cart.total_price >= threshold) {
        if (freeShippingBarEmpty) freeShippingBarEmpty.classList.add('greenBackgroundx');
      } else {
        if (freeShippingBarEmpty) freeShippingBarEmpty.classList.remove('greenBackgroundx');
      }
    });

    giftThresholds.forEach((block, index) => {
      const threshold = parseFloat(block.pricex) * 100;
      const previousThreshold = index > 0 ? parseFloat(giftThresholds[index - 1].pricex) * 100 : 0;
      let percent = 0;

      if (cart.items.length > 0) {
        if (cart.total_price <= previousThreshold) {
          percent = 0;
        } else {
          if (index === 0) {
            percent = (cart.total_price * 100.0) / threshold;
          } else {
            const difference = threshold - previousThreshold;
            const progress = cart.total_price - previousThreshold;
            percent = (progress * 100.0) / difference;
          }
        }
        if (percent > 100) percent = 100;
      }

      const progressBarFill = document.querySelector(`.freeGiftHolderx[high="${threshold}"] .progress-bar-fillx`);
      if (progressBarFill) {
        progressBarFill.style.width = `${percent}%`;
      }
    });
  }

  function initializeGiftSection() {
    fetch('/cart.js')
      .then(response => response.json())
      .then(cart => {
        updateGiftText({ cart });
        updateGiftSectionVisibility(cart);
      });
  }

  document.addEventListener('DOMContentLoaded', () => {
    initializeGiftSection();
  });

  subscribeToCartStateUpdate(state => {
    updateGiftText(state);
    updateGiftSectionVisibility(state.cart);
  });

  function updateGiftSectionVisibility(cart) {
    // (Optional) Add any show/hide logic for gift section
  }
</script>

<!-- Script for Bonus Product Synchronization -->
<script type="module">
  import { cartRequestAdd, cartRequestChange, subscribeToCartStateUpdate } from '//www.ahead-nutrition.com/cdn/shop/t/312/assets/liquid-ajax-cart-v1.10.3.js?v=711574860514368811738669749';

  const MAIN_PRODUCT_IDS = [39524085399639, 39524085858391, 45062024986888, 45062115524872];
  const BONUS_PRODUCT_VARIANT_ID = 44943584198920;

  const NEW_MAIN_PRODUCT_ID = 45062347489544;
  const NEW_BONUS_PRODUCT_VARIANT_ID = 45063289504008;

  function findProductInCart(cart, productId) {
    return cart.items.find(item => item.id === productId);
  }

  function syncBonusProduct(cart) {
    const totalMainProductQuantity = MAIN_PRODUCT_IDS.reduce((total, mainProductId) => {
      const product = findProductInCart(cart, mainProductId);
      return total + (product ? product.quantity : 0);
    }, 0);

    const bonusProduct = findProductInCart(cart, BONUS_PRODUCT_VARIANT_ID);

    if (totalMainProductQuantity > 0 && !bonusProduct) {
      cartRequestAdd({
        items: [{
          id: BONUS_PRODUCT_VARIANT_ID,
          quantity: totalMainProductQuantity
        }]
      }).catch(error => {
        console.error('Error adding bonus product:', error);
      });
    } else if (totalMainProductQuantity === 0 && bonusProduct) {
      cartRequestChange({
        id: bonusProduct.key,
        quantity: 0
      }).catch(error => {
        console.error('Error removing bonus product:', error);
      });
    } else if (bonusProduct && bonusProduct.quantity !== totalMainProductQuantity) {
      cartRequestChange({
        id: bonusProduct.key,
        quantity: totalMainProductQuantity
      }).catch(error => {
        console.error('Error updating bonus product quantity:', error);
      });
    }
  }

  function syncNewBonusProduct(cart) {
    const newMainProduct = findProductInCart(cart, NEW_MAIN_PRODUCT_ID);
    const newBonusProduct = findProductInCart(cart, NEW_BONUS_PRODUCT_VARIANT_ID);

    if (newMainProduct && newMainProduct.quantity > 0 && !newBonusProduct) {
      cartRequestAdd({
        items: [{
          id: NEW_BONUS_PRODUCT_VARIANT_ID,
          quantity: newMainProduct.quantity
        }]
      }).catch(error => {
        console.error('Error adding new bonus product:', error);
      });
    } else if ((!newMainProduct || newMainProduct.quantity === 0) && newBonusProduct) {
      cartRequestChange({
        id: newBonusProduct.key,
        quantity: 0
      }).catch(error => {
        console.error('Error removing new bonus product:', error);
      });
    } else if (newBonusProduct && newMainProduct && newBonusProduct.quantity !== newMainProduct.quantity) {
      cartRequestChange({
        id: newBonusProduct.key,
        quantity: newMainProduct.quantity
      }).catch(error => {
        console.error('Error updating new bonus product quantity:', error);
      });
    }
  }

  subscribeToCartStateUpdate(state => {
    const cart = state.cart;
    syncBonusProduct(cart);
    syncNewBonusProduct(cart);
    console.log("Cart state updated:", cart);
  });
</script>

<input id="_customerReferenceId" hidden="" type="hidden" name="properties[_customerReferenceId]" value="752416b7-a77e-59ef-a9c0-6faa85a5dde6"></form>

<!-- Schema for the Section -->

</div>
      <div class="backgroundBlurx" data-ajax-cart-toggle-class-button="js-my-cart-open"></div>
    </div>

    <!-- Additional Styles and Configurations -->
    <style class="styleHead">
      .my-cart__items {
        opacity: 1;
        transition: opacity .2s;
      }

      /* Make the area with controls visually disabled */
      body.js-ajax-cart-request-in-progress .my-cart__items {
        opacity: .7;
      }

      /* Make the submit button visually disabled */
      form.js-ajax-cart-form-in-progress [type="submit"] {
        opacity: .7;
      }

      .freeGiftHolder {
        display: none;
      }
    </style>
    <script type="application/json" data-ajax-cart-configuration="">
      {
        "addToCartCssClass": "js-my-cart-open"
      }
    </script>
    <style class="shippingCSS">
      .shippingMessage.shippingMessage2 {
        display: none;
      }
      .checkoutButton.checkoutButton2 {
        display: none;
      }
    </style>

    <div id="shopify-section-announcement-bar" class="shopify-section"><style>
.countdown_annoucement_bar_wrapper_clymw87mq253581905ca9qz2vr {
  column-gap: 0px !important;
  padding: 5px 0px !important;
}
.announcement-bar-container {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
}
.announcement-messages {
  position: relative;
}
.announcementHolder {
  min-height: auto;
}
.announcementIcon {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 3;
  cursor: pointer;
}
.announcementIconLeft {
  left: 0;
  display: none;
}
.announcementIconRight {
  right: 0;
  display: none;
}
.announcementContainer *, .announcementContainer2 * {
  font-weight: 700;
  font-size: 14px;
  line-height: 14px;
  color: #FFFC00;
  margin: auto;
}
.announcementContainer2 {
  visibility: hidden;
  opacity: 0;
}
.announcementContainer {
  opacity: 0;
  transition: all .3s ease-out;
  position: absolute;
  top: 0px;
  left: 0;
  width: 100%;
}
.announcementContainer.active {
  opacity: 1;
  z-index: 2;
}
.announceLink {
  margin: 0 12px;
  font-weight: 700;
  font-size: 14px;
  line-height: 19px;
  color: #F0E619;
  text-decoration: unset;
}
.announcement-bar-links {
  display: flex;
  justify-content: flex-end;
  align-items: center;
}
.countrySwitcher {
  display: none;
  place-items: center;
  grid-template-columns: 1fr;
  position: relative;
}
.countrySwitcher .selected a {
  text-decoration: unset;
  font-weight: 700;
  position: relative;
  font-size: 14px;
  line-height: 19px;
  color: #1D1D1B;
  padding-right: 10px;
}
.countrySwitcher img {
  margin-right: 4px;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  margin-bottom: -2px;
}
.countrySwitcher.switcher .selected a:after {
  height: 3.5px;
  display: inline-block;
  position: absolute;
  right: 0px;
  top: 30%;
  transform: rotate(45deg);
  transform-origin: center center;
  width: 3.5px;
  border-right: 1px solid black;
  border-bottom: 1px solid black;
  content: ""!important;
  transition: all .2s;
  z-index: 9999999;
}
.countrySwitcher .option {
  position: absolute;
  background: #fff;
  border-radius: 10px;
  bottom: 0;
  transform: translateY(100%);
  right: 0;
  width: 100%;
  padding: 5px 5px;
  z-index: 9999999;
}
.countrySwitcher .option a {
  display: block;
  text-decoration: unset;
  font-size: 14px;
  line-height: 19px;
  color: #1D1D1B;
  padding: 3px 5px;
}
.countrySwitcher .option img {
  display: none;
}
@media screen and (max-width: 990px) {
  .announcement-bar-links {
    display: none;
  }
  .announcement-bar-container > .announcement-messages {
    display: block;
  }
  .announcement-bar-container {
    display: grid;
    grid-template-columns: 100%;
  }
}
}
</style>
<div class="announcement-bar" style="background-color: #C130ED !important" role="region" aria-label="Ankündigung" id="toppage">
  <div class="page-width announcement-bar-container">
    <div>
    </div>
    <div class="announcement-messages">
    
    <div class="announcementIcon announcementIconLeft">
      <svg xmlns="http://www.w3.org/2000/svg" width="5" height="7" viewBox="0 0 5 7" fill="none">
        <path d="M3.5 1L1 3.5L3.5 6" stroke="#FFFC00" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </div>
    <div class="announcementIcon announcementIconRight">
      <svg xmlns="http://www.w3.org/2000/svg" width="5" height="7" viewBox="0 0 5 7" fill="none">
        <path d="M1 6L3.5 3.5L1 1" stroke="#FFFC00" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </div>
    
    <div class="announcementHolder">
      <div class="announcementContainer2 active" slide="announcement-bar-0"><p class="announcement-bar__message h5">
                  💸 Gratis Versand ab <span class="shippingChange">49€ (DE)</span>
</p></div>
      
      <div class="announcementContainer active" slide="announcement-bar-0"><p class="announcement-bar__message h5">
                  💸 Gratis Versand ab <span class="shippingChange">49€ (DE)</span>
</p></div>
      
      <div class="announcementContainer" slide="aa302166-6a45-4e41-9cd2-af35fe7c1f81"><p class="announcement-bar__message h5">
                  🛡️ 60 Tage Geld-zurück-Garantie
</p></div>
      
      <div class="announcementContainer" slide="ce004155-1cac-4151-91b4-9f98f7ad462f"><p class="announcement-bar__message h5">
                  ⭐ Über 5.000 5* Reviews
</p></div>
      
      </div>
    </div>
      <div class="announcement-bar-links"><a href="https://ahead-help-center.gorgias.help/de-DE" class="announceLink">
                            Kontakt
                          </a><a href="https://www.ahead-nutrition.com/pages/referral-freunde-werben" class="announceLink">
                            10€ für dich!
                          </a><div class="switcher countrySwitcher notranslate">
              <div class="selected">
                <a href="https://www.ahead-nutrition.com/pages/bundle-builder-new?currentFlow=byob&amp;page=addProductsPage1#" onclick="return false;" class=""><img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/de.png" height="24" width="24" alt="de"> DE</a>
              </div>
              <div class="option" style="display: none;">
                <a href="https://en.ahead-nutrition.com/" onclick="doGTranslate(&#39;de|en&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="English" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/en.png" height="24" width="24" alt="en" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/en.png"> EN</a><a href="https://ahead-nutrition.fr/" onclick="doGTranslate(&#39;de|fr&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Français" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/fr.png" height="24" width="24" alt="fr" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/fr.png"> FR</a><a href="https://ahead-nutrition.com/" onclick="doGTranslate(&#39;de|de&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Deutsch" class="nturl selected"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/de.png" height="24" width="24" alt="de" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/de.png"> DE</a><a href="https://ahead-nutrition.it/" onclick="doGTranslate(&#39;de|it&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Italiano" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/it.png" height="24" width="24" alt="it" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/it.png"> IT</a><a href="https://ahead-nutrition.es/" onclick="doGTranslate(&#39;de|es&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Español" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/es.png" height="24" width="24" alt="es" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/es.png"> ES</a></div>
            </div>
      </div>
    <div></div>
    <div class="countdown-timer-block" countdown-timer-id="clymw87mq253581905ca9qz2vr"></div>
  </div>
</div>

<script>
  let div = '';
  $(".announcementIcon").click(function(){
    if ($(this).hasClass("announcementIconLeft")){
      if ($(".announcementContainer.active").prev().length > 1){
        div = $(".announcementContainer.active").prev()
      }else{
        div = $(".announcementContainer").last();
      }
    }else{
      if ($(".announcementContainer.active").next().length > 0){
        div = $(".announcementContainer.active").next()
      }else{
        div = $(".announcementContainer").first();
      }
    }
    $(".announcementContainer.active").removeClass("active");
    $(div).addClass("active");
  });
</script>
<script>
  $(document).ready(function(){
    setInterval(function () {$(".announcementIconRight").click()}, 4000);
  });
</script>
<script>
  $(document).ready(function(){
    $(".countrySwitcher .selected a").click(function(){
      $(".countrySwitcher .option").slideToggle();
    });
  });
</script>


</div>
    <div id="shopify-section-header" class="shopify-section section-header"><link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/component-list-menu.css" media="all" onload="this.media=&#39;all&#39;">
<link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/component-search.css" media="all" onload="this.media=&#39;all&#39;">
<link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/component-menu-drawer.css" media="all" onload="this.media=&#39;all&#39;">
<link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/component-cart-notification.css" media="all" onload="this.media=&#39;all&#39;">
<link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/component-cart-items.css" media="all" onload="this.media=&#39;all&#39;">


<script>

var gt_request_uri = (typeof __st != 'undefined') ? '/'+__st.pageurl.split('/').slice(1).join('/') : location.pathname+location.search;

function doGTranslate(lang_pair) {if(lang_pair.value)lang_pair=lang_pair.value;if(lang_pair=='')return;var lang=lang_pair.split('|')[1];
if(lang == 'es')
    location.href = 'https://ahead-nutrition.es'+gt_request_uri;
else if(lang == 'it')
    location.href = 'https://ahead-nutrition.it'+gt_request_uri;
else if(lang == 'fr')
    location.href = 'https://ahead-nutrition.fr'+gt_request_uri;
	
else {
if(typeof _gaq!='undefined'){_gaq.push(['_trackEvent', 'GTranslate', lang, 'ahead-nutrition.com'+location.pathname+location.search]);}else {if(typeof ga!='undefined')ga('send', 'event', 'GTranslate', lang, 'ahead-nutrition.com'+location.pathname+location.search);}var plang='ahead-nutrition.com'.split('.')[0];if(plang.length !=2 && plang.toLowerCase() != 'zh-cn' && plang.toLowerCase() != 'zh-tw' && plang != 'hmn' && plang != 'haw' && plang != 'ceb')plang='de';location.href=location.protocol+'//'+(lang == 'de' ? '' : lang+'.')+'ahead-nutrition.com'.replace('www.', '').replace(RegExp('^' + plang + '.'), '')+gt_request_uri;}
}
</script>

<script>
	$(document).mouseup(function(e) 
{
    var container = $(".switcher ");

    
    if (!container.is(e.target) && container.has(e.target).length === 0) 
    {
    	if($('.option:visible').length != 0)
		{
			$('.selected ').toggleClass('switch-open');
		}
       
    }
});
</script><link href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/headingMain.css" rel="stylesheet" type="text/css" media="all">
<noscript><link href="//www.ahead-nutrition.com/cdn/shop/t/312/assets/component-list-menu.css?v=151968516119678728991738669749" rel="stylesheet" type="text/css" media="all" /></noscript>
<noscript><link href="//www.ahead-nutrition.com/cdn/shop/t/312/assets/component-search.css?v=96455689198851321781738669749" rel="stylesheet" type="text/css" media="all" /></noscript>
<noscript><link href="//www.ahead-nutrition.com/cdn/shop/t/312/assets/component-menu-drawer.css?v=137940943501986718601738669749" rel="stylesheet" type="text/css" media="all" /></noscript>
<noscript><link href="//www.ahead-nutrition.com/cdn/shop/t/312/assets/component-cart-notification.css?v=119852831333870967341738669749" rel="stylesheet" type="text/css" media="all" /></noscript>
<noscript><link href="//www.ahead-nutrition.com/cdn/shop/t/312/assets/component-cart-items.css?v=154192789894076717891738669749" rel="stylesheet" type="text/css" media="all" /></noscript>

<style>
  header-drawer {
    justify-self: start;
    margin-left: -1.2rem;
  }

  .header__heading-logo {
    max-width: 130px;
  }

  .menu-drawer-container {
    display: flex;
  }

  .list-menu {
    list-style: none;
    padding: 0;
    margin: 0px 0px 200px 0px;
  }

  .list-menu--inline {
    display: inline-flex;
    flex-wrap: wrap;
  }

  summary.list-menu__item {
    padding-right: 2.7rem;
  }

  .list-menu__item {
    display: flex;
    align-items: center;
    line-height: calc(1 + 0.3 / var(--font-body-scale));
  }

  .list-menu__item--link {
    text-decoration: none;
    padding-bottom: 1rem;
    padding-top: 1rem;
    line-height: calc(1 + 0.8 / var(--font-body-scale));
  }
  .header-wrapper.gradient {
    background: #fff;
    border: unset;
  }
  summary.list-menu__item {
    padding-left: 0;
  }
  .header__menu-item {
    font-weight: 700;
    font-size: 16px;
    line-height: 22px;
    color: #1D1D1B;
    padding: 1.2rem 0;
    text-decoration: unset;
  }
  .header__inline-menu .list-menu li {
    margin-right: 60px;
  }
  .header--middle-left.header--middle-left {
    column-gap: 130px;
    max-height: 87px;
  }
@media screen and (min-width: 990px) {
    .openMobileSearch {
       display: none !important;
     }
    .list-menu__item--link {
      padding-bottom: 0.5rem;
      padding-top: 0.5rem;
    }
    .search-modal__form .search__input.field__input {
      background: #F1F1F1;
      border-radius: 50px;
      border-radius: 50px;
      padding: 15px 15px 15px 50px;
      max-width: 261px;
    }
    .field:before, .field:after {
      display: none;
    }
    .search__button {
      left: 1px;
      right: unset;
    }
    .header__search  {
      margin-right: 93px;
    }
    .megaMenu {
      display: none;
      position: absolute;
      background: #fff;
      top: 87px;
      left: 0;
      width: 100vw;
      z-index: 2;
    }
    .hasMegaMenu:hover .megaMenu {
      display: block;
    }
    .hasMegaMenu a.header__menu-item {
      position: relative;
    }
    .megaMenuPosition {
      display: none;
      position: absolute;
      background: #fff;
      bottom: 0;
      transform: translate(-40%, 100%);
      left: 0;
      width: 30vw;
      height: 50px;
    }
  .hasMegaMenu:hover .megaMenuPosition {
      display: block;
    }
   .header--middle-left.header--middle-left {
      column-gap: unset;
      padding-left: 20px;
      padding-right: 40px;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      max-width: 2900px;
      justify-content: center;
      margin: auto;
   }
  .header__icons {
    display: inline-flex;
    justify-content: flex-end;
    grid-column: 3;
  }
  }
    .header--middle-left.header--middle-left {
      column-gap: unset;
    }
    header-drawer {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-column: 1;
      justify-content: flex-start;
      grid-row: 1;
    }
    .openMobileSearch {
      display: grid;
      place-items: center;
    }
    .header__heading-logo {
      max-width: 120px;
    }
</style><style data-shopify="">.header {
    padding-top: 10px;
    padding-bottom: 10px;
  }

  .section-header {
    margin-bottom: 0px;
  }

  @media screen and (min-width: 750px) {
    .section-header {
      margin-bottom: 0px;
    }
  }

  @media screen and (min-width: 990px) {
    .header {
      padding-top: 20px;
      padding-bottom: 20px;
    }
  }
 @media screen and (max-width: 990px) {
   .header__icons .header__search {
     display: none;
   }
    .predictiveDesktop {
     display: none;
       }
   .header--middle-left.header--middle-left {
      padding-left: 20px;
      padding-right: 20px;
   }
  .navi-text-mission {
      display: none;     
   }
  .navi-text-belohnungen {
    display: none;
  }
}</style><script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/details-disclosure.js.download" defer="defer"></script>
<script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/details-modal.js.download" defer="defer"></script>
<script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/cart-notification.js.download" defer="defer"></script><svg xmlns="http://www.w3.org/2000/svg" class="hidden">
  <symbol id="icon-search" viewBox="0 0 18 19" fill="none">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M11.03 11.68A5.784 5.784 0 112.85 3.5a5.784 5.784 0 018.18 8.18zm.26 1.12a6.78 6.78 0 11.72-.7l5.4 5.4a.5.5 0 11-.71.7l-5.41-5.4z" fill="currentColor"></path>
  </symbol>

  <symbol id="icon-close" class="icon icon-close" fill="none" viewBox="0 0 18 17">
    <path d="M.865 15.978a.5.5 0 00.707.707l7.433-7.431 7.579 7.282a.501.501 0 00.846-.37.5.5 0 00-.153-.351L9.712 8.546l7.417-7.416a.5.5 0 10-.707-.708L8.991 7.853 1.413.573a.5.5 0 10-.693.72l7.563 7.268-7.418 7.417z" fill="currentColor">
  </path></symbol>
</svg>
<sticky-header class="header-wrapper color-background-1 gradient header-wrapper--border-bottom">
  <header class="header header--middle-left  header--has-menu"><header-drawer>
        <details id="Details-menu-drawer-container" class="menu-drawer-container">
          <summary id="drawer-open123" class="header__icon header__icon--menu header__icon--summary link focus-inset" aria-label="Menü" role="button" aria-expanded="false" aria-controls="menu-drawer">
            <span class="text-navi-produkte">Produkte</span>
            <span>          
              <svg class="icon icon-hamburger" xmlns="http://www.w3.org/2000/svg" width="17" height="14" viewBox="0 0 17 14" fill="none">
<line x1="1" y1="1" x2="16" y2="1" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round"></line>
<line x1="1" y1="6.88232" x2="16" y2="6.88232" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round"></line>
<line x1="1" y1="12.7646" x2="16" y2="12.7646" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round"></line>
</svg>
 
              <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" role="presentation" class="icon icon-close" fill="none" viewBox="0 0 18 17">
  <path d="M.865 15.978a.5.5 0 00.707.707l7.433-7.431 7.579 7.282a.501.501 0 00.846-.37.5.5 0 00-.153-.351L9.712 8.546l7.417-7.416a.5.5 0 10-.707-.708L8.991 7.853 1.413.573a.5.5 0 10-.693.72l7.563 7.268-7.418 7.417z" fill="currentColor">
</path></svg>

            </span>
          </summary>
          <div id="menu-drawer" class="gradient menu-drawer motion-reduce" tabindex="-1">
            <div class="menu-drawer__inner-container">
              <div class="topDrawer">
                <a href="https://www.ahead-nutrition.com/account/login" class="topDrawerLink">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M1 10C1 11.1819 1.23279 12.3522 1.68508 13.4442C2.13738 14.5361 2.80031 15.5282 3.63604 16.364C4.47177 17.1997 5.46392 17.8626 6.55585 18.3149C7.64778 18.7672 8.8181 19 10 19C11.1819 19 12.3522 18.7672 13.4442 18.3149C14.5361 17.8626 15.5282 17.1997 16.364 16.364C17.1997 15.5282 17.8626 14.5361 18.3149 13.4442C18.7672 12.3522 19 11.1819 19 10C19 8.8181 18.7672 7.64778 18.3149 6.55585C17.8626 5.46392 17.1997 4.47177 16.364 3.63604C15.5282 2.80031 14.5361 2.13738 13.4442 1.68508C12.3522 1.23279 11.1819 1 10 1C8.8181 1 7.64778 1.23279 6.55585 1.68508C5.46392 2.13738 4.47177 2.80031 3.63604 3.63604C2.80031 4.47177 2.13738 5.46392 1.68508 6.55585C1.23279 7.64778 1 8.8181 1 10V10Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M3.70703 16.4337C5.0434 15.6588 6.46494 15.0411 7.94329 14.593C8.59834 14.3511 8.66955 12.8485 8.19999 12.332C7.52225 11.5862 6.94781 10.712 6.94781 8.6021C6.90834 8.18175 6.95853 7.75781 7.09507 7.3583C7.23162 6.9588 7.45141 6.59282 7.73991 6.28457C8.02841 5.97632 8.37905 5.73281 8.76865 5.57015C9.15826 5.40749 9.57795 5.32937 9.99999 5.34097C10.422 5.32937 10.8417 5.40749 11.2313 5.57015C11.6209 5.73281 11.9716 5.97632 12.2601 6.28457C12.5486 6.59282 12.7684 6.9588 12.9049 7.3583C13.0414 7.75781 13.0916 8.18175 13.0522 8.6021C13.0522 10.7151 12.4777 11.5862 11.8 12.332C11.3304 12.8485 11.4016 14.3511 12.0567 14.593C13.535 15.0411 14.9566 15.6588 16.2929 16.4337" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                  <p>Einloggen</p>
                </a>

                <a href="https://ahead-help-center.gorgias.help/de-DE" class="topDrawerLink">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <path d="M9.99999 19C14.9705 19 19 14.9705 19 10C19 5.02943 14.9705 1 9.99999 1C5.02944 1 1 5.02943 1 10C1 14.9705 5.02944 19 9.99999 19Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  <path d="M7.54541 8.36722C7.54548 7.92474 7.66517 7.49048 7.89183 7.11041C8.11848 6.73035 8.44369 6.41863 8.83298 6.20825C9.22227 5.99786 9.66123 5.89663 10.1033 5.91526C10.5454 5.93389 10.9743 6.07171 11.3446 6.31411C11.7147 6.55651 12.0125 6.89449 12.2064 7.29228C12.4003 7.69006 12.483 8.13285 12.4458 8.57381C12.4087 9.01473 12.253 9.43748 11.9953 9.79716C11.7375 10.1569 11.3873 10.4402 10.9818 10.6172C10.6899 10.7446 10.4416 10.9543 10.2673 11.2207C10.0928 11.4871 9.99995 11.7986 9.99995 12.1169V12.454" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  <path d="M10.0029 14.4994C9.88989 14.4994 9.79834 14.4079 9.79834 14.2949C9.79834 14.1819 9.88989 14.0903 10.0029 14.0903" stroke="black" stroke-width="1.5"></path>
                  <path d="M10.0029 14.4994C10.1159 14.4994 10.2075 14.4079 10.2075 14.2949C10.2075 14.1819 10.1159 14.0903 10.0029 14.0903" stroke="black" stroke-width="1.5"></path>
                  </svg>
                  <p>Help Center</p>
                </a>

                <div class="switcher countrySwitcher notranslate">
                  <div class="selected">
                    <a href="https://www.ahead-nutrition.com/pages/bundle-builder-new?currentFlow=byob&amp;page=addProductsPage1#" onclick="return false;" class=""><img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/de.png" height="24" width="24" alt="de"> DE</a>
                  </div>
                  <div class="option" style="display: none;">
                    <a href="https://en.ahead-nutrition.com/" onclick="doGTranslate(&#39;de|en&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="English" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/en.png" height="24" width="24" alt="en" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/en.png"> EN</a><a href="https://ahead-nutrition.fr/" onclick="doGTranslate(&#39;de|fr&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Français" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/fr.png" height="24" width="24" alt="fr" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/fr.png"> FR</a><a href="https://ahead-nutrition.com/" onclick="doGTranslate(&#39;de|de&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Deutsch" class="nturl selected"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/de.png" height="24" width="24" alt="de" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/de.png"> DE</a><a href="https://ahead-nutrition.it/" onclick="doGTranslate(&#39;de|it&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Italiano" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/it.png" height="24" width="24" alt="it" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/it.png"> IT</a><a href="https://ahead-nutrition.es/" onclick="doGTranslate(&#39;de|es&#39;);jQuery(&#39;div.switcher div.selected a&#39;).html(jQuery(this).html());return false;" title="Español" class="nturl"><img data-gt-lazy-src="//gtranslate.io/shopify/assets/flags/24/es.png" height="24" width="24" alt="es" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/es.png"> ES</a></div>
                </div>
              </div>
              <div class="menu-drawer__navigation-container">
                <nav class="menu-drawer__navigation">
                  <ul class="menu-drawer__menu has-submenu list-menu" role="list">
                        
                        

                         
                        <!-- Adventskalender 
                        <a href="/collections/adventskalender" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Category-Adventskalender.png?v=1723540934" >
                          <p class="drawerTitle">Adventskalender</p>
                        </a>
                           -->
                        
                        <!-- Flavour Powder  
                        <a href="/collections/flavour-powder" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/FlavourPowder-500x500.png?v=1719320405" >
                          <p class="drawerTitle">Flavour Powder</p>
                          <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" >
                        </a>  --> 

                          
                         <!-- Probierpakete --> 
                        <a href="https://www.ahead-nutrition.com/collections/probierpakete" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Boxes500x500_1.png">
                          <p class="drawerTitle">Probierpakete</p>
                        </a>

                          
                        <!-- Sparpakete -->
                        <a href="https://www.ahead-nutrition.com/collections/sparpakete" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Sparbox500x500_1.png">
                          <p class="drawerTitle">Sparpakete</p>
                           <!-- <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" > -->
                        </a>


                        <!-- Riegel -->                        
                        <details id="Details-menu-drawer-submenu-example" class="menuDetails">
                          <summary class="drawerMegaLink" role="button" aria-expanded="false">
                            <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Riegel500x500_be20baaa-2adc-4cb2-accc-c877e7fdc401.png">
                            <p class="drawerTitle">Low Sugar Riegel</p>
                             <img class="drawerImage-neu" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Bildschirmfoto_2023-07-24_um_17.32.30.png" style="width: 60px; margin-right: 80px;">
                           
                            <div class="iconDrawer">
                              <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                              <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                            </div>
                          </summary>
                          <div>
                            <div>
                              <ul class="subMenuList">
                                          <li>
                                  <a href="https://www.ahead-nutrition.com/collections/riegel" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Alle Riegel 
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/schokoriegel" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Schokoriegel
                                    <img class="drawerImage-neu" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Bildschirmfoto_2023-07-24_um_17.32.30.png" style="width: 60px; margin-left: 40px;">
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/proteinriegel" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Proteinriegel
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/nut-bars" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Nussriegel
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/cream-filled-wafer-bars" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Cream-Filled Wafer Bars
                    
                                  </a>
        
                                </li>
                              </ul>
                            </div>
                          </div>
                        </details>
                          
                        <!-- Cremes -->  
                        <a href="https://www.ahead-nutrition.com/collections/aufstrich" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Spreads500x500_2d4a34fd-9672-415d-940f-3755b8a09e07.png">
                          <p class="drawerTitle">Low Sugar Nuss Cremes</p>
                          <!-- <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" > -->
                        </a>  
                        <!-- Just Like Sugar 
                        <a href="/products/just-like-sugar" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/CategoryTile_SugarReplacement.png?v=1730791709" >
                          <p class="drawerTitle">Just Like Sugar</p>
                          <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" >
                        </a>
                          -->
                      
                        <!-- Nut Butter Cups
                        <a href="/collections/nut-butter-cups" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/ChocolateCHups500x500.png?v=1730213909" >
                          <p class="drawerTitle">Nut Butter Cups</p>
                          <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" >
                        </a>  -->

                                                <!-- Fruchtaufstrich -->  
                        <a href="https://www.ahead-nutrition.com/collections/fruchtaufstriche" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Jams_CategoryTiles.png">
                          <p class="drawerTitle">Fruchtaufstrich</p>
                        </a>

                         <!-- Sirups -->  
                        <a href="https://www.ahead-nutrition.com/collections/zero-sirup" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Sirup_1.png">
                          <p class="drawerTitle">Zero Sugar Sirups</p>
                          
                        </a>
                          
                        <!-- Choco Chunks 
                        <a href="/collections/choco-chunks" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/ChocoChunks_1.png?v=1729526547" >
                          <p class="drawerTitle">Choco Chunks</p>
                          <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" >
                        </a> -->
                          
                        <!-- Fruchtgummies
                        <a href="/collections/fruchtgummies" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Fruchtgummies_1.png?v=1724158384" >
                          <p class="drawerTitle">Low Sugar Fruchtgummies</p>
                        </a> -->
                          
                        <!-- Flavour Powders
                        <a href="/collections/flavour-powder" class="drawerMegaLink">
                          <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/FlavourPowder-500x500.png?v=1719320405" >
                          <p class="drawerTitle">Protein Flips</p>
                        </a>  -->
                      

                        <!-- Low Sugar Snacks -->  
                        <details id="Details-menu-drawer-submenu-example" class="menuDetails">                         
                           <summary class="drawerMegaLink" role="button" aria-expanded="false">
                            <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Low-Sugar-Foods.png">
                            <p class="drawerTitle">Low Sugar Snacks</p>
          
                            <div class="iconDrawer">
                              <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                              <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                            </div>
                          </summary>
                          <div>
                            <div>
                              <ul class="subMenuList">
                                <li>
                                  <a href="https://www.ahead-nutrition.com/products/milky-hazelnut-crunchies" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Low Sugar Cereal
                                   <img class="drawerImage-neu" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Bildschirmfoto_2023-07-24_um_17.32.30.png" style="width: 60px; margin-left: 40px;">
                                  </a>
                                </li>
                        
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/fruchtgummies" "="" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Fruchtgummies
                                  </a>
                                </li>  
                                <li>
                                  <a href="https://www.ahead-nutrition.com/products/soft-cookie-double-chocolate" "="" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Soft baked Cookies
                                  </a>
                                </li>
                                <!-- Peanut Butter Cups -->
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/nut-butter-cups" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Nut Butter Cups
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/crispies" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Protein Flips
                                  </a>
                                </li>
                                <a href="https://www.ahead-nutrition.com/products/low-sugar-chocolate-sauce" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Low Sugar Sauce
                                   <img class="drawerImage-neu" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Bildschirmfoto_2023-07-24_um_17.32.30.png" style="width: 60px; margin-left: 40px;">
                                  </a>
                                
                                
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/choco-chunks" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Choco Chunks
                                  </a>
                                </li>
                                 <li>
                                  <a href="https://www.ahead-nutrition.com/products/just-like-sugar" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Just Like Sugar
                                  </a>
                                </li>
                                <!-- Flavour Powders -->
                                <li>
                                  <a href="https://www.ahead-nutrition.com/collections/flavour-powder" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Flavour Powder
                                  </a>
                                </li>
                                
                              </ul>
                            </div>
                          </div>
                        </details> 


                        <!-- Proteinpulver --> 
                        <details id="Details-menu-drawer-submenu-example" class="menuDetails">                         
                            <summary class="drawerMegaLink" role="button" aria-expanded="false">
                              <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Proteinpulver500x500.png">
                              <p class="drawerTitle">Proteinpulver</p>
                              <!-- <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-right: 80px;" > -->
                              <div class="iconDrawer">
                                <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                                <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                              </div>
                            </summary>
                            <div>
                              <div>
                                <ul class="subMenuList">
                                            <li>
                                    <a href="https://www.ahead-nutrition.com/collections/proteinpulver" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Alle Proteinpulver
                                    </a>
                                              
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/whey-protein" class="menu-drawer__menu-item link link--text list-menu__item focus-inset" style="display: grid; grid-template-columns: 1fr 140px;">
                                      Whey Protein
                                     <!-- <img class="drawerImage-neu" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Bildschirmfoto_2023-07-24_um_17.32.30.png?v=1690213076" style="width: 60px; margin-left: 40px;" > -->
                                    </a>
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/clear-whey-protein" "="" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      <div>Clear Whey Protein</div>      
                                    </a>
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/vegan-protein" "="" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Vegan Protein
                                    </a>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </details> 

                         <!-- Vegane Produkte -->  
                        <a href="https://www.ahead-nutrition.com/collections/vegan" class="drawerMegaLink">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Vegan_1.png">
                          <p class="drawerTitle">Vegan</p>
                        </a>
                          
                        <!-- Weitere -->  
                        <details id="Details-menu-drawer-submenu-example" class="menuDetails" style="border-bottom: 0.5px solid #1d1d1b;">                         
                            <summary class="drawerMegaLink" role="button" aria-expanded="false">
                              <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Weitere_1.png">
                              <p class="drawerTitle">Weitere</p>             
                              <div class="iconDrawer">
                                <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                                <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                              </div>
                            </summary>
                            <div>
                              <div>
                                <ul class="subMenuList">
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/ahead-meals" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Trinkmahlzeiten
                                    </a>
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/products/kakao-pulver-ohne-zucker-400" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Kakao-Pulver
                                    </a>
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/belly-lemonade" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Belly Lemonades
                                    </a>
                                  </li>
                                  <!-- 
                                  <li>
                                    <a href="/collections/supplements" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Supplements
                                    </a>
                                  </li> -->
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/collections/ahead-merch" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Merch
                                    </a>
                                  </li>
                                  <li>
                                    <a href="https://www.ahead-nutrition.com/products/geschenkkarte" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                      Geschenkgutscheine
                                    </a>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </details> 

                          <!-- OLD 
                          <a href="/collections/flavour-powder" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/FlavourPowder-500x500.png?v=1719320405" >
                            <p class="drawerTitle">Flavour-Powder</p>
                          </a>

                           <a href="/collections/crispies" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/SaltySnacks500x500_6a27ad2d-11f1-423b-a3ff-9c4aba28318c.png?v=1717066687" >
                            <p class="drawerTitle">Low Fat Protein Flips</p>
                          </a>                       
                            
                          <a href="/collections/ahead-meals" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/MealDrink500x500_de3e2fcb-f580-4602-89a2-f4976f4a2a36.png?v=1717066687" >
                            <p class="drawerTitle">Trinkmahlzeiten</p>
                          </a>
  
                          <a href="/collections/supplements" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Supplements500x500_1.png?v=1717511850" >
                            <p class="drawerTitle">Supplements</p>
                          </a>
                          <a href="/collections/ahead-merch" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Merch500x500_1.png?v=1717511850" >
                            <p class="drawerTitle">Merch</p>
                          </a>
                          <a href="/collections/all" style=" border-bottom: 0.5px solid #1d1d1b;" class="drawerMegaLink">
                            <img class="drawerImage" src="https://cdn.shopify.com/s/files/1/2136/3937/files/Webshop-Kategorie-500x500-AllProducts_1.png?v=1691142694" >
                            <p class="drawerTitle">Alle Produkte</p>
                          </a> -->

                         <!-- Submenu --> 
                         <details id="Details-menu-drawer-submenu-example" class="menuDetails info-menu">
                          <summary class="drawerMegaLink" style="margin-top: 40px; border-top: 0px !important;" role="button" aria-expanded="false">
                            <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Info.png">
                            <p class="drawerTitle">Info</p>
                            <div class="iconDrawer">
                              <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                              <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                            </div>
                          </summary>
                          <div>
                            <div>
                              <ul class="subMenuList">
                                <li>
                                  <a href="https://www.ahead-nutrition.com/pages/about-us" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Unsere Mission
                                  </a>
                                </li>
                                <li>
                                  <a href="https://ahead-nutrition.notion.site/WILL-YOU-GO-AHEAD-WITH-US-a916a2b3c72e4e87b5eb3ed2ff1d33ad" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Jobs
                                  </a>
                                </li>
                                <li>
                                  <a href="https://ahead-help-center.gorgias.help/de-DE" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Kontakt
                                  </a>
                                </li>
                                <li>
                                  <a href="https://www.ahead-nutrition.com/pages/store-locator" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                    Store Finder
                                  </a>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </details>
                          
                        <a href="https://www.ahead-nutrition.com/pages/insider-club-benefits" id="menu-sub-belohnungen" class="drawerMegaLink" style=" border-top: 0px solid #1d1d1b;">
                          <img class="drawerImage" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/Belohnung.png">
                          <p class="drawerTitle">Belohnungen</p>
                        </a>
                          
                       
                      

                        
                         
                      
                      <li><details id="Details-menu-drawer-menu-item-2" class="menuDetails" style="display: none;">
                            <summary class="menu-drawer__menu-item list-menu__item link link--text focus-inset" role="button" aria-expanded="false">
                              Info
                               <div class="iconDrawer">
                              <svg class="icon icon-plus" xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 12 11" fill="none">
  <path d="M6 10.36C5.70667 10.36 5.48 10.28 5.32 10.12C5.16 9.94667 5.08 9.71333 5.08 9.42V6.14H1.86C1.58 6.14 1.36 6.06667 1.2 5.92C1.04 5.76 0.96 5.54 0.96 5.26C0.96 4.98 1.04 4.76667 1.2 4.62C1.36 4.46 1.58 4.38 1.86 4.38H5.08V1.2C5.08 0.906666 5.16 0.679999 5.32 0.519999C5.48 0.359999 5.71333 0.28 6.02 0.28C6.31333 0.28 6.53333 0.359999 6.68 0.519999C6.84 0.679999 6.92 0.906666 6.92 1.2V4.38H10.14C10.4333 4.38 10.6533 4.46 10.8 4.62C10.96 4.76667 11.04 4.98 11.04 5.26C11.04 5.54 10.96 5.76 10.8 5.92C10.6533 6.06667 10.4333 6.14 10.14 6.14H6.92V9.42C6.92 9.71333 6.84 9.94667 6.68 10.12C6.53333 10.28 6.30667 10.36 6 10.36Z" fill="#FF7F27"></path>
</svg>

                              <svg class="icon icon-minus" xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 7 3" fill="none">
<path d="M1.22 2.64C0.926667 2.64 0.68 2.54667 0.48 2.36C0.293333 2.16 0.2 1.92 0.2 1.64C0.2 1.34667 0.293333 1.10667 0.48 0.92C0.68 0.733333 0.926667 0.64 1.22 0.64H5.48C5.76 0.64 5.99333 0.733333 6.18 0.92C6.38 1.10667 6.48 1.34667 6.48 1.64C6.48 1.92 6.38 2.16 6.18 2.36C5.99333 2.54667 5.76 2.64 5.48 2.64H1.22Z" fill="#C4C3C8"></path>
</svg>
                              </div>
                            </summary>
                            <div>
                              <div>
                                <ul class="subMenuList"><li><a href="https://www.ahead-nutrition.com/pages/about-us" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                          Über uns
                                        </a></li><li><a href="https://ahead-nutrition.notion.site/WILL-YOU-GO-AHEAD-WITH-US-a916a2b3c72e4e87b5eb3ed2ff1d33ad" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                          Jobs
                                        </a></li><li><a href="https://ahead-help-center.gorgias.help/de-DE" class="menu-drawer__menu-item link link--text list-menu__item focus-inset">
                                          Kontakt
                                        </a></li></ul>
                              </div>
                            </div>
                          </details></li>
                      

                        
                         
                      
                      <li><a href="https://www.ahead-nutrition.com/pages/insider-club-benefits" class="menu-drawer__menu-item list-menu__item link link--text focus-inset" style="display: none;">
                            Belohnungen
                          </a></li>
                      
</ul>
                </nav>
              </div>
            </div>
          </div>
        </details>
        <a class="openMobileSearch">
          <svg xmlns="http://www.w3.org/2000/svg" width="23" height="22" viewBox="0 0 23 22" fill="none">
          <path d="M2.95403 12.6065C3.73749 14.4139 5.22117 15.842 7.07869 16.5769C8.93621 17.3117 11.0154 17.293 12.8589 16.525C14.7024 15.7569 16.1591 14.3023 16.9086 12.4812C17.6582 10.6601 17.6391 8.62164 16.8557 6.81431C16.0722 5.00698 14.5885 3.57881 12.731 2.84396C10.8735 2.10911 8.7943 2.12779 6.95082 2.89588C5.10735 3.66398 3.65061 5.11857 2.90106 6.93967C2.15152 8.76077 2.17057 10.7992 2.95403 12.6065V12.6065Z" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M15.2441 14.9458L21.1016 20.6893" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          </svg>
        </a>
      </header-drawer><div class="navi-text-mission"><a style="text-decoration: none; color: black;" href="https://www.ahead-nutrition.com/pages/about-us">Unsere Mission</a></div>
      <div class="navi-text-belohnungen"><a style="text-decoration: none; color: black;" href="https://www.ahead-nutrition.com/pages/insider-club-benefits">Belohnungen</a></div>
      <style>
        .navi-text-mission {
          grid-column: 1;
          display: inline-flex;
          justify-content: center;
          grid-row:1;
          font-weight: 800;
          font-size: 1.6rem;
          color: black;
          margin-right: -40px;
        }
        .navi-text-belohnungen {
          grid-column: 1;
          display: inline-flex;
          justify-content: flex-end;
          grid-row: 1;
          font-weight: 800;
          font-size: 1.6rem;
          color: black;
          margin-right: -40px;
          margin-left: 80%;
          text-decoration: none;
        }
        .text-navi-produkte {
          margin-left: 40px !important;
          display: flex !important;
          position: absolute;
          margin-top: -21.5px;
          justify-content: center;
          font-weight: 800;
          font-size: 1.6rem;
          margin-right: -40px;

        }
@media screen and (max-width: 990px) {
   .header--middle-left.header--middle-left {
      padding-left: 20px;
      padding-right: 20px;
   }
  .navi-text-mission {
      display: none;     
   }
  .navi-text-belohnungen {
    display: none;
  }
  .text-navi-produkte {
    display: none !important;
  }
}
      </style><a href="https://www.ahead-nutrition.com/" class="header__heading-link link link--text focus-inset header__heading"><img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/ahead-logo-WEB-purple-rgb.png" alt="ahead® | The Better for You Company" srcset="//www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=50 50w, //www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=100 100w, //www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=150 150w, //www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=200 200w, //www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=250 250w, //www.ahead-nutrition.com/cdn/shop/files/ahead-logo-WEB-purple-rgb.png?v=1682517461&amp;width=300 300w" width="130" height="37.79552715654952" class="header__heading-logo">
</a><div class="header__icons">
      <details-modal class="header__search">
        <div open=""><form action="https://www.ahead-nutrition.com/search" method="get" role="search" class="search search-modal__form">
                  <div class="field">
                    <input class="search__input field__input" id="Search-In-Modal" type="search" name="q" value="" placeholder="Suchen">
                    <input type="hidden" name="options[prefix]" value="last">
                    <button class="search__button field__button" aria-label="Suchen">
                      <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23" fill="none">
                        <path d="M3.07958 13.4054C3.89634 15.3273 5.44309 16.8459 7.37956 17.6273C9.31602 18.4087 11.4836 18.3889 13.4054 17.5721C15.3272 16.7553 16.8459 15.2086 17.6273 13.2721C18.4087 11.3357 18.3888 9.16809 17.5721 7.24626C16.7553 5.32444 15.2086 3.80578 13.2721 3.02438C11.3356 2.24298 9.16808 2.26284 7.24625 3.0796C5.32443 3.89635 3.80577 5.4431 3.02437 7.37957C2.24297 9.31604 2.26283 11.4836 3.07958 13.4054V13.4054Z" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M15.8921 15.8926L21.9985 21.9999" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      </svg>
                    </button>
                  </div></form></div>
      </details-modal>

                                                                    <a href="https://ahead-help-center.gorgias.help/de-DE" class="header__icon header__icon--account link focus-inset">
                  <svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 20 20" fill="none">
                  <path d="M9.99999 19C14.9705 19 19 14.9705 19 10C19 5.02943 14.9705 1 9.99999 1C5.02944 1 1 5.02943 1 10C1 14.9705 5.02944 19 9.99999 19Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  <path d="M7.54541 8.36722C7.54548 7.92474 7.66517 7.49048 7.89183 7.11041C8.11848 6.73035 8.44369 6.41863 8.83298 6.20825C9.22227 5.99786 9.66123 5.89663 10.1033 5.91526C10.5454 5.93389 10.9743 6.07171 11.3446 6.31411C11.7147 6.55651 12.0125 6.89449 12.2064 7.29228C12.4003 7.69006 12.483 8.13285 12.4458 8.57381C12.4087 9.01473 12.253 9.43748 11.9953 9.79716C11.7375 10.1569 11.3873 10.4402 10.9818 10.6172C10.6899 10.7446 10.4416 10.9543 10.2673 11.2207C10.0928 11.4871 9.99995 11.7986 9.99995 12.1169V12.454" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  <path d="M10.0029 14.4994C9.88989 14.4994 9.79834 14.4079 9.79834 14.2949C9.79834 14.1819 9.88989 14.0903 10.0029 14.0903" stroke="black" stroke-width="1.5"></path>
                  <path d="M10.0029 14.4994C10.1159 14.4994 10.2075 14.4079 10.2075 14.2949C10.2075 14.1819 10.1159 14.0903 10.0029 14.0903" stroke="black" stroke-width="1.5"></path>
                  </svg>
                </a><a href="https://www.ahead-nutrition.com/account/login" class="header__icon header__icon--account link focus-inset small-hide">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28" fill="none">
<path d="M1 14C1 15.7072 1.33625 17.3977 1.98957 18.9749C2.64288 20.5521 3.60045 21.9852 4.80761 23.1924C6.01477 24.3995 7.44788 25.3571 9.02512 26.0104C10.6023 26.6637 12.2928 27 14 27C15.7072 27 17.3977 26.6637 18.9749 26.0104C20.5521 25.3571 21.9852 24.3995 23.1924 23.1924C24.3995 21.9852 25.3571 20.5521 26.0104 18.9749C26.6637 17.3977 27 15.7072 27 14C27 12.2928 26.6637 10.6023 26.0104 9.02512C25.3571 7.44788 24.3995 6.01477 23.1924 4.80761C21.9852 3.60045 20.5521 2.64288 18.9749 1.98957C17.3977 1.33625 15.7072 1 14 1C12.2928 1 10.6023 1.33625 9.02512 1.98957C7.44788 2.64288 6.01477 3.60045 4.80761 4.80761C3.60045 6.01477 2.64288 7.44788 1.98957 9.02512C1.33625 10.6023 1 12.2928 1 14V14Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
<path d="M4.91016 23.2935C6.84047 22.1742 8.8938 21.282 11.0292 20.6347C11.9754 20.2854 12.0782 18.1149 11.4 17.3688C10.421 16.2915 9.59129 15.0288 9.59129 11.9812C9.53426 11.374 9.60676 10.7617 9.804 10.1846C10.0012 9.60753 10.3187 9.0789 10.7354 8.63365C11.1521 8.1884 11.6586 7.83667 12.2214 7.60171C12.7841 7.36675 13.3904 7.25392 14 7.27067C14.6096 7.25392 15.2158 7.36675 15.7786 7.60171C16.3413 7.83667 16.8478 8.1884 17.2645 8.63365C17.6813 9.0789 17.9987 9.60753 18.196 10.1846C18.3932 10.7617 18.4657 11.374 18.4087 11.9812C18.4087 15.0334 17.5789 16.2915 16.6 17.3688C15.9217 18.1149 16.0246 20.2854 16.9708 20.6347C19.1062 21.282 21.1595 22.1742 23.0898 23.2935" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg>
          <span class="visually-hidden">Einloggen</span>
        </a><a href="https://www.ahead-nutrition.com/cart" data-ajax-cart-toggle-class-button="js-my-cart-open" class="header__icon header__icon--cart link focus-inset" id="cart-icon-bubble"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="24" viewBox="0 0 28 24" fill="none">
<path d="M22.5819 22.3433H5.41806C5.0162 22.336 4.62859 22.1932 4.31801 21.9381C4.00743 21.683 3.79209 21.3305 3.70687 20.9377L1.06151 9.80194C0.990686 9.53524 0.980883 9.25601 1.03283 8.98501C1.08478 8.714 1.19714 8.45819 1.36156 8.23658C1.52598 8.01498 1.73823 7.83328 1.98254 7.705C2.22685 7.57671 2.49693 7.50514 2.7727 7.49561H25.2273C25.5031 7.50514 25.7732 7.57671 26.0175 7.705C26.2618 7.83328 26.474 8.01498 26.6384 8.23658C26.8029 8.45819 26.9152 8.714 26.9672 8.98501C27.0191 9.25601 27.0093 9.53524 26.9385 9.80194L24.2931 20.9377C24.2079 21.3305 23.9926 21.683 23.682 21.9381C23.3714 22.1932 22.9838 22.336 22.5819 22.3433V22.3433Z" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
<path d="M4.7207 7.49585L10.2886 1" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
<path d="M23.2798 7.49585L17.7119 1" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
</svg><span class="visually-hidden">Warenkorb</span>
          <div class="cart-count-bubble"><span data-ajax-cart-bind-state="cart.item_count" aria-hidden="true">3</span><span class="visually-hidden">3 Artikel</span>
          </div>
      </a>
    </div>
  </header>
</sticky-header>

<cart-notification style="display: none!important;">
  <div class="cart-notification-wrapper page-width">
    <div id="cart-notification" class="cart-notification focus-inset color-background-1 gradient" aria-modal="true" aria-label="Artikel wurde in den Warenkorb gelegt" role="dialog" tabindex="-1">
      <div class="cart-notification__header">
        <h2 class="cart-notification__heading caption-large text-body"><svg class="icon icon-checkmark color-foreground-text" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 9" fill="none">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.35.643a.5.5 0 01.006.707l-6.77 6.886a.5.5 0 01-.719-.006L.638 4.845a.5.5 0 11.724-.69l2.872 3.011 6.41-6.517a.5.5 0 01.707-.006h-.001z" fill="currentColor"></path>
</svg>
Artikel wurde in den Warenkorb gelegt</h2>
        <button type="button" class="cart-notification__close modal__close-button link link--text focus-inset" aria-label="Schließen">
          <svg class="icon icon-close" aria-hidden="true" focusable="false"><use href="#icon-close"></use></svg>
        </button>
      </div>
      <div id="cart-notification-product" class="cart-notification-product"></div>
      <div class="cart-notification__links">
        <a href="https://www.ahead-nutrition.com/cart" id="cart-notification-button" class="button button--secondary button--full-width"></a>
        <form action="https://www.ahead-nutrition.com/cart" method="post" id="cart-notification-form">
          <button class="button button--primary button--full-width" name="checkout">Auschecken</button>
        <input id="_customerReferenceId" hidden="" type="hidden" name="properties[_customerReferenceId]" value="752416b7-a77e-59ef-a9c0-6faa85a5dde6"></form>
        <button type="button" class="link button-label">Weiter shoppen</button>
      </div>
    </div>
  </div>
</cart-notification>
<style data-shopify="">
  .cart-notification {
     display: none;
  }
</style>


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "name": "ahead® | The Better for You Company",
    
      "logo": "https:\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/ahead-logo-WEB-purple-rgb.png?v=1682517461\u0026width=313",
    
    "sameAs": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "url": "https:\/\/www.ahead-nutrition.com\/pages\/bundle-builder-new"
  }
</script>
</div>

    <style>
  @media screen and (min-width: 750px) {
    .searchRecHolder {
      display: none!important;
    }
  }
  .searchRecHolder {
    position: fixed;
    top: 40px;
    left: 0; 
    width: 100vw;
    height: 100%;
    z-index: 5;
    background-color: #fff;
    display: none;
  }
  .searchRecHolder .predictive-search--header {
    top: unset;
    border: unset;
    background: #fff;
  }
  .predictiveMobile {
    width: calc(100% - 30px);
    margin: 0 15px;
  }
  .searchRecHolder .header__search {
    width: 100%;
    margin-top: 70px;
  }
  .searchRecHolder .search__input.field__input {
    background: #F1F1F1;
    border-radius: 50px;
    padding: 15px 55px;
  }
  .searchRecHolder .field:after {
    display: none;
  }
  .searchRecHolder .search__button {
    right: unset;
    left: 8px;
  }
  .predictiveHeader {
    display: none;
    justify-content: space-between;
    align-items: center;
    width: calc(100% - 30px);
    margin: 0 auto;
    border-bottom: 1px solid #F3F3F3;
  }
  .predictive-search__heading {
    width: 50%;   
    font-weight: 400;
    font-size: 14px;
    line-height: 9px;
    color: #1D1D1B;
    border-bottom: 0;
    padding: 0;
  }
  .predictive-search__list-item {
    width: 50%;
    list-style-type: none;
  }
  .predictive-search__item--term {
    white-space: nowrap;
    padding-right: 0;
    text-align: right;
    justify-content: flex-end;
    font-weight: 400;
    font-size: 14px;
    line-height: 9px;
    color: #1D1D1B;
  }
  .predictive-search__results-list.list-unstyled .predictive-search__list-item {
    width: 100%;
    border: 0!important;
  }
  .predictive-search__item--link.predictive-search__item--link {
    padding: 10px 15px;
    grid-template-columns: 60px 1fr;
    gap: 10px;
  } 
  .predictive-search__image.predictive-search__image {
    width: 100%;
    height: auto;
    border-radius: 3px;
  }
  .predictive-search__item-content--centered.predictive-search__item-content--centered {
    justify-content: flex-start;
  }
  .predictive-search__item-heading.predictive-search__item-heading.predictive-search__item-heading {
    font-weight: 700;
    font-size: 16px;
    line-height: 18px;
    text-transform: capitalize;
    color: #1D1D1B;
    margin-bottom: 2px;
  }
  .predictiveTag.predictiveTag.predictiveTag {
    background: #F1F1F1;
    border-radius: 3px;
    font-weight: 600;
    font-size: 11px;
    line-height: 15px;
    padding: 2px 6px;
    color: #7D7D78;
    margin-bottom: 4px;
    margin-top: 0;
    display: inline-block;
  }
  .predictive-search__results-list .price {
    margin-top: 0;
  }
  .predictive-search__results-list .price .price__regular .price-item.price-item--regular, .predictive-search__results-list .price .price__sale .price-item.price-item--sale {
    font-weight: 700;
    font-size: 12px;
    line-height: 16px;
    text-transform: uppercase;
    color: #29282C;
    letter-spacing: 0;
  }
  .predictive-search__results-list .price .price__sale .price-item.price-item--regular {
    font-weight: 700;
    font-size: 12px;
    line-height: 16px;
    text-decoration-line: line-through;
    text-transform: uppercase;
    color: #C4C3C8;
  }
  .closeSearchMobile {
    position: absolute;
    right: 8px;
    left: unset;
    border: 0;
    background: unset;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
  }
  @media screen and (min-width: 750px) {
  .predictive-search.predictive-search {
    width: calc(110% + .2rem);
    background: white;
    border-radius: 3px;
  }
  }
</style>
<div class="searchRecHolder">
        <details-modal class="header__search">
        <div open="" class="predictiveMobile">
                <predictive-search class="search-modal__form" data-loading-text="Wird geladen ...">
                <form action="https://www.ahead-nutrition.com/search" method="get" role="search" class="search search-modal__form">
                  <div class="field">
                    <input class="search__input field__input" id="Search-In-Modal" type="search" name="q" value="" placeholder="Suchen" role="combobox" aria-expanded="false" aria-owns="predictive-search-results-list" aria-controls="predictive-search-results-list" aria-haspopup="listbox" aria-autocomplete="list" autocorrect="off" autocomplete="off" autocapitalize="off" spellcheck="false">
                    <input type="hidden" name="options[prefix]" value="last">
                    <button class="search__button field__button" aria-label="Suchen">
                      <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23" fill="none">
                        <path d="M3.07958 13.4054C3.89634 15.3273 5.44309 16.8459 7.37956 17.6273C9.31602 18.4087 11.4836 18.3889 13.4054 17.5721C15.3272 16.7553 16.8459 15.2086 17.6273 13.2721C18.4087 11.3357 18.3888 9.16809 17.5721 7.24626C16.7553 5.32444 15.2086 3.80578 13.2721 3.02438C11.3356 2.24298 9.16808 2.26284 7.24625 3.0796C5.32443 3.89635 3.80577 5.4431 3.02437 7.37957C2.24297 9.31604 2.26283 11.4836 3.07958 13.4054V13.4054Z" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <path d="M15.8921 15.8926L21.9985 21.9999" stroke="#1D1D1B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      </svg>
                    </button>
                    <div class="closeSearchMobile" id="closeSearchMobile">
                      <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" fill="none">
                      <circle cx="15" cy="15" r="15" fill="#CB33FB"></circle>
                      <path d="M10 10L20 20" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M20 10L10 20" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      </svg>
                    </div>
                  </div>

                    <div class="predictive-search predictive-search--header" tabindex="-1" data-predictive-search="">
                      <div class="predictive-search__loading-state">
                        <svg aria-hidden="true" focusable="false" role="presentation" class="spinner" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
                          <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                        </svg>
                      </div>
                    </div>

                    <span class="predictive-search-status visually-hidden" role="status" aria-hidden="true"></span>
                </form>
                </predictive-search>
        </div>
      </details-modal>
</div>
    <script>
      $(document).ready(function(){
        $(".openMobileSearch").click(function(){
          $("html, body").animate({scrollTop: 0}, 0);
          $(".searchRecHolder").slideToggle();
        });
        $("#closeSearchMobile").click(function(){
          $(".searchRecHolder").slideUp();
        });
      });
    </script>

    <main id="MainContent" class="content-for-layout focus-none" role="main" tabindex="-1">
      
      
        <div id="shopify-section-template--24219466662152__title_text_image_2_NphRRe" class="shopify-section"><link href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/title-text-image.css" rel="stylesheet" type="text/css" media="all">
<style>
  #shopify-section-template--24219466662152__title_text_image_2_NphRRe {
    margin-top: 50px;
    margin-bottom: 40px;
  }
</style>
<div class="title-text-image-component">
  <title-text-image>
    <div class="titleTextImage">
      <div class="page-width page-width-desktop">
        
        <style>
          @media screen and (min-width: 750px) {
            .heading-template--24219466662152__title_text_image_2_NphRRe {
              font-size: 38px;
              line-height: 52px;
              font-weight: 900;
              margin-top: 31px;
              margin-bottom: 10px;
              color: #cb33fb;
            }
          }
          @media screen and (max-width: 749px) {
             .heading-template--24219466662152__title_text_image_2_NphRRe {
              font-size: 28px;
              line-height: 34px;
              font-weight: 900;
              margin-top: 20px;
              margin-bottom: 10px;
              color: #cb33fb;
            }
          }
        </style>
          <h2 class="headingClass heading-template--24219466662152__title_text_image_2_NphRRe">Bau dein eigenes Snack-Bundle!</h2>
        
        
        
        <style>
          @media screen and (min-width: 750px) {
            .text-template--24219466662152__title_text_image_2_NphRRe {
              font-size: 22px;
              line-height: 28px;
              font-weight: 900;
              margin-top: 10px;
              margin-bottom: 0px;
              color: #cb33fb;
            }
          }
          @media screen and (max-width: 749px) {
             .text-template--24219466662152__title_text_image_2_NphRRe {
              font-size: 14px;
              line-height: 18px;
              font-weight: 900;
              margin-top: 7px;
              margin-bottom: 0px;
              color: #cb33fb;
            }
          }
        </style>
          <p class="textClass text-template--24219466662152__title_text_image_2_NphRRe">Weil niemand besser weiß, was du magst. Wähle deine Favoriten und spare bis zu 15%:</p>
        
      </div>
      
      
    </div>
  </title-text-image>
</div>
</div><section id="shopify-section-template--24219466662152__custom_liquid_4wVU6M" class="shopify-section section"><style data-shopify="">.section-template--24219466662152__custom_liquid_4wVU6M-padding {
  padding-top: calc(0px * 0.75);
  padding-bottom: calc(52px  * 0.75);
}

@media screen and (min-width: 750px) {
  .section-template--24219466662152__custom_liquid_4wVU6M-padding {
    padding-top: 0px;
    padding-bottom: 52px;
  }
}</style><div class="color-background-1 gradient">
  <div class="section-template--24219466662152__custom_liquid_4wVU6M-padding">
    <div id="myContent" class="page-width-desktop">
    
    <div class="gbbPageBody bundle-1" id="gbbBundle" style="font-family: Nunito, sans-serif; background-color: rgb(241, 233, 222);"><div class="gbbHTMLWrapper"><div class="gbbBodyWrapper"><div class="gbbAddGiftBoxPageWrapper" style=""><div class="gbbAddProductsPageHeader"><div class="gbbPageHeader gbbPageHeaderWithoutLine"></div><div class="gbbAddProductsPageNavigationContainer"></div></div><div class="gbbAddProductPageSubtextWrapper"><div class="gbbAddProductPageSubtext" style="color: rgb(29, 29, 29);"></div><div class="gbbAddProductPageBanners"></div></div><div class="gbbDiscountComponent"></div><div class="gbbMultipleCategoriesContainerHTMLForTabUI"><div class="gbbMultipleCategoriesPageHTMLForTabUI"><div class="gbbFiltersSearchSortHeader"></div><div class="gbbMultipleCategoriesRibbonContainer"><div class="gbbCategoryContainer gbbCategoryContainerTabUI gbbCategoryContainerTabUIActive" categoryid="category47127"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="0" categoryid="category47127"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Schokoriegel</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div><div class="gbbCategoryContainer gbbCategoryContainerTabUI" categoryid="category56417"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="1" categoryid="category56417"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Proteinriegel</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div><div class="gbbCategoryContainer gbbCategoryContainerTabUI" categoryid="category90196"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="2" categoryid="category90196"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Nussriegel</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div><div class="gbbCategoryContainer gbbCategoryContainerTabUI" categoryid="category74800"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="3" categoryid="category74800"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Wafer Bars</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div><div class="gbbCategoryContainer gbbCategoryContainerTabUI" categoryid="category01076"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="4" categoryid="category01076"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Cremes</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div><div class="gbbCategoryContainer gbbCategoryContainerTabUI" categoryid="category74442"><div class="gbbCategoryHeaderContainer gbbCategoryHeaderContainerTabUI" currentindex="5" categoryid="category74442"><div class="gbbCategoryTitlesContainer gbbCategoryTitlesContainerForTabUI"><div class="gbbCategoryTitle">Low Sugar Snacks</div></div><img class="gbbCategoryImageForTabUI" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/multiple_category_category.png"></div></div></div><div class="gbbMultipleCategoriesDropdownContainer"><select class="gbbMutipleCategoriesDropdown"><option value="category47127" categoryid="category47127" currentindex="0">Schokoriegel</option><option value="category56417" categoryid="category56417" currentindex="1">Proteinriegel</option><option value="category90196" categoryid="category90196" currentindex="2">Nussriegel</option><option value="category74800" categoryid="category74800" currentindex="3">Wafer Bars</option><option value="category01076" categoryid="category01076" currentindex="4">Cremes</option><option value="category74442" categoryid="category74442" currentindex="5">Low Sugar Snacks</option></select><div class="gbbMultipleCategoriesDropdownArrow"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 128 128" fill="none">
<path fill-rule="evenodd" clip-rule="evenodd" d="M35.006 49.4059C36.8805 47.5314 39.9197 47.5314 41.7942 49.4059L64.0001 71.6118L86.206 49.4059C88.0805 47.5314 91.1197 47.5314 92.9942 49.4059C94.8687 51.2804 94.8687 54.3196 92.9942 56.1941L67.3942 81.7941C65.5197 83.6686 62.4805 83.6686 60.606 81.7941L35.006 56.1941C33.1315 54.3196 33.1315 51.2804 35.006 49.4059Z" fill="#4A4A4A"></path>
</svg></div></div><div class="gbbMultipleCategoriesActiveCategorySubtitle"></div><div class="gbbMultipleCategoryBodyContainer"><div class="gbbMultipleCategoryBody"><div class="gbbMultiCategoryProductsContainer"><div class="gbbAddProductsContainerHTML"><div class="gbbProductsContainer"><div class="gbbProductsItemsContainer gbbProductsItemsContainerLessProducts" total-products="2"><div class="gbbProductItem" productid="7964092072200" firstvariantid="43530481139976" style="background: rgb(255, 255, 255); color: rgb(29, 29, 29);"><div class="gbbProductImageContainer"><img class="gbbProductImageContainerImg0 gbbProductImageContainerImg gbbFade" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09QT242YD.02.jpg" style="display: block;"><a class="gbbPrevImage" style="display: none;">❮</a><a class="gbbNextImage" style="display: none;">❯</a><div class="gbbProductItemOverLay"><div class="gbbOverLayIconContainer"></div></div></div><div class="gbbProductTextContainer"><div class="gbbProductItemTitle" style="cursor: pointer;"><div class="gbbProductTitleOnly">Hazelnut-Cacao</div><div class="gbbVariantTitle"></div></div></div><div class="gbbProductActionContainer"><div class="gbbProductItemPricesContainer"><div class="gbbProductItemCompareAtPrice"></div><div class="gbbProductItemPrice">₹2700.00</div></div><div class="gbbProductButtonWrapper"><div class="gbbProductAddButton" style="background: rgb(203, 51, 251); color: rgb(255, 255, 255);">Hinzufügen</div></div></div></div><div class="gbbProductItem" productid="6610491048023" firstvariantid="39418248364119" data-load-more-indicator-status="active" style="background: rgb(255, 255, 255); color: rgb(29, 29, 29);"><div class="gbbProductImageContainer"><img class="gbbProductImageContainerImg0 gbbProductImageContainerImg gbbFade" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/B09GRCR2DL.03.jpg" style="display: block;"><a class="gbbPrevImage" style="display: none;">❮</a><a class="gbbNextImage" style="display: none;">❯</a><div class="gbbProductItemOverLay"><div class="gbbOverLayIconContainer"></div></div></div><div class="gbbProductTextContainer"><div class="gbbProductItemTitle" style="cursor: pointer;"><div class="gbbProductTitleOnly">Coconut-Almond</div><div class="gbbVariantTitle"></div></div></div><div class="gbbProductActionContainer"><div class="gbbProductItemPricesContainer"><div class="gbbProductItemCompareAtPrice"></div><div class="gbbProductItemPrice">₹2700.00</div></div><div class="gbbProductButtonWrapper"><div class="gbbProductAddButton" style="background: rgb(203, 51, 251); color: rgb(255, 255, 255);">Hinzufügen</div></div></div></div></div></div></div></div></div></div></div></div><div class="gbbAddProductsPageFooterHTML" style="background: rgb(241, 242, 243); color: rgb(29, 29, 29);"><div class="gbbPageFooterHTML"><div class="gbbDiscountFooterHTML"><div class="gbbDiscountMessageContainer"><div class="gbbDiscountMessage" style="color: rgb(29, 29, 29);">Füge 3 Artikel hinzu und spare <span style="color:red;" <strong="">5%!</span></div></div></div><div class="gbbProductsFooterHTML" style="background: rgb(241, 242, 243); color: rgb(29, 29, 29); grid-template-columns: 1fr;"><div><div class="gbbFooterButtonsWrapper" style="grid-template-columns: auto 1fr auto;"><div class="gbbFooterNextButton" style="background: rgb(29, 29, 29); color: rgb(255, 255, 255); grid-column: 3 / 3;">Zum Warenkorb hinzufügen</div></div></div></div></div></div></div></div></div></div>
    
    
    <style>.flatpickr-calendar {
  background: transparent;
  opacity: 0;
  display: none;
  text-align: center;
  visibility: hidden;
  padding: 0;
  -webkit-animation: none;
  animation: none;
  direction: ltr;
  border: 0;
  font-size: 14px;
  line-height: 24px;
  border-radius: 5px;
  position: absolute;
  width: 307.875px;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  -ms-touch-action: manipulation;
  touch-action: manipulation;
  background: #fff;
  -webkit-box-shadow: 1px 0 0 #e6e6e6, -1px 0 0 #e6e6e6, 0 1px 0 #e6e6e6,
    0 -1px 0 #e6e6e6, 0 3px 13px rgba(0, 0, 0, 0.08);
  box-shadow: 1px 0 0 #e6e6e6, -1px 0 0 #e6e6e6, 0 1px 0 #e6e6e6,
    0 -1px 0 #e6e6e6, 0 3px 13px rgba(0, 0, 0, 0.08);
}
.flatpickr-calendar.open,
.flatpickr-calendar.inline {
  opacity: 1;
  max-height: 640px;
  visibility: visible;
}
.flatpickr-calendar.open {
  display: inline-block;
  z-index: 99999;
}
.flatpickr-calendar.animate.open {
  -webkit-animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);
  animation: fpFadeInDown 300ms cubic-bezier(0.23, 1, 0.32, 1);
}
.flatpickr-calendar.inline {
  display: block;
  position: relative;
  top: 2px;
}
.flatpickr-calendar.static {
  position: absolute;
  top: calc(100% + 2px);
}
.flatpickr-calendar.static.open {
  z-index: 999;
  display: block;
}
.flatpickr-calendar.multiMonth
  .flatpickr-days
  .dayContainer:nth-child(n + 1)
  .flatpickr-day.inRange:nth-child(7n + 7) {
  -webkit-box-shadow: none !important;
  box-shadow: none !important;
}
.flatpickr-calendar.multiMonth
  .flatpickr-days
  .dayContainer:nth-child(n + 2)
  .flatpickr-day.inRange:nth-child(7n + 1) {
  -webkit-box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;
  box-shadow: -2px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;
}
.flatpickr-calendar .hasWeeks .dayContainer,
.flatpickr-calendar .hasTime .dayContainer {
  border-bottom: 0;
  border-bottom-right-radius: 0;
  border-bottom-left-radius: 0;
}
.flatpickr-calendar .hasWeeks .dayContainer {
  border-left: 0;
}
.flatpickr-calendar.hasTime .flatpickr-time {
  height: 40px;
  border-top: 1px solid #e6e6e6;
}
.flatpickr-calendar.noCalendar.hasTime .flatpickr-time {
  height: auto;
}
.flatpickr-calendar:before,
.flatpickr-calendar:after {
  position: absolute;
  display: block;
  pointer-events: none;
  border: solid transparent;
  content: "";
  height: 0;
  width: 0;
  left: 22px;
}
.flatpickr-calendar.rightMost:before,
.flatpickr-calendar.arrowRight:before,
.flatpickr-calendar.rightMost:after,
.flatpickr-calendar.arrowRight:after {
  left: auto;
  right: 22px;
}
.flatpickr-calendar.arrowCenter:before,
.flatpickr-calendar.arrowCenter:after {
  left: 50%;
  right: 50%;
}
.flatpickr-calendar:before {
  border-width: 5px;
  margin: 0 -5px;
}
.flatpickr-calendar:after {
  border-width: 4px;
  margin: 0 -4px;
}
.flatpickr-calendar.arrowTop:before,
.flatpickr-calendar.arrowTop:after {
  bottom: 100%;
}
.flatpickr-calendar.arrowTop:before {
  border-bottom-color: #e6e6e6;
}
.flatpickr-calendar.arrowTop:after {
  border-bottom-color: #fff;
}
.flatpickr-calendar.arrowBottom:before,
.flatpickr-calendar.arrowBottom:after {
  top: 100%;
}
.flatpickr-calendar.arrowBottom:before {
  border-top-color: #e6e6e6;
}
.flatpickr-calendar.arrowBottom:after {
  border-top-color: #fff;
}
.flatpickr-calendar:focus {
  outline: 0;
}
.flatpickr-wrapper {
  position: relative;
  display: inline-block;
}
.flatpickr-months {
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
}
.flatpickr-months .flatpickr-month {
  background: transparent;
  color: rgba(0, 0, 0, 0.9);
  fill: rgba(0, 0, 0, 0.9);
  height: 34px;
  line-height: 1;
  text-align: center;
  position: relative;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  overflow: hidden;
  -webkit-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  flex: 1;
}
.flatpickr-months .flatpickr-prev-month,
.flatpickr-months .flatpickr-next-month {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  text-decoration: none;
  cursor: pointer;
  position: absolute;
  top: 0;
  height: 34px;
  padding: 10px;
  z-index: 3;
  color: rgba(0, 0, 0, 0.9);
  fill: rgba(0, 0, 0, 0.9);
}
.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,
.flatpickr-months .flatpickr-next-month.flatpickr-disabled {
  display: none;
}
.flatpickr-months .flatpickr-prev-month i,
.flatpickr-months .flatpickr-next-month i {
  position: relative;
}
.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,
.flatpickr-months .flatpickr-next-month.flatpickr-prev-month {
  /*
      /*rtl:begin:ignore*/
  left: 0; /*
      /*rtl:end:ignore*/
} /*
      /*rtl:begin:ignore*/
/*
      /*rtl:end:ignore*/
.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,
.flatpickr-months .flatpickr-next-month.flatpickr-next-month {
  /*
      /*rtl:begin:ignore*/
  right: 0; /*
      /*rtl:end:ignore*/
} /*
      /*rtl:begin:ignore*/
/*
      /*rtl:end:ignore*/
.flatpickr-months .flatpickr-prev-month:hover,
.flatpickr-months .flatpickr-next-month:hover {
  color: #959ea9;
}
.flatpickr-months .flatpickr-prev-month:hover svg,
.flatpickr-months .flatpickr-next-month:hover svg {
  fill: #f64747;
}
.flatpickr-months .flatpickr-prev-month svg,
.flatpickr-months .flatpickr-next-month svg {
  width: 14px;
  height: 14px;
}
.flatpickr-months .flatpickr-prev-month svg path,
.flatpickr-months .flatpickr-next-month svg path {
  -webkit-transition: fill 0.1s;
  transition: fill 0.1s;
  fill: inherit;
}
.numInputWrapper {
  position: relative;
  height: auto;
}
.numInputWrapper input,
.numInputWrapper span {
  display: inline-block;
}
.numInputWrapper input {
  width: 100%;
}
.numInputWrapper input::-ms-clear {
  display: none;
}
.numInputWrapper input::-webkit-outer-spin-button,
.numInputWrapper input::-webkit-inner-spin-button {
  margin: 0;
  -webkit-appearance: none;
}
.numInputWrapper span {
  position: absolute;
  right: 0;
  width: 14px;
  padding: 0 4px 0 2px;
  height: 50%;
  line-height: 50%;
  opacity: 0;
  cursor: pointer;
  border: 1px solid rgba(57, 57, 57, 0.15);
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.numInputWrapper span:hover {
  background: rgba(0, 0, 0, 0.1);
}
.numInputWrapper span:active {
  background: rgba(0, 0, 0, 0.2);
}
.numInputWrapper span:after {
  display: block;
  content: "";
  position: absolute;
}
.numInputWrapper span.arrowUp {
  top: 0;
  border-bottom: 0;
}
.numInputWrapper span.arrowUp:after {
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-bottom: 4px solid rgba(57, 57, 57, 0.6);
  top: 26%;
}
.numInputWrapper span.arrowDown {
  top: 50%;
}
.numInputWrapper span.arrowDown:after {
  border-left: 4px solid transparent;
  border-right: 4px solid transparent;
  border-top: 4px solid rgba(57, 57, 57, 0.6);
  top: 40%;
}
.numInputWrapper span svg {
  width: inherit;
  height: auto;
}
.numInputWrapper span svg path {
  fill: rgba(0, 0, 0, 0.5);
}
.numInputWrapper:hover {
  background: rgba(0, 0, 0, 0.05);
}
.numInputWrapper:hover span {
  opacity: 1;
}
.flatpickr-current-month {
  font-size: 135%;
  line-height: inherit;
  font-weight: 300;
  color: inherit;
  position: absolute;
  width: 75%;
  left: 12.5%;
  padding: 7.48px 0 0 0;
  line-height: 1;
  height: 34px;
  display: inline-block;
  text-align: center;
  -webkit-transform: translate3d(0, 0, 0);
  transform: translate3d(0, 0, 0);
}
.flatpickr-current-month span.cur-month {
  font-family: inherit;
  font-weight: 700;
  color: inherit;
  display: inline-block;
  margin-left: 0.5ch;
  padding: 0;
}
.flatpickr-current-month span.cur-month:hover {
  background: rgba(0, 0, 0, 0.05);
}
.flatpickr-current-month .numInputWrapper {
  width: 6ch;
  width: 7ch\0;
  display: inline-block;
}
.flatpickr-current-month .numInputWrapper span.arrowUp:after {
  border-bottom-color: rgba(0, 0, 0, 0.9);
}
.flatpickr-current-month .numInputWrapper span.arrowDown:after {
  border-top-color: rgba(0, 0, 0, 0.9);
}
.flatpickr-current-month input.cur-year {
  background: transparent;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  color: inherit;
  cursor: text;
  padding: 0 0 0 0.5ch;
  margin: 0;
  display: inline-block;
  font-size: inherit;
  font-family: inherit;
  font-weight: 300;
  line-height: inherit;
  height: auto;
  border: 0;
  border-radius: 0;
  vertical-align: initial;
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
  appearance: textfield;
}
.flatpickr-current-month input.cur-year:focus {
  outline: 0;
}
.flatpickr-current-month input.cur-year[disabled],
.flatpickr-current-month input.cur-year[disabled]:hover {
  font-size: 100%;
  color: rgba(0, 0, 0, 0.5);
  background: transparent;
  pointer-events: none;
}
.flatpickr-current-month .flatpickr-monthDropdown-months {
  appearance: menulist;
  background: transparent;
  border: none;
  border-radius: 0;
  box-sizing: border-box;
  color: inherit;
  cursor: pointer;
  font-size: inherit;
  font-family: inherit;
  font-weight: 300;
  height: auto;
  line-height: inherit;
  margin: -1px 0 0 0;
  outline: none;
  padding: 0 0 0 0.5ch;
  position: relative;
  vertical-align: initial;
  -webkit-box-sizing: border-box;
  -webkit-appearance: menulist;
  -moz-appearance: menulist;
  width: auto;
}
.flatpickr-current-month .flatpickr-monthDropdown-months:focus,
.flatpickr-current-month .flatpickr-monthDropdown-months:active {
  outline: none;
}
.flatpickr-current-month .flatpickr-monthDropdown-months:hover {
  background: rgba(0, 0, 0, 0.05);
}
.flatpickr-current-month
  .flatpickr-monthDropdown-months
  .flatpickr-monthDropdown-month {
  background-color: transparent;
  outline: none;
  padding: 0;
}
.flatpickr-weekdays {
  background: transparent;
  text-align: center;
  overflow: hidden;
  width: 100%;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
  -webkit-align-items: center;
  -ms-flex-align: center;
  align-items: center;
  height: 28px;
}
.flatpickr-weekdays .flatpickr-weekdaycontainer {
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  flex: 1;
}
span.flatpickr-weekday {
  cursor: default;
  font-size: 90%;
  background: transparent;
  color: rgba(0, 0, 0, 0.54);
  line-height: 1;
  margin: 0;
  text-align: center;
  display: block;
  -webkit-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  flex: 1;
  font-weight: bolder;
}
.dayContainer,
.flatpickr-weeks {
  padding: 1px 0 0 0;
}
.flatpickr-days {
  position: relative;
  overflow: hidden;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: start;
  -webkit-align-items: flex-start;
  -ms-flex-align: start;
  align-items: flex-start;
  width: 307.875px;
}
.flatpickr-days:focus {
  outline: 0;
}
.dayContainer {
  padding: 0;
  outline: 0;
  text-align: left;
  width: 307.875px;
  min-width: 307.875px;
  max-width: 307.875px;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  display: inline-block;
  display: -ms-flexbox;
  display: -webkit-box;
  display: -webkit-flex;
  display: flex;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  -ms-flex-pack: justify;
  -webkit-justify-content: space-around;
  justify-content: space-around;
  -webkit-transform: translate3d(0, 0, 0);
  transform: translate3d(0, 0, 0);
  opacity: 1;
}
.dayContainer + .dayContainer {
  -webkit-box-shadow: -1px 0 0 #e6e6e6;
  box-shadow: -1px 0 0 #e6e6e6;
}
.flatpickr-day {
  background: none;
  border: 1px solid transparent;
  border-radius: 150px;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  color: #393939;
  cursor: pointer;
  font-weight: 400;
  width: 14.2857143%;
  -webkit-flex-basis: 14.2857143%;
  -ms-flex-preferred-size: 14.2857143%;
  flex-basis: 14.2857143%;
  max-width: 39px;
  height: 39px;
  line-height: 39px;
  margin: 0;
  display: inline-block;
  position: relative;
  -webkit-box-pack: center;
  -webkit-justify-content: center;
  -ms-flex-pack: center;
  justify-content: center;
  text-align: center;
}
.flatpickr-day.inRange,
.flatpickr-day.prevMonthDay.inRange,
.flatpickr-day.nextMonthDay.inRange,
.flatpickr-day.today.inRange,
.flatpickr-day.prevMonthDay.today.inRange,
.flatpickr-day.nextMonthDay.today.inRange,
.flatpickr-day:hover,
.flatpickr-day.prevMonthDay:hover,
.flatpickr-day.nextMonthDay:hover,
.flatpickr-day:focus,
.flatpickr-day.prevMonthDay:focus,
.flatpickr-day.nextMonthDay:focus {
  cursor: pointer;
  outline: 0;
  background: #e6e6e6;
  border-color: #e6e6e6;
}
.flatpickr-day.today {
  border-color: #959ea9;
}
.flatpickr-day.today:hover,
.flatpickr-day.today:focus {
  border-color: #959ea9;
  background: #959ea9;
  color: #fff;
}
.flatpickr-day.selected,
.flatpickr-day.startRange,
.flatpickr-day.endRange,
.flatpickr-day.selected.inRange,
.flatpickr-day.startRange.inRange,
.flatpickr-day.endRange.inRange,
.flatpickr-day.selected:focus,
.flatpickr-day.startRange:focus,
.flatpickr-day.endRange:focus,
.flatpickr-day.selected:hover,
.flatpickr-day.startRange:hover,
.flatpickr-day.endRange:hover,
.flatpickr-day.selected.prevMonthDay,
.flatpickr-day.startRange.prevMonthDay,
.flatpickr-day.endRange.prevMonthDay,
.flatpickr-day.selected.nextMonthDay,
.flatpickr-day.startRange.nextMonthDay,
.flatpickr-day.endRange.nextMonthDay {
  background: #569ff7;
  -webkit-box-shadow: none;
  box-shadow: none;
  color: #fff;
  border-color: #569ff7;
}
.flatpickr-day.selected.startRange,
.flatpickr-day.startRange.startRange,
.flatpickr-day.endRange.startRange {
  border-radius: 50px 0 0 50px;
}
.flatpickr-day.selected.endRange,
.flatpickr-day.startRange.endRange,
.flatpickr-day.endRange.endRange {
  border-radius: 0 50px 50px 0;
}
.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n + 1)),
.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n + 1)),
.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n + 1)) {
  -webkit-box-shadow: -10px 0 0 #569ff7;
  box-shadow: -10px 0 0 #569ff7;
}
.flatpickr-day.selected.startRange.endRange,
.flatpickr-day.startRange.startRange.endRange,
.flatpickr-day.endRange.startRange.endRange {
  border-radius: 50px;
}
.flatpickr-day.inRange {
  border-radius: 0;
  -webkit-box-shadow: -5px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;
  box-shadow: -5px 0 0 #e6e6e6, 5px 0 0 #e6e6e6;
}
.flatpickr-day.flatpickr-disabled,
.flatpickr-day.flatpickr-disabled:hover,
.flatpickr-day.prevMonthDay,
.flatpickr-day.nextMonthDay,
.flatpickr-day.notAllowed,
.flatpickr-day.notAllowed.prevMonthDay,
.flatpickr-day.notAllowed.nextMonthDay {
  color: rgba(57, 57, 57, 0.3);
  background: transparent;
  border-color: transparent;
  cursor: default;
}
.flatpickr-day.flatpickr-disabled,
.flatpickr-day.flatpickr-disabled:hover {
  cursor: not-allowed;
  color: rgba(57, 57, 57, 0.1);
}
.flatpickr-day.week.selected {
  border-radius: 0;
  -webkit-box-shadow: -5px 0 0 #569ff7, 5px 0 0 #569ff7;
  box-shadow: -5px 0 0 #569ff7, 5px 0 0 #569ff7;
}
.flatpickr-day.hidden {
  visibility: hidden;
}
.rangeMode .flatpickr-day {
  margin-top: 1px;
}
.flatpickr-weekwrapper {
  float: left;
}
.flatpickr-weekwrapper .flatpickr-weeks {
  padding: 0 12px;
  -webkit-box-shadow: 1px 0 0 #e6e6e6;
  box-shadow: 1px 0 0 #e6e6e6;
}
.flatpickr-weekwrapper .flatpickr-weekday {
  float: none;
  width: 100%;
  line-height: 28px;
}
.flatpickr-weekwrapper span.flatpickr-day,
.flatpickr-weekwrapper span.flatpickr-day:hover {
  display: block;
  width: 100%;
  max-width: none;
  color: rgba(57, 57, 57, 0.3);
  background: transparent;
  cursor: default;
  border: none;
}
.flatpickr-innerContainer {
  display: block;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  overflow: hidden;
}
.flatpickr-rContainer {
  display: inline-block;
  padding: 0;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
}
.flatpickr-time {
  text-align: center;
  outline: 0;
  display: block;
  height: 0;
  line-height: 40px;
  max-height: 40px;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  overflow: hidden;
  display: -webkit-box;
  display: -webkit-flex;
  display: -ms-flexbox;
  display: flex;
}
.flatpickr-time:after {
  content: "";
  display: table;
  clear: both;
}
.flatpickr-time .numInputWrapper {
  -webkit-box-flex: 1;
  -webkit-flex: 1;
  -ms-flex: 1;
  flex: 1;
  width: 40%;
  height: 40px;
  float: left;
}
.flatpickr-time .numInputWrapper span.arrowUp:after {
  border-bottom-color: #393939;
}
.flatpickr-time .numInputWrapper span.arrowDown:after {
  border-top-color: #393939;
}
.flatpickr-time.hasSeconds .numInputWrapper {
  width: 26%;
}
.flatpickr-time.time24hr .numInputWrapper {
  width: 49%;
}
.flatpickr-time input {
  background: transparent;
  -webkit-box-shadow: none;
  box-shadow: none;
  border: 0;
  border-radius: 0;
  text-align: center;
  margin: 0;
  padding: 0;
  height: inherit;
  line-height: inherit;
  color: #393939;
  font-size: 14px;
  position: relative;
  -webkit-box-sizing: border-box;
  box-sizing: border-box;
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
  appearance: textfield;
}
.flatpickr-time input.flatpickr-hour {
  font-weight: bold;
}
.flatpickr-time input.flatpickr-minute,
.flatpickr-time input.flatpickr-second {
  font-weight: 400;
}
.flatpickr-time input:focus {
  outline: 0;
  border: 0;
}
.flatpickr-time .flatpickr-time-separator,
.flatpickr-time .flatpickr-am-pm {
  height: inherit;
  float: left;
  line-height: inherit;
  color: #393939;
  font-weight: bold;
  width: 2%;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
  align-self: center;
}
.flatpickr-time .flatpickr-am-pm {
  outline: 0;
  width: 18%;
  cursor: pointer;
  text-align: center;
  font-weight: 400;
}
.flatpickr-time input:hover,
.flatpickr-time .flatpickr-am-pm:hover,
.flatpickr-time input:focus,
.flatpickr-time .flatpickr-am-pm:focus {
  background: #eee;
}
.flatpickr-input[readonly] {
  cursor: pointer;
}

@-webkit-keyframes fpFadeInDown {
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, -20px, 0);
    transform: translate3d(0, -20px, 0);
  }
  to {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
}
@keyframes fpFadeInDown {
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, -20px, 0);
    transform: translate3d(0, -20px, 0);
  }
  to {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
}
.gbbDiscountComponentProgressBarContainer{
    background: gray;
    display: block;
    position: relative;
    height:20px;
    border-radius:5px;
    width: 100%;
    margin: auto;
    width: 80%;
}

.gbbDiscountComponentProgressBar{
    /* background: rgb(0, 217, 255); */
    background: rgb(26, 240, 58);
    position: absolute;
    display: block !important;
    /* max-width: 100%; */
    height: 100%;
    border-radius:5px;
}
.gbbDiscountComponentProgressBarAnimation{
    animation: progressAnimation 1s forwards;
    width: 100%;
}

.gbbDiscountComponentProgressBarRuleText{
    position: absolute;
    top: 22px;
    width: 6ch;
}

/* progressAnimation based on time */
@keyframes progressAnimation {
    0% { width: 0%; }
    10%{ width: 10%; }
    20%{ width: 20%; }
    30%{ width: 30%; }
    40%{ width: 40%; }
    50%{ width: 50%; }
    60%{ width: 60%; }
    70%{ width: 70%; }
    80%{ width: 80%; }
    90%{ width: 90%; }
    100% { width: 100%; }
}


.gbbDiscountComponentProgressBarContainer{
    height: 10px;
}

.gbbDiscountComponent:not(:empty){
    height: 40px;
}

.gbbStarSvgContainer{
    width: 24px;
    height: 24px;
    position: absolute;
    top: -15px;
}


.gbbReviewPageDiscountAppliedLabel{
    display: grid;
    justify-content: end;
    grid-template-columns: max-content;
    font-size: 14px;
    font-weight: 600;
}

.gbbReviewPageDiscountAppliedWrapper:not(empty){
    display: grid;
    justify-content: end;
}

.gbbReviewPageTotalCartValueLabel{
    display: grid;
    justify-content: end;
    grid-template-columns: max-content;
    font-size: 16px;
    font-weight: 600;
    text-align: end;
}


/* .gbbStarSvgContainer polygon.svgInnerBody{
    fill: white;
} */

.gbbStarActive polygon.svgInnerBody{
    fill: rgb(255, 255, 0) !important;
    /* add animation */
    /* animation: starAnimation 1s infinite; */
    /* put a transform and translate animation */
    
    transition: fill 0.5s;
}

@keyframes starAnimation {
    0% { fill: white; }
    50% { fill: rgb(58, 10, 232); }
    100% { fill: rgb(255, 255, 0); }
}


@media screen and (min-width: 1023px) {
    .gbbDiscountComponentProgressBarRuleText{
        position: absolute;
        top: 22px;
        width: max-content;
    }

    .gbbDiscountComponentProgressBarContainer{
        width: 80%;
    }  
    
    .gbbReviewPageTotalCartValueLabel{

        font-size: 24px;
    
    }
    .gbbReviewPageDiscountAppliedLabel{
        font-size: 16px;
    }
       
}



.gbbCategoryHeaderContainer {
  display: grid;
  /* grid-auto-flow: column; */
  align-items: center;
  justify-content: start;
  grid-template-columns: 0.3fr 1fr 2fr;
}
.gbbCategoryImage {
  width: 150px;
  height: 100px;
  object-fit: contain;
}
.gbbCategoryContainer {
  padding: 5px;
  /* background: #f5f5f5; */
  border: 2px solid #C0C0C0;
  border-radius: 10px;
}
.gbbMultipleCategoriesContainerHTML{
  display: grid;
  grid-gap: 20px;
}
.gbbMultipleCategoriesPageHTML{
  margin: 20px 0;
}
.gbbCategoryHeaderContainer{
  cursor: pointer;
}
.gbbCategoryTitle{
  font-weight: 600;
}

.gbbCategoryContainerTab{
  width: fit-content;
  padding: 5px;
  border-radius: 6px;
  display: grid;
  place-items: center;
}

.gbbCategoryTitlesContainer.gbbCategoryContainerTabUI{
  width: fit-content;
  display: grid;
  place-items: center;
}

.gbbMultipleCategoriesRibbonContainer, .gbbMultipleCategoriesDropdownContainer{
  padding: 21px 15px;
  display: flex;
  place-content: start;
  flex-wrap: wrap;
  grid-gap: 10px;
  overflow-x: auto;
  top: 0;
  z-index: 2;
}

.gbbMultipleCategoriesDropdownContainer{
  border-radius: 4px;
}


.gbbCategoryContainer.gbbCategoryContainerTabUI , .gbbMutipleCategoriesDropdown{
  padding: 5px 15px;
  border-radius: 5px;
  border: 1px solid #3c3c3c;
 
  display: grid;
  flex-grow: 1;
}


.gbbMutipleCategoriesDropdown{
  background: black;
  color: white;
  padding: 10px;
  border-radius: 4px;
}


.gbbCategoryContainer.gbbCategoryContainerTabUI.gbbCategoryContainerTabUIActive{
  background-color: black;
  color: #F6F6F6;
}

.gbbCategorySubTitleForTabUI{
  display: none;
}

.gbbMultipleCategoriesActiveCategorySubtitle{
  display: grid;
  place-items: center;
  grid-template-columns: 1fr;
  font-weight: 900;
}

.gbbCategoryImageForTabUI{
  display: none;
}

.gbbCategoryTitlesContainer.gbbCategoryTitlesContainerForTabUI{
  display: grid;
  place-content: center;
}

.gbbCategoryHeaderContainerTabUI.gbbCategoryHeaderContainer{
  display: grid;
  place-items: center;
  grid-template-columns: 1fr;
}

/* .gbbMultipleCategoriesPageHTMLForTabUI{
  overflow-y: auto;
  max-height: 80vh;
} */
.gbbMultipleCategoriesContainerHTMLForTabUI{
  position: relative;
}
 .gbbFiltersMainButtonWrapper{
  z-index: 1;
}
@media (min-width:600px){
  .gbbCategoryContainer {
      padding: 10px 20px;
  }
  .gbbCategoryHeaderContainer {
      grid-template-columns: unset;
      grid-auto-flow: column;
  }
  .gbbCategoryTitlesContainer.gbbCategoryTitlesContainerForTabUI{
    display: grid;
    place-content: center;
  }
  
  .gbbCategoryHeaderContainerTabUI.gbbCategoryHeaderContainer{
    display: grid;
    place-items: center;
    grid-template-columns: 1fr;
  }
}

@media only screen and (max-width: 600px) {
  .gbbMultipleCategoriesRibbonContainer , .gbbMultipleCategoriesDropdownContainer{
    padding: 21px 15px;
    place-content: start;
  }
 
  .gbbMultipleCategoriesDropdownContainer{
      display: flex;
    }


    .gbbMultipleCategoriesRibbonContainer{
      display: none;
    }

}

@media only screen and (min-width: 601px) {
  .gbbMultipleCategoriesDropdownContainer{
    display: none;
  }
}

.gbbMultipleCategoriesDropdownArrow{
    align-self: center;
    display: grid;
    position: absolute;
    right: 4%;
    pointer-events: none;
}

.gbbMultipleCategoriesDropdownArrow svg path{ 
  fill: white;
}

.gbbMutipleCategoriesDropdown{
  -webkit-appearance: none; /* Remove default arrow for WebKit browsers */
  -moz-appearance: none; /* Remove default arrow for Firefox */
  appearance: none; /* Remove default arrow for modern browsers */
}



.bannerAttached .gbbCategoryHeaderContainer :first-child, .bannerAttached .gbbCategorySubTitle{
  display : none;
}
.bannerAttached .gbbCategoryImage{
  width: unset !important;
  height: unset !important;
  max-width: 100%;
}
.bannerAttached .gbbCategoryHeaderContainer{
  grid-template-columns: unset;
}

.gbbCategoryContainer.bannerAttached {
  background: #FFFFFF;
  border: unset;
}.gbbProductsContainer,.gbbProductsContainerV2{
  margin: 15px 10px;
  
}
.gbbProductsItemsContainer{
  display: grid;
  grid-template-columns: repeat(2,1fr);
  grid-gap: 15px;
  font-size: 14px;
}
.gbbProductItem {
  display: grid;
  grid-template-rows: 2fr 0.1fr 0.5fr;
  background: #f1f2f3;
  /* padding: 10px; */
  position: relative;
  box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
  transition: all 0.3s cubic-bezier(.25,.8,.25,1);
}


.gbbProductItem {
    display: grid;
    grid-template-rows: 1fr 0.1fr 0.1fr;
    background: #F1F2F3;
    /* padding: 10px; */
    position: relative;
    box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
    transition: all 0.3s cubic-bezier(.25,.8,.25,1);
}
  


.gbbProductReadMore{
  display: grid;
  justify-self: end;
  padding: 10px;
  color: red;
  cursor: pointer;
}
.gbbProductDescriptionContainer{
  width: 100%;
}
.gbbProductDescriptionText{
  display: -webkit-box;
  max-width: 100%;
  margin: 0 auto;
  font-size: 14px;
  -webkit-box-orient: vertical;
  overflow: hidden;
  font-weight: 400;
  max-height: 200px;
  overflow-y: auto;
  /* -webkit-line-clamp: 4;
  text-overflow: ellipsis; */
}
.gbbProductVariantModalDetailsContainer{
  display: grid;
  grid-gap: 15px;
}
.gbbProductCardActionContainer{
  display: grid;
  grid-template-rows: min-content;
  grid-gap: 10px;
  grid-template-columns: 1fr 1fr;
}
.gbbProductCardActionContainer .gbbProductButtonWrapper{
  width: 50%;
  justify-self: end;
  user-select: none;
}
.gbbProductVariantModalContentContainer{
  display: grid;
  grid-gap: 20px;
}
.gbbProductItemPrice{
}
.gbbProductImageContainer{
  /* width: 140px;
  height: 140px; */
  position: relative;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.gbbProductSliderNavigatior{
  position: absolute;
  bottom: 5px;
  right:5px;
}
.gbbPrevImage,.gbbNextImage{
  margin-left:5px;
  position: absolute;
  top: 50%;
  width: 2px;
  padding: 16px;
  margin-top: -22px;
  color: #777676;
  font-weight: bold;
  font-size: 18px;
  transition: 0.6s ease;
  border-radius: 0 3px 3px 0;
  user-select: none;
  margin-left: 5px;
  font-size: 16px;
  cursor: pointer !important;
}
.gbbNextImage{
  right: 3%;
}
.gbbPrevImage:hover, .gbbNextImage:hover {
  /* background-color: rgb(124 121 121 / 80%);
  color: #ffff; */
  scale: 1.1;
}
.gbbFade {
  animation-name: gbbFade;
  animation-duration: 1.5s;
}

@keyframes gbbFade {
  from {opacity: .4} 
  to {opacity: 1}
}
.gbbProductImageContainerImg{
  width: 100%;
  height: 100%;
  object-fit: cover;
  max-height: 150px;
  background: white;
}
.gbbProductVariantModalContentContainer .gbbProductImageContainerImg{
  max-height: 300px;
}
.gbbAddedToCartText{
  position: absolute;
  top: 5%;
  left: 5%;
  background: #000;
  color: #fff;
  border-radius: 5px;
  padding: 5px;
}
.gbbProductQtyContainer{
  width: 60%;
  margin: 0% 10%;
}
.gbbProductQuantityHTML{
  width: 100%;
  display: grid;
  grid-auto-flow: column;
  grid-gap: 15px;
  align-items: center;
}
.gbbProductQuantityAddButton, .gbbProductQuantityRemoveButton{
  background: #000000;
  color:#ffffff;
  border: none;
  border-radius: 5px;
  width: 35px;
  height: 35px;
  font-size: 24px;
  justify-self: center;
  cursor: pointer;
  position: relative;
  user-select: none;
  
  
}

.gbbProductQuantityAddButtonWrapper, .gbbProductQuantityRemoveButtonWrapper{
  position: absolute;
  top: 16px;
  left: 18px;
  transform: translate(-50%, -50%);
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}


.gbbProductQuantityAddButton{
  justify-self: right;
  -webkit-tap-highlight-color: transparent;
}
.gbbProductQuantityRemoveButton{
  justify-self: left;
  -webkit-tap-highlight-color: transparent;
}
.gbbProductQuantityLabel{
  text-align: center;
  font-size: 16px;
  user-select: none;
}
.gbbProductActionContainer{
  width: 100%;
  padding: 10px 10px;
  align-items: center;
  display: grid;
  grid-gap:5px;
  padding-top: 5px;
}
.gbbProductAddButton{
  -webkit-tap-highlight-color: transparent;
  padding: 10px;
  width: 100%;
  background: #000000;
  color: #ffffff;
  border-radius: 5px;
  border: none;
  font-size: 14px;
  cursor: pointer;
  text-align: center;
}

.gbbProductAddButton:active, .gbbProductQuantityAddButton:active, .gbbProductQuantityRemoveButton:active {
  transform: scale(0.95);
}
.gbbProductTextContainer, .gbbProductCardTextContainer,.gbbProductDynamicContentContainer{
  text-align: left;
  width: 100%;
  font-size: 12px;
  align-self: center;
  padding: 5px 10px;
}
.gbbProductCardTextContainer > div{
  font-weight: bold;
  padding: 0;
  font-size: 14px;
}
.gbbProductItemPrice{
  font-size: 12px;
  /* color: black; */
}
.gbbProductItemTitle{
  /* color: black; */
}
.gbbProductsLabel{
  margin: 0 5px;
  font-size: 16px;
  font-weight: 600;
  color: #4f4b4b;
  margin-bottom: 20px;
}
.gbbProductQuantityHTMLContainer{
  display: grid;
  grid-auto-flow: column;
  grid-template-columns: 0.2fr 0.2fr;
  grid-gap: 15px;
  -webkit-tap-highlight-color: transparent;
}
.gbbPageBannerImage{
  width: 100%;
}
.gbbAddProductsPageNavigationContainer, .gbbChooseGiftBoxPageNavigationContainer, .gbbPersonalizePageNavigationContainer{
  /* width: 100%; */
  position: relative;
  /* top: 15%; */
  /* transform: translate(0px, -45%); */
}
.gbbAddProductsPageHTML, .gbbChooseGiftBoxPageHTML, .gbbPersonalizePageHTML{
  /* position: relative;  */
  /* transform: translate(0px, -150px); */
}
.gbbPrecuratedBoxPageHTML{
  position: relative; 
  transform: translate(0px, -100px);
}
/* .gbbAddProductsPageNavigationContainer .gbbNavigationItemsContainer::before{
  content: none;
}
.gbbChooseGiftBoxPageNavigationContainer .gbbNavigationItemsContainer::before{
  content: none;
}
.gbbPersonalizePageNavigationContainer .gbbNavigationItemsContainer::before{
  content: none;
} */
/* do it for other pages also */
/* .gbbAddProductsPageNavigationContainer .gbbNavigationItemsContainer{ 
  margin: 0 10%;
}
.gbbChooseGiftBoxPageNavigationContainer .gbbNavigationItemsContainer{ 
  /* margin: 0 10%; */
  /* margin: 10%; */
/* } */
/* .gbbPersonalizePageNavigationContainer .gbbNavigationItemsContainer{ 
  margin: 0 10%;
}  */

.gbbChooseGiftBoxPageHeader, .gbbAddProductsPageHeader{
  
}

.gbbProductRemoveButton{
  background: rgb(237 159 159);
}
.gbbProductSoldOutButton{
  background: #d2cccc;
  pointer-events: none;
}
/********************PRODUCT VARIANTS MODAL*********************************/
.gbbDisabled {
  pointer-events: none;
  opacity: 0.2;
  /* background-color: black; */
}
.gbbProductVariantModalMainContainer{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  background-color: rgba(24,24,24,0.8);
  z-index: 1000000000;
}
.gbbProductVariantModalContainer{
  position: fixed;
  /* top: 30%;
  left: 5% !important;
  right: 5% !important;
transform: translate(0%, -50%); */
  /* width: 100%;
  margin: 0 25px; */
  height: 100%;
  background: #ffff;
  overflow-y: auto;
  z-index: 100;
  display: grid;
  /* grid-template-rows: 0.1fr 0.6fr 0.1fr;; */
  padding: 20px;
  border: 2px solid #b2b5b9;
  border-radius: 5px;
  grid-gap: 20px;
  overflow-x: hidden;
  /* animation: zoom-in-zoom-out 0.2s ease; */

}
.gbbCartProductsMainContainer{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  background-color: rgba(24,24,24,0.8);
  z-index: 1000000000;
}
.gbbCartProductsContainerModal{
  position: fixed;
  z-index: 1000000000;
  transform: translate(0, -50%);
  background: #ffff;
  border-radius: 5px;
  text-align: center;
  padding: 10px;
  max-height: 95vh;
  /* left: 5vw;
  top: 5vh;
  right: 5vw; */
  left: 5vw;
  right: 5vw;
  top: 50vh;
}
.gbbCartProductsContainerHeader{
  display: grid;
  grid-template-columns: 1fr 0.2fr;
  justify-content: space-between;
  align-items: center;
}
.gbbCartProductsModalClose{
  justify-self: end;
  padding: 12px 10px;
  font-weight: bold;
  transform: rotate(45deg);
  font-size: 35px;
  position: absolute;
  top: -8px;
  right: 0px;
  color: #B2B5B9;
  cursor: pointer;
  user-select: none;
}
.gbbModalTotalContainer{
  display: grid;
  grid-template-columns: 1fr 1fr;
  justify-content: space-between;
  align-items: center;
  padding: 0 5px;
}
.gbbModalTotalContainer .gbbFooterTotalContainer{
  text-align: unset;
}
.gbbModalTotalContainer .gbbFooterTotalLabel{
  justify-self: start;
  font-size: 16px;
  font-weight: 600;
}
.gbbModalTotalContainer .gbbFooterTotalValue{
  justify-self: end;
}
.gbbConditionNotificationToastMainContainer{
  position: fixed;
  top: 80%;
transform: translate(-50%, -50%);
  background: #ffff;
  padding: 20px;
  border-radius: 5px;
  text-align: center;
  z-index: 300;
}
.gbbConditionNotificationToast {
  position: absolute;
  left: 50%;
  bottom: 80%;
  right: 5%;
  transform: translate(-50%, -50%);
  background: #ffff;
  z-index: 99999999999;
  padding: 5px 15px;
  border-radius: 5px;
  width: 80%;
  display: grid;
  grid-auto-flow: column;
  grid-gap: 20px;
  align-items: center;
  justify-content: center;
}
@keyframes zoom-in-zoom-out {
  0% {
    transform: scale(0, 0);
  }
  50% {
    transform: scale(0.5, 0.5);
  }
  100% {
    transform: scale(1, 1);
  }
}



.gbbProductVariantOptionValue{
  padding: 5px 15px;
  border: none;
  background: #f1f2f3;
  font-size: 14px;
  border-radius: 5px;
  cursor: pointer;
}
.gbbProductVariantModalHeader{
  display: grid;
  grid-auto-flow: column;
}
.gbbProductVariantOptionLabel, .gbbProductQuantityHeading{
  font-weight: bold;
  font-size: 14px;
}
.gbbProductVariantNotAvailableWarning{
  font-size: 14px;
  color: red;
  font-weight: bold;
  display: none;
}
.gbbProductVariantOptionValuesContainer{
  /* padding: 10px 0; */
  display: flex;
  flex-wrap: wrap;
  row-gap: 10px;
  column-gap: 10px;
}
.gbbProductVariantAddButton{
  padding: 5px 10px;
  width: 100%;
  display: grid;
  justify-self: end;
  border: none;
  border-radius: 5px;
  background: #000000;
  color: #ffffff;
  cursor: pointer;
  text-align: center;
  align-items: center;
}
.gbbProductVariantAddButton:active {
  transform: scale(0.95);
}
.gbbProductVariantModalClose{
  justify-self: end;
  padding: 2px 10px;
  font-weight: bold;
  transform: rotate(45deg);
  font-size: 35px;
  position: absolute;
  top: -5px;
  right: 0px;
  color: #B2B5B9;
  cursor: pointer;
  user-select: none;
}
.gbbConditionNotificationClose{
  justify-self: end;
  transform: rotate(45deg);
  font-size: 35px;
  color: #ffff;
  cursor: pointer;
}
.gbbFooterProductPrice, .gbbCartModalProductPrice{
  font-weight: bold;
}
.gbbFooterTotalValueContainer{
  display: grid;
  grid-auto-flow: column;
  grid-gap: 5px;
  grid-template-columns: repeat(2, min-content);
  justify-content: end;
}
.gbbFooterOriginalTotalValue, .gbbSummaryPageBundleOriginalPrice{
  text-decoration: line-through;
}
.gbbFooterProductsContainer{

}
.gbbDiscountMessage{
  text-align: center;
  font-size: 16px;
  color: black;
}
/* .gbbFooterProductsContainer::-webkit-scrollbar {
  width: 0.3rem;
}

.gbbFooterProductsContainer::-webkit-scrollbar-track {
  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
}

.gbbFooterProductsContainer::-webkit-scrollbar-thumb {
  background-color: darkgrey;
} */

/********FILTER PRODUCTS*******************************/
.gbbProductsFilterContainer{
  margin: 0 20px;
  cursor: pointer;
  /* margin-top: 70px; */
}
.gbbFiltersDropDownWrapper{
  display: grid;
  grid-template-columns: 1fr 50px;
  margin: 10px 0px;
  align-items: center;
}

.gbbFiltersDropDownButton{
/* transform: rotate(180deg); */
/* height: 30px; */
    display: grid;
width: auto;
cursor: pointer
}
.gbbProductsFilterHeader{
  cursor: pointer !important;
}
.gbbProductsFilterButton{
  color: #796c6c;
  padding: 10px 15px;
  font-size: 16px;
  border: none;
  background: #f1f2f3;
  font-weight: 500;
  font-weight: bold;
  margin: 10px 0;
  border-radius: 5px;
  cursor: pointer;
}
.gbbProductsFilterTagsContainer{
  /* width: min-content; */
  /* display: grid;
  grid-template-columns: repeat(3,1fr);
  grid-gap: 30px; */
  display: flex;
  flex-flow: row wrap;
  gap: 10px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #f1f2f3;
}
.gbbActiveFilter{
  background: #000000;
  color: #ffffff;
}
.gbbFilterTagContainer{
  /* padding: 0 10px; */
  background: #f1f2f3;
  border-radius: 5px;
  /* display: grid;
  grid-auto-flow: column;
  grid-gap: 10px;
  height: min-content;
  justify-items: center; */
}
.gbbFilterTagText{
  color: black;
  padding: 5px 10px;
}
.gbbFilterTagRemoveSymbol{
  font-size: 14px;
  align-self: center;
}
.gbbFiltersSideBarContainer, .gbbProductsFiltersMainContainer{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  z-index: 999999999;
  transition: transform 2s;
}
.gbbProductsFiltersMainContainer{
  background-color: rgba(24,24,24,0.8);
  height: 100%;
}
.gbbProductsFiltersContainer{
  background: white;
  padding: 4%;
  height: 100%;
  width: 70%;
  transition: 0.5s;
  transform: translateX(-100%);
  overflow-y: auto;
  animation: slide-in 0.5s forwards;
  -webkit-animation: slide-in 0.5s forwards;
}
.gbbProductsFiltersContainerHeader{
  display: flex;
  justify-content: space-between;
  margin: 10px 0px;
  position: relative;
}
.gbbFilterDropDownButton{
  transform: rotate(180deg);
  height: 30px;
  width: auto;
  cursor: pointer;
}
.gbbProductsFiltersContainerHeaderLabels{
  display: grid;
  grid-auto-flow: column;
  grid-gap: 10px;
  align-items: center;
}
.gbbProductsFiltersClearLabel{
  font-size: 10px;
  text-decoration: underline;
  cursor: pointer;
}
.gbbProductsFiltersContainerLabel{
  font-weight: 600;
  font-size: 16px;
}
.gbbFilterModalClose{
  justify-self: end;
  transform: rotate(45deg);
  font-size: 45px;
  position: absolute;
  top: -30px;
  right: 0px;
  color: #B2B5B9;
  cursor: pointer;
}
.gbbProductsFilterTagContainer{
  display: flex;
  gap: 10px;
  align-items: center;
}
.gbbProductsFilterTagCheckbox{
  width: 16px;
  height: 16px;
}
.gbbFilterContainer {
  border-top: 1px solid #d5cccc;
  padding-bottom: 15px;
  cursor: pointer; 
}

.gbbFilterTagsContainer{
  height: 85%;
  /* overflow-y: scroll; */
  overflow-y: auto;
}

.gbbFiltersSearchSortHeader{
  margin: 5px 10px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-gap: 10px;
}
.gbbFiltersMainButtonWrapper{
  display: grid;
  grid-auto-flow: column;
  grid-gap: 15px;
  align-items: center;
  font-size: 14px;
  border: 1px solid #f1f2f3;
  padding: 0 20px;
  cursor: pointer;
}
/* Filters sidebar animation */
.gbbFiltersSideBarContainerSlideIn {
  animation: slide-in 0.5s forwards;
  -webkit-animation: slide-in 0.5s forwards;
}

.gbbFiltersSideBarContainerSlideOut {
  animation: slide-out 0.5s forwards;
  -webkit-animation: slide-out 0.5s forwards;
}
  
@keyframes slide-in {
  100% { transform: translateX(0%); }
}

@-webkit-keyframes slide-in {
  100% { -webkit-transform: translateX(0%); }
}
  
@keyframes slide-out {
  0% { transform: translateX(0%); }
  100% { transform: translateX(-100%); }
}

@-webkit-keyframes slide-out {
  0% { -webkit-transform: translateX(0%); }
  100% { -webkit-transform: translateX(-100%); }
}
/* code for price filter from codepen ->  https://codepen.io/sln/pen/bqzRMq */
.gbbFilterPriceContainer {
  width: 100%;
  border: 0;
  padding: 0;
  margin: 0; 
}

.gbbPriceFieldContainer {
  position: relative;
  width: 100%;
  height: 36px;
  box-sizing: border-box;
  background: rgba(248, 247, 244, 0.2);
  padding-top: 15px;
  border-radius: 3px;
}

.gbbPriceFieldContainer input[type=range] {
    position: absolute;
}

/* Reset style for input range */

.gbbPriceFieldContainer input[type=range] {
  width: 100%;
  height: 2px; 
  border: 0;
  outline: 0;
  box-sizing: border-box;
  border-radius: 5px;
  pointer-events: none;
  -webkit-appearance: none;
}

.gbbPriceFieldContainer input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
}

.gbbPriceFieldContainer input[type=range]:active,
.gbbPriceFieldContainer input[type=range]:focus {
  outline: 0;
}

.gbbPriceFieldContainer input[type=range]::-ms-track {
  width: 100%;
  height: 2px; 
  border: 0;
  outline: 0;
  box-sizing: border-box;
  border-radius: 5px;
  pointer-events: none;
  background: transparent;
  border-color: transparent;
  color: transparent;
  border-radius: 5px;
}

/* Style toddler input range */

.gbbPriceFieldContainer input[type=range]::-webkit-slider-thumb { 
  /* WebKit/Blink */
    position: relative;
    -webkit-appearance: none;
    margin: 0;
    border: 0;
    outline: 0;
    border-radius: 50%;
    height: 15px;
    width: 15px;
    margin-top: -6px;
    background-color: #686662;
    cursor: pointer;
    cursor: pointer;
    pointer-events: all;
    z-index: 100;
}

.gbbPriceFieldContainer input[type=range]::-moz-range-thumb { 
  /* Firefox */
  position: relative;
  appearance: none;
  margin: 0;
  border: 0;
  outline: 0;
  border-radius: 50%;
  height: 10px;
  width: 10px;
  margin-top: -5px;
  background-color: #686662;
  cursor: pointer;
  cursor: pointer;
  pointer-events: all;
  z-index: 100;
}

.gbbPriceFieldContainer input[type=range]::-ms-thumb  { 
  /* IE */
  position: relative;
  appearance: none;
  margin: 0;
  border: 0;
  outline: 0;
  border-radius: 50%;
  height: 10px;
  width: 10px;
  margin-top: -5px;
  background-color: #686662;
  cursor: pointer;
  cursor: pointer;
  pointer-events: all;
  z-index: 100;
}

/* Style track input range */

.gbbPriceFieldContainer input[type=range]::-webkit-slider-runnable-track { 
  /* WebKit/Blink */
  width: 188px;
  height: 2px;
  cursor: pointer;
  background: #686662;
  border-radius: 5px;
}

.gbbPriceFieldContainer input[type=range]::-moz-range-track { 
  /* Firefox */
  width: 188px;
  height: 2px;
  cursor: pointer;
  background: #686662;
  border-radius: 5px;
}

.gbbPriceFieldContainer input[type=range]::-ms-track { 
  /* IE */
  width: 188px;
  height: 2px;
  cursor: pointer;
  background: #686662;
  border-radius: 5px;
}

/* Style for input value block */

.gbbPriceTextWrap {
  display: flex;
  justify-content: space-between;
  color: #686662;
  font-size: 14px;
  line-height: 1.2em;
  font-weight: 400;
  margin: 5px 0;
}

.gbbPriceWrap1, 
.gbbPriceWrap1 {
  display: flex;
}



.gbbPriceTextWrap #gbbPriceWrap1Input, 
.gbbPriceTextWrap #gbbPriceWrap2Input {
  width: 30px;
  text-align: right;
  margin: 0;
  padding: 0;
  margin:0 2px;
  background:  0;
  border: 0;
  outline: 0;
  color: #fff;
  font-size: 14px;
  line-height: 1.2em;
  font-weight: 400;
}

.gbbPriceTextWrap label {
  text-align: right;
}

/* Style for active state input */
    
.gbbPriceFieldContainer input[type=range]:hover::-webkit-slider-thumb {
  box-shadow: 0 0 0 0.5px #686662;
  transition-duration: 0.3s;
}

.gbbPriceFieldContainer input[type=range]:active::-webkit-slider-thumb {
  box-shadow: 0 0 0 0.5px #686662;
  transition-duration: 0.3s;
}
.gbbSortByDropDownSelect{
  cursor: pointer;
  padding: 5px 25px;
  border: 2px solid #f1f2f3;
  font-size: 14px;
}
/* style for search box */
.gbbSearchBarMainWrapper{
display: grid;
  grid-template-columns: 0.1fr 1fr;
  align-items: center;
  grid-column: 2;
  margin: 10px 0;
  justify-self: end;
  /* border-bottom: 1px solid #f1f2f3; */
  border-bottom: 1px solid #000000;
}
.gbbSearchBarIcon{
  width: fit-content;
  display: grid;
}
.gbbSearchBarInput{
  padding: 10px;
  font-size: 14px;
  border: none;
  box-shadow: none;
    outline: none;
        width: 100%;
    background-color: transparent;
}
.gbbSearchBarInput::placeholder{
  color: #c4c4c4;
}
/* .gbbSearchBarMainWrapper:focus-within{
  border-bottom: 1px solid #000000;
} */
 .gbbProductsNotAvailable{
  text-align: center;
  font-size: 2rem;
  grid-column: 1 / -1;
 }
/*******************FOOTER HTML****************************/
.gbbAddProductsPageFooterHTML,.gbbChooseGiftBoxPageFooterHTML, .gbbPersonalizePageFooterHTML, .gbbPrecuratedBoxPageFooterHTML, .gbbMultipleCategoriesPageFooterHTML{
  background: #D7D7D7;
  padding: 5px;
  position: sticky;
  bottom: 0;
  /* z-index: 999999; */
}
.gbbProductsFooterHTML{
  display: grid;
  grid-template-columns: 1fr 0.2fr;
  grid-gap: 20px;
  padding: 10px;
  position: relative;
  background: #D7D7D7;
  /* background: #f1f2f3;
  padding: 5px;
  position: sticky;
  bottom: 0; */
}
.gbbFooterProductsContainer{
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: min-content;
  grid-gap: 5px;
  overflow-x: auto;
  overflow-y: hidden;
}
.gbbCartModalProductsContainer{
  display: grid;
  grid-auto-flow: column;
  grid-gap: 5px;
  /* overflow-x: auto; */
  overflow-y: auto;
  max-height: 70vh;
}
.gbbCartModalProductsContainer{
  grid-auto-flow: row;
}
.gbbFooterProductContainer, .gbbCartModalProductContainer{
  display: grid;
  grid-auto-flow: column;
  grid-gap: 10px;
  position: relative;
  padding: 5px;
}
.gbbCartModalProductContainer{
  grid-template-columns: 0.5fr 3fr;
}


.gbbFooterProductImageContainer{
  display: grid;
  width: 50px;
  height: 50px;
  border: 1px solid #cfc9c9;
  overflow: hidden;
}
.gbbCartProductImageContainer{
  display: grid;
  width: 80px;
  height: 80px;
  border: 1px solid #cfc9c9;
  overflow: hidden;
}
.gbbViewCartProductsLink{
  text-decoration: underline;
  cursor: pointer; 
}
.gbbCartModalProductImage{
  width: 100%;
  height: 100%;
}

.gbbFooterProductRemoveButton, .gbbCartModalProductRemoveButton{
  position: absolute;
  cursor: pointer;
}
.gbbCartProductImageContainer{
  object-fit: contain;
}
.gbbFooterProductImage{
  /* max-width: 50px; */
  /* max-width: 40px;
  min-height: 40px; */
  width: 100%;
  height: 100%;
  object-fit: contain;
}
.gbbFooterProductTextContainer{
  font-size: 12px;
  width: 100px;
}
.gbbCartModalProductTextContainer{
  font-size: 14px;
  /* width: 165px; */
  display: grid;
  grid-template-columns: 1fr 0.2fr;
  justify-content: space-between;
  align-items: start;
  grid-gap: 10px;
}
.gbbCartProductsContainerHeaderLabel{
  justify-self: start;
  font-size: 16px;
  font-weight: bold;
}
.gbbProductsFooterHTMLForMobile .gbbFooterButtonsWrapper{
  grid-template-columns: 1fr 2fr;
}
.gbbFooterProductTitle{
  width: 100px;
  white-space: nowrap;
  text-overflow: ellipsis;
  display: block;
  overflow: hidden;
}
.gbbCartModalProductTitle{
  width: 100%;
  text-align: left;
}
.gbbCartModalProductPriceQtyContainer{
  display: grid;
  grid-template-columns: 1fr 2fr;
  grid-gap: 5px;
}
.gbbFooterTotalLabel{
  color: black;
  font-size: 14px;
  line-height: 8px;
}
.gbbFooterTotalValue{
  color: black;
  font-weight: 600;
  font-size: 16px;
  white-space: nowrap;
}
.gbbFooterButtonsWrapper{
  display: grid;
  grid-gap: 15px;
  grid-template-columns: auto auto;
}
.gbbFooterBackButton, .gbbFooterNextButton {
  font-size: 12px;
  padding: 10px 15px;
  border: none;
  border-radius: 5px;
  text-align: center;
  font-weight: 600;
  cursor: pointer;
  user-select: none;
}
.gbbFooterBackButton{
  background: grey;
  color: #ffff;
}
.gbbFooterBackButton:active {
  transform: scale(0.95);
}
.gbbFooterNextButton {
  color: #000;
  background: #000000;
  color: #ffffff;
  grid-column: 2 /-1;
}

.gbbFooterNextButton:active {
  transform: scale(0.95);
}

.gbbFooterTotalContainer{
  text-align: right;
}
.gbbFooterProductQtyPriceContainer, .gbbCartModalProductQtyPriceContainer{
  display: flex;
  gap: 5px;
}
.gbbCartModalProductTitleQty{
  display: grid;
  justify-content: start;
  width: unset;
}
.gbbCartModalProductQuantity{
  justify-self: start;
}
.gbbAddedToCartText{
  position: absolute;
  top: 5%;
  left: 5%;
  background: black;
  color: #ffff;
  padding: 0 4px;
  border-radius: 5px;
  font-size: 12px;
}
.gbbViewProductsLabelAndTotalContainer{
  display: grid;
  grid-template-columns: 1fr 0.4fr;
}
.gbbCartProductsContainerModal{
  display: grid;
  grid-gap: 10px;
}
.gbbAddProductsPageHTML .gbbProductsFilterContainer, .gbbChooseGiftBoxPageHTML .gbbProductsFilterContainer, .gbbPrecuratedBoxPageHTML .gbbProductsFilterContainer{
  /* margin-top: 120px; */
}

.gbbLoadMoreProductsButton{
  text-align: center;
  margin: 20px;
  padding: 10px;
  border: 1px solid black;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
}
.gbbProductAllImagesContainer{
  display: none;
  max-height: 200px;
}
.gbbProductVariantModalImageTitleContainer{
  display: grid;
  grid-gap: 15px;
}
.gbbProductTileImageContainer{
  display: grid;
  justify-items: center;
  align-items: center;
}


@media (min-width:600px){

  .gbbProductsItemsContainer{
      grid-template-columns: repeat(3,1fr);
   
  }
  /* .gbbProductItem{
      grid-template-rows: 3fr 0.8fr 0.8fr;
  } */
  .gbbProductImageContainerImg{
      max-height: 180px;
  }
  
  .gbbAddProductsPageNavigationContainer,.gbbPersonalizePageNavigationContainer,.gbbChooseGiftBoxPageNavigationContainer{
  }
  .gbbAddProductsPageNavigationContainer, .gbbChooseGiftBoxPageNavigationContainer, .gbbPersonalizePageNavigationContainer{
      /* transform: translate(0px, -35%); */
  } 
  .gbbProductTextContainer, .gbbProductItemPrice,.gbbProductDynamicContentContainer{
      font-size: 14px;
  }
  .gbbProductCardTextContainer > div{
      font-size: 18px;
  }
  .gbbProductActionContainer{
      display: grid;
      grid-template-columns: auto auto;
      justify-content: space-between;
      grid-gap: max-content;
      width: 100%;
  } 
  .gbbProductsFilterTagsContainer{
  }
  .gbbAddedToCartText{
      font-size: 14px;
  }
  .gbbAddProductsPageHeader, .gbbChooseGiftBoxPageHeader{
  }
  .gbbProductsFiltersContainerLabel{
      font-size: 20px;
  }
  .gbbFiltersMainButtonWrapper{
      font-size: 18px;
  }
  .gbbSortByDropDownSelect{
      font-size: 18px;
  }
  .gbbFiltersMainButtonWrapper{
      justify-self: start;
      padding: 5px 20px;
  }
  .gbbSortByDropDownContainer{
      justify-self: end;
  }
  .gbbProductsFiltersClearLabel{
      font-size: 14px;
  }
  .gbbProductVariantModalBodyContainer{
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      align-items: center;
      grid-gap: 15px;
  }
  .gbbProductVariantModalDetailsContainer{
      display: grid;
      grid-gap: 20px;
  }
  .gbbProductVariantOptionsContainer{
      display: grid;
      grid-gap: 15px;
  }
  .gbbProductVariantOptionLabel, .gbbProductQuantityHeading{
      font-weight: bold;
      font-size: 16px;
  }
  .gbbProductVariantOptionValue{
      font-size: 16px;
  }
  .gbbProductVariantAddButton{
      /* width: 50%; */
  }
  .gbbProductDescriptionText{
      max-height: 150px;
  }
  .gbbProductAllImagesContainer{
      display: grid;
      grid-gap: 5px;
      grid-auto-columns: min-content;
      grid-template-columns: repeat(4, 1fr);
      overflow-y: auto;
  }
  .gbbProductTileImageContainer{
      object-fit: contain;
  }
  .gbbProductTileImage {
      max-height: 70px;
  }
}
/* @media (min-width:768px) and (max-widthx:1023px){
  .gbbAddProductsPageNavigationContainer, .gbbChooseGiftBoxPageNavigationContainer{
      transform: translate(0px, -55%);
  }    
} */
@media (min-width:1024px){
  .gbbProductVariantModalContainer{
      top: 40vh;
      left: 50vw !important;
      transform: translate(-50%, -50%);
      margin: 10vh 0;
      height: unset;
      grid-gap: 15px;
      max-height: 95vh;
  }
  .gbbProductImageContainerImg{
      max-height: 200px;
  }

  .gbbPrevImage,.gbbNextImage{
      font-size: 20px;
  }

  .gbbProductItem:hover {
      box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);
  }

  .gbbProductItem{
      grid-template-rows: 3fr 0.8fr 0.8fr;
  }

  .gbbProductImageContainer{
      /* width: 235px;
      height: 235px; */
  }
  .gbbProductsLabel{
      margin: 0 10px;
      font-size: 18px;
      margin-bottom: 20px;
  }
  .gbbPageBannerImage{
      width: 100%;
      height: 10vw;
  }
  .gbbProductButton{
      padding: 10px;
  }
  .gbbFooterProductTextContainer{
      width: 150px;
      font-size: 12px;
  }
  .gbbFooterProductTitle{
      width: 150px;
  }
  .gbbFooterProductImage{
      /* min-height: 50px;
      max-width: 50px; */
  }
  .gbbFooterBackButton, .gbbFooterNextButton {
      font-size: 14px;
  }
  .gbbFooterTotalValue{
      font-size: 16px;
  }
  .gbbFooterTotalContainer{
      text-align: right;
  }
  .gbbFooterProductsContainer{
      grid-gap: 0;
  }
  .gbbProductsFilterContainer{
      margin: 0 20px;
      cursor: pointer;
      /* margin-top: 80px; */

  }
  .gbbChooseGiftBoxPageHTML .gbbProductsFilterContainer{
      /* margin-top: 0 !important; */
  }
  .gbbProductsFilterButton{
      color: #796c6c;
      padding: 10px 15px;
      font-size: 16px;
      border: none;
      background: #f1f2f3;
      font-weight: 500;
      font-weight: bold;
      margin: 10px 0;
      border-radius: 5px;
      cursor: pointer;
  }
  .gbbProductsFilterTagsContainer{
      /* width: min-content; */
      
  }
  .gbbFilterTagContainer{
      /* padding: 0 10px; */
      background: #f1f2f3;
      border-radius: 5px;
      /* display: grid;
      grid-auto-flow: column;
      grid-gap: 10px;
      height: min-content; */
  }
  .gbbFilterTagText{
      color: black;
      padding: 5px 10px;
  }
  .gbbFilterTagRemoveSymbol{
      font-size: 14px;
      align-self: center;
  }
  .gbbProductsFilterTagsContainer{
      padding: 20px;
      border-radius: 5px;
  }
  .gbbPrevImage,.gbbNextImage{
      width: 5px;
  }
  .gbbAddProductsPageNavigationContainer, .gbbChooseGiftBoxPageNavigationContainer, .gbbPersonalizePageNavigationContainer{
      /* transform: translate(0px, -40%); */
  }  
  .gbbProductTextContainer, .gbbProductItemPrice, .gbbProductCardTextContainer,.gbbProductDynamicContentContainer{
      font-size: 14px;
  }

  .gbbProductDynamicContentContainer{
    font-weight: 600;
  }

  .gbbChooseGiftBoxPageHeader{
  }
  .gbbAddProductsPageHeader {
  }
  .gbbProductsFiltersContainer{
      background: white;
      width: 25%;
  }
  .gbbConditionNotificationToast{
      width: max-content;
  }
}
@media(min-width:1192px){
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(4,1fr);
  }
  .gbbProductImageContainerImg{
      max-height: 240px;
  }
  .gbbLoadMoreProductsButton{
      border: none;
      border-bottom: 1px solid black;
  }
}

@media(min-width:1600px){
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(5,1fr);
  }
  
}

@media(min-width:1920px){
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(6,1fr);
  }
}

@media(min-width:2560px){
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(8,1fr);
  }
}

@media(min-width:3840px){
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(12,1fr);
  }
}

@media(min-width: 1023px){

  .gbbProductItemOverLay{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex !important;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    cursor: pointer;
  }
  
  
  .gbbOverLayIconContainer{
    display: block !important;
    width:100%;
    height: 100%;
    background-image: url("https://d3ks0ngva6go34.cloudfront.net/storefront/overlay-image.svg");
    background-repeat: no-repeat;
    background-size: 25%;
    background-position: center;
  }


  /* .gbbProductItem:hover .gbbProductItemOverLay{
    opacity: 0.8;
    display: flex !important;
  } */

  .gbbProductImageContainer:hover .gbbProductItemOverLay{
    opacity: 0.8;
    display: flex !important;
  }
}


.gbbProductFormText{
  margin: 0px;
  padding: 10px 18px;
  width: 100%;
  background-color: #ffffff;
  color: #000000;
  max-width: 100%;
  line-height: 1.2;
  border-radius: 2px;
  padding-bottom: 10px;
  border: 1px solid #A2A2A2;
  font-size: 14px !important;
}

.gbbProductVariantModalContainerWithPersonalization .gbbProductDescriptionContainer{
  display: none;
}

.gbbRequiredFieldMessage{
    color: red;
    margin: 0;
    padding: 0;
    font-size: 12px;

}

.gbbProductFormTextCharacterCount {
  font-size: 12px;
  color: #8c8c8c;
  text-align: end;
  grid-column: 2/-1;
}
.gbbProductFormValidationContainer{
  display: grid;
  grid-template-columns: 1fr 1fr;
}


/* For the main list container */
/* .gbbProductFormImageSelectorListContainer {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-gap: 10px;
} */

/* For individual list items within the list container */
.gbbProductFormImageSelectorListItems {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
}

/* For the label element */
.gbbProductFormImageSelectorListLabel {
  width: 100%;
  height: 125px;
  position: relative;
  cursor: pointer;
  display: inline-block;
  align-self: center;
}

/* For individual list items */
.gbbProductFormImageSelectorListItem {
  position: relative;
}

/* For the input (radio button) element */
.personalizationImageInput {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  visibility: hidden;
}

/* For the image element */
.personalizationImage {
  width: 100%;
  height: auto;
  height: 100%;
}

.gbbActiveImageSelectorListItem{
  border: 1px solid #000000;
  opacity: 0.5;
  padding : 10px;
  padding : 5px;
}

.gbbProductFormContainer{
  display: grid;
  grid-gap: 10px;
}

.gbbPersonalizationImageCaption {
  position: absolute;
  bottom: 5%;
  width: 100%;
  opacity: 0;
  background-color: rgba(0,0,0,0.5);
  color: white;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: opacity 0.5s;
  cursor: pointer;
  font-size: 1.5rem;
  font-weight: bold;
  text-align: center;
}

.gbbActiveImageSelectorListItem .gbbPersonalizationImageCaption{
  opacity: 0;
  padding: 10px;
}


.gbbProductFormRadioListItems{
  display: flex;
  gap: 20px;
}

.personalizationRadioLabel{
  padding-left: 5px;
}

/* =============== NEW PRODUCT CARD DESIGN ============== */
.gbbProductsCardLayoutV2 .gbbProductTextContainer,.gbbProductsCardLayoutV2 .gbbProductItemPricesContainer{
  text-align: center;
}
.gbbProductsCardLayoutV2 .gbbProductActionContainer{
  grid-template-columns: 1fr;
  padding: 0px;
  grid-template-rows: .5fr 45px;
  place-self: end;
}
.gbbProductsCardLayoutV2 .gbbProductItemPricesContainer{
  display: grid;
  grid-template-columns: auto auto;
  justify-self: center;
  gap:10px;
}
.gbbProductsCardLayoutV2 .gbbProductItem{
  background: white;  
  padding: 8px;
  grid-gap: 5px;
  border-radius: 12px;
  border: 1px solid #E3E3E3;
}
.gbbProductsCardLayoutV2 .gbbProductItem:has(.gbbReviewStarsContainer){
    grid-template-rows: min-content;
}
.gbbProductsCardLayoutV2 .gbbProductItem:not(:hover){
  box-shadow: none;
}
.gbbProductsCardLayoutV2 .gbbProductImageContainer{
  border-radius: 8px;
  overflow: hidden;
}
.gbbProductsCardLayoutV2 .gbbProductQuantityHTML,.gbbProductVariantModalLayoutV2 .gbbProductQuantityHTML{
  height: 100%;
  padding: 5px;
  border-radius: 9px;
  place-items: center;
  background: #eeeeee;
}
.gbbProductsCardLayoutV2 .gbbProductTitleOnly{
  font-weight: bold;
    font-size: 18px;
    line-height: 22px;
}
.gbbProductsCardLayoutV2 .gbbFooterButtonsWrapper{
      grid-template-columns: .5fr 1fr .5fr;
        width: 100%;
}
.gbbProductsCardLayoutV2 .gbbDiscountMessage{
  font-weight: bold;
}
.gbbProductsCardLayoutV2 .gbbFooterButtonsContainer{
  display: grid;
    justify-items: center;
    background: #f6f6f6;
    padding: 8px;
    border-radius: 12px;
}
.gbbProductsCardLayoutV2 .gbbFooterTotalContainer{
    display: grid;
      grid-template-columns: repeat(2, min-content);
      align-items: center;
      grid-gap: 10px;
      font-weight: bold;
      place-content: center;
}
.gbbProductsCardLayoutV2 .gbbFooterTotalValueContainer{
  justify-content: start;
}
.gbbProductsCardLayoutV2 .gbbFooterBackButton{
  color: black ;
    border: 2px solid black;
    background: white ;
}
.gbbProductsCardLayoutV2 .gbbFooterNextButton{
  grid-column: 3;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTML{
  grid-template-columns: 1fr;
  padding: 10px 0px;
  grid-gap: 8px;
}
.gbbProductsCardLayoutV2 .gbbDiscountFooterHTML{
  padding-top: 5px;
}
.gbbDiscountFooterHTML:has(.progressBarContainer) {
  display: grid;
  grid-gap: 10px;
}
.gbbProductsCardLayoutV2 .gbbDiscountMessageContainer{
      display: grid;
        grid-template-columns: repeat(2, max-content);
        place-content: center;
        grid-gap: 10px;
        align-items: center;
        /* cursor: pointer; */
}
.gbbProductsCardLayoutV2 .gbbProductAddButton{
  border-radius: 10px;
  font-weight:  bold;
}

.gbbProductsCardLayoutV2 .gbbShowBoxProductsToggle{
  height: 25px;
}
.gbbProductsCardLayoutV2 .gbbShowBoxProductsToggleContainer{
  display: flex;
  align-items: center;
}
.gbbProductsCardLayoutV2 .gbbShowBoxProductsToggleContainer>svg{
  height: 30px;
  width: 30px;
}
.gbbProductsCardLayoutV2 .gbbProductQuantityRemoveButton,.gbbProductsCardLayoutV2 .gbbProductQuantityAddButton{
        border-radius: 6px;
        width: 100%;
}
.gbbProductsCardLayoutV2 .gbbProductQuantityAddButtonWrapper,.gbbProductsCardLayoutV2 .gbbProductQuantityRemoveButtonWrapper{
  top: 50%;
  left: 50%;
}
.gbbProductsCardLayoutV2 .showBoxProductsInFooter{
  display: grid;
  grid-template-columns: repeat(2, max-content);
  justify-content: center;
  align-items: center;
  cursor: pointer;
  grid-gap: 10px;
  padding-top: 5px;
}
/* .gbbProductsCardLayoutV2 .gbbFooterProductsContainer{
  display: none;
} */
 .gbbProductsCardLayoutV2 .gbbFooterTotalLabel{
  font-size: 16px;
 }
 .gbbProductsCardLayoutV2 .gbbPageFooterHTML{
  width: 80%;
 }
 .gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterButtonsWrapper{
  grid-template-columns: .5fr 1.5fr .5fr;
  grid-gap: 10px;
 }
 .gbbProductsCardLayoutV2 .gbbAddProductsPageFooterHTML, .gbbProductsCardLayoutV2 .gbbPersonalizePageFooterHTML{
  display: grid;
  justify-items: center;
  z-index: 2;
 }
.gbbAddProductsPageFooterHTML{
  border-top: 1px solid #E3E3E3;
 }
.progressBarContainer {
      display: flex;
        justify-content: center;
 }
.progressBar {
        background-color: #C1E7C5;
        height: 7px;
        border-radius: 25px;
        overflow: hidden;
        width: 80%;
 }
.gbbProductsCardLayoutV2 .progressBar{
width: 100%;
}
.progressBarFill {
        height: 100%;
        width: 0%;
        background-color: #4caf50;
        transition: width 1s;
        /* animation: fillAnimation 2s forwards; */
        display: block !important;
 }
 .gbbProductsCardLayoutV2 .gbbFooterOriginalTotalValue{
  grid-column: 2;
 }
 .gbbProductsCardLayoutV2 .gbbFooterBackButton, .gbbProductsCardLayoutV2 .gbbFooterNextButton{
  border-radius: 5px;
  font-weight: bold;
 }
 .gbbProductsCardLayoutV2 .gbbOverLayIconContainer{
  background-image: url("https://d3ks0ngva6go34.cloudfront.net/storefront/magnifier_new.svg");
 }
 .gbbProductsCardLayoutV2 .gbbProductItemPrice,
 .gbbProductsCardLayoutV2 .gbbProductItemCompareAtPrice {
   font-size: 16px !important;
   font-weight: bold;
 }
  .gbbProductsCardLayoutV2 .gbbProductItem:hover {
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.12), 0 10px 10px rgba(0, 0, 0, 0.12);
  }
  .gbbProductsCardLayoutV2 .gbbProductTextContainer{
    padding: 0px;
  }
  .gbbProductsCardLayoutV2 .gbbProductItem .gbbReviewStarsContainer{
    text-align: center;
  }
  .gbbProductVariantModalContainer .gbbReviewStarsContainer{
    font-size: 13px;
  }

  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButtonWrapper,
  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButton{
      width: 100%;
      text-align: center;
      font-size: 14px;
      font-weight: bold;
      height: auto;
  }
  .gbbProductQuantityHTML.productMaxQuantityReached, .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButton{
    padding: 10px;
  }
  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButtonWrapper,
  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButton,
  .gbbProductQuantityHTML.productMaxQuantityReached{
      background-color: var(--gbb-product-card-button-text-color) !important;
      color: var(--gbb-product-card-button-color) !important;
  }
  .gbbProductQuantityHTML.productMaxQuantityReached{
      border: 1px solid var(--gbb-product-card-button-color);
  }

  .gbbDisabledForMaximumQuantityLimit{
    pointer-events: none;
    opacity: 0.5;
  }

 @media (max-width: 900px){
  .gbbProductsCardLayoutV2 .gbbPageFooterHTML{
    width: 100%;
  }
  .gbbProductsCardLayoutV2 .gbbDiscountMessageContainer{
    display: flex;
  }
  .gbbProductsCardLayoutV2 .gbbDiscountMessage,.gbbProductsCardLayoutV2 .gbbFooterTotalContainer{
    font-size: 14px;
  }
  .gbbProductsCardLayoutV2 .gbbProductTitleOnly {
  font-size: 14px;
    line-height: 18px;
  }
  .gbbProductsCardLayoutV2 .gbbProductItemPrice,
    .gbbProductsCardLayoutV2 .gbbProductItemCompareAtPrice {
    font-size: 14px !important;
  }
  .gbbProductsCardLayoutV2 .gbbProductAddButton{
    font-size: 12px;
  }
  .gbbProductsCardLayoutV2 .gbbProductItem{
    grid-gap: 8px;
  }
  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButtonWrapper,
  .gbbProductQuantityHTML.productMaxQuantityReached .gbbProductQuantityRemoveButton{
      font-size: 12px;
  }
 }
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductsContainer {
    display: grid;
      max-height: 60vh;
      overflow-y: auto;
      grid-template-columns: 1fr;
      grid-auto-columns: unset;
      grid-auto-flow: unset;
      padding-top: 5px;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductContainer {
  grid-template-columns: 65px 1fr;
  align-items: center;
  padding: 0px;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductImageContainer {
  height: 60px;
    width: 65px;
  border-radius: 8px;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductImage{
  height: 100%;
  object-fit: contain;
  width: 100%;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductRemoveButton {
    align-items: center;
      position: absolute;
      cursor: pointer;
      top: 0;
      height: 15px;
      display: flex;
}
.gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductTextContainer{
  width: 100%;
  overflow: auto;
}
 .gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbFooterProductTitle{
  font-size: 14px;
  width: 100%;
}
 .gbbProductsCardLayoutV2 .gbbCartIconWithQuantityContainer {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
  top: 0px;
  display: flex;
    padding: 0px 10px;
    border-radius: 10px;
    font-size: 14px;
    align-items: center;
 }
/* .gbbProductsCardLayoutV2 .gbbProductsFooterHTMLForMobile .gbbCartIconWithQuantityContainer {
  display: flex;
  padding: 0px 10px;
  border-radius: 10px;
  font-size: 14px;
  align-items: center;
} */
.gbbProductsCardLayoutV2 .gbbCartIconWithQuantityContainer>svg {
 height: 20px;
}
/* .gbbProductsCardLayoutV2 .gbbProductsFooterHTML.gbbProductsFooterHTMLForMobile {
  padding: 0px;
} */
/* NEW VARIANT MODAL */
.gbbProductVariantModalLayoutV2 .gbbProductItemPricesContainer {
  display: grid;
  grid-template-columns: repeat(2,max-content);
  align-items: center;
  gap: 5px;
}
.gbbProductVariantModalLayoutV2 .gbbProductItemCompareAtPrice{
  grid-column: -1;
  grid-row: 1;
}
.gbbProductVariantModalLayoutV2 .gbbProductItemPrice{
  grid-column: 1;
  grid-row: 1;
}
.gbbProductVariantModalLayoutV2 .gbbProductQuantityHTMLContainer{
  grid-template-columns: .8fr 1.5fr;
  align-items: center;
}
.gbbProductVariantModalLayoutV2 .gbbProductQuantityAddButton,
.gbbProductVariantModalLayoutV2 .gbbProductQuantityRemoveButton{
  width: 55px;
  height: 30px;
}
.gbbProductVariantModalLayoutV2 .gbbProductQuantityAddButtonWrapper,
.gbbProductVariantModalLayoutV2 .gbbProductQuantityRemoveButtonWrapper{
  top: 50%;
  left: 50%;
}
.gbbProductVariantModalLayoutV2 .gbbProductCardTextContainer{
  display: grid;
    grid-gap: 5px;
}
.gbbProductVariantModalLayoutV2 .gbbProductDescriptionText{
  scrollbar-width: thin;
}
.gbbProductVariantModalLayoutV2 .gbbProductItemTitle{
  font-size: 20px;
}
.gbbProductVariantModalLayoutV2 .gbbProductItemCompareAtPrice{
  font-size: 15px;
}
.gbbProductVariantModalLayoutV2 .gbbProductItemPrice{
  font-size: 16px;
}
.gbbProductVariantModalLayoutV2 .gbbNextBtnContainer,.gbbProductVariantModalLayoutV2 .gbbPrevBtnContainer{
      background: #eeee;
        display: grid;
        place-items: center;
        cursor: pointer;
}
.gbbProductVariantModalLayoutV2 .gbbNextBtnContainer{
  border-bottom-left-radius: 6px;
    border-bottom-right-radius: 6px;
}
.gbbProductVariantModalLayoutV2 .gbbPrevBtnContainer {
  border-top-left-radius: 6px;
  border-top-right-radius: 6px;
}
.gbbProductVariantModalLayoutV2 .gbbProductImageContainerImg{
  border-radius: 10px;
}
.gbbProductVariantModalLayoutV2 .gbbProductTabImageContainer ,.gbbProductVariantModalLayoutV2 .gbbProductTabImageContainer img{
  border-radius: 8px;
}
.gbbProductVariantModalLayoutV2 .gbbProductCardActionContainer{
grid-template-columns: 1fr;
grid-gap: 0px;
}
.gbbProductVariantModalLayoutV2 .gbbProductVariantModalContainer{
  border: none;
}
.gbbProductVariantModalContainer.gbbVariantInventoryNotAvailable .gbbProductVariantAddButton{
  pointer-events: none;
  opacity: 0.5;
}
.gbbInventoryText{
  font-style: italic;
  font-size: 14px;
}

@media (max-width:430px) {
  .gbbProductsCardLayoutV2 .gbbProductItemPricesContainer{
    grid-template-columns: 1fr;
    gap: 0px;
  }
 
}
@media (max-width:330px) {
  .gbbProductsItemsContainer{
      grid-template-columns: repeat(1,1fr);
    }
}

@media screen and (min-width: 1800px) {
  .gbbProductImageContainer img {
    object-fit: contain;
  }
}
/* @media (min-width: 486px) {
.gbbProductsItemsContainer[data-total-products="1"],
  .gbbProductsItemsContainer[data-total-products="2"],
  .gbbProductsItemsContainer[data-total-products="3"],
  .gbbProductsItemsContainer[data-total-products="4"] {
    display: flex;
    justify-content: center;
  } -- not using this block
.gbbProductsItemsContainerLessProducts{
  display: flex;
  justify-content: center;
}
  .gbbProductsItemsContainerLessProducts .gbbProductTitleOnly {
    word-wrap: break-word;
    max-width: 240px;
  }

  .gbbProductsItemsContainerLessProducts .gbbProductItem {
    min-width: 250px;
  }
} */

/* SLOTS */
.gbbSlotFooterProductsContainer {
  display: grid;
  grid-auto-flow: column;
  grid-auto-columns: min-content;
  grid-gap: 10px;
  padding: 5px 0px;
  overflow-x: auto;
  overflow-y: hidden;
  /* place-content: center; */
}
.gbbSlotFooterProductContainer {
      position: relative;
      height: 70px;
      width: 75px;
      border-radius: 8px;
      display: grid;
      place-content: center;
}
img.gbbSlotFooterProductImage {
  height: 100%;
  object-fit: contain;
  width: 100%;
}
.gbbSlotFooterProductImageContainer {
        height: 70px;
        width: 75px;
        margin: 0;
            border: 1px solid #cfc9c9;
              overflow: hidden;
              border-radius: 8px;
}
.gbbSlotFooterProductContainerEmpty {
  border: 1px dashed;
  background: #f1f1f1;
}
.gbbSlotFooterProductQuantity {
  position: absolute;
  bottom: 5%;
  font-size: 12px;
  right: 2%;
  background: black;
  color: white;
  padding: 0px 10px;
  border-radius: 10px;
}
.gbbSlotFooterProductRemoveButton{
  align-items: center;
  position: absolute;
  cursor: pointer;
  top: 0;
  /* right: -5px; */
  height: 15px;
  display: flex;
}
.gbbSlotFooterProductsContainerWrapper {
  display: grid;
  justify-content: center;
}
  .gbbProductsFooterHTMLForMobile .gbbSlotFooterProductContainer ,
  .gbbProductsFooterHTMLForMobile .gbbSlotFooterProductImageContainer{
    height: 60px;
    width: 65px;
  }
  .gbbProductsFooterHTMLForMobile .gbbSlotFooterProductQuantity {
    font-size: 10px;
}
.gbbDiscountRibbon {
  background: red;
  color: white;
  font-weight: bold;
  width: fit-content;
  padding: 2px 8px;
  position: absolute;
  top: 25px;
  right: 0;
  font-size: 12px;
}



/* @media (max-width: 900px) { */
  /* .gbbProductQuantityHTML.productMaxQuantityReached {
      font-size: 12px;
  } */
/* } *//***************************************************Landing page CSS*******************************************************************/
* {
  margin: 0;
  padding: 0;
}
.gbbReviewPageHTMLContent {
  display: grid;
  grid-gap: 20px;
}
/* review page banner css */
.gbbReviewPageBanner {
  display: grid;
  position: relative;
}
.gbbReviewPageBannerImage {
  display: grid;
  object-fit: cover;
  width: 100%;
  /* width: 100vw; */
  height: 40vw; /*20vw for desktop*/
}
.gbbReviewPageBannerText {
  font-size: 14px;
  /* color: #fff; */
}
.gbbReviewPageBannerSubText {
  font-size: 12px;
  /* color: #fff; */
}
.ReviewPageBannerButton {
  padding: 10px;
  font-size: 12px;
  width: 100%;
  border-radius: 8px;
  border: 2px solid #ffff;
  cursor: pointer;
}
.gbbReviewPageBannerTextWrapper {
  /* position: absolute; */
  top: 55%;
  left: 8%;
  /* top: 20%;
    left: 10%; */
  width: max-content;
  display: grid;
  grid-template-rows: 0.2fr 0.4fr;
  grid-gap: 10px;
  grid-gap: 5px;
  justify-items: center;
  text-align: center;
  width: 70vw;
  padding: 10px;
}

.gbbReviewPageBodyContainer {
  display: grid;
  justify-self: center;
  width: 95%;
}

.gbbReviewPageTotalBlock {
  display: grid;
  grid-auto-flow: column;
  grid-template-columns: auto auto 2fr;
  border-radius: 5px;
  color: #000;
}
.gbbReviewPageTotalBlockPrice {
  display: grid;
  justify-self: center;
  align-self: center;
  padding: 5px 5px;
}
.gbbReviewPageTotalBlockPriceTitle {
  font-size: 12px;
}

.gbbReviewPageTotalBlockPriceValue {
  font-weight: 700;
}
.gbbReviewPageTotalBlockDelivery {
  display: grid;
  justify-self: center;
  align-self: center;
  padding: 5px 5px;
}
.gbbReviewPageTotalBlockDeliveryTitle {
  font-size: 12px;
}
.gbbReviewPageTotalBlockDeliveryTitleValue {
  font-weight: 700;
}

.gbbReviewPageTotalBlockActions {
  display: grid;
  /* grid-template-columns: 1fr auto auto; */
  grid-template-columns: 1fr 1fr;
  grid-auto-flow: column;
  justify-items: end;
  grid-gap: 5px;
  /* padding: 5px 5px; */
  margin-top: 10px;
  justify-items: right;
  align-items: center;
}

.gbbReviewPageTotalBlockActionsBack {
  background-color: grey;
  padding: 5px 10px;
  text-align: center;
  color: #fff;
  border-radius: 5px;
  justify-self: left;
  font-size: 12px;
  cursor: pointer;
}

.gbbReviewPageTotalBlockActionsCheckout {
  padding: 5px 10px;
  text-align: center;
  color: #000;
  border-radius: 5px;
  font-size: 12px;
  cursor: pointer;
  width: 100%;
  font-weight: 500;
}
.gbbReviewPageProductList {
  /* padding-top: 20px; */
}
.gbbReviewPageProductListItems {
  display: grid;
  margin: 10px 0px;
  /* padding: 0px 10px; */
  border-top: 2px solid #f1f2f3;
  border-bottom: 2px solid #f1f2f3;
}
.gbbReviewPageProductListItem,
.gbbReviewPageProductItemsHeaders {
  display: grid;
  grid-auto-flow: column;
  grid-template-columns: 2fr 1fr 1fr;
}
.gbbReviewPageProductListItem {
  font-size: 12px;
}

.gbbReviewPageProductListItemName,
.gbbReviewPageProductItemsHeadersProduct,
.gbbReviewPageProductItemsHeadersQuantity,
.gbbReviewPageProductItemsHeadersPrice {
  padding: 5px 5px;
  font-weight: 600;
}
.gbbReviewPageProductItemsHeadersProduct {
  text-align: left;
}
.gbbReviewPageProductItemsHeadersQuantity {
  text-align: center;
}
.gbbReviewPageProductItemsHeadersPrice {
  text-align: right;
}
.gbbReviewPageProductListItemQty {
  padding: 5px 5px;
  text-align: center;
}
.gbbReviewPageProductListItemPrice {
  padding: 5px 5px;
  text-align: right;
  display: grid;
  grid-template-columns: max-content;
  justify-content: end;
}
.gbbReviewPageProductListItemRemoveBtn {
  padding: 5px 5px;
  font-size: 12px;
  justify-self: end;
  cursor: pointer;
  color: #aba6a6;
}
.gbbReviewPageProductListTitle {
  font-size: 15px;
  font-weight: 600;
}
/**********ADD ON PRODUCTS HTML ****/
.gbbReviewPageHTMLContent .gbbProductItem {
  /* width: auto; */
  display: grid;
  width: 140px;
  grid-template-rows: 90px 0.1fr 0.1fr;
  grid-gap: 5px;
}
.gbbReviewPageHTMLContent .gbbProductsContainer {
  overflow-x: auto;
  display: grid;
  justify-self: center;
}
.gbbReviewPageHTMLContent .gbbProductsItemsContainer {
  display: grid;
  grid-auto-flow: column;
  grid-template-columns: auto;
  grid-gap: 10px;
  overflow-x: auto;
}
.gbbReviewPageHTMLContent .gbbProductTextContainer {
  align-self: normal;
}
.gbbReviewPageHTMLContent .gbbProductItemTitle {
  color: black;
  white-space: nowrap;
  text-overflow: ellipsis;
  width: 120px;
  display: block;
  overflow: hidden;
}
.gbbReviewPageHTMLContent .gbbProductImageContainer {
  position: relative;
  width: 100%;
  height: 100%;
  border: 1px solid #cfc9c9;
  overflow: hidden;
}

.gbbReviewPageSubTotalCartWrapper {
  display: grid;
  grid-template-columns: 1fr 1fr;
}

.gbbReviewPageSubTotalCart {
  text-align: end;
  grid-column: 2/3;
}

.gbbReviewPageSubTotalCartLabel {
  display: grid;
  font-size: 14px;
  font-weight: 600;
  justify-content: end;
  grid-template-columns: max-content;
}
.gbbReviewPageHTMLContent .gbbProductQuantityRemoveButton,
.gbbReviewPageHTMLContent .gbbProductQuantityAddButton {
  height: 25px;
  width: 25px;
  font-size: 14px;
}
.gbbReviewPageHTMLContent .gbbProductActionContainer {
  grid-auto-flow: row !important;
  grid-gap: 10px !important;
}
.gbbReviewPageHTMLContent .gbbPrevImage,
.gbbReviewPageHTMLContent .gbbNextImage {
  padding: 0;
  width: 2px;
  margin-top: 0;
  top: 40%;
  background: none;
  color: grey;
}
.gbbReviewPageBodyContainer {
  margin: 20px;
}
.gbbReviewPageHTMLContent .gbbNextImage {
  right: 10px;
}
@media only screen and (min-width: 600px) {
  .gbbReviewPageProductListTitle {
    font-size: 20px;
  }
  .gbbReviewPageProductListItem {
    font-size: 15px;
  }

  .gbbReviewPageBannerImage {
    height: 22vw;
  }
  .gbbReviewPageBannerTextWrapper {
    /* width: 30vw;
        top: 15%; */
    width: 40vw;
    top: 50%;
    left: 20%;
  }
  .gbbReviewPageBodyContainer {
    width: 80%;
    margin: 20px;
  }
  .gbbReviewPageTotalBlockPrice {
    padding: 5px 20px;
  }
  .gbbReviewPageTotalBlockDelivery {
    padding: 5px 20px;
  }
  .gbbReviewPageTotalBlockActionsBack {
    font-size: 14px;
    /* grid-column: 2/2; */
  }

  .gbbReviewPageTotalBlockActionsCheckout {
    font-size: 16px;
    width: 80%;
    /* grid-column: 3/3; */
  }

  .gbbReviewPageTotalBlockActions {
    /* grid-template-columns: 2fr auto auto; */
    grid-template-columns: 1fr 1fr;
    grid-gap: 15px;
    /* padding: 5px 15px; */
    /* padding: 5px 5px; */
  }

  /* .gbbReviewPageHTMLContent .gbbProductItem{
        grid-template-rows: auto;
    } */
  .gbbReviewPageHTMLContent .gbbProductItem {
    display: grid;
    width: 170px;
    grid-template-rows: 110px 0.1fr 0.1fr;
    grid-gap: 5px;
  }
}

@media (min-width: 1023px) {
  .gbbReviewPageProductListItem {
    font-size: 16px;
  }
  .gbbReviewPageTotalBlockActionsBack {
    font-size: 16px;
  }

  .gbbReviewPageSubTotalCartLabel {
    font-size: 16px;
  }

  .gbbReviewPageDiscountAppliedLabel {
    font-size: 16px;
  }
  .gbbReviewPageTotalBlockActionsCheckout {
    font-size: 16px;
    width: 60%;
  }
  .gbbReviewPageBannerTextWrapper {
    width: 35vw;
  }
  .gbbReviewPageBannerImage {
    height: 18vw;
  }

  .gbbBodyWrapper {
    margin: 0 10%;
  }
  .gbbReviewPageBannerTextWrapper {
    /* grid-gap: 14px; */
    top: 55%;
    left: 20%;
  }
  .gbbReviewPageBannerText {
    font-size: 22px;
  }
  .gbbReviewPageBannerSubText {
    font-size: 15px;
    /* width: 45%; */
  }
  .gbbReviewPageBannerButtonWrapper {
  }
  .ReviewPageBannerButton {
    padding: 12px;
    font-size: 18px;
    width: 100%;
  }

  .gbbReviewPageTotalBlockActions {
    /* grid-template-columns: 3fr auto auto; */
    grid-template-columns: 1fr 1fr;
    grid-gap: 15px;
    margin-top: 10px;
    /* padding: 5px 15px; */
    /* padding: 5px 5px; */
  }

  .gbbReviewPageHTMLContent .gbbProductsItemsContainer {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }

  .gbbReviewPageHTMLContent .gbbProductItem {
  }
}

@media (min-width: 1192px) {
  .gbbReviewPagePrecuratedBoxesLabel {
    font-size: 18px;
  }
  /* .gbbNavigationItemsContainer::before{
        top: 45px;
    } */
}

/* this  {is the css code */
.gbbBundleQuantityHTMLContainer {
  grid-template-columns: 0fr 0fr;
  grid-gap: 0px;
  display: grid;
  grid-auto-flow: column;
  -webkit-tap-highlight-color: transparent;
}

.gbbBundleChangeButton {
  padding-left: 9px;
  background: #51d5c7;
  border: none;
  border-radius: 5px;
  width: 35px;
  height: 35px;
  font-size: 24px;
  justify-self: center;
  cursor: pointer;
  position: relative;
  user-select: none;
}

.gbbBundleQuantityWrapper {
  width: 100%;
  display: flex;
  justify-content: end;
  flex-direction: row;
}

/* bundle from product */
.gbbBundleQuantityHTML {
  width: 100%;
  display: grid;
  grid-auto-flow: column;
  grid-gap: 15px;
  align-items: center;
}

.gbbBundleQuantityHeading {
  font-weight: bold;
  font-size: 14px;
}

.gbbBundleQuantityLabel {
  text-align: center;
  font-size: 16px;
  user-select: none;
}
.gbbSummaryPageHTML{
  margin-bottom: 100px;
}
.gbbSummaryPageBodyWrapper{
    display: grid;
    grid-gap: 10px;
}
.gbbSummaryPageBundleDetailsContainer{
    display: grid;
    grid-template-columns: 1fr 0.2fr;
    align-items: start;
}
.gbbSummaryPageBundleDetails{
    display: grid;
    grid-gap: 5px;
}
.gbbSummaryPageBundleDetailsHTML{
    display: grid;
    grid-template-columns: 0.1fr 1fr;
    grid-gap: 10px;
    padding: 10px;
    border:2px solid #f1f2f3;
    margin-bottom: 10px;
    /* grid-column: 1/3; */
}
.gbbSummaryPageBundleImage{
    width: 60px;
    height: 60px;
    object-fit: contain;
}
.gbbSummaryPageBundleImageContainer{
    display: grid;
    justify-content: center;
}
.gbbSummaryPageProductListItemName{
  color: #848484;
  font-weight: 600;
}
.gbbSummaryPageProductListItemName, .gbbSummaryPageProductQtyPriceContainer{
    /* padding: 5px 5px; */
    font-size: 12px;
    text-wrap: balance;

}

.gbbSummaryPageProductTitleQtyPriceContainer{
    display: grid;
    grid-template-columns: 1fr 0.2fr;
}
.gbbSummaryPageProductQtyPriceContainer{
    display: grid;
    grid-auto-flow: column;
    grid-gap: 10px;
    grid-template-columns: 1fr 1fr;
}
.gbbSummaryPageBundleQuantityAddButton{
    justify-self: right;
    -webkit-tap-highlight-color: transparent;
}
.gbbSummaryPageBundleQuantityRemoveButton{
    justify-self: left;
    -webkit-tap-highlight-color: transparent;
}
.gbbSummaryPageBundleQuantityAddButton:active, .gbbSummaryPageBundleQuantityRemoveButton:active {
    transform: scale(0.95);
}
.gbbSummaryPageQuantityAddButtonWrapper, .gbbSummaryPageQuantityRemoveButtonWrapper{
  position: absolute;
  top: 10px;
  left: 11px;
  transform: translate(-50%, -50%);
  -webkit-tap-highlight-color: transparent;
  user-select: none;
}
.gbbSummaryPageBundleQuantityAddButton, .gbbSummaryPageBundleQuantityRemoveButton{
    background: #000000;
    color:#ffffff;
    border: none;
    border-radius: 5px;
    width: 20px;
    height: 20px;
    font-size: 14px;
    justify-self: center;
    cursor: pointer;
    position: relative;
    user-select: none;
}
.gbbSummaryPageBundleQuantityAddButton{
  justify-self: right;
  -webkit-tap-highlight-color: transparent;
}
.gbbSummaryPageBundleQuantityRemoveButton{
  justify-self: left;
  -webkit-tap-highlight-color: transparent;
}
.gbbSummaryPageBundleQuantityAddButton{

}
.gbbSummaryPageBundleItemsLabel{
  font-size: 14px;
}
.gbbSummaryPageBundleTitle{
    font-size: 14px;
    font-weight: 700;
}
.gbbSummaryPageBundleQuantityContainer{
    display: grid;
    grid-template-columns: auto auto auto;
    grid-gap: 15px;
    align-items: center;
    width: 20px;
}
.gbbSummaryPageBundleQuantityText{
    text-align: center;
}
.gbbSummaryPageProductListItemPrice{
    font-weight: 600;
    justify-self: end;
}
.gbbSummaryPageProductListItemQty{
  justify-self: end;
}
.gbbOrderDetailsHTMl, .gbbSummaryPageSubscriptionHTML{
    padding: 15px;
    display: grid;
    grid-gap: 10px;
    background: #f1f2f3;
}
.gbbOrderDetailsHeading, .gbbScheduleDeliveryHeadingLabel{
    font-weight: 600;
}
.gbbSummaryPageSubTotalCart, .gbbSummaryPageDiscountAppliedContainer, .gbbSummaryPageTotalCartValueContainer{
    display: grid;
    grid-template-columns: 1fr 1fr;
}
.gbbSummaryPageSubTotalCartLabel, .gbbSummaryPageDiscountAppliedLabel, .gbbSummaryPageTotalCartValueLabel{
    font-weight: 600;
    color: #848484;
}
.gbbScheduleDeliveryDateLabel{
    font-weight: 600;
}
.gbbSummaryPageSubTotalValue, .gbbSummaryPageDiscountAppliedValue, .gbbSummaryPageTotalCartValue{
    justify-self: end;
    font-weight: 600;
}
.gbbSummaryPageBundleProductsMainContainer{
    /* display: grid; */
    /* align-items: center; */
    /* grid-column: span 2; */
    /* grid-column-start: 2; */
    white-space: nowrap;
}
.gbbSummaryPageBundleImageTitleContainer{
    display: grid;
    grid-template-columns: 0.2fr 1fr;
    align-items: center;
}
/* .gbbSummaryPageBundleProductsContainer{
    grid-column: 2;
} */
.gbbSummaryPageBundlePriceLabel{
    font-weight: 600;
    text-align: end;
    justify-self: end;
}
.gbbSummaryPageBundleRemoveButton{
    font-size: 14px;
    color: #ce6b6b;
    text-align: end;
    cursor: pointer;
}
.gbbSummaryPageBundlePriceContainer{
    display: grid;
    grid-template-columns: 1fr min-content;
    grid-gap: 5px;
}
.gbbSummaryPageBundleDiscountedPrice{
    font-weight: 600;
    justify-self: end;
}
.gbbSummaryPageActionButtons{
    display: grid;
    /* grid-template-columns: 0.4fr 1fr; */
    grid-gap: 10px;
}
.gbbSummaryPageBackButton{
    background-color: grey;
    padding: 10px;
    text-align: center;
    color: #fff;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    border: none;
    display: grid;
    align-self: center;
}
.gbbSummaryPageCheckoutButton, .gbbSummaryPageCreateNewBoxButton, .gbbUnavailableProductsModalFooterBackBtn, .gbbUnavailableProductsModalFooterCheckoutBtn{
    padding: 10px 10px;
    text-align: center;
    color: #000;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    width: 100%;
    font-weight: 500;
    background: black;
    color: white;
    border: none;
}
.gbbUnavailableProductsModalFooter{
  display: grid;
  grid-gap: 10px;
}
.gbbSummaryPageBanner {
    display: grid;
    position: relative;
  }
  .gbbSummaryPageBannerImage {
    display: grid;
    object-fit: cover;
    width: 100%;
    /* width: 100vw; */
    height: 40vw; /*20vw for desktop*/
  }
  .gbbSummaryPageBannerText {
    font-size: 14px;
    /* color: #fff; */
  }
  .gbbSummaryPageBannerSubText {
    font-size: 12px;
    /* color: #fff; */
  }
  .gbbSummaryPageBannerTextWrapper {
    /* position: absolute; */
    top: 55%;
    left: 8%;
    /* top: 20%;
      left: 10%; */
    width: max-content;
    display: grid;
    grid-template-rows: 0.2fr 0.4fr;
    grid-gap: 10px;
    grid-gap: 5px;
    justify-items: center;
    text-align: center;
    width: 70vw;
    padding: 40px 10px;
  }
  .gbbSummaryPageBannerText {
    font-size: 14px;
    /* color: #fff; */
  }
  .gbbSummaryPageBannerSubText {
    font-size: 12px;
    /* color: #fff; */
  }
  .gbbScheduleDeliveryWrapper{
    display: grid;
    grid-gap: 10px;
    padding: 15px;
    background: #f1f2f3;
  }
  .gbbSummaryPageDeliverOrderDetailsDiv{
    /* padding: 10px;
    background: #f1f2f3; */
  }
  .gbbSummaryPageBundleTitleContainer{
    display: flex;
    gap: 10px;
    align-items: center;
  }
  .gbbEmptySummaryPageWrapper{
    margin-bottom: 100px;
  }
  .gbbEmptySummaryPageWrapper, .gbbEmptySummaryPageBannerTextWrapper{
    display: grid;
    justify-content: center;
    align-items: center;
    grid-gap: 10px;
  }
  .EmptySummaryPageAction{
    text-align: center;
    padding: 10px;
    background: black;
    color: white;
    border-radius: 5px;
    cursor: pointer;
  }
  .gbbEmptySummaryPageBannerText{
    text-align: center;
  }
  .gbbEmptySummaryPageBannerImage{
    width: 250px;
    height: 250px;
    object-fit: contain;
  }
  .gbbOrderSubtotalTotalContainer{
    display: grid;
    /* grid-template-columns: 1fr 1fr; */
  }
  .gbbSummaryPageBundleQuantity{
    justify-self: end;
  }
  .gbbSummaryPageBundleItemsLabel{
    color: #848484;
  }
  .gbbSummaryPageBundleItemsLabel{
    display: none;
  }
  .gbbSummaryPageBundleDetailsWithProducts{
    display: grid;
    grid-template-rows: min-content;
    grid-gap: 10px;
    overflow-wrap: break-word;

  }

  .gbbFooterDiscountedTotalValue, .gbbFooterOriginalTotalValue, .gbbFooterTotalLabel {
    white-space: nowrap !important;
  }
  
  .gbbSummaryPageDiscountAppliedWrapper{
    display: grid;
    grid-gap: 10px;
  }
  .gbbSummaryPageOneTimeSubscriptionDiv, .gbbSummaryPageSubscriptionAndSaveInputAndLabel{
    display: grid;
    grid-template-columns: min-content 1fr;
    grid-gap: 10px;
    align-items: center;
  }
  .gbbSubscriptionDropDownSelect{
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #cbc2c2;
    border-radius: 5px;
    border: 1px solid #D3D5D6;
  }
  .gbbSummaryPageSubscriptionAndSaveDiv{
    display: grid;
    grid-gap: 10px;
  }
  .gbbSummaryPageOneTimeSubscriptionInput, .gbbSummaryPageSubscriptionAndSaveInput{
    width: 15px;
  }
  .gbbSummaryPageSubscriptionAndSaveLabel, .gbbSummaryPageOneTimeSubscriptionLabel{
    cursor: pointer;
  }
  .gbbSubscriptionDeliveryFrequencyLabel{
    font-size: 12px;
    text-transform: uppercase;
  }
  /* .gbbSummaryPageCreateNewBoxButtonWrapper{
    padding: 5px 10px;
    width: fit-content;
    background: black;
    color: white;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    /* text-decoration: underline; 
    border-radius: 5px;
  }*/
  .gbbSummaryPageBundleEditButton{
    font-size: 14px;
    text-align: end;
    cursor: pointer;
    /* text-decoration: underline; */
    font-weight: bold;
  }
  .gbbSummaryPageBundleEditRemoveButtons{
    display: grid;
    grid-template-columns: 1fr 1fr;
    align-items: center;
    grid-gap: 10px;
  }
  .gbbPreparingBundleMainContainer, .gbbUnavailableProductsMainContainer, .gbbActivatePricingMainContainer{
    position: fixed;
    left: 0;
    right: 0;
    bottom: 0;
    top: 0;
    background-color: rgba(24,24,24,0.8);
    z-index: 1000000000;
  }
  .gbbPreparingBundleContainerModal{
    position: fixed;
    z-index: 1000000000;
    transform: translate(0, -50%);
    background: #ffff;
    border-radius: 5px;
    text-align: center;
    padding: 10px;
    max-height: 95vh;
    /* left: 5vw;
    top: 5vh;
    right: 5vw; */
    left: 25vw;
    right: 25vw;
    top: 50vh;
    display: grid;
    grid-gap: 10px;
    justify-content: center;
  }

  @media screen and (min-width: 600px) {
    .gbbPreparingBundleContainerModal{
      left: 35vw;
      right: 35vw;
    }
    
  }

  .gbbUnavailableProductsContainerModal{
    position: fixed;
    z-index: 1000000000;
    transform: translate(0, -50%);
    background: #ffff;
    border-radius: 5px;
    text-align: center;
    padding: 10px;
    max-height: 95vh;
    /* left: 5vw;
    top: 5vh;
    right: 5vw; */
    left: 20vw;
    right: 20vw;
    top: 50vh;
    display: grid;
    grid-gap: 10px;
  }
  .gbbPreparingBundleHeader{
    font-weight: 600;
    font-size: 14px;
  }
  .gbbPreparingBundleGif{
    width: 120px;
    max-width: 100%;
  }
  .gbbUnavailableProductsModalDiscountsMayNotApplyText{
    color: grey;
  }
  .gbbActivatePricingContainerModal{
    position: fixed;
    z-index: 1000000000;
    transform: translate(-50%, -50%);
    background: #ffff;
    border-radius: 5px;
    text-align: center;
    padding: 2rem 1rem;
    max-height: 95vh;
    left: 50%;
    top:50%;
    display: grid;
    grid-gap: 10px;
    width:300px;
  }
  .gbbActivatePricingImg{
    width:150px;
    height:150px;
  }
  .gbbActivatePricingHeader{
    font-weight: 600;
    font-size: 1.7rem;
    color:#8C4444;
    line-height:initial;
  }
  .gbbActivatePricingDescription{
    font-size: 1.3rem;
    font-weight:500;
    line-height:initial;
  }
  .gbbActivatePricingButton{
    background-color: #8C4444;
    color: #ffffff;
    border-radius:5px;
    padding:1rem 2.5rem;
    font-weight:550;
    cursor:pointer;
    border:none;
  }
  .gbbActivatePricingNoteContainer{
    font-size: 1.2rem;
  }
  .gbbActivatePricingPoweredByContainer{
    display:grid;
    justify-items:end;
    font-size: 1.1rem;
  }
  

@media (min-width: 600px) {
    .gbbSummaryPageBannerImage {
        height: 22vw;
      }
      .gbbSummaryPageBundleItemsLabel{
        display: block;
      }
      .gbbSummaryPageBannerTextWrapper {
        /* width: 30vw;
            top: 15%; */
        width: 40vw;
        top: 50%;
        left: 20%;
      }
    .gbbSummaryPageProductListItemName, .gbbSummaryPageProductQtyPriceContainer{
        font-size: 14px;
    }

    .gbbSummaryPageBundleTitle{
      font-size: 16px;
    }
    .gbbSummaryPageBundleImage{
      width: 100px;
      height: 100px;
    }
    .gbbSummaryPageBundleQuantityAddButton, .gbbSummaryPageBundleQuantityRemoveButton{
      width: 25px;
      height: 25px;
    }
    .gbbSummaryPageQuantityAddButtonWrapper, .gbbSummaryPageQuantityRemoveButtonWrapper{
      top: 12px;
      left: 13px;
    }
    .gbbSummaryPageOneTimeSubscriptionInput, .gbbSummaryPageSubscriptionAndSaveInput{
      width: 20px;
      height: 20px;
    }
    .gbbPreparingBundleGif{
      width: 150px;
    }
    .gbbActivatePricingContainerModal{
      width:500px;
    }
}
@media (min-width: 1023px) {
      .gbbSummaryPageBodyWrapper{
        margin: 0 20px;
      }
      .gbbSummaryPageBannerImage {
        height: 18vw;
      }
      .gbbSummaryPageBannerText {
        font-size: 22px;
      }
      .gbbSummaryPageBannerSubText {
        font-size: 15px;
        /* width: 45%; */
      }
      .gbbSummaryPageBannerTextWrapper {
        width: 35vw;
        top: 55%;
        left: 20%;
      }
      .gbbSummaryPageBannerText {
        font-size: 22px;
      }
      .gbbSummaryPageBannerSubText {
        font-size: 15px;
        /* width: 45%; */
      }
      .gbbSummaryPageBodyWrapper{
        grid-template-columns: 1fr 0.5fr;
    }
    .gbbSummaryPageBundleDetailsHTML{
        /* grid-row-start: 1;
        grid-row-end: span 2; */
    }
    .gbbSummaryPageDeliverOrderDetailsDiv{
        /* height: 100%; */
    }
    .gbbSummaryPageOrderDetailsUI{
        grid-column-start: 2;
    }
    .gbbSummaryPageBundlePriceContainer{
      /* grid-template-columns: 1fr 0.3fr; */
      grid-gap: 10px;
  }
  .gbbSummaryPageBundlePriceLabel{
    /* text-align: unset; */
  }
  .gbbPreparingBundleGif{
    width: 200px;
  }
  .gbbUnavailableProductsContainerModal{
    left: 30vw;
    right: 30vw;
  }
  .gbbUnavailableProductsModalFooter{
    grid-template-columns: 1fr 1fr;
  }
}
.gbbSummaryPageWrapper.gbbSubscriptionBundle .gbbSummaryPageCreateNewBoxButton {
  display: none;
  /*--- TEMP FIX ----*/
}

.gbbSummaryPageBundleSubscriptionDetails {
  font-size: 14px;
}
:root {
    --gbb-gbbSubscriptionBundle-purchase-option-active-color: #2B2B2B;
    --gbb-gbbSubscriptionBundle-purchase-option-active-bg-color: #FFFFFF;
    --gbb-gbbSubscriptionBundle-purchase-option-inactive-color: #888888;
    --gbb-gbbSubscriptionBundle-purchase-option-inactive-bg-color: #F0F0F0;
    --gbb-gbbSubscriptionBundle-purchase-option-stroke-radius: 8px;
    --gbb-gbbSubscriptionBundle-purchase-option-stroke-color: #D5D5D5;
    --gbb-gbbSubscriptionBundle-purchase-option-stroke-width: 2px;

    --gbb-gbbSubscriptionBundle-selling-plan-navigation-active-bg-color: #FFFFFF;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-active-title-color: #333333;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-title-color: #333333;

    --gbb-gbbSubscriptionBundle-page-title-color: #000000;
    --gbb-gbbSubscriptionBundle-page-title-font-weight: bold;
    --gbb-gbbSubscriptionBundle-header-bg-color: #EDEDED;

    --gbb-gbbSubscriptionBundle-selling-plan-navigation-next-prev-icon-bg-color: #2B2B2B;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-active-discount-pill-bg-color: #CAE983;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-active-discount-pill-text-color: #000000;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-discount-pill-text-color: #000000;
    --gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-discount-pill-bg-color: #9D9D9D;

    --gbb-gbbSubscriptionBundle-product-discount-ribbon-bg-color: #FF0000;
    --gbb-gbbSubscriptionBundle-product-discount-ribbon-text-color: #FFFFFF;

    --gbb-gbbSubscriptionBundle-subscription-frequency-label-text-color: #333333;
    --gbb-gbbSubscriptionBundle-subscription-frequency-label-font-weight: bold;
    --gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-color: #B7B7B7;
    --gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-width: 2px;
    --gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-radius: 10px;
}
.gbbPurchaseOptionsWrapper{
    display: grid;
    place-content: center;
    gap: 5px;
}
.gbbPurchaseOptionsTitle{
    color:var(--gbb-gbbSubscriptionBundle-subscription-frequency-label-text-color);
    text-align: center;
    font-weight: var(--gbb-gbbSubscriptionBundle-subscription-frequency-label-font-weight);
}
.gbbPurchaseOptionsButtonWrapper {
    display: grid;
    grid-template-columns: repeat(2, max-content);
    align-items: center;
    place-content: center;
}
.gbbPurchaseOption{
    padding: 6px 14px;
    font-weight: bold;
    text-transform: capitalize;
    cursor: pointer;
    /* border:var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-width) solid var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-color); */
    background-color: var(--gbb-gbbSubscriptionBundle-purchase-option-inactive-bg-color);
    color: var(--gbb-gbbSubscriptionBundle-purchase-option-inactive-color);
}
.gbbPurchaseOption {
    width: fit-content;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    user-select: none;
    background-color: rgba(0, 0, 0, 0.16);
    color: rgba(255, 255, 255, 0.7);
    transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1);
    transition-duration: 300ms;
    transition-property: color, background-color, box-shadow;
    display: flex;
    align-items: center;
    box-shadow: rgba(0, 0, 0, 0.15) 0px 2px 1px 0px inset, rgba(255, 255, 255, 0.17) 0px 1px 1px 0px;
    outline: none;
    justify-content: center;
}
.gbbPurchaseOption.active {
        background-color: #2d6737;
        color: white;
        box-shadow: rgba(0, 0, 0, 0.23) 0px -1px 1px 0px inset, rgba(255, 255, 255, 0.17) 0px -1px 1px 0px, rgba(0, 0, 0, 0.17) 0px 2px 4px 1px;
    }
.gbbPurchaseOption.active .gbbPurchaseOptionTextContent {
    transform: translateY(-2px);
}
.gbbPurchaseOption.active:hover {
    /* background-color: #34723f; */
    box-shadow: rgba(0, 0, 0, 0.26) 0px -1px 1px 0px inset, rgba(255, 255, 255, 0.17) 0px -1px 1px 0px, rgba(0, 0, 0, 0.15) 0px;
}
.gbbPurchaseOption:hover .gbbPurchaseOptionTextContent {
    transform: translateY(-2px);
}
.gbbPurchaseOption:hover {
    background-color: #2c2c2c;
    color: white;
    box-shadow: rgba(0, 0, 0, 0.23) 0px -1px 1px 0px inset, rgba(255, 255, 255, 0.17) 0px -1px 1px 0px, rgba(0, 0, 0, 0.17) 0px 2px 4px 1px;
}
.gbbPurchaseOption .gbbPurchaseOptionTextContent {
    font-size: 14px;
    font-weight: 600;
    pointer-events: none;
    transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1);
    transition-duration: 300ms;
    transition-property: transform;
    transform: translateY(0px);
}

.gbbPurchaseOption:hover .gbbPurchaseOptionTextContent {
    transform: translateY(-2px);
}
.gbbPurchaseOption:first-child{
    border-top-left-radius: var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-radius);
    border-bottom-left-radius: var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-radius);
}
.gbbPurchaseOption:last-child{
    border-top-right-radius: var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-radius);
    border-bottom-right-radius: var(--gbb-gbbSubscriptionBundle-purchase-option-stroke-radius);
}
.gbbPurchaseOption.active{
    background-color: var(--gbb-gbbSubscriptionBundle-purchase-option-active-bg-color);
    color: var(--gbb-gbbSubscriptionBundle-purchase-option-active-color);
}
.gbbSellingPlansNavigationTabsContainer {
        display: grid;
        grid-auto-flow: column;
        overflow-x: scroll;
        grid-auto-columns: 25%; /* make it dynamic width tabs */
        scrollbar-width: none;
}

.gbbSellingPlanNavigationDiscountText {
    font-size: 12px;
    background: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-discount-pill-bg-color);
    color: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-discount-pill-text-color);
    width: fit-content;
    padding: 2px 10px;
    border-radius: 12px;
}
.gbbSellingPlanNavigationTab.active .gbbSellingPlanNavigationDiscountText{
    background-color: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-active-discount-pill-bg-color);
    color: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-active-discount-pill-text-color);
}
.gbbSellingPlanNavigationTab {
    display: grid;
    place-content: center;
    text-align: center;
    cursor: pointer;
    position: relative;
    padding: 10px;
    place-items: center;
    border-top-left-radius: var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-radius);
    border-top-right-radius: var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-radius);
    border-bottom: var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-width) solid var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-color);
}

.gbbSellingPlansNavigationTitle{
    color: var(--gbb-gbbSubscriptionBundle-page-title-color);
    font-weight: var(--gbb-gbbSubscriptionBundle-page-title-font-weight);
}
.gbbSellingPlanNavigationTab.active {
    background-color: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-active-bg-color);
    border: var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-width) solid var(--gbb-gbbSubscriptionBundle-selling-plans-navigation-stroke-color);
    border-bottom: none;
}
.gbbSellingPlanNavigationTabTitle{
    color:var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-inactive-title-color)
}
.gbbSellingPlanNavigationTabTitle.active{
    color: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-active-title-color);
}
.gbbSellingPlansNavigationWrapper {
    display: grid;
    text-align: center;
    gap: 10px;
}
.gbbSubscriptionBundleWrapper {
    display: grid;
    gap: 20px;
    margin: 0 -12.5%;
    background: var(--gbb-gbbSubscriptionBundle-header-bg-color);
}
.gbbSellingPlansNavigationItemsWrapper {
    display: grid;
    align-items: center;
    gap: 20px;
}
.gbbSellingPlanNextNavigationIconWrapper{
    transform: rotate(180deg);
}
.gbbSellingPlanNextNavigationIconWrapper,
.gbbSellingPlanPrevNavigationIconWrapper{
    cursor: pointer;
}
.gbbSellingPlanNextNavigationIconWrapper svg g,
.gbbSellingPlanPrevNavigationIconWrapper svg g{
    fill: var(--gbb-gbbSubscriptionBundle-selling-plan-navigation-next-prev-icon-bg-color);
}

.gbbSellingPlansNavigationItemsWrapper:has(.gbbSellingPlanNextNavigationIconWrapper) {
    grid-template-columns: 30px 1fr 30px;
    padding: 0px 20px;
}

.gbbSubscriptionDiscountContent {
    background: var(--gbb-gbbSubscriptionBundle-product-discount-ribbon-bg-color);
    color: var(--gbb-gbbSubscriptionBundle-product-discount-ribbon-text-color);
    font-weight: bold;
    width: fit-content;
    padding: 2px 8px;
    position: absolute;
    top: 25px;
    right: 0;
    font-size: 12px;
}
.gbbPageBody:has(.gbbSubscriptionBundleWrapper){
    padding: 0px !important;
}
.gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="2"] .gbbSellingPlansNavigationTabsContainer,
.gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="3"] .gbbSellingPlansNavigationTabsContainer,
.gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="1"] .gbbSellingPlansNavigationTabsContainer{
    justify-content: center;
}
.gbbSubscriptionBundleWrapper:not(:has(.gbbSellingPlansNavigationWrapper)){
    padding-bottom: 20px;
}
@media only screen and (max-width: 500px) {
    .gbbSubscriptionBundleWrapper{
        margin: 0px;
    }
    .gbbPurchaseOption .gbbPurchaseOptionTextContent{
        font-size: 12px;
    }
    .gbbSellingPlansNavigationTabsContainer{
        grid-auto-columns: 33%;
    }
    .gbbSellingPlansNavigationItemsWrapper:has(.gbbSellingPlanNextNavigationIconWrapper){
        padding: 0px 5px;
    }
    .gbbSellingPlansNavigationItemsWrapper:has(.gbbSellingPlanNextNavigationIconWrapper) .gbbSellingPlansNavigationTabsContainer{
        grid-auto-columns: 100%;
    }
    .gbbSellingPlanNavigationTab{
        padding :5px;
    }
        .gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="2"] .gbbSellingPlansNavigationTabsContainer,
        .gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="3"] .gbbSellingPlansNavigationTabsContainer,
        .gbbSellingPlansNavigationItemsWrapper[data-total-selling-plans="1"] .gbbSellingPlansNavigationTabsContainer {
            justify-content: normal;
        }
 }
  @media only screen and (max-width: 1020px) {
      .gbbSubscriptionBundleWrapper {
          margin: 0px;
      }
  }/***************************************************Landing page CSS*******************************************************************/
*{
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: inherit;
}
main{
    padding: 0 !important;
}

p{
    padding: 0 ;
    margin: 0 ;
}
/* landing page banner css */
.gbbLandingPageBanner{
    display: grid;
    position: relative;
}
.gbbLandingPageBannerImage {
    display: grid;
    object-fit: cover;
    width: 100vw;
    height: 25vw;  /*20vw for desktop*/
}
.gbbLandingPageBannerText{
    font-size: 14px;
    color: black;
    text-align: center;
    margin: 2% 0%;
}
.gbbLandingPageBannerSubText{
    font-size: 12px;
    color: #fff;
}
.landingPageBannerButton{
    padding: 10px;
    font-size: 12px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    width: 50%;
    margin: 2% 0%;
}

.landingPageBannerButton:active {
    transform: scale(0.95);
}

.gbbMainPrecuratedBoxesContainer{
    margin: 10% 0%;
}
.gbbLandingPageBannerTextWrapper{
    position: absolute;
    top: 12%;
    left: 7%;
    width: max-content;
    display: grid;
    grid-template-rows: 0.2fr 0.4fr 0.2fr;
    grid-gap: 10px;
    justify-items: center;
    text-align: center;
}
/* landing page - navigation css */
.gbbNavigationItemsContainer{
    display: grid;
    /* grid-template-columns: 1fr 1fr 1fr; */
    grid-template-columns: repeat(auto-fit,minmax(50px,1fr));
    justify-content: center;
    position: relative;
    margin:2% 2%;
}
.gbbLandingPageNavigationItemsContainer{
    margin:2% 2%;
}
.gbbNavigationItem{
    cursor: pointer;
}
.gbbLandingPageNavigationItemsContainer::before{
    /* content: '';
    position: absolute;
    border-top: 5px solid #f1f2f3;
    left: 0;
    right: 0;
    top: 45px;
    z-index: -1; */
}
.gbbNavigationItem{
    justify-content: center;
    z-index: 1;
    display: grid;
    justify-items: center;
}
.gbbNavigationItemsContainer::before{
    content: '';
    position: absolute;
    border-top: 2px solid #d4d5d6;
    left: 0px;
    right: 0px;
    top: 22px;
    z-index: 0;
}


.gbbPreviousNavigationItemsButton , .gbbNextNavigationItemsButton{
    cursor: pointer;
    display: grid;
    justify-items: center;
    align-items: center;
    position: absolute;
    top: 10px;
    border-radius: 50%;
}

.gbbPreviousNavigationItemsButton {
    left:-12px;
}

.gbbNextNavigationItemsButton{
    right: -12px;
   
    transform: rotate(180deg);
    -webkit-transform: rotate(180deg);  
    -moz-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -ms-transform: rotate(180deg);
    /* rotate: 180deg; */
}


.gbbNavigationItemsContainer {
    display: grid;
    justify-items: center;
} 

.gbbNavigationStepContainer {
    display: grid;
    grid-template-rows: 1fr 0.2fr;
    justify-content: center;
    align-items: center;
}
.gbbNavigationImage {
    width: 100%;
    height: 100%;
}
.gbbNavigationStepImgContainer {
    background: white;
    text-align: center;
    border: 2px solid #d4d5d6;
    border-radius: 50%;
    padding: 4px;
    display: grid;
    align-items: center;
    justify-items: center;
    width: 40px;
    height: 40px;
    overflow: hidden;
}
.gbbNavigationTitle{
    font-size: 12px;
    font-weight: 600;
    text-align: center;
}
.gbbNavigationTitleContainer{
    display: grid;
    /* justify-content: center; */
    align-items: center; 
    /* width: 100%; */
    /* padding: 7px 25px; */
    /* text-align: center; */
}
/* landing page - precurated boxes css */
.gbbLandingPagePrecuratedBoxes{
    margin:20px 10px;
    display: grid;
    grid-gap: 20px;
}
.gbbLandingPagePrecuratedBoxesLabel {
    font-size: 16px; 
}
.gbbLandingPagePrecuratedBoxesCardWrapper{
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 12px;
}
.gbbPrecuratedBoxesCard{
    display: grid;
    grid-template-rows: 1fr 0.2fr;
    justify-content: center;
    background: #f1f2f3;
    padding: 20px;
    font-size: 16px;
    grid-gap: 15px;
}
.gbbPrecuratedBoxesCardImageContainer{
    width: 120px;
    height: 120px;
}
.gbbPrecuratedBoxesCardImage{
    width: 100%;
    height: 100%;
    object-fit: contain;
}
.gbbPrecuratedBoxesCardText{
    text-align: center;
}
.activeNavItem{
    border:  4px solid #ffffff;
}
.gbbLandingPageBannerButtonWrapper{
    text-align: center;
    display: grid;
    place-items: center;
}
.gbbPageHeader{
    position: relative;
}
.gbbPageHeaderText{
    position: absolute;
    top: 10%;
    z-index: 100;
    left: 30%;
    color: white;
    font-size: 16px;
    font-size: 14px;
}
.gbbtickMark {
    border: none;
    position: absolute;
    top: 5px;
}

.gbbtickMarkPseudo::before {
    display: block !important;
    position: absolute;
    left: 0;
    top: 50%;
    height: 50%;
    width: 3px;
    background-color: #ffffff;
    content: "";
    transform: translateX(10px) rotate(-45deg);
    transform-origin: left bottom;
}

.gbbtickMarkPseudo::after {
    display: block !important;
    position: absolute;
    left: 0;
    bottom: 0;
    height: 3px;
    width: 100%;
    background-color: #ffffff;
    content: "";
    transform: translateX(10px) rotate(-45deg);
    transform-origin: left bottom;
}

.checkmark {
    display:inline-block;
    width: 22px;
    height:22px;
    -ms-transform: rotate(45deg); /* IE 9 */
    -webkit-transform: rotate(45deg); /* Chrome, Safari, Opera */
    transform: rotate(45deg);
}

.checkmarkStem {
    position: absolute;
    width:3px;
    height:9px;
    background-color:#ccc;
    left:11px;
    top:6px;
}

.checkmarKick {
    position: absolute;
    width:3px;
    height:3px;
    background-color:#ccc;
    left:8px;
    top:12px;
}
.gbbPageHeader{
    position: relative;
}
.gbbPageHeader:after{
    /* content: " ";
    position: absolute;
    width: 75%;
    left: 10%;
    bottom: 10%;
    height: 50px;
    z-index: -1;
    -moz-box-shadow: 0px 4px #d4d5d6;
    -webkit-box-shadow: 0px 4px #d4d5d6;
    box-shadow: 0px 4px #d4d5d6; */
        /* right: 10px; */

}
/* .gbbPrecuratedPageHeader, .gbbPageHeaderWithoutLine{
    position: relative;
}
.gbbPageHeaderWithoutLine:after{
    display: none !important;
} */
.gbbAddProductPageSubtext,
.gbbPrecuratedBoxPageSubtext,
.gbbPersonalizePageSubtext,
.gbbChooseBoxPageSubtext,
.gbbMultipleCategoriesPageSubtext{
    font-size: 14px;
    color: black;
}

.page-container{
overflow : unset !important;
}
#dummy-chat-button-iframe{
display : none !important;
}

#dummy-chat-button{
display : none !important;
}

@media (min-width:600px){
    .gbbNavigationItemsContainer{
        margin: 2% 10%;  
    }
    .gbbLandingPageBannerImage{
        height: 20vw;
    }
    .gbbNavigationTitleContainer{
        padding: 8px 0px;
    }
    .gbbNavigationTitle{
        font-size: 14px;
    }
    .landingPageBannerButton{
        width: 40%;
    }
    .gbbPageHeaderText{
        top: 15%;
        left: 35%;
        font-size: 16px;
    }
    .gbbPageHeader:after{
        bottom: 7%;
    }

    .gbbAddProductPageSubtext,
    .gbbPrecuratedBoxPageSubtext,
    .gbbPersonalizePageSubtext,
    .gbbChooseBoxPageSubtext,
    .gbbMultipleCategoriesPageSubtext{
        font-size: 18px;
        color: black;
    }

}
@media (min-width:1024px){
    .gbbtickMark{
        /* top: 4%; */
    }
    .gbbLandingPageBannerImage{
        height: 18vw;
        width: 78vw;
    }
    .gbbBodyWrapper{
    margin: 0 10%;
    }
    
.gbbPreviousNavigationItemsButton {
    left:-24px;
}
.gbbNextNavigationItemsButton{
    right: -24px;
}
    .gbbMainPrecuratedBoxesContainer{
        margin: 5% 0%;
    }
    .gbbLandingPageBannerTextWrapper{
        grid-gap: 14px;
        top: 16%;
        left: 8%;
    }
    .gbbLandingPageBannerText{
        font-size: 25px;
    }
    .gbbLandingPageBannerSubText{
        font-size: 17px;
        /* width: 45%; */
    }
    .landingPageBannerButton{
        padding: 12px;
        font-size: 18px;
        width: 40%;
        border-radius: 10px;
    }
    .gbbNavigationItemsContainer{
         margin: 2% 20%;
        /* grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); */ 
    }
    /* .gbbNavigationStepImgContainer{
        height: 100px;
        width: 100px;
    } */
    .gbbNavigationImage{
        width: 100%;
        height: 100%;
    }
    .gbbLandingPagePrecuratedBoxesLabel{
        font-size: 18px;
    }
    .gbbLandingPagePrecuratedBoxesCardWrapper{
        display: grid;
        grid-template-columns: repeat(3,1fr);
        grid-gap: 15px;
    }
    .gbbAddProductPageSubtext,
    .gbbPrecuratedBoxPageSubtext,
    .gbbPersonalizePageWrapper,
    .gbbChooseBoxPageSubtext,
    .gbbMultipleCategoriesPageSubtext{
        font-size: 18px;
    }

    .gbbNavigationItemsContainer::before{
        /* top: 30%; */
    }
    .gbbNavigationItem{
        /* width: 100px;         */
    }
    .gbbNavigationTitleContainer{
        justify-content:normal;
        padding: 4px 2px;
        text-align: center;
    }
    .gbbPrecuratedBoxesCard{
        padding: 10px;
    }
    .gbbPrecuratedBoxesCardImageContainer{
        width: 235px;
        height: 235px;
    }
    .gbbPageHeaderText{
        top: 25%;
        left: 40%;

    }
}

.gbbAddProductPageSubtextWrapper:not(:empty),
.gbbPrecuratedBoxPageSubtextWrapper:not(:empty),
.gbbPersonalizePageSubtextWrapper:not(:empty),
.gbbChooseBoxPageSubtextWrapper:not(:empty),
.gbbMultipleCategoriesPageSubtextWrapper:not(:empty){
    display: grid;  
    margin: 10px;
    justify-content: center;
    text-align: center;
}



.gbbAddProductPageSubtext,
.gbbPrecuratedBoxPageSubtext,
.gbbChooseBoxPageSubtext,
.gbbMultipleCategoriesPageSubtext{
    font-size: 18px;
}

@media(min-width:1192px){
    .gbbLandingPagePrecuratedBoxesLabel{
        font-size: 18px;
    }
    .gbbNavigationItemsContainer::before{
        /* top: 45px; */
    }
}






/* .gbbLoadingScreen {
    display: grid;
    place-items: center;
    height: 80vh;
    margin: 0 auto;
    text-align: -webkit-center;
  } */
  /* .gbbLoadingScreenSpinner {
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid rgb(117, 117, 122);
    border-bottom: 16px solid rgb(117, 117, 122);
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
  }

  @-webkit-keyframes spin {
    0% {
      -webkit-transform: rotate(0deg);
    }

    100% {
      -webkit-transform: rotate(360deg);
    }
  } */
/* 
  .gbbLoadingSkeleon {
    opacity: .7;
    animation: skeleton-loading 1s linear infinite alternate;
  }
  .gbbLoadingSkeleon .skeleton-text {
    width: 100%;
    height: .5rem;
    margin-bottom: .25rem;
    border-radius: .125rem;
  }
  .gbbLoadingSkeleon .skeleton-text:last-child {
    margin-bottom: 0;
    width: 80%;
  }

  @keyframes skeleton-loading {
    0% {
      background-color: hsl(200, 20%, 70%);
    }
  100% {
      background-color: hsl(200, 20%, 95%);
    }
  }

  .gbbLoadingScreenSpinner {    
    width: 100%;
    height: 100%;
    display: block;
    background: linear-gradient(
        to right,
        rgba(255, 255, 255, 0),
        rgba(255, 255, 255, 0.5) 50%,
        rgba(255, 255, 255, 0) 80%
      ),
      lightgray;
    background-repeat: repeat-y;
    background-position: 0 0;
    animation: shine 1s infinite;
  }


  @keyframes shine {
    to {
      background-position: 100% 0;
    } 
  /* } */

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }


.gbbNavigationStepsContainer{
    max-width: 100%;
    width: 100%;
    table-layout: fixed;
    display: table;
}

.gbbNavigationStep{
    cursor: pointer;
    margin: 0 15px;
    text-align: center;
    display: table-cell;
    opacity: 0.6;
    color: rgba(58,58,58,1);
}

.gbbProgressBar{
    display: block !important;
    border-bottom: solid 2px rgba(217,225,230,1);
}

.gbbStepActive{
    opacity: 1;
    font-family: bold;
}

.gbbStepCompleted{
    opacity: 1;
}

.gbbNavigationStepCircle{
    display: block !important;
    margin: 0 auto;
    margin-top: -7px;
    width: 12px;
    height: 12px;
    background: white;
    border: solid 2px;
    border-radius: 50%;
}

.gbbNavigationContainerV2{
    margin:5% 15px;
}


.landingPageBannerButton,
.gbbProductAddButton,
.gbbProductQuantityRemoveButton,
.gbbProductQuantityAddButton,
.gbbProductVariantOptionValue,
.gbbProductVariantAddButton,
.gbbFooterNextButton,
.gbbFooterBackButton,
.gbbCustomerUploadsActionButton,
.gbbProductAddButton{
    cursor: pointer;
    user-select: none;
}

.gbbLoadingScreen{
    user-select: none;
    z-index: 1;
    /* background: #fff; */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: grid;
    justify-content: center;
    align-items: center;
}




.gbbHideScrollBar{
    overflow: hidden;
}
.gbbPageBody{
    height:100%;
    padding:10px;
}


.gbbProductItemCompareAtPrice{
    text-decoration: line-through;
    color: #999;
    font-size: 12px;
}
.gbbProductVariantOptionContainerHidden{
    display: none;
}

.gbbFooterOriginalTotalValue{
    color : #625f5f;
}


.gbbTagsAndPillHTMLContainer{
    display: inline;
}


.gbbProductTabImageContainer img {
    width: 100%;
    height: 100%;
}

.gbbMobileImageBanner , .gbbDesktopImageBanner {
    width: 100%;
  }

.gbbProductQuantityInput{
  width: 48px;  
  font-size: 16px;
  padding: 4px;
  border-radius: 5px;
}

.gbbProductQuantityInput{
    text-align: center;
}

.gbbProductQuantityInput::-webkit-outer-spin-button,
.gbbProductQuantityInput::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
.gbbProductQuantityInput[type=number] {
  -moz-appearance: textfield;
}

/* Mobile styles */
@media (max-width: 600px) {
    .gbbMobileImageBanner {
      display: block;
    }
    .gbbDesktopImageBanner {
      display: none;
    }
    .gbbProductQuantityHTML{
        grid-gap: 8px;
    }
    .gbbProductQuantityInput{
        width: 64px;
    }
    .gbbProductVariantModalDetailsContainer .gbbProductQuantityHTML{
        grid-gap: 8px;
    }
  }
  
  /* Desktop styles */
  @media (min-width: 601px) {
    .gbbMobileImageBanner {
      display: none;
    }
    .gbbDesktopImageBanner {
      display: block;
    }
  }

  .gbbAddProductPageBanners:empty{
     display: none;
  }


.gbbProductsCardLayoutV2 .gbbNavigationItemsContainer::before{
    content: none;
    }
  .gbbProductsCardLayoutV2 .gbbStepsProgressBarContainer{
    width: 100%;
    height: 6px;
    position: absolute;
    border-radius: 20px;
    overflow: hidden;
    top: 17px;
  }
  .gbbProductsCardLayoutV2 .gbbStepsProgressBar{
    width: 100%;
    background: #eeeeee;
    height: 100%;
  }
  .gbbProductsCardLayoutV2 .gbbStepsProgressBarFilled{
    display: block !important;
    background: black;
    width: 10%;
    height: 100%;
  }

  .gbbBundle-HTML footer, .gbbBundle-HTML .footer  {
    opacity: 0;
    visibility: hidden;
    transition: opacity 3s, visibility 3s;
    animation: showElement 3s forwards;
}

@keyframes showElement {
    from {
        opacity: 0;
        visibility: hidden;
    }
    to {
        opacity: 1;
        visibility: visible;
    }
}

.gbbPersonalizePageWrapper{
  /* margin: 10% 25%; */
}
.gbbPersonalizePageHTML{
  margin: 5% 5%;
  display:grid;
  grid-gap:40px;
  position: relative; 
  transform: translate(0px, -5%);
}

.gbbPersonalizePageHTMLContent{
    display:grid;
    grid-gap: 20px;
}

.greetingCardAllImagesContainer{
    display: grid;
    /* grid-template-columns: repeat(2,1fr); */
    grid-gap: 15px;
    padding: 10px;
    background: white;    
}


.gbbGreetingCardContainer,
.gbbGiftWrapContainer{
    display: grid;
    grid-gap: 10px;
}

.gbbGreetingCardImg,
.gbbGiftWrapImg{
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: white;
}

.greetingCardPreviewImage{
    height: 100px;
    width: 150px;
}
/* .greetingCardImage,.gbbGreetingCardListWrapper{ */
.greetingCardImage,
.giftWrapImage{
    width: 100%;
    height: 100%;
    /* object-fit: contain; */
    object-fit: cover;
    /* border: 2px solid white; */
    /* padding: 5px; */
    background: white;
}

.greetingCardWrapper,
.giftWrapWrapper{
    overflow-x: hidden;
    /* overflow-y: auto; */
    /* overflow-y: auto; */
    padding-right:5px;
    height: auto;
    /* max-height: 400px; */
    max-height: 350px;
    /* padding: 5px 10px; */
    /* border: 2px solid #D3D5D6; */
    border-radius: 5px;
}

.gbbGreetingCardShowAllImagesButtonWrapper{
    padding: 10px;
    background: white;
    height: fit-content;
}

.gbbGreetingCardShowAllImagesButton{
    padding:10px;
    border-radius: 5%;
}

.gbbGreetingCardDropDownWrapper,
.gbbGiftWrapDropDownWrapper{
    display: grid;
    /* grid-template-columns : 1fr; */
    grid-template-columns: 2fr 1fr;
    grid-template-rows: 1fr;
    padding: 0px 10px;
    border-radius: 5px;
  /* 
    border: 2px solid #D3D5D6;
    padding: 5px; */
}

.gbb_checkmark {
    display:inline-block;
    position:absolute;
    top:10px;
    left:10px;
    width: 22px;
    height:22px;
    -ms-transform: rotate(45deg); /* IE 9 */
    -webkit-transform: rotate(45deg); /* Chrome, Safari, Opera */
    transform: rotate(45deg);
}
.gbb_checkmark {
    top: 50%;
    left: 50%;
    transform: rotate(45deg) translate(-50%, -50%);
}



.gbb_checkmark_circle {
    /* display:block;
    position: absolute;
    width:22px;
    height:22px;
    background-color: green;
    border-radius:11px;
    left:0;
    top:0;
    opacity:0.5; */

    display: block !important;
    position: absolute;
    width: 36px;
    height: 36px;
    background-color: #026a02;
    border-radius: 50%;
    left: -6px;
    top: 0px;
}




.gbb_checkmark_stem {
    display:block !important;
    position: absolute;
    width:3px;
    height:9px;
    background-color:#fff;
    left:11px;
    top:6px;
}
.gbb_checkmark_stem {
  height: 20px;
}

.gbb_checkmark_kick {
    display:block !important;
    position: absolute;
    width:3px;
    height:3px;
    background-color:#fff;
    left:8px;
    top:12px;
}

.gbb_checkmark_kick{
     width: 9px;
    background-color: #fff;
    left: 3px;
    top: 23px;
}



.gbbGreetingCardImageList .greetingCardLabel input:checked,
.giftWrapImageList .giftWrapLabel input:checked{
    border:2px solid #A96668;
    border-radius:5px;
}

.gbbGreetingCardImageList .gbbGreetingCardImageLabel img, 
.giftWrapImageList .giftWrapImageLabel img{
    max-width:100%;
    width: 100%;
    /* width: -moz-available;           */
    /* WebKit-based browsers will ignore this. */
}

.gbbGreetingCardImageLabel,
.giftWrapImageLabel{
    width: 100%;
    height: 150px;
    height: 125px;
    position:relative;
    cursor:pointer;
    display:inline-block;
    align-self:center;
}


.gbbGreetingCardImageList,
.giftWrapImageList{
    display:grid;
    /* grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); */
    grid-template-columns: repeat(1, 1fr);
    grid-template-columns: repeat(2, 1fr);
    grid-gap:10px;
}

.gbbGreetingCardImageList .gbbGreetingCardImageLabel,
.giftWrapImageList .giftWrapImageLabel{
/* gbbGreetingCardImageList .gbbGreetingCardImageLabel, */
  /* border: 1px solid #D3D5D6; */

}
.gbbActiveGreetingCard{
  opacity: 0.5;
}

.greetingCardImageInput,
.giftWrapImageInput{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    visibility:hidden;
}


.gbbBodyWrapper ::-webkit-scrollbar {
  height: 4px;
  width: 3px;
}
  
  /* Track */
  .gbbBodyWrapper ::-webkit-scrollbar-track {
    background: #f1f1f1; 
  }
   
  /* Handle */
   .gbbBodyWrapper ::-webkit-scrollbar-thumb {
    background: #2c2c2c 0% 0% no-repeat padding-box;
  }
  
  /* Handle on hover */
  .gbbBodyWrapper ::-webkit-scrollbar-thumb:hover {
    background: #000000 0% 0% no-repeat padding-box;
  }



.greetingCardDropDownWrapper{
    cursor: pointer;
}


.gbbDisabled{
    pointer-events: none;
    opacity: 0.5;
}

.gbbEmailAddressWrapper{
  display: grid;
  /* background: white;     */
  background: none;
}



.gbbScheduleDeliveryDatePicker{
  display: grid;
  padding: 5px 10px;
  font-weight: 500;
  background: white;    
  /* width: 100%; */
  border-radius: 5px;
  border: 1px solid #D3D5D6;
}




.greetingCardWrapper::-webkit-scrollbar,.giftWrapWrapper::-webkit-scrollbar{ 
  width: 0.3rem;
}
.greetingCardWrapper::-webkit-scrollbar-track,.giftWrapWrapper::-webkit-scrollbar-track{
  -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
}
.greetingCardWrapper::-webkit-scrollbar-thumb,.giftWrapWrapper::-webkit-scrollbar-thumb{
  width: 5px;
  background-color: rgb(26, 24, 24);
}


.gbbGreetingCardDropDownButton,
.gbbGiftWrapDropDownButton{
  transform: rotate(180deg);
  justify-self: self-end;
  height: 30px;
  width: auto;
  cursor: pointer
}


.gbbJustOneProduct{
  display: grid;
  grid-template-columns: 1fr;
  grid-template-rows: 1fr;
  padding: 10px 0px;
  background: white;    
}

.gbbClearSelectionButton{
  border: none;
  text-decoration: underline;
  font-size: 12px;
  cursor: pointer;
  justify-self: end;
}


.greetingCardImgWrapper,.giftWrapImgWrapper{
  height: 250px;
  overflow: hidden;
}


.gbbGreetingCardCheckboxPrice,
.gbbGiftWrapCheckboxPrice{
   justify-self: right;
} 

.gbbVideoHasAlreadyBeenRecorded{
  color: #007F60;
  font-size: 12px;
  font-weight: 600;
  text-align: center;
  background: #f1f2f3;
}


.gbbVideoMsgButtonGroup{
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-gap: 10px;
}

.gbbVideoMsgReRecordButton,
.gbbVideoMsgSaveButton{
  background: #f1f2f3;
  border: 1px solid #D3D5D6;
  border-radius: 5px;
  padding: 5px;
  cursor: pointer;
}

.gbbVideoMsgSaveButton{
  grid-column: 2/3;
  padding: 5px;
}

.gbbVariantDetailsWrapper{
  /* position: absolute;
  bottom: 10%;
  right: 25%;
  background: black;
  color: white; */
  display: grid;
  grid-template-columns: 1fr 1fr;
  /* background-color: rgb(189, 183, 183) ; */
  /* grid-gap: 10px; */
  /* justify-items: center; */
}

.greetingCardImageAndDetailsWrapper{
  display: grid;
  /* grid-template-rows: 3fr 0.5fr; */
  /* grid-gap: 10px; */
  /* border: 2px solid #D3D5D6; */
  border-radius: 5px;
  padding: 5px 5px;
  background-color: rgb(241, 242, 243);
  /* padding: 5px;
  justify-content: center; */
}

.gbbScheduleDeliveryHTML{
  /* grid-column: 2/3; */
}

.gbbScheduleMessageDeliveryWrapper{
  display: grid;
  grid-template-columns: 1fr 1fr;
  grid-gap: 10px;
  width: 100%;
  max-width: 100%;
}
.gbbScheduleMessageDeliveryHTML{
  display: grid;
  grid-gap: 10px;
}
.gbbScheduleMessageSendNowContainer, .gbbScheduleMessageSendLaterContainer{
  box-shadow: none;
  display: inline-block;
  justify-content: center;
  cursor: pointer;
  line-height: 30px;
  margin: 0px;
  padding: 6px;
  font-weight: 700;
  text-transform: uppercase;
  font-size: 12px;
  color: #585858;
  border: 1px solid #f3f3f3;
  /* border-top: 0 solid #f3f3f3; */
  transition: transform .2s;
  font-family: inherit;
  /* background: none; */
}
.gbbScheduleMessageSendNowContainer:hover, .gbbScheduleMessageSendLaterContainer:hover{

  transform: scale(0.95);

}
.gbbScheduleMessageDatePicker{
  width: 100%;
  padding: 10px;
  border: 1px solid #a6a6a6;
  display: none;
}
.gbbGiftMessageV2RequiredWarning{
  color: #ff0000;
  font-size: 14px;
}

.gbbGiftMessageV2ToFromContainer {
  width: 100%;
  max-width: 100%;
  display: grid;
  grid-template-columns: 1fr;
  grid-gap: 10px;
  margin-bottom: 10px;
}

.gbbGiftMessageV2FromField,
.gbbGiftMessageV2ToField {
  padding: 10px 18px;
  padding-bottom: 10px;
  border-radius: 2px;
  border: 1px solid #A2A2A2;
  width: unset;
}



@media (min-width:600px){
  .gbbPersonalizePageHTML{
      margin: 10% 0%;
  }
  .gbbGiftMessageV2ToFromContainer{
    grid-template-columns: 1fr 1fr;
  }
  
  .gbbGreetingCardImageLabel, .giftWrapImageLabel{
      width: 100%;
      height: 150px;
  }
  .gbbScheduleDeliveryDatePicker{
    
    padding: 8px 10px;
    
  }
  .gbbGreetingCardImageList{
    grid-template-columns: repeat(3, 1fr);
  }
}


@media (min-width:1024px){  
.gbbPersonalizePageHTML{
  position: relative; 
  transform: translate(0px, -10%);
}
.gbbGiftMessageV2InputFieldsDiv textarea {
  height: 130px;
}

.gbbJustOneProduct .gbbGreetingCardImageLabel,
.gbbJustOneProduct .giftWrapImageLabel{
  width: 100%;
  height: 200px;
}
.gbbGreetingCardImageList, .giftWrapImageList {
  display: grid;
  /* grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); */
  grid-template-columns: repeat(4, 1fr);
  grid-gap: 10px;
}
}


.gbbVariantPrice{
  justify-self: right;
}


.gbbGiftMessageCounterEle:not(:empty),.gbbGiftMessageCounterEle:not(:empty){
  font-size: 12px;
  color: #8c8c8c;
  margin-top: 5px;
  text-align: end;
}


.gbbCustomerUploadsListItemInput{
  display: none;
}


.gbbCustomerUploadsList {
  display: grid;
  grid-gap: 15px;
}

.gbbCustomerUploadsListItem {
  display: grid;
  grid-template-columns: 2fr 1fr 25px;
  grid-gap: 10px;
  margin-bottom: 10px;
}


.gbbCustomerUploadsErrorMsg:not(:empty){
  display: block;
  color:red
}


.gbbCustomerUploadButton{
  font-size: 14px;
  padding: 5px 10px;
  border: none;
  /* width: min-content; */
  border-radius: 5px;
  justify-self: end;
  text-align: center;
  cursor: pointer;
  user-select: none;
}


.gbbCustomerUploadsActionButton {
  font-size: 14px;
  justify-self: end;
}


.gbbCustomerUploadsRemoveButton{
  grid-column: 3/4;
  align-self: end;
  cursor: pointer;
  user-select: none;
}



.gbbCustomerUploadPreviewButton{
  /* underline and blue color */
  font-size: 14px;
  padding: 5px 10px;
  border: none;
  /* width: min-content; */
  border-radius: 5px;
  justify-self: end;
  text-align: center;
  cursor: pointer;
  user-select: none;
  cursor: pointer;
  user-select: none;
  text-decoration: underline;
  color: blue;
}
.gbbCustomerUploadButton{

}

.gbbCustomerUploadsRemoveButton svg {
  /* background: #cf1a1a;
  border-radius: 50%;
  stroke: 0;
  border: 1px solid white;
  fill: white; */
}

.gbbCustomerUploadsMainText{
  /* font-size: 15px; */
  font-weight: 600;
}

.gbbCustomerUploadsDivider{
  display: block !important;
  border: 1px solid #A2A2A2 !important;
  height: 0px;
  opacity: 0.5;
}


/* PRODUCT ADDONS */
.gbbAddonDiscountRibbon{
  background: blue; 
  color: white;
  border-radius: 5px 0px 0px 5px;
}
.notEligibleForAddons .gbbProductItem{
  pointer-events: none;
  opacity: 0.5;
}
.gbbPersonalizePageHTML:has(.gbbAddonProductsWrapper){
  transform: translate(0px, 0px);
  margin: 0% 0%;
}
.gbbAddonProductsSectionTitle{
  font-weight: 600;
}
.gbbProductItem[free-addon-product="true"] .gbbProductItemPricesContainer{
  display: none;
}
.gbbProductItem[free-addon-product="true"] .gbbProductActionContainer {
  grid-template-rows: auto;
}

/* PRODUCT ADDONS */:root {
    /* Banners */
    --gbb-landing-page-image-src: url(https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_bannerv2.png);
    --gbb-page-banner-image-src: url(https://d3ks0ngva6go34.cloudfront.net/public/banners/page_banner_temp.png);
    --gbb-product-review-image-src: url(https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_bannerv2.png);

    /* Colors */
    --gbb-primary-color: blue;
    --gbb-secondary-color: aqua;
    --gbb-text-color: black;
    --gbb-disabled-color: gray;
    --gbb-product-box-color: blue;

    /* Landing Page */
    --gbb-landing-page-text-color: #000000;
    --gbb-landing-page-button-bg-color: #000000;
    --gbb-landing-page-button-text-color: #ffffff;

    /* Cart Footer */
    --gbb-cart-footer-bg-color: #ffffff;
    --gbb-cart-footer-buttons-container-bg-color: #f6f6f6;
    --gbb-cart-footer-border-radius: 0px;
    --gbb-cart-footer-product-image-border-radius: 0px;
    --gbb-cart-footer-buttons-container-border-radius: 9px;
    --gbb-cart-footer-show-hide-prices: visible;
    --gbb-cart-footer-text-color: #000000;
    --gbb-cart-footer-strikethrough-price-color: #8D8D8D;
    --gbb-cart-footer-final-price-font-thickness: bold;
    --gbb-cart-footer-strikethrough-price-font-thickness: regular;
    --gbb-cart-footer-back-button-color: #6d7175;
    --gbb-cart-footer-back-button-text-color: #FFFFFF;
    --gbb-cart-footer-back-button-border-color: #000000;
    --gbb-cart-footer-back-button-border-thickness: 2px;
    --gbb-cart-footer-next-button-text-color: #ffffff;
    --gbb-cart-footer-next-button-color: #000000;
    --gbb-cart-footer-next-button-border-color: #000000;
    --gbb-cart-footer-next-button-border-thickness: 2px;
    --gbb-cart-footer-buttons-border-radius: 9px;
    --gbb-cart-footer-buttons-padding: 10px;
    --gbb-cart-footer-discount-progress-bar-empty-color: #C1E7C5;
    --gbb-cart-footer-discount-progress-bar-filled-color: #15A524;
    --gbb-cart-footer-discount-text-visibility: visible;

    /* Product Card */
    --gbb-product-card-bg-color: #f1f2f3;
    --gbb-product-card-border-radius: 12px;
    --gbb-product-card-image-border-radius: 8px;
    --gbb-product-card-image-fit: cover;
    --gbb-product-card-per-row-xtra-large-screen: 6;
    --gbb-product-card-per-row-large-screen: 4;
    --gbb-product-card-text-color: #252525;
    --gbb-product-card-title-font-size: 19px;
    --gbb-product-card-title-font-weight: regular;
    --gbb-product-card-final-price-visibility: block;
    --gbb-product-card-compare-at-price-font-size: 20px;
    --gbb-product-card-compare-at-price-font-weight: regular;
    --gbb-product-card-compare-at-price-visibility: block;
    --gbb-product-card-final-price-font-size: 18px;
    --gbb-product-card-final-price-font-color: #252525;
    --gbb-product-card-final-price-font-weight: bold;
    --gbb-product-card-button-color: #000000;
    --gbb-product-card-button-text-color: #ffffff;
    --gbb-product-card-button-border-radius: 10px;
    --gbb-product-card-allow-only-one-quantity: block;
    --gbb-product-card-quantity-selector-bg-color: #EEEEEE;
    --gbb-product-card-quantity-selector-btns-bg-color: #000000;
    --gbb-product-card-quantity-selector-text-color: #000000;
    --gbb-product-card-quantity-selector-border-radius: 8px;
    --gbb-product-card-quantity-selector-button-text-color: #ffffff;

    /* Navigation Banner */
    --gbb-navigation-banner-title-color: #ffffff;
    --gbb-navigation-banner-text-color: #ffffff;
    --gbb-navigation-banner-step-completion-color: #000000;
    --gbb-navigation-banner-step-done-color: #000000;
    --gbb-navigation-banner-step-text-color: #000000;
    --gbb-navigation-banner-step-progress-bar-filled-color: #1E1E1E;
    --gbb-navigation-banner-step-progress-bar-empty-color: #cccccc;
    --gbb-navigation-banner-step-text-font-size: 20px;
    --gbb-navigation-check-color: #ffffff;
    --gbb-navigation-banner-step-completed-border-color: #000000;
    --gbb-navigation-banner-step-completed-border-width: 2px;
    --gbb-navigation-banner-step-incomplete-bg-color: #FFFFFF;
    --gbb-navigation-banner-step-incomplete-border-color: #000000;
    --gbb-navigation-banner-step-incomplete-border-width: 2px;
    --gbb-navigation-banner-tabs-active-bg-color: #000000;
    --gbb-navigation-banner-tabs-active-text-color: #F6f6f6;
    --gbb-navigation-banner-tabs-inactive-bg-color: #FFFFFF;
    --gbb-navigation-banner-tabs-inactive-text-color: #000000;
    --gbb-navigation-banner-tabs-border-color: #3c3c3c;
    --gbb-navigation-banner-tabs-corner-radius: 5px;

    /* Summary Block */
    --gbb-summary-block-add-to-cart-button-color: #000000;
    --gbb-summary-block-add-to-cart-button-text-color: #ffffff;
    --gbb-summary-block-back-button-color: #252525;
    --gbb-summary-block-back-button-text-color: #ffffff;

    /* Category Block */
    --gbb-category-bg-color: #f5f5f5;
    --gbb-tab-active-bg-color: #000000;
    --gbb-tab-active-text-color: #F6f6f6;
    --gbb-tab-inactive-bg-color: #FFFFFF;
    --gbb-tab-inactive-text-color: #000000;

    /* Quick Settings */
    --gbb-quick-settings-primary-color: #000000;
    --gbb-quick-settings-button-bg-color: #000000;
    --gbb-quick-settings-button-text-color: #ffffff;

    /* General Settings */
    --gbb-condition-toast-bg-color: #000000;
    --gbb-condition-toast-text-color: #ffffff;
    --gbb-scroll-bar-color: #F6F6F6;
    --gbb-icon-text-color: #1d1d1b;
    --gbb-icon-bg-color: #ffffff;
    --gbb-product-page-title-color: #000000;
    --gbb-bundle-bg-color: #ffffff;
}


.gbbNewPageCustomization.gbbProductsCardLayoutV2 {

    /* CART FOOTER COLOR CONFIG */
    .gbbProductsFooterHTML,
    .gbbAddProductsPageFooterHTML,
    .gbbPersonalizePageFooterHTML {
        background-color: var(--gbb-cart-footer-bg-color);
        border-radius: var(--gbb-cart-footer-border-radius);
    }

    .gbbFooterButtonsWrapper {
        background-color: var(--gbb-cart-footer-buttons-container-bg-color);
        border-radius: var(--gbb-cart-footer-buttons-container-border-radius);
    }

    .gbbFooterTotalContainer {
        visibility: var(--gbb-cart-footer-show-hide-prices);
    }

    .gbbFooterProductImageContainer {
        border-radius: var(--gbb-cart-footer-product-image-border-radius);
    }

    .gbbFooterDiscountedTotalValue {
        font-weight: var(--gbb-cart-footer-final-price-font-thickness);
        color: var(--gbb-cart-footer-final-price-font-color);
    }
    
    .gbbFooterOriginalTotalValue {
        color: var(--gbb-cart-footer-strikethrough-price-color);
        font-weight: var(---gbb-cart-footer-strikethrough-price-font-thickness);
    }

    .gbbFooterBackButton {
        background-color: var(--gbb-cart-footer-back-button-color);
        color: var(--gbb-cart-footer-back-button-text-color);
        border: var(--gbb-cart-footer-back-button-border-thickness) solid var(--gbb-cart-footer-back-button-border-color);

    }

    .gbbFooterNextButton {
        background-color: var(--gbb-cart-footer-next-button-color);
        color: var(--gbb-cart-footer-back-button-text-color);
        border: var(--gbb-cart-footer-next-button-border-thickness) solid var(--gbb-cart-footer-next-button-border-color);
       
    }
    .gbbFooterBackButton,.gbbFooterNextButton{
        border-radius: var(--gbb-cart-footer-buttons-border-radius);
        padding: var(--gbb-cart-footer-buttons-padding);
    }

    .progressBar {
        background-color: var(--gbb-cart-footer-discount-progress-bar-empty-color);
    }

    .progressBarFill {
        background-color: var(--gbb-cart-footer-discount-progress-bar-filled-color);
    }

    .gbbDiscountMessage {
        color: var(--cart-footer-discount-text-color);
        visibility: var(--gbb-cart-footer-discount-text-visibility)
    }

    
    /* CART FOOTER COLOR CONFIG */

    /* PRODUCT CARD COLOR CONFIG */
    .gbbProductItem {
        background-color: var(--gbb-product-card-bg-color);
        border-radius: var(--gbb-product-card-border-radius);
    }

    .gbbProductQuantityAddButton {
        display: var(--gbb-product-card-allow-only-one-quantity);
        border-radius: var(--gbb-product-card-quantity-selector-border-radius);
    }

    .gbbProductItemPrice {
        display: var(--gbb-product-card-final-price-visibility);
    }

    .gbbProductImageContainer {
        border-radius: var(--gbb-product-card-image-border-radius);
    }

    .gbbProductImageContainerImg {
        object-fit: var(--gbb-product-card-image-fit);
    }

    .gbbProductTextContainer {
        color: var(--gbb-product-card-text-color);
    }

    .gbbProductTitleOnly {
        font-size: var(--gbb-product-card-title-font-size);
        font-weight: var(--gbb-product-card-title-font-weight);
    }

    .gbbProductItemCompareAtPrice {
        color: var(--gbb-product-card-compare-at-price-font-color);
        font-size: var(--gbb-product-card-compare-at-price-font-size);
        font-weight: var(--gbb-product-card-compare-at-price-font-weight);
        display: var(--gbb-product-card-compare-at-price-visibility);
    }

    .gbbProductItemPrice {
        color: var(--gbb-product-card-final-price-font-color);
        font-size: var(--gbb-product-card-final-price-font-size);
        font-weight: var(--gbb-product-card-final-price-font-weight);
    }

    .gbbProductAddButton {
        background-color: var(--gbb-product-card-button-color);
        color: var(--gbb-product-card-button-text-color);
        border-radius: var(--gbb-product-card-button-border-radius);
    }

    .gbbProductQuantityHTML {
        background-color: var(--gbb-product-card-quantity-selector-bg-color);
        color:var(--gbb-product-card-quantity-selector-text-color) ;
        border-radius: var(--gbb-product-card-button-border-radius);
    }
    .gbbProductQuantityRemoveButton{
        background-color: var(--gbb-product-card-quantity-selector-btns-bg-color);
        color: var(--gbb-product-card-quantity-selector-button-text-color);
        border-radius: var(--gbb-product-card-quantity-selector-border-radius);
    }
        /* productCardQuantitySelectorButtonTextColor */
    @media screen and (min-width: 1921px) {
        .gbbProductsItemsContainer {
            grid-template-columns: repeat(var(--gbb-product-card-per-row-xtra-large-screen), 1fr);
        }
    }
        @media screen and (min-width: 768px) and (max-width: 1920px) {
            .gbbProductsItemsContainer {
                grid-template-columns: repeat(var(--gbb-product-card-per-row-large-screen), 1fr);
            }
        }
    /* PRODUCT CARD COLOR CONFIG */

    /* Navigation */

    .gbbNavigationTitle {
        color: var(--gbb-navigation-banner-text-color);
        font-size: var(--gbb-navigation-banner-step-text-font-size);
    }

    .gbbStepsProgressBar {
        background-color: var(--gbb-navigation-banner-step-progress-bar-empty-color);
    }

    .gbbStepsProgressBarFilled {
        background-color: var(--gbb-navigation-banner-step-progress-bar-filled-color);
    }

    .gbbCategoryContainerTabUI {
        background-color: var(--gbb-navigation-banner-tabs-inactive-bg-color);
        color: var(--gbb-navigation-banner-tabs-inactive-text-color);
        border: 1px solid var(--gbb-navigation-banner-tabs-border-color);
        border-radius: var(--gbb-navigation-banner-tabs-corner-radius);
    }

    .gbbCategoryContainerTabUIActive {
        background-color: var(--gbb-navigation-banner-tabs-active-bg-color);
        color: var(--gbb-navigation-banner-tabs-active-text-color);
    }

    .gbbtickMark svg>path {
        fill: var(--gbb-navigation-banner-step-done-color);
    }
 /* gbbNavigationStepImgContainer class which doesnt includes gbbNavigationStepImgContainerActive */

    .gbbNavigationStepImgContainer:not(.gbbNavigationStepImgContainerActive) {
        border: var(--gbb-navigation-banner-step-incomplete-border-width) solid var(--gbb-navigation-banner-step-incomplete-border-color);
        background-color: var(--gbb-navigation-banner-step-incomplete-bg-color);
    }

    .gbbNavigationStepImgContainerActive {
        border: var(--gbb-navigation-banner-step-completed-border-width) solid var(--gbb-navigation-banner-step-completion-color);
        /* background-color: var(--gbb-navigation-banner-step-completion-color); */
    }

    /* Navigation */

/*const cssVariables=[ '
--gbb-navigation-banner-title-color',
'--gbb-navigation-banner-step-text-color',
];*/

}
.gbbNewPageCustomization.gbbProductVariantModalLayoutV2 {
    .gbbProductVariantAddButton{
        background-color: var(--gbb-product-card-button-color);
            color: var(--gbb-product-card-button-text-color);
            border-radius: var(--gbb-product-card-button-border-radius);

    }
    .gbbProductQuantityHTML {
        background-color: var(--gbb-product-card-quantity-selector-bg-color);
        color: var(--gbb-product-card-quantity-selector-text-color);
        border-radius: var(--gbb-product-card-quantity-selector-border-radius);
    }
    .gbbProductQuantityAddButton {
        display: var(--gbb-product-card-allow-only-one-quantity);
        border-radius: var(--gbb-product-card-quantity-selector-border-radius);
    }
    .gbbProductQuantityRemoveButton {
        background-color: var(--gbb-product-card-quantity-selector-btns-bg-color);
        color: var(--gbb-product-card-quantity-selector-button-text-color);
        border-radius: var(--gbb-product-card-quantity-selector-border-radius);
    }
}.gbbGiftMessageV2InputFieldsDiv textarea {
    margin:0px;
    padding: 10px 18px;
    width: 100%;
    border: 1px solid #cccccc;
    /* background-color:#f1f2f3; */
    /* background-color: #ffffff; */
    color: #000000;
    max-width: 100%;
    line-height: 1.2;
    border-radius: 2px;
    padding-bottom: 10px;
    max-height: 170px !important;
    min-height:50px !important;
    border: 1px solid #A2A2A2;
    resize: none;
    width: 100%;
    height: 130px;
    padding: 10px;
    background: none;
}


.gbbGiftMessageV2Divider{
    display: block !important;
    border: 1px solid #A2A2A2 !important;
    height: 0px;
    opacity: 0.5;
 }
.gbbGiftMessageV2Label{
    text-align: left;
    letter-spacing: 0px;
    display: block;
    color: #000000;
    padding-bottom: 10px;
    opacity: 1;
}

.gbbGiftMessageV2{
    display: grid;
    grid-template-rows: 0.6fr;
    grid-gap: 10px;
}
.gbbVideoMessageCheckboxRow{
    display: grid;
    grid-auto-flow: column;
    padding: 5px;
    /* background-color: #f1f2f3; */
}
.gbbVideoMsgCheckboxLabel{
    text-align: left;
    letter-spacing: 0px;
    color: #000000;
}
 .gbbVideoMsgCheckboxWrapper {
    position: relative;
    display: inline-block;
    width: 44px;
    justify-self: end;
    height: 26px;
  }
.gbbVideoMsgCheckboxField { 
  width: 0px;
  height: 0px;
}

.gbbVideoMsgToggle input{ 
    opacity: 0;
    width: 0;
    height: 0;
  }
  
.gbbVideoMsgSlider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #fff;
    border: 1px solid black;    
    -webkit-transition: .4s;
    transition: .4s;
  }
  
 .gbbVideoMsgSlider:before {
    position: absolute;
    content: "";
    height: 20px;
    width: 20px;
    left: 4px;
    bottom: 4px;
    top:2px;
    background-color: white;
    -webkit-transition: .4s;
    transition: .4s;
  }
  
   input:checked + .gbbVideoMsgSlider {
    background-color: black;
  }
  
 input:checked + .gbbVideoMsgSlider:before {
    -webkit-transform: translateX(16px);
    -ms-transform: translateX(16px);
    
    transform: translateX(16px);
  }
  
 
 
  /* Rounded sliders */
  .slider.round, .gbbVideoMsgSlider {
    border-radius: 34px;
  }
  
  .slider.round:before, .gbbVideoMsgSlider:before {
    border-radius: 50%;
    border: 1px solid black;
  }


  /* ============================================================================video message  */
  .gbbVideoPlayerHide {
    display: none !important;
  }

  .gbbVideoMsgPlayerWrapper {
    /* height: 100vh; */
    z-index: 10000000000000;
    display: none;
    align-items: center;
    justify-items: center;
    width: 100%;
    /* position: fixed; */
    top: 30px;
    margin: 10px auto;
  }

  .gbbRecorder {
  
    width: 100%;
    min-height: 250px;
    position: relative;
    border-radius: 2%;
    overflow: hidden;
  }

  .gbbVideoPlayer,
  .gbbVideoPlayerRecording {
    width: 100%;
    height: auto;
  }
 
  .gbbRecorderCloseBtn {
    position: absolute;
    z-index: 1;
    left: 2%;
    top: 5%;
    background: transparent;
    border: none;
    display: none;
  }

  .gbbRecorderCloseBtn img {
    height: 30px;
    width: 30px;
    filter: invert(90%);
    cursor: pointer;
  }

  .gbbVideoPlayerStartBtn,
  .gbbVideoPlayerStopBtn {
    position: absolute;
    bottom: 2%;
    left: 50%;
    transform: translateX(-50%);
    cursor: pointer;
    height: 60px;
    width: 60px;
    border-radius: 50%;
    border: none;
    background-color: transparent;
  }

  .gbbVideoPlayerStartBtn {
    background-color: white;
  }

  .gbbVideoPlayerStopBtn {
    background-color: red;
  }

  .gbbVideoPlayerRedDot,
  .gbbVideoPlayerRedSquare {
    height: 20px;
    width: 20px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .gbbVideoPlayerRedDot {
    background-color: red;
    border-radius: 50%;
  }

  .gbbVideoPlayerRedSquare {
    background-color: white;
    border-radius: 10%;
  }

  .gbbPermissionDenied {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 16px;
  }

  .gbbVideoPlayerTimeLeft {
    position: absolute;
    bottom: 4%;
    right: 4%;
    color: white;
    font-size: 12px;
    background: black;
    padding: 4px;
    color: white;
    opacity: 0.7;  
  }

  .gbbVideoPlayerStatus {
    position: absolute;
    bottom: 4%;
    left: 4%;
    font-size: 12px;
    padding: 4px;
    background-color: black;
    color: white;
    opacity: 0.7;
  }

  

  .gbbVideoPlayerControls {
    width: 100%;
    text-align: center;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    display: grid;
    /* grid-template-columns: repeat(3, 1fr); */
    justify-content: space-evenly;
    align-items: center;
  }

  .gbbLoadingHeading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    color: white;
    font-size: 20px;
  }

  .gbbUploadingVideoHeading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
    color: #e3dada;
    font-size: 16px;
    text-align: center;
    line-height: 40px;
  }

  .gbbVideoPlayerControlsAcceptBtnDiv, 
  .gbbVideoPlayerControlsPlayBtnDiv, 
  .gbbVideoPlayerControlsReStartBtnDiv{
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }
  .gbbVideoPlayerControlsReStartBtnDiv,
  .gbbVideoPlayerControlsAcceptBtnDiv{
    display: none;
  }

  .gbbVideoPlayerControlsBtnDivInfo{
    font-size: 12px;
    color: white;
    margin: 0 0 8px 0; 
  }

  .gbbVideoPlayerControlsAcceptBtn,
  .gbbVideoPlayerControlsPlayBtn,
  .gbbVideoPlayerControlsReStartBtn {
    background-color: transparent;
    height: 90px;
    width: 90px;
    border-radius: 50%;
    cursor: pointer;
    border:0;
    /* margin-right: 20px; */
  }

  old.gbbVideoPlayerControlsAcceptBtn {
    border: 5px solid #3ce669;
  }

  old.gbbVideoPlayerControlsPlayBtn {
    border: 5px solid #d3d3d3;
  }

  old.gbbVideoPlayerControlsReStartBtn {
    border: 5px solid #e03838;
  }

  .gbbVideoPlayerControlsAcceptBtnImg,
  .gbbVideoPlayerControlsPlayBtnImg,
  .gbbVideoPlayerControlsReStartBtnImg {
    height: auto;
    width: 100%;
  }

  old.gbbVideoPlayerControlsAcceptBtnImg {
    filter: invert(69%) sepia(59%) saturate(537%) hue-rotate(80deg) brightness(98%) contrast(93%);
  }

  old.gbbVideoPlayerControlsPlayBtnImg {
    filter: invert(100%) sepia(0) saturate(7500%) hue-rotate(116deg) brightness(80%) contrast(109%);
  }

  old.gbbVideoPlayerControlsReStartBtnImg {
    filter: invert(23%) sepia(77%) saturate(3858%) hue-rotate(348deg) brightness(98%) contrast(80%);
  }

  /* 500px and down */
  @media only screen and (max-width: 600px) {
    .gbbVideoPlayerRecording {
      object-fit: cover;
      height: 100%;
    }
    .gbbRecorder {
      min-height: 36vh;
    }
    .gbbVideoPlayer,
  .gbbVideoPlayerRecording{
    width: 100%;
    object-fit: cover;
    position: absolute;
    height: 100%;
  }
    .gbbVideoPlayerControlsAcceptBtn,
    .gbbVideoPlayerControlsPlayBtn,
    .gbbVideoPlayerControlsReStartBtn {
      height: 50px;
      width: 50px;
    }

    .gbbVideoPlayerControlsAcceptBtnImg,
    .gbbVideoPlayerControlsPlayBtnImg,
    .gbbVideoPlayerControlsReStartBtnImg {
      height: 40px;
      width: 40px;
    }
  }

  /* 350px and down */
  @media only screen and (max-width: 600px) {
    .gbbVideoPlayerStartBtn,
    .gbbVideoPlayerStopBtn {
      height: 40px;
      width: 40px;
    }

    .gbbVideoPlayerRedDot,
    .gbbVideoPlayerRedSquare {
      width: 10px;
      height: 10px;
    }
    .gbbGiftMessageV2InputFieldsDiv textarea {
      height: 80px;
    }

  }
  .gbbGiftCardMessageContent{
    overflow-y:auto;
  }

  
  /* Track */
  .gbbGiftCardMessageContent  ::-webkit-scrollbar-track,.gbbGreetingCardListWrapper ::-webkit-scrollbar-track  {
    background: #f1f1f1; 
  }
   
  /* Handle */
   .gbbGiftCardMessageContent  ::-webkit-scrollbar-thumb,.gbbGreetingCardListWrapper ::-webkit-scrollbar-thumb{
    background: #2c2c2c 0% 0% no-repeat padding-box;
  }



  
  /* Handle on hover */
  .gbbGiftCardMessageContent  ::-webkit-scrollbar-thumb:hover, .gbbGreetingCardListWrapper ::-webkit-scrollbar-thumb:hover {
    background: #000000 0% 0% no-repeat padding-box;
  }

  /* Extra small devices (phones, 600px and down) */
  /* @media only screen and (max-width: 800px) {
    .gbbRecorder {
      width: 375px;
      height: 650px;
      background-color: black;
    }

    .gbbVideoPlayer,
    .gbbVideoPlayerRecording {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .gbbVideoPlayerRecording {
      object-fit: contain;
    }

    .gbbVideoPlayerControls {
      width: 80%;
    }

    .gbbVideoPlayerControlsAcceptBtn,
    .gbbVideoPlayerControlsPlayBtn,
    .gbbVideoPlayerControlsReStartBtn {
      margin-right: 7px;
    }

    .gbbVideoPlayerTimeLeft,
    .gbbVideoPlayerStatus {
      font-size: 18px;
      background-color: rgba(0,0,0,0.2);
      padding: 2px 4px;
    }

  } */


  /* @media only screen and (max-width: 850px) {} */

  /* Small devices (portrait tablets and large phones, 600px and up) */
  /* @media only screen and (min-width: 600px) {} */

  /* Medium devices (landscape tablets, 768px and up) */
  /* @media only screen and (min-width: 768px) {} */

  /* Large devices (laptops/desktops, 992px and up) */
  @media only screen and (min-width: 900px) {
    .gbbRecorder {
      min-height: 180px;
      height: 100%;
    }
    .gbbRecord,.gbbRecorded{
      height: 100%;
    }
    .gbbVideoPlayer, .gbbVideoPlayerRecording{
      width: 100%;
      object-fit: cover;
      height: 100%;
    }
    .gbbVideoMsgPlayerWrapper{
      height: auto;  
    }
   
    .gbbGiftCardMessageContent{
      max-height: 350px;
    } 

  }

  /* Extra large devices (large laptops and desktops, 1200px and up) */
  /* @media only screen and (min-width: 1200px) {}  */


  .giftMessageDeliveryInfo{
    font-size: 12px;
    /* font-style: italic; */
    color: #8c8c8c;    
  }
  
.gbbVideoMsgEmailField{
  margin: 0px;
  padding: 10px 18px;
  /* width: 100%; */
  /* background-color: #ffffff; */
  color: #000000;
  max-width: 100%;
  line-height: 1.2;
  border-radius: 2px;
  padding-bottom: 10px;
  border: 1px solid #A2A2A2;
  font-size: 14px !important;
  background: none;
}



.gbbEmailValidationError{
  color: #ff0000;
  font-size: 14px;
  margin-top: 5px;
}

.gbbVideoMessageHTML{
    height: fit-content;
    /* background: #f1f2f3; */
    /* background-color: white; */
    background: none;
    display: grid;
    grid-gap: 5px;
}


.gbbGreetingCardDropDownWrapper,.gbbGiftWrapDropDownWrapper,
.gbbGiftMessageV2Label,.gbbScheduleDeliveryDateLabel,
.gbbEmailAddressLabelField{
  font-weight: 600;
}</style>
    <style>  </style>
    <style></style>
    <style>.gbbBodyWrapper {
    margin: 0px !important;
}
.gbbPageBody {
  background: transparent !important;
}
.gbbMultipleCategoriesDropdownArrow > svg:nth-child(1) {
    width: 30px;
    height: 30px;
}
.gbbMultipleCategoriesDropdownArrow {
    right: 20%;
    background: #fff;
    border-radius: 50px;
}
.gbbConditionNotificationToast {
    background: #CB33FB !important;
    color: #fff !important;
    border-radius: 10px !important;
}
.gbbPrevImage, .gbbNextImage {
    color:#CB33FB !important;
}
.gbbProductItemCompareAtPrice {
    display: none;
}
.gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {
    color:#1D1D1B !important;
}
.gbbMultipleCategoriesDropdownArrow svg path {
    fill: #CB33FB !important;
}
.gbbAddProductPageSubtextWrapper:not(:empty), .gbbPrecuratedBoxPageSubtextWrapper:not(:empty), .gbbPersonalizePageSubtextWrapper:not(:empty), .gbbChooseBoxPageSubtextWrapper:not(:empty), .gbbMultipleCategoriesPageSubtextWrapper:not(:empty) {
    display: none !important;
}
.gbbProductVariantModalContainer {
    border-radius: 20px;
}

@media screen and (min-width: 990px) {
    .gbbMultipleCategoriesRibbonContainer {
        gap: 4px;
        overflow-x: scroll;
        padding: 0px !important;
    }
    .gbbExtBundleRedirectButton {
        font-weight: 800;
        font-size: 14px;
        line-height: 19px;
        padding: 15px 20px;
        text-align: center;
        text-decoration: none;
        background: #F1FF00;
        border-radius: 50px;
        width: 80%;
        margin-top: 10px;
    }
    .gbbPageBody {
        max-width: 1200px;
        padding: 0 5rem;
        margin: auto;
    }
    .gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {
        line-height: 28px !important;
        color:#1D1D1B !important;
    }
    .gbbAddProductsPageFooterHTML {
        padding: 20px;
        border: 1px solid #7F7F7F;
        border-radius: 20px;
        z-index: 2;
        min-height: auto;
        background: #fff !important;
        bottom: 1px;
    }
    .gbbProductsFooterHTML {
        background: #fff !important;
        display: grid;
        grid-template-columns: 1fr;
        padding: 10px;
        position: relative;
        grid-gap: 0px;
    }
    .gbbFooterProductsContainer {
        grid-gap: 20px;
    }
    .gbbFooterProductTitle {
        display: none;
    }
    .gbbFooterProductImageContainer {
        display: grid;
        width: 70px;
        height: 70px;
        border: 1px solid #CB33FB;
        overflow: hidden;
        border-radius: 10px;
    }
    .gbbFooterProductPrice {
        display: none;
    }
    .gbbFooterProductTextContainer {
        width: auto !important;
        justify-content: center;
        display: flex;
        font-size: 18px;
        line-height: 28px;
        font-weight: 900;
    }
    .gbbFooterOriginalTotalValue {
        color: red;
    }
    .gbbFooterProductQtyPriceContainer {
        display: flex;
        gap: 5px;
        margin: auto;
    }
    .gbbFooterTotalContainer {
        text-align: center;
        font-size: 22px;
        line-height: 28px;
        font-weight: 900;
        color: #1D1D1B !important;
    }
    .gbbFooterTotalValueContainer {
        justify-content: center;
    }
    .gbbFooterButtonsWrapper {
        display: block;
        margin: auto;
        width: 500px;
    }
    .gbbFooterBackButton, .gbbFooterNextButton {
        background: #CB33FB !important;
        padding: 15px 0px;
        border: none;
        border-radius: 50px;
        text-align: center;
        font-weight: 900;
        font-size: 18px !important;
        line-height: 25px;
    }
    .gbbFooterProductRemoveButtonIcon > svg:nth-child(1) {
        background: #CB33FB !important;
        border-radius: 50% !important;
        fill: #fff !important;
        width: 22px !important;
        height: 22px !important;
        border: 1px solid #CB33FB !important;
    }
    .gbbProductsItemsContainer {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 30px;
    }
   .gbbProductImageContainerImg {
        max-height: 100%;
        width: 100%;
        padding-bottom: 0;
        border-radius: 10px;
    }
    .gbbProductItem {
        box-shadow: none;
        transition: none;
        display: flex;
        flex-direction: column;
        background: #fff !important;
        color: #1D1D1B !important;
        border-radius: 10px;
        padding: 10px;
    }
    .gbbProductItem:hover {
        box-shadow: none;
        transition: none;
    }
    .gbbProductTextContainer {
        text-align: left;
        font-size: 18px;
        line-height: 28px;
        font-weight: 900;
    }
    .gbbProductActionContainer {
        width: 100%;
        display: flex;
        flex-direction: column;
        padding: 0px 15px 20px;
        align-items: normal;
    }
    .gbbProductItemPricesContainer {
        font-weight: 700;
        font-size: 18px;
        line-height: 25px;
        text-transform: uppercase;
        color: #1D1D1B;
    }
    .gbbProductItemCompareAtPrice {
        font-weight: 700;
        font-size: 18px;
        line-height: 25px;
        text-transform: uppercase;
        color: #1D1D1B;
    }
    .gbbProductItemCompareAtPrice {
        font-weight: 700;
        font-size: 18px;
        line-height: 25px;
        text-transform: uppercase;
        color: red;

    }
    .gbbProductQuantityHTML {
        background-color: #CB33FB;
        border: 2px;
        border-radius: 50px;
        color: #fff;
        padding: 7px;
    }
    .gbbProductQuantityRemoveButton {
        background: #CB33FB !important;;
        border-radius: 50px;
    }
    .gbbProductQuantityAddButton {
        background: #CB33FB !important;
        border-radius: 50px;
    }
    .gbbProductQuantityLabel {
        color: #fff;
        font-size: 18px;
        line-height: 28px;
    }
    .gbbProductAddButton {
        background: #CB33FB !important;
        border-radius: 50px;
        font-size: 18px;
        line-height: 28px;
    }
    .gbbDiscountMessage {
        text-align: center;
        font-size: 18px;
        line-height: 28px;
        font-weight: 900;
        padding: 5px 0px;
    }
    .gbbProductDescriptionText {
        max-height: 100% !important;
    }
    .gbbProductVariantModalDetailsContainer {
        display: grid;
        grid-gap: 20px;
        grid-template-rows: 1fr auto;
        height: 100%;
    }
    .gbbProductCardTextContainer {
        height: 100% !important;
    }
    .gbbProductQuantityHTMLContainer {
        grid-template-columns: auto 1fr;
    }
    .gbbProductQuantityHeading {
        display: flex;
        margin: auto;
        font-size: 18px;
        line-height: 28px;
        font-weight: 900;
    }
    .gbbProductCardActionContainer {
        grid-template-columns: auto;
    }
    .gbbProductVariantAddButton {
        background: #CB33FB !important;
        padding: 15px 0px;
        border: none;
        border-radius: 50px;
        text-align: center;
        font-weight: 900;
        font-size: 18px !important;
        line-height: 25px;
    }
    .gbbProductVariantModalClose {
        font-weight: bold;
        transform: rotate(45deg);
        font-size: 40px;
        position: absolute;
        color: #CB33FB;
        cursor: pointer;
        user-select: none;
        padding: 0;
        top: 10px;
        right: 10px;
    }
    .gbbActiveImage {
        border: 1px solid #CB33FB !important;
        border-radius: 10px;
    }
    .gbbProductTabImageContainer img {
        border-radius: 10px;
    }
    .gbbProductVariantModalContentContainer .gbbProductImageContainerImg {
        max-height: 100% !important;
    }
    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown {
        background: transparent !important;
        padding: 5px 2px;
        border-bottom: 2px solid #1d1d1d;
        text-align: center;
        font-weight: 900;
        font-size: 18px !important;
        line-height: 25px;
        color: #1d1d1d;
    }
    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown, .gbbCategoryContainer {
        border-top: 0px !important;
        border-left: 0px !important;
        border-right: 0px !important;
        border-radius: 0px;
    }
    .gbbCategoryContainer.gbbCategoryContainerTabUI.gbbCategoryContainerTabUIActive {
        color: #CB33FB;
        opacity: 100%;
        border-bottom: 2px solid #CB33FB;
    }
    .gbbAddProductPageSubtext {
        text-align: center;
        font-size: 40px;
        font-weight: 900;
        line-height: 50px;
        padding: 50px 4rem 30px 4rem;
        color: #CB33FB !important;
    }
}
@media screen and (max-width: 990px) {
    .gbbPageBody {
        padding: 0px;
    }
    .gbbAddProductsPageFooterHTML {
        background: #fff !important;
        color:#1D1D1B !important;
        border-top: 3px solid #CB33FB;
        min-height: auto;
    }
    .gbbProductsFooterHTML {
        background: #fff !important;
        display: grid;
        grid-template-columns: 1fr;
        padding: 10px;
        position: relative;
        grid-gap: 20px;
        color:#1D1D1B !important;
    }
    .gbbFooterProductsContainer {
        grid-gap: 20px;
    }
    .gbbFooterProductTitle {
        display: none;
    }
    .gbbFooterProductImageContainer {
        display: grid;
        width: 70px;
        height: 70px;
        border: 1px solid #CB33FB;
        overflow: hidden;
        border-radius: 10px;
    }
    .gbbFooterProductPrice {
        display: none;
    }
    .gbbFooterProductTextContainer {
        width: auto !important;
        justify-content: center;
        display: flex;
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900;
    }
    .gbbFooterOriginalTotalValue {
        color: red;
    }
    .gbbFooterProductQtyPriceContainer {
        display: flex;
        gap: 5px;
        margin: auto;
    }
    .gbbFooterTotalContainer {
        text-align: center;
        font-size: 18px !important;
        line-height: 18px !important;
        font-weight: 900;
        color:#1D1D1B !important
    }
    .gbbFooterTotalValueContainer {
        justify-content: center;
    }
    .gbbFooterButtonsWrapper {
        display: block;
        margin: auto;
        width: 100%;
    }
    .gbbFooterBackButton, .gbbFooterNextButton {
        background: #CB33FB !important;
        padding: 15px 0px;
        border: none;
        border-radius: 50px;
        text-align: center;
        font-weight: 900;
        font-size: 16px !important;
        line-height: 18px;
    }
    .gbbFooterProductRemoveButtonIcon > svg:nth-child(1) {
        background: #CB33FB !important;
        border-radius: 50% !important;
        fill: #fff !important;
        width: 22px !important;
        height: 22px !important;
        border: 1px solid #CB33FB !important;
    }
    .gbbProductsItemsContainer {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px 15px;
    }
   .gbbProductImageContainerImg {
        max-height: 100%;
        width: 100%;
        padding-bottom: 0;
        border-radius: 10px;
    }
    .gbbProductItem {
        box-shadow: none;
        transition: none;
        display: flex;
        flex-direction: column;
        background: #fff !important;
        color: #1D1D1B !important;
        border-radius: 10px;
        padding: 10px;
    }
    .gbbProductItem:hover {
        box-shadow: none;
        transition: none;
    }
    .gbbProductTextContainer {
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900;
        padding: 5px 0px;
    }
    .gbbProductActionContainer {
        width: 100%;
        display: flex;
        flex-direction: column;
        padding: 0px 0px 5px;
        align-items: normal;
        margin: auto;
    }
    .gbbProductButtonWrapper {
        width: 100%;
    }
    .gbbProductItemPricesContainer {
        font-weight: 700;
        font-size: 16px !important;
        line-height: 18px;
        text-transform: uppercase;
        color: #1D1D1B;
    }
    .gbbProductItemCompareAtPrice {
        font-weight: 700;
        font-size: 18px;
        line-height: 25px;
        text-transform: uppercase;
        color: #1D1D1B;
    }
    .gbbProductItemCompareAtPrice {
        font-weight: 700;
        font-size: 16px !important;
        line-height: 18px;
        text-transform: uppercase;
        color: red;

    }
    .gbbProductQuantityHTML {
        background-color: #CB33FB;
        border: 2px;
        border-radius: 50px;
        color: #fff;
        padding: 1px;
    }
    .gbbProductQuantityRemoveButton {
        background: #CB33FB !important;;
        border-radius: 50px;
    }
    .gbbProductQuantityAddButton {
        background: #CB33FB !important;
        border-radius: 50px;
    }
    .gbbProductQuantityLabel {
        color: #fff;
        font-size: 16px !important;
        line-height: 18px;
    }
    .gbbProductAddButton {
        background: #CB33FB !important;
        border-radius: 50px;
        font-size: 16px !important;
        line-height: 18px;
    }
    .gbbDiscountMessage {
        text-align: center;
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900;
        color: #1D1D1B !important;
        padding: 5px 0px;
    }
  
    .gbbProductQuantityHTMLContainer {
        grid-template-columns: auto 1fr;
    }
    .gbbProductQuantityHeading {
        display: flex;
        margin: auto;
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900;
        color:#1D1D1B !important;
    }
    .gbbProductItemTitle {
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900 !important;
        color: #1D1D1B !important;
    }
    .gbbProductItemPrice {
        font-size: 16px !important;
        line-height: 18px;
        font-weight: 900 !important;
        color: #1D1D1B !important;
    }
    .gbbProductVariantAddButton {
        background: #CB33FB !important;
        padding: 15px 0px;
        border: none;
        border-radius: 50px;
        text-align: center;
        font-weight: 900;
        font-size: 16px !important;
        line-height: 18px;
    }
    .gbbProductVariantModalClose {
        font-weight: bold;
        transform: rotate(45deg);
        font-size: 40px;
        position: absolute;
        color: #CB33FB;
        cursor: pointer;
        user-select: none;
        padding: 0;
        top: 10px;
        right: 10px;
    }
    .gbbActiveImage {
        border: 1px solid #CB33FB !important;
        border-radius: 10px;
    }
    .gbbProductTabImageContainer img {
        border-radius: 10px;
    }
    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown {
        background: #CB33FB !important;
        padding: 15px 0px;
        border: 1px solid #CB33FB;
        border-radius: 50px;
        text-align: center;
        font-weight: 900;
        font-size: 16px !important;
        line-height: 18px;
        color: #fff;
display: block;
    }
    .gbbCategoryContainer.gbbCategoryContainerTabUI.gbbCategoryContainerTabUIActive {
        color: #fff;
        background: #CB33FB !important;
    }
    .gbbProductVariantModalContentContainer {
        display: block;
    }
    .gbbProductVariantModalBodyContainer {
        display: block;
        width: 100%;
        margin: auto;
        padding: 40px 0px 0px;
    }
    .gbbProductCardActionContainer {
        display: block;
        padding: 20px 0;
        width: 100%;
    }
    .gbbProductVariantModalContentContainer .gbbProductImageContainerImg {
        max-height: 500px !important;
    }
    .gbbProductDescriptionText {
        color: #1D1D1B !important;
    }
    .gbbViewProductsLabelAndTotalContainer {
        display: flex;
        flex-direction: column;
        margin: auto;
        gap: 10px;
    }
    .gbbViewCartProductsLink {
        text-decoration: none;
        cursor: pointer;
        color: #CB33FB;
        border: 1px solid;
        border-radius: 100px;
        padding: 4px 10px;
        margin: auto;
    }
    .gbbCartModalProductTitleContainer, .gbbCartModalProductPrice {
        display: none;
    }
    .gbbCartProductsContainerHeaderLabel {
        display: none;
    }
    .gbbCartProductsModalClose {
        padding: 0px;
        font-weight: bold;
        transform: rotate(45deg);
        font-size: 40px;
        position: absolute;
        top: -10px;
        right: 5px;
        color: #CB33FB;
        cursor: pointer;
        user-select: none;
    }
    div.gbbFooterTotalContainer:nth-child(3) {
        display: none;
    }
    .gbbCartModalProductRemoveButtonIcon > svg:nth-child(1) {
        background: #CB33FB !important;
        border-radius: 50% !important;
        fill: #fff !important;
        width: 15px !important;
        height: 15px !important;
        border: 1px solid #CB33FB !important;
        
    }
    .gbbCartProductImageContainer {
        border: 1px solid #CB33FB;
        border-radius: 10px;
    }
    .gbbCartModalProductImage {
        border-radius: 10px;
    }
    .gbbAddProductPageSubtext {
        text-align: center;
        font-size: 28px;
        font-weight: 900;
        line-height: 36px;
        padding: 30px 4rem 10px 4rem;
        color: #CB33FB !important;
    }
    .gbbCartModalProductQuantity {
        font-weight: 900;
        font-size: 16px !important;
        line-height: 18px;
        color: #1d1d1d;
    }
    .gbbCartModalProductPriceQtyContainer {
        margin: auto;
        display: flex;

    }
    .gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {
        line-height: 18px !important;
        color: #1D1D1B !important;
    }

}</style>
    
    <style>  </style>
    
      <style>
    .gbbLoadingScreen{
    user-select: none;
    z-index: 1;
    /* background: #fff; */
    position: unset;
    top: 0;
    left: 0;
    width: 100%;
    height: 1000px;
    display: grid;
    justify-content: center;
    align-items: center;
    }
    </style>
    
    </div>
<script>
window.easyBundlesConfig= {
shopName: "ahead-nutrition.myshopify.com",
bundleId: 1,
targetSelector: '#myContent'
};
</script>
<script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/easyBundlesBuilderPageEmbedv1.js.download"></script>
  </div>
</div>


</section>
      
    </main><div tabindex="-1" aria-hidden="true" id="web-pixels-manager-sandbox-container" data-shopify-privacy="exclude" style="height: 0px !important; width: 0px !important; position: fixed !important; visibility: hidden !important; overflow: hidden !important; z-index: -100 !important; margin: 0px !important; padding: 0px !important; border: 0px !important;"><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-2916616-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new.html" id="web-pixel-sandbox-CUSTOM-2916616-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-3014920-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(1).html" id="web-pixel-sandbox-CUSTOM-3014920-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-90177800-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(2).html" id="web-pixel-sandbox-CUSTOM-90177800-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-91685128-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(3).html" id="web-pixel-sandbox-CUSTOM-91685128-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-106627336-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(4).html" id="web-pixel-sandbox-CUSTOM-106627336-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-140574984-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(5).html" id="web-pixel-sandbox-CUSTOM-140574984-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe><iframe tabindex="-1" aria-hidden="true" name="web-pixel-sandbox-CUSTOM-shopify-custom-pixel-LAX-c93fac4ewa0d30776p1feda67fm7b175787" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bundle-builder-new(6).html" id="web-pixel-sandbox-CUSTOM-shopify-custom-pixel-LAX-c93fac4ewa0d30776p1feda67fm7b175787" sandbox="allow-scripts allow-forms" style="height: 0px !important; width: 0px !important; visibility: hidden !important;"></iframe></div>

    <div id="shopify-section-new-footer" class="shopify-section"><link href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/section-footer.css" rel="stylesheet" type="text/css" media="all">

<style>
  .footerNews, .footerNews:before {
    background-color: #f1ff00;
  }
  .footerMenu, .footerMenu:before {
    background-color: #cb33fb;
  }
</style>
<footer class="footer">
  <div class="page-width-desktop">
    <div class="footerContainer">
      <div class="footerNews">
        
        
    <!-- Klaviyo
        <div class="klaviyo-form-VAdpUB"></div>
        <div class="klaviyo-form-UxsD73"></div> -->
        
      </div>
      <div class="footerMenu">
        <div class="footerTop">
                    <div class="footerOther">
            
              <p class="headingClass heading-new-footer">Service</p>
            
            
              <a href="https://ahead-help-center.gorgias.help/de-DE" class="buttonClass button-new-footer">Ich benötige Hilfe</a>
            
          </div>
          <div class="footerNav">
            
            <div class="footerNav1"><span class="footerNaviheader"> Unternehmen</span><a href="https://www.ahead-nutrition.com/pages/about-us" class="footerLink">
                            Über uns
                          </a><a href="https://www.ahead-nutrition.com/pages/agb" class="footerLink">
                            AGB
                          </a><a href="https://www.ahead-nutrition.com/pages/datenschutz" class="footerLink">
                            Datenschutzerklärung
                          </a><a href="https://www.ahead-nutrition.com/pages/impressum" class="footerLink">
                            Impressum
                          </a><a href="https://ahead-help-center.gorgias.help/de-DE/wie-kann-ich-meine-bestellung-widerrufen-335647" class="footerLink">
                            Widerrufsbelehrung
                          </a></div>
            <div class="footerNav2"><span class="footerNaviheader"> Informationen</span><a href="https://ahead-nutrition.notion.site/WILL-YOU-GO-AHEAD-WITH-US-a916a2b3c72e4e87b5eb3ed2ff1d33ad" class="footerLink">
                            Jobs
                          </a><a href="https://www.ahead-nutrition.com/pages/store-locator" class="footerLink">
                            Store Finder
                          </a><a href="https://ahead-help-center.gorgias.help/de-DE/was-sind-eure-versandkonditionen-335646" class="footerLink">
                            Versandkosten
                          </a><a href="https://ahead-help-center.gorgias.help/de-DE/was-ist-die-geschmacksgarantie-335644" class="footerLink">
                            Geschmacksgarantie
                          </a><a href="https://www.ahead-nutrition.com/pages/referral-freunde-werben" class="footerLink">
                            10€ für dich
                          </a></div>
            <div class="footerNav3"><span class="footerNaviheader"> Hilfe &amp; Kontakt</span><a href="https://ahead-help-center.gorgias.help/de-DE" class="footerLink">
                            Hilfe
                          </a><a href="https://www.ahead-nutrition.com/pages/kontakt" class="footerLink">
                            Kontakt
                          </a><a href="https://ahead-help-center.gorgias.help/de-DE/articles/versand-&amp;-lieferung-96032" class="footerLink">
                            Versand &amp; Lieferung
                          </a><a href="https://ahead-help-center.gorgias.help/de-DE/articles/rucksendung-&amp;-erstattung-96029" class="footerLink">
                            Rücksendung &amp; Erstattung
                          </a><a href="https://www.ahead-nutrition.com/pages/retoure-anmelden" class="footerLink">
                            Retoure anmelden
                          </a><script>
  document.addEventListener('DOMContentLoaded', function() {
    // Target the footer links within the .footerNav3 container
    const footerLinks = document.querySelectorAll('.footerNav3 .footerLink');

    // Loop through each link to add click event listener
    footerLinks.forEach(function(link) {
      link.addEventListener('click', function(event) {
        // Check if the link text is exactly 'Kontakt'
        if (event.target.textContent.trim() === 'Kontakt') {
          event.preventDefault(); // Prevent the default link action

          // Trigger the Typeform embed script
          var div = document.createElement('div');
          div.setAttribute('data-tf-live', '01HGFK3DXN7X7TZFY5BZB0G7DS');
          document.body.appendChild(div);
          var script = document.createElement('script');
          script.src = '//embed.typeform.com/next/embed.js';
          document.body.appendChild(script);
        }
      });
    });
  });
</script>
            </div>
          </div>
        </div> 
        <div class="footerBottom">
          <div class="footerBottomTop">
            <div class="paymentDiv">
              <p class="footerTitle2">Sicher zahlen mit:</p>
              <div class="paymentOptions"><div class="list-payment__item">
                    <svg class="icon icon--full-color" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="pi-american_express" viewBox="0 0 38 24" width="38" height="24"><title id="pi-american_express">American Express</title><path fill="#000" d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3Z" opacity=".07"></path><path fill="#006FCF" d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32Z"></path><path fill="#FFF" d="M22.012 19.936v-8.421L37 11.528v2.326l-1.732 1.852L37 17.573v2.375h-2.766l-1.47-1.622-1.46 1.628-9.292-.02Z"></path><path fill="#006FCF" d="M23.013 19.012v-6.57h5.572v1.513h-3.768v1.028h3.678v1.488h-3.678v1.01h3.768v1.531h-5.572Z"></path><path fill="#006FCF" d="m28.557 19.012 3.083-3.289-3.083-3.282h2.386l1.884 2.083 1.89-2.082H37v.051l-3.017 3.23L37 18.92v.093h-2.307l-1.917-2.103-1.898 2.104h-2.321Z"></path><path fill="#FFF" d="M22.71 4.04h3.614l1.269 2.881V4.04h4.46l.77 2.159.771-2.159H37v8.421H19l3.71-8.421Z"></path><path fill="#006FCF" d="m23.395 4.955-2.916 6.566h2l.55-1.315h2.98l.55 1.315h2.05l-2.904-6.566h-2.31Zm.25 3.777.875-2.09.873 2.09h-1.748Z"></path><path fill="#006FCF" d="M28.581 11.52V4.953l2.811.01L32.84 9l1.456-4.046H37v6.565l-1.74.016v-4.51l-1.644 4.494h-1.59L30.35 7.01v4.51h-1.768Z"></path></svg>

                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" version="1.1" xmlns="http://www.w3.org/2000/svg" role="img" x="0" y="0" width="38" height="24" viewBox="0 0 165.521 105.965" xml:space="preserve" aria-labelledby="pi-apple_pay"><title id="pi-apple_pay">Apple Pay</title><path fill="#000" d="M150.698 0H14.823c-.566 0-1.133 0-1.698.003-.477.004-.953.009-1.43.022-1.039.028-2.087.09-3.113.274a10.51 10.51 0 0 0-2.958.975 9.932 9.932 0 0 0-4.35 4.35 10.463 10.463 0 0 0-.975 2.96C.113 9.611.052 10.658.024 11.696a70.22 70.22 0 0 0-.022 1.43C0 13.69 0 14.256 0 14.823v76.318c0 .567 0 1.132.002 1.699.003.476.009.953.022 1.43.028 1.036.09 2.084.275 3.11a10.46 10.46 0 0 0 .974 2.96 9.897 9.897 0 0 0 1.83 2.52 9.874 9.874 0 0 0 2.52 1.83c.947.483 1.917.79 2.96.977 1.025.183 2.073.245 3.112.273.477.011.953.017 1.43.02.565.004 1.132.004 1.698.004h135.875c.565 0 1.132 0 1.697-.004.476-.002.952-.009 1.431-.02 1.037-.028 2.085-.09 3.113-.273a10.478 10.478 0 0 0 2.958-.977 9.955 9.955 0 0 0 4.35-4.35c.483-.947.789-1.917.974-2.96.186-1.026.246-2.074.274-3.11.013-.477.02-.954.022-1.43.004-.567.004-1.132.004-1.699V14.824c0-.567 0-1.133-.004-1.699a63.067 63.067 0 0 0-.022-1.429c-.028-1.038-.088-2.085-.274-3.112a10.4 10.4 0 0 0-.974-2.96 9.94 9.94 0 0 0-4.35-4.35A10.52 10.52 0 0 0 156.939.3c-1.028-.185-2.076-.246-3.113-.274a71.417 71.417 0 0 0-1.431-.022C151.83 0 151.263 0 150.698 0z"></path><path fill="#FFF" d="M150.698 3.532l1.672.003c.452.003.905.008 1.36.02.793.022 1.719.065 2.583.22.75.135 1.38.34 1.984.648a6.392 6.392 0 0 1 2.804 2.807c.306.6.51 1.226.645 1.983.154.854.197 1.783.218 2.58.013.45.019.9.02 1.36.005.557.005 1.113.005 1.671v76.318c0 .558 0 1.114-.004 1.682-.002.45-.008.9-.02 1.35-.022.796-.065 1.725-.221 2.589a6.855 6.855 0 0 1-.645 1.975 6.397 6.397 0 0 1-2.808 2.807c-.6.306-1.228.511-1.971.645-.881.157-1.847.2-2.574.22-.457.01-.912.017-1.379.019-.555.004-1.113.004-1.669.004H14.801c-.55 0-1.1 0-1.66-.004a74.993 74.993 0 0 1-1.35-.018c-.744-.02-1.71-.064-2.584-.22a6.938 6.938 0 0 1-1.986-.65 6.337 6.337 0 0 1-1.622-1.18 6.355 6.355 0 0 1-1.178-1.623 6.935 6.935 0 0 1-.646-1.985c-.156-.863-.2-1.788-.22-2.578a66.088 66.088 0 0 1-.02-1.355l-.003-1.327V14.474l.002-1.325a66.7 66.7 0 0 1 .02-1.357c.022-.792.065-1.717.222-2.587a6.924 6.924 0 0 1 .646-1.981c.304-.598.7-1.144 1.18-1.623a6.386 6.386 0 0 1 1.624-1.18 6.96 6.96 0 0 1 1.98-.646c.865-.155 1.792-.198 2.586-.22.452-.012.905-.017 1.354-.02l1.677-.003h135.875"></path><g><g><path fill="#000" d="M43.508 35.77c1.404-1.755 2.356-4.112 2.105-6.52-2.054.102-4.56 1.355-6.012 3.112-1.303 1.504-2.456 3.959-2.156 6.266 2.306.2 4.61-1.152 6.063-2.858"></path><path fill="#000" d="M45.587 39.079c-3.35-.2-6.196 1.9-7.795 1.9-1.6 0-4.049-1.8-6.698-1.751-3.447.05-6.645 2-8.395 5.1-3.598 6.2-.95 15.4 2.55 20.45 1.699 2.5 3.747 5.25 6.445 5.151 2.55-.1 3.549-1.65 6.647-1.65 3.097 0 3.997 1.65 6.696 1.6 2.798-.05 4.548-2.5 6.247-5 1.95-2.85 2.747-5.6 2.797-5.75-.05-.05-5.396-2.101-5.446-8.251-.05-5.15 4.198-7.6 4.398-7.751-2.399-3.548-6.147-3.948-7.447-4.048"></path></g><g><path fill="#000" d="M78.973 32.11c7.278 0 12.347 5.017 12.347 12.321 0 7.33-5.173 12.373-12.529 12.373h-8.058V69.62h-5.822V32.11h14.062zm-8.24 19.807h6.68c5.07 0 7.954-2.729 7.954-7.46 0-4.73-2.885-7.434-7.928-7.434h-6.706v14.894z"></path><path fill="#000" d="M92.764 61.847c0-4.809 3.665-7.564 10.423-7.98l7.252-.442v-2.08c0-3.04-2.001-4.704-5.562-4.704-2.938 0-5.07 1.507-5.51 3.82h-5.252c.157-4.86 4.731-8.395 10.918-8.395 6.654 0 10.995 3.483 10.995 8.89v18.663h-5.38v-4.497h-.13c-1.534 2.937-4.914 4.782-8.579 4.782-5.406 0-9.175-3.222-9.175-8.057zm17.675-2.417v-2.106l-6.472.416c-3.64.234-5.536 1.585-5.536 3.95 0 2.288 1.975 3.77 5.068 3.77 3.95 0 6.94-2.522 6.94-6.03z"></path><path fill="#000" d="M120.975 79.652v-4.496c.364.051 1.247.103 1.715.103 2.573 0 4.029-1.09 4.913-3.899l.52-1.663-9.852-27.293h6.082l6.863 22.146h.13l6.862-22.146h5.927l-10.216 28.67c-2.34 6.577-5.017 8.735-10.683 8.735-.442 0-1.872-.052-2.261-.157z"></path></g></g></svg>

                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" xmlns="http://www.w3.org/2000/svg" role="img" viewBox="0 0 38 24" width="38" height="24" aria-labelledby="pi-google_pay"><title id="pi-google_pay">Google Pay</title><path d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3z" fill="#000" opacity=".07"></path><path d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32" fill="#FFF"></path><path d="M18.093 11.976v3.2h-1.018v-7.9h2.691a2.447 2.447 0 0 1 1.747.692 2.28 2.28 0 0 1 .11 3.224l-.11.116c-.47.447-1.098.69-1.747.674l-1.673-.006zm0-3.732v2.788h1.698c.377.012.741-.135 1.005-.404a1.391 1.391 0 0 0-1.005-2.354l-1.698-.03zm6.484 1.348c.65-.03 1.286.188 1.778.613.445.43.682 1.03.65 1.649v3.334h-.969v-.766h-.049a1.93 1.93 0 0 1-1.673.931 2.17 2.17 0 0 1-1.496-.533 1.667 1.667 0 0 1-.613-1.324 1.606 1.606 0 0 1 .613-1.336 2.746 2.746 0 0 1 1.698-.515c.517-.02 1.03.093 1.49.331v-.208a1.134 1.134 0 0 0-.417-.901 1.416 1.416 0 0 0-.98-.368 1.545 1.545 0 0 0-1.319.717l-.895-.564a2.488 2.488 0 0 1 2.182-1.06zM23.29 13.52a.79.79 0 0 0 .337.662c.223.176.5.269.785.263.429-.001.84-.17 1.146-.472.305-.286.478-.685.478-1.103a2.047 2.047 0 0 0-1.324-.374 1.716 1.716 0 0 0-1.03.294.883.883 0 0 0-.392.73zm9.286-3.75l-3.39 7.79h-1.048l1.281-2.728-2.224-5.062h1.103l1.612 3.885 1.569-3.885h1.097z" fill="#5F6368"></path><path d="M13.986 11.284c0-.308-.024-.616-.073-.92h-4.29v1.747h2.451a2.096 2.096 0 0 1-.9 1.373v1.134h1.464a4.433 4.433 0 0 0 1.348-3.334z" fill="#4285F4"></path><path d="M9.629 15.721a4.352 4.352 0 0 0 3.01-1.097l-1.466-1.14a2.752 2.752 0 0 1-4.094-1.44H5.577v1.17a4.53 4.53 0 0 0 4.052 2.507z" fill="#34A853"></path><path d="M7.079 12.05a2.709 2.709 0 0 1 0-1.735v-1.17H5.577a4.505 4.505 0 0 0 0 4.075l1.502-1.17z" fill="#FBBC04"></path><path d="M9.629 8.44a2.452 2.452 0 0 1 1.74.68l1.3-1.293a4.37 4.37 0 0 0-3.065-1.183 4.53 4.53 0 0 0-4.027 2.5l1.502 1.171a2.715 2.715 0 0 1 2.55-1.875z" fill="#EA4335"></path></svg>

                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" width="38" height="24" role="img" aria-labelledby="pi-maestro"><title id="pi-maestro">Maestro</title><path opacity=".07" d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3z"></path><path fill="#fff" d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32"></path><circle fill="#EB001B" cx="15" cy="12" r="7"></circle><circle fill="#00A2E5" cx="23" cy="12" r="7"></circle><path fill="#7375CF" d="M22 12c0-2.4-1.2-4.5-3-5.7-1.8 1.3-3 3.4-3 5.7s1.2 4.5 3 5.7c1.8-1.2 3-3.3 3-5.7z"></path></svg>
                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" width="38" height="24" aria-labelledby="pi-master"><title id="pi-master">Mastercard</title><path opacity=".07" d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3z"></path><path fill="#fff" d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32"></path><circle fill="#EB001B" cx="15" cy="12" r="7"></circle><circle fill="#F79E1B" cx="23" cy="12" r="7"></circle><path fill="#FF5F00" d="M22 12c0-2.4-1.2-4.5-3-5.7-1.8 1.3-3 3.4-3 5.7s1.2 4.5 3 5.7c1.8-1.2 3-3.3 3-5.7z"></path></svg>
                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" width="38" height="24" role="img" aria-labelledby="pi-paypal"><title id="pi-paypal">PayPal</title><path opacity=".07" d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3z"></path><path fill="#fff" d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32"></path><path fill="#003087" d="M23.9 8.3c.2-1 0-1.7-.6-2.3-.6-.7-1.7-1-3.1-1h-4.1c-.3 0-.5.2-.6.5L14 15.6c0 .2.1.4.3.4H17l.4-3.4 1.8-2.2 4.7-2.1z"></path><path fill="#3086C8" d="M23.9 8.3l-.2.2c-.5 2.8-2.2 3.8-4.6 3.8H18c-.3 0-.5.2-.6.5l-.6 3.9-.2 1c0 .2.1.4.3.4H19c.3 0 .5-.2.5-.4v-.1l.4-2.4v-.1c0-.2.3-.4.5-.4h.3c2.1 0 3.7-.8 4.1-3.2.2-1 .1-1.8-.4-2.4-.1-.5-.3-.7-.5-.8z"></path><path fill="#012169" d="M23.3 8.1c-.1-.1-.2-.1-.3-.1-.1 0-.2 0-.3-.1-.3-.1-.7-.1-1.1-.1h-3c-.1 0-.2 0-.2.1-.2.1-.3.2-.3.4l-.7 4.4v.1c0-.3.3-.5.6-.5h1.3c2.5 0 4.1-1 4.6-3.8v-.2c-.1-.1-.3-.2-.5-.2h-.1z"></path></svg>
                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" viewBox="-36 25 38 24" xmlns="http://www.w3.org/2000/svg" width="38" height="24" role="img" aria-labelledby="pi-unionpay"><title id="pi-unionpay">Union Pay</title><path fill="#005B9A" d="M-36 46.8v.7-.7zM-18.3 25v24h-7.2c-1.3 0-2.1-1-1.8-2.3l4.4-19.4c.3-1.3 1.9-2.3 3.2-2.3h1.4zm12.6 0c-1.3 0-2.9 1-3.2 2.3l-4.5 19.4c-.3 1.3.5 2.3 1.8 2.3h-4.9V25h10.8z"></path><path fill="#E9292D" d="M-19.7 25c-1.3 0-2.9 1.1-3.2 2.3l-4.4 19.4c-.3 1.3.5 2.3 1.8 2.3h-8.9c-.8 0-1.5-.6-1.5-1.4v-21c0-.8.7-1.6 1.5-1.6h14.7z"></path><path fill="#0E73B9" d="M-5.7 25c-1.3 0-2.9 1.1-3.2 2.3l-4.4 19.4c-.3 1.3.5 2.3 1.8 2.3H-26h.5c-1.3 0-2.1-1-1.8-2.3l4.4-19.4c.3-1.3 1.9-2.3 3.2-2.3h14z"></path><path fill="#059DA4" d="M2 26.6v21c0 .8-.6 1.4-1.5 1.4h-12.1c-1.3 0-2.1-1.1-1.8-2.3l4.5-19.4C-8.6 26-7 25-5.7 25H.5c.9 0 1.5.7 1.5 1.6z"></path><path fill="#fff" d="M-21.122 38.645h.14c.14 0 .28-.07.28-.14l.42-.63h1.19l-.21.35h1.4l-.21.63h-1.68c-.21.28-.42.42-.7.42h-.84l.21-.63m-.21.91h3.01l-.21.7h-1.19l-.21.7h1.19l-.21.7h-1.19l-.28 1.05c-.07.14 0 .28.28.21h.98l-.21.7h-1.89c-.35 0-.49-.21-.35-.63l.35-1.33h-.77l.21-.7h.77l.21-.7h-.7l.21-.7zm4.83-1.75v.42s.56-.42 1.12-.42h1.96l-.77 2.66c-.07.28-.35.49-.77.49h-2.24l-.49 1.89c0 .07 0 .14.14.14h.42l-.14.56h-1.12c-.42 0-.56-.14-.49-.35l1.47-5.39h.91zm1.68.77h-1.75l-.21.7s.28-.21.77-.21h1.05l.14-.49zm-.63 1.68c.14 0 .21 0 .21-.14l.14-.35h-1.75l-.14.56 1.54-.07zm-1.19.84h.98v.42h.28c.14 0 .21-.07.21-.14l.07-.28h.84l-.14.49c-.07.35-.35.49-.77.56h-.56v.77c0 .14.07.21.35.21h.49l-.14.56h-1.19c-.35 0-.49-.14-.49-.49l.07-2.1zm4.2-2.45l.21-.84h1.19l-.07.28s.56-.28 1.05-.28h1.47l-.21.84h-.21l-1.12 3.85h.21l-.21.77h-.21l-.07.35h-1.19l.07-.35h-2.17l.21-.77h.21l1.12-3.85h-.28m1.26 0l-.28 1.05s.49-.21.91-.28c.07-.35.21-.77.21-.77h-.84zm-.49 1.54l-.28 1.12s.56-.28.98-.28c.14-.42.21-.77.21-.77l-.91-.07zm.21 2.31l.21-.77h-.84l-.21.77h.84zm2.87-4.69h1.12l.07.42c0 .07.07.14.21.14h.21l-.21.7h-.77c-.28 0-.49-.07-.49-.35l-.14-.91zm-.35 1.47h3.57l-.21.77h-1.19l-.21.7h1.12l-.21.77h-1.26l-.28.42h.63l.14.84c0 .07.07.14.21.14h.21l-.21.7h-.7c-.35 0-.56-.07-.56-.35l-.14-.77-.56.84c-.14.21-.35.35-.63.35h-1.05l.21-.7h.35c.14 0 .21-.07.35-.21l.84-1.26h-1.05l.21-.77h1.19l.21-.7h-1.19l.21-.77zm-19.74-5.04c-.14.7-.42 1.19-.91 1.54-.49.35-1.12.56-1.89.56-.7 0-1.26-.21-1.54-.56-.21-.28-.35-.56-.35-.98 0-.14 0-.35.07-.56l.84-3.92h1.19l-.77 3.92v.28c0 .21.07.35.14.49.14.21.35.28.7.28s.7-.07.91-.28c.21-.21.42-.42.49-.77l.77-3.92h1.19l-.84 3.92m1.12-1.54h.84l-.07.49.14-.14c.28-.28.63-.42 1.05-.42.35 0 .63.14.77.35.14.21.21.49.14.91l-.49 2.38h-.91l.42-2.17c.07-.28.07-.49 0-.56-.07-.14-.21-.14-.35-.14-.21 0-.42.07-.56.21-.14.14-.28.35-.28.63l-.42 2.03h-.91l.63-3.57m9.8 0h.84l-.07.49.14-.14c.28-.28.63-.42 1.05-.42.35 0 .63.14.77.35s.21.49.14.91l-.49 2.38h-.91l.42-2.24c.07-.21 0-.42-.07-.49-.07-.14-.21-.14-.35-.14-.21 0-.42.07-.56.21-.14.14-.28.35-.28.63l-.42 2.03h-.91l.7-3.57m-5.81 0h.98l-.77 3.5h-.98l.77-3.5m.35-1.33h.98l-.21.84h-.98l.21-.84zm1.4 4.55c-.21-.21-.35-.56-.35-.98v-.21c0-.07 0-.21.07-.28.14-.56.35-1.05.7-1.33.35-.35.84-.49 1.33-.49.42 0 .77.14 1.05.35.21.21.35.56.35.98v.21c0 .07 0 .21-.07.28-.14.56-.35.98-.7 1.33-.35.35-.84.49-1.33.49-.35 0-.7-.14-1.05-.35m1.89-.7c.14-.21.28-.49.35-.84v-.35c0-.21-.07-.35-.14-.49a.635.635 0 0 0-.49-.21c-.28 0-.49.07-.63.28-.14.21-.28.49-.35.84v.28c0 .21.07.35.14.49.14.14.28.21.49.21.28.07.42 0 .63-.21m6.51-4.69h2.52c.49 0 .84.14 1.12.35.28.21.35.56.35.91v.28c0 .07 0 .21-.07.28-.07.49-.35.98-.7 1.26-.42.35-.84.49-1.4.49h-1.4l-.42 2.03h-1.19l1.19-5.6m.56 2.59h1.12c.28 0 .49-.07.7-.21.14-.14.28-.35.35-.63v-.28c0-.21-.07-.35-.21-.42-.14-.07-.35-.14-.7-.14h-.91l-.35 1.68zm8.68 3.71c-.35.77-.7 1.26-.91 1.47-.21.21-.63.7-1.61.7l.07-.63c.84-.28 1.26-1.4 1.54-1.96l-.28-3.78h1.19l.07 2.38.91-2.31h1.05l-2.03 4.13m-2.94-3.85l-.42.28c-.42-.35-.84-.56-1.54-.21-.98.49-1.89 4.13.91 2.94l.14.21h1.12l.7-3.29-.91.07m-.56 1.82c-.21.56-.56.84-.91.77-.28-.14-.35-.63-.21-1.19.21-.56.56-.84.91-.77.28.14.35.63.21 1.19"></path></svg>
                  </div><div class="list-payment__item">
                    <svg class="icon icon--full-color" viewBox="0 0 38 24" xmlns="http://www.w3.org/2000/svg" role="img" width="38" height="24" aria-labelledby="pi-visa"><title id="pi-visa">Visa</title><path opacity=".07" d="M35 0H3C1.3 0 0 1.3 0 3v18c0 1.7 1.4 3 3 3h32c1.7 0 3-1.3 3-3V3c0-1.7-1.4-3-3-3z"></path><path fill="#fff" d="M35 1c1.1 0 2 .9 2 2v18c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V3c0-1.1.9-2 2-2h32"></path><path d="M28.3 10.1H28c-.4 1-.7 1.5-1 3h1.9c-.3-1.5-.3-2.2-.6-3zm2.9 5.9h-1.7c-.1 0-.1 0-.2-.1l-.2-.9-.1-.2h-2.4c-.1 0-.2 0-.2.2l-.3.9c0 .1-.1.1-.1.1h-2.1l.2-.5L27 8.7c0-.5.3-.7.8-.7h1.5c.1 0 .2 0 .2.2l1.4 6.5c.1.4.2.7.2 1.1.1.1.1.1.1.2zm-13.4-.3l.4-1.8c.1 0 .2.1.2.1.7.3 1.4.5 2.1.4.2 0 .5-.1.7-.2.5-.2.5-.7.1-1.1-.2-.2-.5-.3-.8-.5-.4-.2-.8-.4-1.1-.7-1.2-1-.8-2.4-.1-3.1.6-.4.9-.8 1.7-.8 1.2 0 2.5 0 3.1.2h.1c-.1.6-.2 1.1-.4 1.7-.5-.2-1-.4-1.5-.4-.3 0-.6 0-.9.1-.2 0-.3.1-.4.2-.2.2-.2.5 0 .7l.5.4c.4.2.8.4 1.1.6.5.3 1 .8 1.1 1.4.2.9-.1 1.7-.9 2.3-.5.4-.7.6-1.4.6-1.4 0-2.5.1-3.4-.2-.1.2-.1.2-.2.1zm-3.5.3c.1-.7.1-.7.2-1 .5-2.2 1-4.5 1.4-6.7.1-.2.1-.3.3-.3H18c-.2 1.2-.4 2.1-.7 3.2-.3 1.5-.6 3-1 4.5 0 .2-.1.2-.3.2M5 8.2c0-.1.2-.2.3-.2h3.4c.5 0 .9.3 1 .8l.9 4.4c0 .1 0 .1.1.2 0-.1.1-.1.1-.1l2.1-5.1c-.1-.1 0-.2.1-.2h2.1c0 .1 0 .1-.1.2l-3.1 7.3c-.1.2-.1.3-.2.4-.1.1-.3 0-.5 0H9.7c-.1 0-.2 0-.2-.2L7.9 9.5c-.2-.2-.5-.5-.9-.6-.6-.3-1.7-.5-1.9-.5L5 8.2z" fill="#142688"></path></svg>
                  </div></div>
            </div>
            <div class="shippingDiv">
              <p class="footerTitle2">Schneller Versand durch:</p>
              <div class="shippingOptions">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="24" viewBox="0 0 36 24" fill="none">
                <rect x="-7.14941" y="-6" width="51.0638" height="37" fill="url(#pattern0)"></rect>
                <defs>
                <pattern id="pattern0" patternContentUnits="objectBoundingBox" width="1" height="1">
                <use xlink:href="#image0_4034_2391" transform="translate(0 -0.0175388) scale(0.00125 0.00172513)"></use>
                </pattern>
                <image id="image0_4034_2391" width="800" height="600" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAyAAAAJYCAYAAACadoJwAAAgAElEQVR4Ae3debBkaVnncfJG5a24S9w1aTZlFUdApR0EZBQcF1RGRwFnFBxwBgZU3MANFxzbBZFRGFQCRBpEllAEASGQrekQaO41Zv7r6Oo1eu/otaK6uruiqroqquqdeM/NA8n13pt5T76Zlfm+n464kVXVdbLyfM833/P8nvO+5zzkIf5DAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQKIdA+HLrTPhyK/jBgAMc4AAHOMABDiRx4Ew5laQ9RaABAQEkyUAjwAmxHOAABzjAAQ7UDgggDWpSmxREQAARQHS7OMABDnCAAxxI6oAAUlAtbVcbEBBAkg44defDqy4YBzjAAQ5woFwHBJAGNalNCiIggAggul4c4AAHOMABDiR1QAApqJa2qw0ICCBJBxzdrnK7XY69Y88BDnCAA7UDAkiDmtQmBREQQAQQXS8OcIADHOAAB5I6IIAUVEvb1QYEBJCkA07d+fCqC8YBDnCAAxwo1wEBpEFNapOCCAggAoiuFwc4wAEOcIADSR0QQAqqpe1qAwICSNIBR7er3G6XY+/Yc4ADHOBA7YAA0qAmtUlBBAQQAUTXiwMc4AAHOMCBpA4IIAXV0na1AQEBJOmAU3c+vOqCcYADHOAAB8p1QABpUJPapCACAogAouvFAQ5wgAMc4EBSBwSQgmppu9qAgACSdMDR7Sq32+XYO/Yc4AAHOFA7IIA0qEltUhABAUQA0fXiAAc4wAEOcCCpAwJIQbW0XW1AQABJOuDUnQ+vumAc4AAHOMCBch0QQBrUpDYpiIAAIoDoenGAAxzgAAc4kNQBAaSgWtquNiAggCQdcHS7yu12OfaOPQc4wAEO1A4IIA1qUpsUREAAEUB0vTjAAQ5wgAMcSOqAAFJQLW1XGxAQQJIOOHXnw6suGAc4wAEOcKBcBwSQBjWpTQoiIIAIILpeHOAABzjAAQ4kdUAAKaiWtqsNCAggSQcc3a5yu12OvWPPAQ5wgAO1AwJIg5rUJgUREEAEEF0vDnCAAxzgAAeSOiCAFFRL29UGBASQpANO3fnwqgvGAQ5wgAMcKNcBAaRBTWqTgggIIAKIrhcHOMABDnCAA0kdEEAKqqXtagMCAkjSAUe3q9xul2Pv2HOAAxzgQO2AANKgJrVJQQQEEAFE14sDHOAABzjAgaQOCCAF1dJ2tQEBASTpgFN3PrzqgnGAAxzgAAfKdUAAaVCT2qQgAgKIAKLrxQEOcIADHOBAUgcEkIJqabvagIAAknTA0e0qt9vl2Dv2HOAABzhQOyCANKhJbVIQAQFEANH14gAHOMABDnAgqQMCSEG1tF1tQEAASTrg1J0Pr7pgHOAABzjAgXIdEEAa1KQ2KYiAACKA6HpxgAMc4AAHOJDUAQGkoFrarjYgIIAkHXB0u8rtdjn2jj0HOMABDtQOCCANalKbFERAABFAdL04wAEOcIADHEjqgABSUC1tVxsQEECSDjh158OrLhgHOMABDnCgXAcEkAY1qU0KIiCACCC6XhzgAAc4wAEOJHVAACmolrarDQgIIEkHHN2ucrtdjr1jzwEOcIADtQMCSIOa1CYFERBABBBdLw5wgAMc4AAHkjoggBRUS9vVBgQEkKQDTt358KoLxgEOcIADHCjXAQGkQU1qk4IICCACiK4XBzjAAQ5wgANJHRBACqql7WoDAgJI0gFHt6vcbpdj79hzgAMc4EDtgADSoCa1SUEEBBABRNeLAxzgAAc4wIGkDgggBdXSdrUBAQEk6YBTdz686oJxgAMc4AAHynVAAGlQk9qkIAICiACi68UBDnCAAxzgQFIHBJCCamm72oCAAJJ0wNHtKrfb5dg79hzgAAc4UDsggDSoSW1SEAEBRADR9eIABzjAAQ5wIKkDAkhBtbRdbUBAAEk64NSdD6+6YBzgAAc4wIFyHRBAGtSkNimIgAAigOh6cYADHOAABziQ1AEBpKBa2q42ICCAJB1wdLvK7XY59o49BzjAAQ7UDgggDWpSmxREQAARQHS9OMABDnCAAxxI6oAAUlAtbVcbEBBAkg44defDqy4YBzjAAQ5woFwHBJAGNalNCiIggAggul4c4AAHOMABDiR1QAApqJa2qw0ICCBJBxzdrnK7XY69Y88BDnCAA7UDAkiDmtQmBREQQAQQXS8OcIADHOAAB5I6IIAUVEvb1QYEBJCkA07d+fCqC8YBDnCAAxwo1wEBpEFNapOCCAggAoiuFwc4wAEOcIADSR0QQAqqpe1qAwICSNIBR7er3G6XY+/Yc4ADHOBA7YAA0qAmtUlBBAQQAUTXiwMc4AAHOMCBpA4IIAXV0na1AQEBJOmAU3c+vOqCcYADHOAAB8p1QABpUJPapCACAogAouvFAQ5wgAMc4EBSBwSQgmppu9qAgACSdMDR7Sq32+XYO/Yc4AAHOFA7IIA0qEltUhABAUQA0fXiAAc4wAEOcCCpAwJIQbW0XW1AQABJOuDUnQ+vumAc4AAHOMCBch0QQBrUpDYpiIAAIoDoenGAAxzgAAc4kNQBAaSgWtquNiAggCQdcHS7yu12OfaOPQc4wAEO1A4IIA1qUpsUREAAEUB0vTjAAQ5wgAMcSOqAAFJQLW1XGxAQQJIOOHXnw6suGAc4wAEOcKBcBwSQBjWpTQoiIIAIILpeHOAABzjAAQ4kdUAAKaiWtqsNCAggSQcc3a5yu12OvWPPAQ5wgAO1AwJIg5rUJgUREEAEEF0vDnCAAxzgAAeSOiCAFFRL29UGBASQpANO3fnwqgvGAQ5wgAMcKNcBAaRBTWqTgggIIAKIrhcHOMABDnCAA0kdEEAKqqXtagMCAkjSAUe3q9xul2Pv2HOAAxzgQO2AANKgJrVJQQQEEAFE14sDHOAABzjAgaQOCCAF1dJ2tQEBASTpgFN3PrzqgnGAAxzgAAfKdUAAaVCT2qQgAgKIAKLrxQEOcIADHOBAUgcEkIJqabvagIAAknTA0e0qt9vl2Dv2HOAABzhQOyCANKhJbVIQAQFEANH14gAHOMABDnAgqQMCSEG1tF1tQEAASTrg1J0Pr7pgHOAABzjAgXIdEEAa1KQ2KYiAACKA6HpxgAMc4AAHOJDUAQGkoFrarjYgIIAkHXB0u8rtdjn2jj0HOMABDtQOCCANalKbFERAABFAdL04wAEOcIADHEjqgABSUC1tVxsQEECSDjh158OrLhgHOMABDnCgXAcEkAY1qU0KIiCACCC6XhzgAAc4wAEOJHVAACmolrarDQgIIEkHHN2ucrtdjr1jzwEOcIADtQMCSIOa1CYFERBABBBdLw5wgAMc4AAHkjoggBRUS9vVBgQEkKQDTt358KoLxgEOcIADHCjXAQGkQU1qk4IICCACiK4XBzjAAQ5wgANJHRBACqql7WoDAgJI0gFHt6vcbpdj79hzgAMc4EDtgADSoCa1SUEEBBABRNeLAxzgAAc4wIGkDgggBdXSdrUBAQEk6YBTdz686oJxgAMc4AAHynVAAGlQk9qkIAICiACi68UBDnCAAxzgQFIHBJCCamm72oCAAJJ0wNHtKrfb5dg79hzgAAc4UDsggDSoSW1SEAEBRADR9eIABzjAAQ5wIKkDAkhBtbRdbUBAAEk64NSdD6+6YBzgAAc4wIFyHRBAGtSkNimIgAAigOh6cYADHOAABziQ1AEBpKBa2q42ICCAJB1wdLvK7XY59o49BzjAAQ7UDgggDWpSmxREQAARQHS9OMABDnCAAxxI6oAAUlAtbVcbEBBAkg44defDqy4YBzjAAQ5woFwHBJAGNalNCiIggAggul4c4AAHOMABDiR1QAApqJa2qw0ICCBJBxzdrnK7XY69Y88BDnCAA7UDAkiDmtQmBREQQAQQXS8OcIADHOAAB5I6IIAUVEvb1QYEBJCkA07d+fCqC8YBDnCAAxwo1wEBpEFNapOCCAggAoiuFwc4wAEOcIADSR0QQAqqpe1qAwICSNIBR7er3G6XY+/Yc4ADHOBA7YAA0qAmtUlBBAQQAUTXiwMc4AAHOMCBpA4IIAXV0na1AQEBJOmAU3c+vOqCcYADHOAAB8p1QABpUJPapCACAogAouvFAQ5wgAMc4EBSBwSQgmppu9qAgACSdMDR7Sq32+XYO/Yc4AAHOFA7IIA0qEltUhABAUQA0fXiAAc4wAEOcCCpAwJIQbW0XW1AQABJOuDUnQ+vumAc4AAHOMCBch0QQBrUpDYpiIAAIoDoenGAAxzgAAc4kNQBAaSgWtquNiAggCQdcHS7yu12OfaOPQc4wAEO1A4IIA1qUpsUREAAEUB0vTjAAQ5wgAMcSOqAAFJQLW1XGxAQQJIOOHXnw6suGAc4wAEOcKBcBwSQBjWpTQoiIIAIILpeHOAABzjAAQ4kdUAAKaiWtqsNCAggSQcc3a5yu12OvWPPAQ5wgAO1AwJIg5rUJgUREEAEEF0vDnCAAxzgAAeSOiCAFFRL29UGBASQpANO3fnwqgvGAQ5wgAMcKNcBAaRBTWqTgggIIAKIrhcHOMABDnCAA0kdEEAKqqXtagMCAkjSAUe3q9xul2Pv2HOAAxzgQO2AANKgJrVJQQQEEAFE14sDHOAABzjAgaQOCCAF1dJ2tQEBASTpgFN3PrzqgnGAAxzgAAfKdUAAaVCT2qQgAgKIAKLrxQEOcIADHOBAUgcEkIJqabvagIAAknTA0e0qt9vl2Dv2HOAABzhQOyCANKhJbVIQAQFEANH14gAHOMABDnAgqQMCSEG1tF1tQEAASTrg1J0Pr7pgHOAABzjAgXIdEEAa1KQ2KYiAACKA6HpxgAMc4AAHOJDUAQGkoFrarjYgIIAkHXB0u8rtdjn2jj0HOMABDtQOCCANalKbFERAABFAdL04wAEOcIADHEjqgABSUC1tVxsQEECSDjh158OrLhgHOMABDnCgXAcEkAY1qU0KIiCACCC6XhzgAAc4wAEOJHVAACmolrarDQgIIEkHHN2ucrtdjr1jzwEOcIADtQMCSIOa1CYFERBABBBdLw5wgAMc4AAHkjoggBRUS9vVBgQEkKQDTt358KoLxgEOcIADHCjXAQGkQU1qk4IICCACiK4XBzjAAQ5wgANJHRBACqql7WoDAgJI0gFHt6vcbpdj79hzgAMc4EDtgADSoCa1SUEEBBABRNeLAxzgAAc4wIGkDgggBdXSdrUBAQEk6YBTdz686oJxgAMc4AAHynVAAGlQk9qkIAICiACi68UBDnCAAxzgQFIHBJCCamm72oCAAJJ0wNHtKrfb5dg79hzgAAc4UDsggDSoSW1SEAEBRADR9eIABzjAAQ5wIKkDAkhBtbRdbUBAAEk64NSdD6+6YBzgAAc4wIFyHRBAGtSkNimIgAAyxQFksxXCv/qZSgbx2MWfjSn2r2lhEfc5R29HfSwx27mYz9Wn3uM9areafpdtt7OTW1wEkIJqabvagIAAMr0F4Ml3tcMDf3owHPszPxPF4E0Hw7E37/Dzltlw/C9mw4m/mg0n/6YdTn3wQDjzyZlw7kvbCvKci42NVjj7uZlw7C0HwwOZeFvtx5sOhjOfmhlZoDz3hVY4/tbZrL7vcew6/dEDwzHbaIUzn54Jx/5PPj7tNJad+cSQnASFvYLCqP6fANKgJrVJQQQEkCkMIJutEMPHtY9bDYcWO+HQsp/JYrAeDi3v/HPlynq4cm09XHXBerj6kWvhhqeshtt+YDnc/fLFcPR1c+HE22fDmY93i43YAc0sjMSwdfdPL4bI4dBSJt4udsJNT18Jpz82oiJxo1W5cdVDc2G2Xo1b1z5+NZx8T3vrSmCTAnmjFWIwu/O/LnW/b5n49JXxfIvT9U9erZoV1RXTJpxsM6qA0e99BZCCamm72oCAADJlASR2/D41E256xkq4ot0JVxz0M3UMZjvhivqn3QmXH+hsHcv5ThVOrn/SarjzRUvh/tcfDKc/0i1q43StaS8kNlvh/j+aC1d11vNxt90JVz9irbo6MZICMTYb3t0O1z5mNR9mszEorIejvz03XMDuBrMrV9e3vk+5jYWznXDl+np44A0Hm4e0aR8zpvvzCyANalKbFERAAJmuwi52kO96yWK4Yl7wmLrgMUiBFINJDJbtTtUlvu6Jq+Huly2GE++c3ZqqNa1BZLMVHnx/O1z3DZkV0kudcOTV86MJhxk3G+54wVI49y9DXOHLMZhtHx/mO9XVwnNfnK5z1NQ3StKFHgGkoFrarjYgIIBM0eAeO8h/2O0gx0J1+wnL7/NjEsPIbCdc/bC1cMePL4WTF7e3it1pmprVXfdxy3cv59Wpnu2E235wOZy9ZDRrP7JsNrQ74cYLV7emqzUN03Uwe2bGV4HbnXDzdy6PdF2RoDDyc78A0qAmtUlBBASQkQ9CabqjsYP8vna49gkZdZAFpsEDU/fKSFw3cs/PLGytE2lawKXr8A3m9mWt6jPH9UrV1LMcjnu7E+JUuVMfOjCa6TE5NhtikH7kWjj+9tmhmFXB7KUZXwVud8K1j10NJ/92iPUx4/6O+/d2GgsFkIJqabvagIAAMgUBJHaQPzsTbnn2cj7zwHMoQs/HPnSvfMU1QFUhN+lXQjZb1d2urrpgLZ/wMdupbiIQ73Q2qnUfsdlwXU7NhrjuY2k9HPmVIaer5RjMeseRuO5jdT3cd9GQ62MEgp0Cwbj/TABpUJPapCACAsgUBJDYQX7FQrUmwLQrU88qB9qdcM3XrYX7/tfc1tqQSQwiG63qCkG8UpDTDRMOLXSqKzrhshGMHb3NhsymWd72vCGnq3WvAmcVzHrDR/z1XCfc+RNL1d29crsDXoFTvgSQgmppu9qAgAAygiIiZfcpxw7y9pOu3w8+FauXVXvrLjmxqxynpUxUwRJvkfovrWqNRDbTriL7difc8pzlcPYzo1n3EYu0OMWumq7We6yn+dcppqvFYHbJTMU+pzD7NQ2luD7maSvhdH0b7pTnEe817qsf8d8TQBrUpDYpiIAAMsEBZLNV3Yb1+qfk1UH+mpPuNBdWk/DZu7fqvPfX58NIOvJNC5eNVrj3V+er531kE0BGPTd/s1U9wPLqh6/lc8UoTlfrrIcH/vfw09UOv2qhmsaVjU+940d9O+ch18cUeJXhfASLQf9NAaSgWtquNiAggExoAIkd5Etnwu0/vNysO957cvPrvBm2t9Yk3P/HByfjKshmq1qfcs2j8iqkRzo3v242PDmzZsNCJ9z98oWtK3RNw2yOwax3TK7Xx7xmyPUxTfnabtBAsd+/J4A0qEltUhABAWRyA8iR18xXD+zKsuPXewL26+EDUuzOP341PPje83znnHiL1E/MhBu/LbNbpMa5+S9aHM3c/FybDbOdEG+9fObTQ0xXyzWY9Y55s52q0XT280NwEiL2Gw7G8fcFkIJqabvagIAAMoEBJHaQ3zYbrs6pg9x7wvXr4QPHTgzj+oTvWa7umHa+1oPEh6bF55XExbTZTLVrd0K861gMViPhutEK2TUb6kD8viECca7BrPe72+6EG56yGk59eES3cxZMxhE0dvs3BJAGNalNCiIggExYAIkd5I8fCDdemFkHufek69ejKc6rqRydcPR1c6O5PWy/YmajFY7+zlx1G9Fsrtp17zZ24uLhnl2x69z8utnwyMymq62th/v/YMhbyeYYzHrHvup2zmvh2P8Zfn3Mrn71+876/7uFhxR/LoAUVEvb1QYEBJAJCiCx4/eFVrjjhZl1kHtPun49mvBRc+3ecej0Px0YTbd+t4JlsxVOvrsdrn1MRmsYYqBbXg/3vnZ+NCxzbTbMdcJdP7UY4tWwxleM6mCW61Xg6NZiJxz+uYXJunnEbt9vf94kkAggDWpSmxREQACZrABy9Lfm8+og14Wx19EGjx6+sbAZ61WQWEh/aibc9B35XbW74wVL1c0gGhfSuxVuuTYb2p1w83eshDOfHGK6Wq7BrOc7Gq8Q3vr953e6pKsmIz/3CyAF1dJ2tQEBAWTkg9BgnZPYQX5XO1zz6IymYvSecP16bAEkPifhpm9fGdtakPgMkrv+22K4Yj6vdR83XrgaTn90RHPz43S13JoNcbra169VV8IaPyE+12DWO/61O+G6J66GB/9uiPUxuwVbfz7Y+XY8nASQBjWpTQoiIIBMQACpO8jPzK+DnM1C5N4CYtJ/3X32womLx1DgbLbCfX8wVz3rIZt1H7OdcPUj1sLxt45u3ceJ3JoN8Xk0K+vh6G8Pv+4ju2DWO17Uz0X5E+s+CrgCI4AUVEvb1QYEBJDzH0CqDvJPZdZB7j3p+vX4rn7UrOc64d7fmA/hX0fo92YrPPiBdrjuCZmt+1jqhCO/PKJnMtTNhmfk12yIa9fO/ctw6z5iaM76KvB8J9z9PxaHey7KeLr3k3QlYVo/iwDSoCa1SUEEBJARFmiDnChiB/n3M+sg10Ww1/EHj5p5uxNu/b7lredWDOLhfv/ORqua4hWf85DNlY/IbrYTbnvecjh7yRBrGPZgWTUbXpxZs6HdCTf++5Vw+mNDTFfLOJh95SpwvE32s5er9VLJ1xTt4VwBVxomNaAIIAXV0na1AQEB5DwGkNhBfn+7eoBcnLf/lRNVXUR6xaSpA3Ge+TeuhjP/PJpCOlzWCvf8z8XqTj7ZBJDuHcROfWiIQnqvQnCjFe67aC5cub6eT2hrd8LVj1yrnnzfeN3Hl1vVFYG7cgtmvd/d+FyUx66Gk387hmmRezno/40zrAggDWpSmxREQAA5Tx73Q2oAACAASURBVAGk7iA/J7MOcu9J16/PX4DqLgiuHnC2kdjxzVZ44H8fDFddsB6yCc5xbv5D18OxN41obn5sNrwvs2ZD9zbFR35lyOlqOQaz3rEvro9ZXa/CpysficeiyQ5UAkhBtbRdbUBAADlPA+JlrXB3bh3k3pOuX5+/8BHZx4XUD1+rrrAN05n+N9M3NlshXiG4/psyWvdxsBMOLXTCPT8zomcy1M2GZ2fWbJjthNt/ZDmc/fwQV9lyDGbbx765TrjzRYtb0yFTNwMmuwAf59WGSfy3BJAGNalNCiIggJyHABI7yH/S7SDPmnpl6tkIHIgB5GFr4cH3JpzyEQvpz8+E234gv0L61u9ZDmc/M0QhvVchGJsNL89vutoN37waqitsmw3H0FyDWW8AibfEfsZKOPOJEbm1l3f+3/kOJQJIQbW0XW1AQABpePJsOrhvtMKpfzhQzc+//MBWp7qaQx+DiJ/zy6C3cJj2X3dvJZv6WQOHf2Ghejp4Tus+rvuG1epuXkmvFNXjQ2w2vOFgNb0rG2ZxutoFa+HYW4acrhaD2csWq6tP2bDpHTfiNMivWwsnLh7R7Zxrx7ye76Cx278vgDSoSW1SEAEBZLwB5NylMyHerjLON/czQQw661uF9Vwnj3UNcdHrY7oP0ksx7WOzFY79+Wz1fIyc1n3EBeH3v37IQnq3AjBOV+s2G3JidmixEw6/asjpajkGs97w0V0fc+9r54N1H+M9x/6baaO7fT9H/+cCSEG1tF1tQEAAGe/gGO+Tf/Ld7XDiHbPhxF/7mRgGb58Nx958MBz9nblw2w8uh0Mr032nonh17YZvWU3zNPSNVnWL1fh+2RTSsVic74S7XroYzn1xBGNAnF50yUy49bkZTld77vJwXsVg9sGtq8BZ+dQbQA52wh0vWAqx4SSAjOD7NfrwsNtVjf38uQDSoCa1SUEEBJDzMDjGOdN+JotBfGBf/Pm/rXD2czPVcw2qKXLbioqpWa/S7oQ7f3JpPyfLnf/uRqt6uNztP7p8fhfVj+A4VM9k+OxMCP+ve+xrB4Z9/b9b3+94leDQUndq5Qg+/9hd7N7a+cG/H+I2xXUw+/7Mglnv8Y3PRbmwe/Wx6fqY6Siwdx4zfPaaiwBSUC1tVxsQEEDOQwAxQNcD9ES+xqtUNz19JUxzADm0vB4eeOPB4Z+EvtEK9/76fLhyyq8IbS/WDy11qqmQ9/7afIi3kU35c++vzod7XrlQ3YUsmw5/XPfRWa9unjHsWpnsgllv+OiuvTr+Vus+Jmgq1Pk6zwggDWpSmxREQAARQJwoehzY3JoiFx+uNrULY+P6j8evhtMfOTDc9I/NVjVVMC6kzaaQ7i0W469HfeOH7f/etP5+vlMtGI9Pcm88XsR1RG8+mFcw6z2ecd3HUiccefWQz0XRoGru2GSxE0AKqqXtagMCAsgQJ9TJGuxyGbTP337E6SGXzoRbM5gecs8rFobjuNEKZz45E2582kq+4aO3ePTr3afYzXZCNV3t00OsZ9hsVYH4+qdkto6o15vZTrjtecvV2h/rPpxXY23VoCSzCQLlEBBAChko452QpvknzqWOc/NHOac6Tjf6tfnpvs1snKf/xCGfz/DlVrUw+87/uhSuiHcF6y2y/LosHvFq2uNWh3ueTFxHdOlMuP2H81tH9JXvRrsTrn/yavWQzpGOUZpewzVWxstPACmnlLanTQgIIAUEkMta4ehvzYfb/tNyVQTEQmCqfv7zcojF8JFfWth6XsMoTiJxutFfz4Zrvn6KpxvNdqq1Gvf93txwU682WuHo6+bClWvTfSewrxSHQlOz0BR9Wl0P9100vE9HXjPlwX4vh6rnoqxX08uEjwLOp4OffwSQJkWpbcohIIBkPmD2PL/h8lanWlgdF1dP409ch1B1Gf9hiLvw7HTyiNON/nmmWng+7Wsd7vzxpequVY2ngMQ1MH/TDtc+NuOpMnsVk/7fV8PKXCfc9eLFcO4L3aunO313+v3ZZiscf9tsqNZUtfO8mnZooRPu+dkhn4vSj6P/P01XPurPKoCUU0rb0yYEBJCMA0huz2/odmRjQVNNx0p0Uo4La2OhFZ8LMbVd83jrz6ethNP/NEQ4i0Hs0zPh5mdZ9zG1HqQKUO1OuOmZK+HMJ4ZY9xF9+viBcOOFGfs02wm3fu+Qz0VJNI41vjmAf78ODKlfBZAmRaltyiEggGQaQOrnN/zY0vQW1duLqe76htMfHfLuTr0n3M1WuO8P5sKVnSmebtTuVB3mE3813K0/qyD20sUQO7rFF+Db3Svp9+1ONRXxxMXt5muu4vjzhVZ1q+Ns1xF1x6MHPzAEp96xyK9TB4Dz/X4CSDmltD1tQkAAyTeAZPX8hniLy8VO9UyKxtOLtp/gN1vVmpLrnjDF040il+X1cORXh7z152Yr3P9Hc9WzHqb29sMlhYRR7WvXp6O/OT/8OqLfmq/WkGTpU7wau74e7v/jg81D2vbxyO/Pd2BI/e8LIE2KUtuUQ0AAyTCA1M9vmOYF1dsLrNRTHeItdz83E275nil/IvNsJ9z+I8vh7OeHmCpTB7FvmOIgtt0Xv298FeuOFw6/jujEu9rhmkdP8Q0d+vkTn4vy04vV3eJMfcrwHJomDAog5ZTS9rQJAQEks8Gzfn7Dt2c07zpOdXjCanjw/WmnOsSFo4eWug+j61dwTOL/b3fCDd+8Gk7943DrPqog9h+nPIhN4vGZts8U1xF920o4/bHhfDrzqZlw0zMyGn+2H8d2J9z8Xcsh7meyq7FpCt7UHXzvN9xxEUCaFKW2KYeAAJJXADn3xVa48yeWpntBde8JP051WFuvpgclu8Vl/UTmh01xh7a69edaOPaW4dZ9hMta4Z5XLlTT27KcKtPrkl/vflVkthOufsRadceqYb5nWdzQYS9P4nNRHrsaTr4nbTPEVZS8zsPd4ymAlFNK29MmBASQjAa++PyG383s+Q3xVqAvSTjVId4Z7KMHwg3T/ETm7nqYwz8/5K0/N1vhgT89GK66YIqD2F7Fov+3e+DoZRN9WuqEI68ech3RRqt6ZkhcG5FlmK2fi/K/hnwuynBddVclpoefANKkKLVNOQQEkEwCSHx+w3sye35DnOrwrJVw5pOJpjrUdwb70Sl/InNcD/Pc5WoNS+MpIJutcOrDB8L1T7Luo/g7fs12qoeUnr1kiO9ZXEf0vna49vEZ+zTXCXf+5NJwz0WZnuJZ0Bn+WAkg5ZTS9rQJAQEkgwASF1TH5zf8h4zmXXdvBXry3QmnOmy0wr2/MV89LXxqO7RxPcw3roZTfz/cPP24aP22H5ryINbbxffrwa52bOdUP9zzQ0P69NmZcMuzM15HFJ+L8vSVcPrjQ3AavqAVCqaLoQDSpCi1TTkEBJDpDyBx3nW8I0s2z2+IUx1W1sPR30441SHeGeyds9XzDab2aedx3UdnPTzwxuFv/Xnklxaq2/dObRDbXkj7/f4DSLWOaD0ce/OQPl3WCne/rDv+zGb4DJnYDHnUWjjx10Out5qu4lnYGf54CSDllNL2tAkBAWTKA0h8fsPr83t+w9C3Au09ecQ7g+VwZ55468+XLYYYOBsvWt1sheN/MVs9uHBqg5iwsf+wsQOz2LCId4KLNyIYxqcH3nAwXPXQfNd9xOfsxCunjRn1jkV+XRJHAaRJUWqbcggIIEOcfM/3ySTOu/67drjuiRnNu05xK9Adjss9r1gIV0zzE75nO+GW5yyHM58eYp5+XID/TwfCDd+akS87FNbFr+kYhElcR/R9y+HsZ4fwKa4j+uCBakpgzmH29ucvhXOXDsFph/FImJni8+7gx1MAKaeUtqdNCAggUzoQdh+kd+u0P0ivt1hqd6rO/PG3J5zqEK9+fPxAuG6aH7IXb/35uNXw4HuHWA8TF+B/oRXueP5Sku65In+KpxrFdURPXK2aF41vuRvHn0tmqpshZDuNLz5n56mr4fRHrPsQmBrVCQJIk6LUNuUQEEAaDSwTcRn5np+Z8gfp9YaP6lag6+HIaxJPdYhd/48dqO7df3lrCh86WN/68/eHXA+TwwL8Xl/8ulmQjD511sP9bxhy3ceXW+HwqzIaf7b7FJshD18Lx/8yYTNk8M75RJxfhI6hawMBpJxS2p42ISCADD3IjP9kEZ/f8GeZPb8hxa1AdzvBf6kV7vvduXDj01aqRdzVYv25Kelgz3fCXS9eHO7WnxutagHtNV/veR+lX7k5tNgJd/+PIdcRbbSqheuxQM/16kdc9xFv1KAIn8Lz427ngfH/uQDSpCi1TTkEBJApG2DjvOt/zOz5DfFWoE9ZrZ5L0XhKSL+Ty2armu9+/G2z4b7fnwtHf3M+3Pvr8+HeX5vsn3gnsDP/PPz88xMXt6uFtPe+dj74KZTBb8xXQXyodUTd79nxt85ufX9y9ClyumiummLW+Dk7/cYj/7+EcCeAlFNK29MmBASQKQogcR7/pTPhtudl9PyGVLcCHeSEvtEK4V+n8Cd+7kH2b6+/szmF+z2Nx2oaPjOfBhsHUnDa6zvp/w0/rk02QwGkSVFqm3IICCAJirsxDoJHfnk+r+c3dG8tO9StQMfIf+gg4LPmXnTYP45zgAPRAQGknFLanjYhIIBMSQCJz2/4y8ye3xAf8PWYEU+9ciJUDHGAAxzgwPgdEECaFKW2KYeAADIFAaR+fsNT83p+w+UHOuH6J6+Gs5+bCSNb+zH+k44TPeYc4AAHOCCAlFNK29MmBAYKIOaPDzZneL/zvweZY1w/v+EFS+GKablz0/ZbWu72+7j+o7N1692z9QP2SnctxUk7R4Zxn1Kw2e094ndxv9/fafj7u+3vfv48R5+m4diN8zMOci6KznBha5wYbDwSQJoUpbYph0C/AHLui61w9HfnQnySdHzuhJ9EDF6xEI792cHQd+1DfH7Da+fDlavred7yMj7/Y3k93PjU1XD7f14Od71kccu1n1sIhwv6uednF8KRX14IZz4x5B2v4i1S/3w23PPKRJ5Ownf+lQvVdyA++G4kdyXaaIUHP9CunmuRzfj2yoXqNrJnPjk8s3jL76x8mgSnJ+kzvGIh3P/HB0P4Up+QH8eWN3Eh1kJHXze3dWv0vYO8AFJOKW1PmxDoF0DiSf+Gb10N1UPc2p1whZ+hGcSpR1ddsB6OveXg3gXVZiuceOdsKOH5DZFJ/CnZr3h3s2o62qDdyO0nv81W9XTr+JTry2cyYjnfqcJo3wJpO49Bfh+f6P3pmXDzd66EKzLz7/YfXR7uVrKbrXDyb9pbD/HMjE3J40zvvscx98r19fBAfDDlXuNOHFve2w7XPm61+HE61kI3fMvqIN8tAaRJUWqbcggMFECe2h10dptK488Hfypx7PgvdsLhX1jY++rHRqt6/sNNT1/ZKsoxHpzxtLFqd8KNF66G0x850HwtTCykPzcTbvme5byulM12wq3PHTKY7RFEzl3WCnf/9GKoHk45bd7s9nnbnXDDU1fD6Y8O51N8XsjNzzL+ZP3wyngXwpf3eTBlHFs+MxNufnZmY8tu358+fx5DW2zKDnBFVgApp5S2p00ICCBjfiJ2fOL3D/YvqOLUtztftBSumB/z5+sz+GZ9Mj4f+x7vBPb1a9WTyoddiB+nD8Vwm83TqdudcN2/Ww2n/n6IQnqP8BF53//6g9U6pGyYzXZCfEJ5vGPeMD6d+1Ir3PXSzILZ+fh+T/K/OdsJtzxnOfR9MGUM6S/rujDrfCSANKk0bYPADgQEkDEOqPGJ39+0Gk59sE9BtdEK9/3eXHVpPJvCaJJPxOfrs3UX4ccns+85/WGvIjr+v81WiPP0r7pgLZ+rZV02D7zx4FCF9K4L13umq1VTUs6XAyn/3Xh1dalTrf3Ydb/7udT16f4/mssrmKXknMN7tTvVdKo4rWrPoBrHljccDFc9NNM1iA2OpQCyQyHpjxBoQmCgABLXgMQ55bH74acZg3anGsQf+NM+BVXPXNtsCqMGg3z2V1q6i+8P/+JCiNOAGheMm61w6sMHwvVPyusWzfHKX9+pIYMU0zv9ne50tVu/N7MpJfXV1WEW6+cYzIw/Xzt9dbZT3dSkb+Njo1VdfcxuTdmQ61hjLWQNSJNq0zYIbCPQL4DEqUD3/cFctWbh8C8tBD8NGfziQohdxchz12LTXNuvPVHmWjh01wHFtQfn/qXV/OpH9OXSmXDbDy3nxW3QqSE7hYsB/yzedSxeLcjmCmO8uvqk1XDqH/pcXd2LTzeYZbeOKNdxpOl+zXXCXS9e3LqL014Lzzda4eR72lvn/p9fCIf9bDF41UK47yJ3wdpWSvotAvsn0C+AVMXyOO9Hnvu/tUcBUC2IrefaNj252G6yi/F4BXG+E+544dIgixh3D6tdj+Kte+NtjHMqpOOddvpODdnje7RrwI/bbG7dSvTqh2U2Xe2h69U0vD2n0wzArFpHlFMwMx5+7XjY7oSbnrky+O2+Y0DJ/ZzcZP88B2T/xaYtENhOYKAAMsCJa8+Tvu37FpKxcLjfXNuvPVnmVjx0w8ftP7ZU3VVm2HUfcaHx1Y/Mq5COz7vpOzWk6Xiy2Qqn/zG/6WrxDl7x2QRx4XjjcTgGszcfDFkFs9zGj2H3p77hxbv6rPto+v2y3fbvn7tgbS84/R6BXgICyBAn7VQDbpzH/8EDIc61te5jjDcFGPaEvp/t6/Dxo0vhzGdm9l742c+rjVY4/U8HqlutZuXLoFND+vHZ6f9vtMK5OF3teRlOV/uPy8MF2u4tv+Ote7PyaT/fz9z/blz3sbIejv7WfPMpnzt9r/zZ9tDR+3sBpLfY9GsEthMYKIDEy7DxkqOf/TEYZHCO864vmQm3fn9mC2JzP6HvZ//imo+FrWlXKcLHuS+0wh0vWApXzGUU1uqpIQme3L3jVYCNVjjy6vnspqtd94TV8OD7h+xob7Sque1ZPQtlP9/PQv5unPbZd82Zc/xg5/i91s589bwvgGwvOP0egV4C/QJILHbiQ/PueP5SNW89DmJ+BmDw/KXqGQNhgDscHf65zBbEFnJCH+hOXd27Xd31U4vDPeW8PqlttMK9r52v7mKT07qP6lkoo5oastkKx9+a4XS1tfXqxhZDrfuIVz8+OVPdHjzeXnQgp32/p4tTfNDpt62E0x/rf4OCePv32Nxwjt+DwfOXqpqoCnP1uLzzqwDSW2z6NQLbCfQLILE7H285d/lDOiGeoPwMwKDVCdc8ai2ceGefh4HV864fntE8fsXJV4uTdqd6lksMmH07jzufwHov51eduehULNazmSrTDWgjmxoSp6t9/EC4MbfpRXG62ksW976r3oBOHfuzg3kFWmPQ14xBVz9iLRx/e/9z0fG3zYarH7UWLm8NcI4ruRZ4SCfc8M2rgzSUBJDtBaffI9BLYKAA8tTVKnjojg3QIazn2v5On4fLxQWxHzkQrn+Kedc5ehWDegwKR183t/Wcj8Eu2X9t4OgtILvz9G96+ko+4aNbKA40NaSXxaC/jus+4nS1F+Y3Xe3mZ62EM/88M/x8/o1WuPO/LGXnVI5jyr73KYb7+GDK18zvPq7E71IcW2JIvzC/sWXfzAYIr3Fsv+FbVwe5i6EA0lts+jUC2wkIIAOEigEGpd6B7o4f7zPXtrsg9vYfzmxB7D459TLL6tftTrVA/PhfzA5fIHaL7fj8mDtftFTdwjcbVnFqyIWDTQ3ZcV1HvyASp6v9ZobT1R69Fk6+e8h1Hz1e3fxdyxpMOY5d8cGU/2l570I515A+wuMpgGyvIv0egYYEBJCEASQWVP9+pbpD0Z7zsuOC2F/JbEHsCAf8qSm4251waLFTPRjw1IcObN0/v1+RPMj/32iFODf7yvWMnvcx2wnV1JC39ZkaMgifnf7OZiucuLgdrnl0XtPVqjsZ9bu6uhOPXf4sTg2MV9ViUTU13zNjTf9jFR9M+ZTVcOrDfdZ9bLSqO2PF219ns6ZsxH4IIA2LTZshsJ1AvwBy7pKZagFbPDnFu6T42ZlBfLhcXPdx/K/6FFRxQezbZqu/m808/hEP+NNQGMWTUpw/ffgXF7Y6joM9qGrvqRGxaNxsVQ/liw/ny8aXemrIq/tMDdmlaO57NaServaM/KaUxOlSSdYTddnGKWo3f6crINMwxgz8GWc74aoL1qvnuvRrhMUradc+drW6o55z+87n9u1c4nG48UJTsLbXkn6PwL4J9Asg4UutcOzPZ8N9F81VDwiLDwnzswODi+aqO+3sedcrc237d+6mLcy0t55sfvN/WNk6/nGtx7DrPerCO96i+TMz4eZnZ3aL5kGmhtQMGrzGB/Ld9eLF/KarPW2Aq6v75RXXgPzEku73tI07e3zeWDDf87MLYc9zUfRko1Xdwtn5fIfz+V51zkVz4dhbDg5yAwhrQPZdkdqgKAJ9A0gcqGI391/99GWwV9fbXNu8wsfs1p1i4kLzeLI/86mZdFOuukXkucta4e6XLVZXHQfufu5RmEzEe8SpIU9eDdUUtb2+L/stpOu/H6erXZTZdLV2p3ri/Yl+V1drBvt5jVdk/2I2r+l9k/4dGOXnm+2EW79vOZz97IA3KIjNEuf2/TMYbOwSQIqqpu3svgkMFED2c0Lzd3eeVmOubTYBJE63inOmb/uh5a1bLae86lF/fzZb4f43HAxXPTSjudmDTg2pGez3NU5Xe187XPv4zKarLa+HI786uulqZz83Yx3IKEPBuN673QnXPXE1PPh3aW5Q0Heq436/n+X9fQFk3xWpDYoiIIC0dg4MKQfLzVY4+a7MFsSO66Q6Qf9ODB5xkfnN37ES7v/Dua25+IN1wvbn2GYrnPrggaqYyGbdR3cN2UBTQ5p89+J0tc/OhFsynK52+48sh7OfH7Cj3YRdfB7Rmw5W6wZy8m0irviNa/yKt3/vrFdNiz3XfTTxwzb7G7+/yksAKaqatrP7JjBQAPlSK4QvtkJcD+Jni0G8LWr86dslius+PjUTbnpmfgtiizjBd6daxeAR7xZ09Dfnq3UZ1bSFr55o+nsw6N+NhfQlM+HW789v3ce+poYMyqv+e/V0tcVOPusZ4u2cv3k1nPrHPncyqhkM83pZKxx+1UI4tJLRFbdxFf+T8O/Md8Ld/30xxPVPfc9JzuPD1TF1LdT/+yaA7LsitUFRBPoFkHjHlbteulh1Fm/57uXgp8vgOcvVrVH7LfSrFsT+t8wWxE7CCXfUn6G9tcYjTrWKz0k4+ttz4cynu+s8Ui0y3+UEVhWCS3kV0tXUkA+MaGrIZis88CfdDv5sJreTraarrYVjb+lzV71dHOpbhG7frrtG7Z6fWdhaDxJvrjDq75j3T8O43aluVFGtQ9tjbIrnoiO/vBBueY7z+FB1zLOXw10vWQznLp3pF/YEkKKqaTu7bwL9Akjsxt7wLavh8odsFWRxGkrxP61OuO4bVqs7iOx5uXuzVd0x7KqOruJUFDPdqx3xs17zmNVw+48thQfecHDrtrpxoeYeJ/d9F3zbC8D4+zgV5s0Hw9UPz+zZFevr4f4/Prh1M4ud9nuYP4vT1f7hQLjuGzNb97HYCYd/foA7GQ3Dbvu2MYR8qRXu+925anyrpmPlEuhyDTvtTnUb3ZN/2yfcx5D+xq01ZZfPOIcPVcM8ZOvKZFw71eecIIDsuyK1QVEEBgogT131oKr6BBY7k531quPaL3w8+P7MFsTWDHJ67V7piA/huvpha9WVvsO/tFAtZq5CxTiCRywEN1vh9EcOhBueklEhHT2JU0N+enGw6YrbC+J+v6+nqz03w+lqz10OAxQ4/Tqwzf5/dzF/fObI1Y9c2xr7XRFJc7Ui5dgZ132srm9did+rORJD+ocOhOv/XWZjS0qW+3ivGF5u+FbPASmqULazoyEggOxzqkEsqF7WZ65tvSD2OZkVRvsYpCfyikf3Ckc8gcTublzXEe+YdOtzl8PhX1gIJ/56dmtheQwdo1hcvltBHTvPl86E2394efKKnGGOeZwa8l3LW7co3qtA2o3LAH8erxIcym262jeuhlN/P4Z1H3vx7fp/4h2z4a6fWgzXP2m1+r7UnWNPzd7neWOY79Fu2851wp0/uRTiwyR37cTHc9HnZ8JtP+BclOqcJICMphb1rgUSGDiAzHTnpMdL8qX+tDtVh7zfXNu4UP/ul3ef31Aqq/Ox37FL272iURdKVdiIn2W+U93SNi7qjYEjhsh4J6s4fadaxzPu0LGt+DvymvlwaHl962nn54Nd6n+znhrynj5TQ7ZxGHgqWz1d7WHdDn3qz38+3q/dvbr6xhFNV2vCOgaReHXuYweqTnt8aGG8GUM1TXB+l+9b93tY7HliHO60t26Kcfrj/YNqbK5UIT0el3F8tsz/jTiFzRWQAotlu5yeQL8Acu7zM+HmZ61U047iMwmK/emsh+u/aTWcfG+fgmqjFY7/5Wy49nGrmI3DlwvWwtWPWAvXPGqtmgsdO7U3fttK1XmPz+mIBVPskt/3e3MhPsitCo+X9Tx8a0Sd+YEL6Y1WOPmeduVWnNqXy/crTt2JzHftzDYphutt4p3lPpnhuHTBWrjnFQuD3cmoZjGu1/g96Yb0eE6ItxWPxzfeVvmOFy5Vd22Ld/qLhVm84cA1j16tpm/FoHLVw/wkZXDBWsX4xDv73KBgo1U9pygej5zGlvM+RnbWw03fsbK1NnDv7581IOlLVu+YE4F+ASR28+PDveKl+DhFpdifd8xuTYvYe8Cp5lyf+vABvMblyjtnw8l3t8OD721Xz84484mZEAukr9wiOXZwY+FUX+E434FjB39idzmr79c7ZsPJv2lvTQ3ZYX8HDme7bRunlXxuJpx4Zzur8ejkxe3RPu9jN55N/nz79+qyVjV98exnZqq1TA9+oF0F6xhUTlzsJzWD6mGDsZHS59jFdWVZjS3jOq/s9e+8Y3ZrjWD/Wx4LIDkVy/YlPYG+ASQO/L4ZcAAAFx9JREFUcN3L8F77D/jVCSEWuZidHwYTGDD6FQnVVYIcfelTHPXlstf2uX7HptHf3uMUP3+ux2bSvqO93Hf7tWMxuvPQbsy/+ucCSPqS1TvmRGCgAPLVL1TfjstQRYV/B18OcIADHOAAB6bfAQEkp2LZvqQnIIAMeFVj+gdDJzTHkAMc4AAHODAeBwSQ9CWrd8yJgAAigLhqxQEOcIADHOBAUgcEkJyKZfuSnoAAknTA0VkaT2cJZ5w5wAEOcGCSHRBA0pes3jEnAgKIAKLrxQEOcIADHOBAUgcEkJyKZfuSnoAAknTAmeRujM+mW8gBDnCAAxwYjwMCSPqS1TvmREAAEUB0vTjAAQ5wgAMcSOqAAJJTsWxf0hMQQJIOODpL4+ks4YwzBzjAAQ5MsgMCSPqS1TvmREAAEUB0vTjAAQ5wgAMcSOqAAJJTsWxf0hMQQJIOOJPcjfHZdAs5wAEOcIAD43FAAElfsnrHnAgIIAKIrhcHOMABDnCAA0kdEEByKpbtS3oCAkjSAUdnaTydJZxx5gAHOMCBSXZAAElfsnrHnAgIIAKIrhcHOMABDnCAA0kdEEByKpbtS3oCAkjSAWeSuzE+m24hBzjAAQ5wYDwOCCDpS1bvmBMBAUQA0fXiAAc4wAEOcCCpAwJITsWyfUlPQABJOuDoLI2ns4QzzhzgAAc4MMkOCCDpS1bvmBMBAUQA0fXiAAc4wAEOcCCpAwJITsWyfUlPQABJOuBMcjfGZ9Mt5AAHOMABDozHAQEkfcnqHXMiIIAIILpeHOAABzjAAQ4kdUAAyalYti/pCQggSQccnaXxdJZwxpkDHOAABybZAQEkfcnqHXMiIIAIILpeHOAABzjAAQ4kdUAAyalYti/pCQggSQecSe7G+Gy6hRzgAAc4wIHxOCCApC9ZvWNOBAQQAUTXiwMc4AAHOMCBpA4IIDkVy/YlPQEBJOmAo7M0ns4SzjhzgAMc4MAkOyCApC9ZvWNOBAQQAUTXiwMc4AAHOMCBpA4IIDkVy/YlPQEBJOmAM8ndGJ9Nt5ADHOAABzgwHgcEkPQlq3fMiYAAIoDoenGAAxzgAAc4kNQBASSnYtm+pCcggCQdcHSWxtNZwhlnDnCAAxyYZAcEkPQlq3fMiYAAIoDoenGAAxzgAAc4kNQBASSnYtm+pCcggCQdcCa5G+Oz6RZygAMc4AAHxuOAAJK+ZPWOOREQQAQQXS8OcIADHOAAB5I6IIDkVCzbl/QEBJCkA47O0ng6SzjjzAEOcIADk+yAAJK+ZPWOOREQQAQQXS8OcIADHOAAB5I6IIDkVCzbl/QEBJCkA84kd2N8Nt1CDnCAAxzgwHgcEEDSl6zeMScCAogAouvFAQ5wgAMc4EBSBwSQnIpl+5KegACSdMDRWRpPZwlnnDnAAQ5wYJIdEEDSl6zeMScCAogAouvFAQ5wgAMc4EBSBwSQnIpl+5KegACSdMCZ5G6Mz6ZbyAEOcIADHBiPAwJI+pLVO+ZEQAARQHS9OMABDnCAAxxI6oAAklOxbF/SExBAkg44Okvj6SzhjDMHOMABDkyyAwJI+pLVO+ZEQAARQHS9OMABDnCAAxxI6oAAklOxbF/SExBAkg44k9yN8dl0CznAAQ5wgAPjcUAASV+yesecCAggAoiuFwc4wAEOcIADSR0QQHIqlu1LegICSNIBR2dpPJ0lnHHmAAc4wIFJdkAASV+yesecCAggAoiuFwc4wAEOcIADSR0QQHIqlu1LegICSNIBZ5K7MT6bbiEHOMABDnBgPA4IIOlLVu+YEwEBRADR9eIABzjAAQ5wIKkDAkhOxbJ9SU9AAEk64OgsjaezhDPOHOAABzgwyQ4IIOlLVu+YEwEBRADR9eIABzjAAQ5wIKkDAkhOxbJ9SU9AAEk64ExyN8Zn0y3kAAc4wAEOjMcBASR9yeodcyIggAggul4c4AAHOMABDiR1QADJqVi2L+kJCCBJBxydpfF0lnDGmQMc4AAHJtkBASR9yeodcyIggAggul4c4AAHOMABDiR1QADJqVi2L+kJCCBJB5xJ7sb4bLqFHOAABzjAgfE4IICkL1m9Y04EBBABRNeLAxzgAAc4wIGkDgggORXL9iU9AQEk6YCjszSezhLOOHOAAxzgwCQ7IICkL1m9Y04EBBABRNeLAxzgAAc4wIGkDgggORXL9iU9AQEk6YAzyd0Yn023kAMc4AAHODAeBwSQ9CWrd8yJgAAigOh6cYADHOAABziQ1AEBJKdi2b6kJyCAJB1wdJbG01nCGWcOcIADHJhkBwSQ9CWrd8yJgAAigOh6cYADHOAABziQ1AEBJKdi2b6kJyCAJB1wJrkb47PpFnKAAxzgAAfG44AAkr5k9Y45ERBABBBdLw5wgAMc4AAHkjoggORULNuX9AQEkKQDjs7SeDpLOOPMAQ5wgAOT7IAAkr5k9Y45ERBABBBdLw5wgAMc4AAHkjoggORULNuX9AQEkKQDziR3Y3w23UIOcIADHODAeBwQQNKXrN4xJwICiACi68UBDnCAAxzgQFIHBJCcimX7kp6AAJJ0wNFZGk9nCWecOcABDnBgkh0QQNKXrN4xJwICiACi68UBDnCAAxzgQFIHBJCcimX7kp6AAJJ0wJnkbozPplvIAQ5wgAMcGI8DAkj6ktU75kRAABFAdL04wAEOcIADHEjqgACSU7FsX9ITEECSDjg6S+PpLOGMMwc4wAEOTLIDAkj6ktU75kRAABFAdL04wAEOcIADHEjqgACSU7FsX9ITEECSDjiT3I3x2XQLOcABDnCAA+NxQABJX7J6x5wICCACiK4XBzjAAQ5wgANJHRBAciqW7Ut6AgJI0gFHZ2k8nSWcceYABzjAgUl2QABJX7J6x5wICCACiK4XBzjAAQ5wgANJHRBAciqW7Ut6AgJI0gFnkrsxPptuIQc4wAEOcGA8Dggg6UtW75gTAQFEANH14gAHOMABDnAgqQMCSE7Fsn1JT0AASTrg6CyNp7OEM84c4AAHODDJDggg6UtW75gTAQFEANH14gAHOMABDnAgqQMCSE7Fsn1JT0AASTrgTHI3xmfTLeQABzjAAQ6MxwEBJH3J6h1zIiCACCC6XhzgAAc4wAEOJHVAAMmpWLYv6QkIIEkHHJ2l8XSWcMaZAxzgAAcm2QEBJH3J6h1zIiCACCC6XhzgAAc4wAEOJHVAAMmpWLYv6QkIIEkHnEnuxvhsuoUc4AAHOMCB8TgggKQvWb1jTgQEEAFE14sDHOAABzjAgaQOCCA5Fcv2JT0BASTpgKOzNJ7OEs44c4ADHODAJDsggKQvWb1jTgQEEAFE14sDHOAABzjAgaQOCCA5Fcv2JT0BASTpgDPJ3RifTbeQAxzgAAc4MB4HBJD0Jat3zImAACKA6HpxgAMc4AAHOJDUAQEkp2LZvqQnIIAkHXB0lsbTWcIZZw5wgAMcmGQHBJD0Jat3zImAACKA6HpxgAMc4AAHOJDUAQEkp2LZvqQnIIAkHXAmuRvjs+kWcoADHOAAB8bjgACSvmT1jjkREEAEEF0vDnCAAxzgAAeSOiCA5FQs25f0BASQpAOOztJ4Oks448wBDnCAA5PsgACSvmT1jjkREEAEEF0vDnCAAxzgAAeSOiCA5FQs25f0BASQpAPOJHdjfDbdQg5wgAMc4MB4HBBA0pes3jEnAgKIAKLrxQEOcIADHOBAUgcEkJyKZfuSnoAAknTA0VkaT2cJZ5w5wAEOcGCSHRBA0pes3jEnAgKIAKLrxQEOcIADHOBAUgcEkJyKZfuSnoAAknTAmeRujM+mW8gBDnCAAxwYjwMCSPqS1TvmREAAEUB0vTjAAQ5wgAMcSOqAAJJTsWxf0hMQQJIOODpL4+ks4YwzBzjAAQ5MsgMCSPqS1TvmREAAEUB0vTjAAQ5wgAMcSOqAAJJTsWxf0hMQQJIOOJPcjfHZdAs5wAEOcIAD43FAAElfsnrHnAgIIAKIrhcHOMABDnCAA0kdEEByKpbtS3oCAkjSAUdnaTydJZxx5gAHOMCBSXZAAElfsnrHnAgIIAKIrhcHOMABDnCAA0kdEEByKpbtS3oCAkjSAWeSuzE+m24hBzjAAQ5wYDwOCCDpS1bvmBMBAUQA0fXiAAc4wAEOcCCpAwJITsWyfUlPQABJOuDoLI2ns4QzzhzgAAc4MMkOCCDpS1bvmBMBAUQA0fXiAAc4wAEOcCCpAwJITsWyfUlPQABJOuBMcjfGZ9Mt5AAHOMABDozHAQEkfcnqHXMiIIAIILpeHOAABzjAAQ4kdUAAyalYti/pCQggSQccnaXxdJZwxpkDHOAABybZAQEkfcnqHXMiIIAIILpeHOAABzjAAQ4kdUAAyalYti/pCQggSQecSe7G+Gy6hRzgAAc4wIHxOCCApC9ZvWNOBAQQAUTXiwMc4AAHOMCBpA4IIDkVy/YlPQEBJOmAo7M0ns4SzjhzgAMc4MAkOyCApC9ZvWNOBAQQAUTXiwMc4AAHOMCBpA4IIDkVy/YlPQEBJOmAM8ndGJ9Nt5ADHOAABzgwHgcEkPQlq3fMiYAAIoDoenGAAxzgAAc4kNQBASSnYtm+pCcggCQdcHSWxtNZwhlnDnCAAxyYZAcEkPQlq3fMiYAAIoDoenGAAxzgAAc4kNQBASSnYtm+pCcggCQdcCa5G+Oz6RZygAMc4AAHxuOAAJK+ZPWOOREQQAQQXS8OcIADHOAAB5I6IIDkVCzbl/QEBJCkA47O0ng6SzjjzAEOcIADk+yAAJK+ZPWOOREQQAQQXS8OcIADHOAAB5I6IIDkVCzbl/QEBJCkA84kd2N8Nt1CDnCAAxzgwHgcEEDSl6zeMScCAogAouvFAQ5wgAMc4EBSBwSQnIpl+5KegACSdMDRWRpPZwlnnDnAAQ5wYJIdEEDSl6zeMScCAogAouvFAQ5wgAMc4EBSBwSQnIpl+5KegACSdMCZ5G6Mz6ZbyAEOcIADHBiPAwJI+pLVO+ZEQAARQHS9OMABDnCAAxxI6oAAklOxbF/SExBAkg44Okvj6SzhjDMHOMABDkyyAwJI+pLVO+ZEQAARQHS9OMABDnCAAxxI6oAAklOxbF/SExBAkg44k9yN8dl0CznAAQ5wgAPjcUAASV+yesecCAggAoiuFwc4wAEOcIADSR0QQHIqlu1LegICSNIBR2dpPJ0lnHHmAAc4wIFJdkAASV+yesecCAggAoiuFwc4wAEOcIADSR0QQHIqlu1LegICSNIBZ5K7MT6bbiEHOMABDnBgPA4IIOlLVu+YEwEBRADR9eIABzjAAQ5wIKkDAkhOxbJ9SU9AAEk64OgsjaezhDPOHOAABzgwyQ4IIOlLVu+YEwEBRADR9eIABzjAAQ5wIKkDAkhOxbJ9SU9AAEk64ExyN8Zn0y3kAAc4wAEOjMcBASR9yeodcyIggAggul4c4AAHOMABDiR1QADJqVi2L+kJCCBJBxydpfF0lnDGmQMc4AAHJtkBASR9yeodcyIggAggul4c4AAHOMABDiR1QADJqVi2L+kJCCBJB5xJ7sb4bLqFHOAABzjAgfE4IICkL1m9Y04EBBABRNeLAxzgAAc4wIGkDgggORXL9iU9AQEk6YCjszSezhLOOHOAAxzgwCQ7IICkL1m9Y04EBBABRNeLAxzgAAc4wIGkDgggORXL9gUBBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEEEAAAQQQQAABBBBAAAEEppbA/wccfCPfn22+vgAAAABJRU5ErkJggg=="></image>
                </defs>
                </svg>
              </div>
            </div>
          </div>
          
          <div class="footerBottomBottom">
                        <div class="socialIcons">
            <div class="igIcon">
              <svg onclick="window.open(&#39;https://www.instagram.com/ahead_nutrition/?hl=en&#39;)" xmlns="http://www.w3.org/2000/svg" width="29" height="28" viewBox="0 0 29 28" fill="none">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M14.9458 28C12.0075 28 9.6291 27.9296 7.76355 27.8356C4.0986 27.6511 1.29472 24.8472 1.11017 21.1822C1.01623 19.3167 0.945801 16.9383 0.945801 14C0.945801 11.0617 1.01624 8.6833 1.11017 6.81775C1.29472 3.15279 4.0986 0.348924 7.76355 0.164372C9.6291 0.0704294 12.0075 0 14.9458 0C17.8841 0 20.2625 0.0704294 22.128 0.164372C25.793 0.348924 28.5969 3.1528 28.7814 6.81775C28.8754 8.6833 28.9458 11.0617 28.9458 14C28.9458 16.9383 28.8754 19.3167 28.7814 21.1823C28.5969 24.8472 25.793 27.6511 22.128 27.8356C20.2625 27.9296 17.8841 28 14.9458 28ZM7.47913 14C7.47913 9.87628 10.8221 6.53333 14.9458 6.53333C19.0695 6.53333 22.4125 9.87628 22.4125 14C22.4125 18.1237 19.0695 21.4667 14.9458 21.4667C10.8221 21.4667 7.47913 18.1237 7.47913 14ZM23.0347 4.04444C22.3474 4.04444 21.7902 4.6016 21.7902 5.28889C21.7902 5.9762 22.3474 6.53333 23.0347 6.53333H23.6569C24.3442 6.53333 24.9014 5.9762 24.9014 5.28889C24.9014 4.6016 24.3442 4.04444 23.6569 4.04444H23.0347Z" fill="white"></path>
              </svg>
            </div>
            <div class="fbIcon">
              <svg onclick="window.open(&#39;https://www.facebook.com/aheadDE/&#39;)" xmlns="http://www.w3.org/2000/svg" width="29" height="28" viewBox="0 0 29 28" fill="none">
                <path d="M12.8211 27.8865C5.93504 27.0071 0.612305 21.1251 0.612305 14C0.612305 6.26802 6.88032 0 14.6123 0C22.3443 0 28.6123 6.26802 28.6123 14C28.6123 20.7696 23.8076 26.4169 17.4223 27.7179V19.6246H20.8687C21.4213 19.6246 21.9187 19.2608 21.9995 18.7141C22.133 17.8099 22.0763 16.9876 21.9899 16.4029C21.9105 15.8661 21.4322 15.5127 20.8896 15.5127H17.4223C17.4223 12.4057 17.9393 11.9536 20.8538 11.897C21.4129 11.8862 21.915 11.517 21.9961 10.9636C22.1325 10.0333 22.0782 9.22059 21.9925 8.64883C21.9135 8.12068 21.4399 7.77641 20.9059 7.78108C15.7549 7.826 12.8211 8.43503 12.8211 15.5127H10.1525C9.63391 15.5127 9.17346 15.8378 9.095 16.3504C9.0105 16.9028 8.95942 17.7034 9.10047 18.6772C9.18198 19.2397 9.68798 19.6246 10.2564 19.6246H12.8211V27.8865Z" fill="white"></path>
              </svg>
            </div>
            <div class="ytIcon" style="margin-top: 2px;">
              <svg onclick="window.open(&#39;https://www.youtube.com/channel/UCqnoSGEX7szUZJ44YRm24Xw/videos&#39;)" xmlns="http://www.w3.org/2000/svg" width="31" height="22" viewBox="0 0 31 22" fill="none">
                <path d="M25.7761 0H5.71561C4.42123 0.0192744 3.18527 0.542039 2.26991 1.45741C1.35454 2.37277 0.831774 3.60873 0.8125 4.90311L0.8125 16.2524C0.831774 17.5468 1.35454 18.7828 2.26991 19.6981C3.18527 20.6135 4.42123 21.1363 5.71561 21.1556H25.7761C27.0704 21.1363 28.3064 20.6135 29.2218 19.6981C30.1371 18.7828 30.6599 17.5468 30.6792 16.2524V4.90311C30.6599 3.60873 30.1371 2.37277 29.2218 1.45741C28.3064 0.542039 27.0704 0.0192744 25.7761 0ZM21.3956 10.5778L12.9707 16.0036C12.8723 16.0718 12.7545 16.1067 12.6347 16.1031C12.5305 16.1036 12.4278 16.078 12.3361 16.0284C12.2387 15.9737 12.1576 15.8943 12.1007 15.7981C12.0439 15.702 12.0135 15.5926 12.0125 15.4809V4.704C12.0135 4.59233 12.0439 4.48291 12.1007 4.38677C12.1576 4.29063 12.2387 4.21118 12.3361 4.15644C12.4317 4.09819 12.5414 4.06737 12.6534 4.06737C12.7653 4.06737 12.8751 4.09819 12.9707 4.15644L21.3956 9.54489C21.4829 9.6013 21.5547 9.67869 21.6045 9.76999C21.6542 9.86129 21.6802 9.96359 21.6802 10.0676C21.6802 10.1715 21.6542 10.2738 21.6045 10.3651C21.5547 10.4564 21.4829 10.5338 21.3956 10.5902V10.5778Z" fill="white"></path>
              </svg>
            </div>
          </div><a href="https://www.ahead-nutrition.com/pages/datenschutz" class="footerBottomLink" style="display: none;">
                            Datenschutz
                          </a><a href="https://www.ahead-nutrition.com/pages/agb" class="footerBottomLink" style="display: none;">
                            AGB
                          </a><a href="https://www.ahead-nutrition.com/pages/impressum" class="footerBottomLink" style="display: none;">
                            Impressum
                          </a></div>
        </div>
      </div>
    </div>
  </div>
<!-- Reviews star snippet -->
<script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/dist.js.download"></script>
<link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/dist.css">
<script>
ratingSnippet("ruk_rating_snippet", {
  store: "www.ahead-nutrition.com",
  mode: "default",
  color: "#FDC827",
  linebreak: false,
  text: "",
  singularText: "",
  lang: "de-in",
  usePolaris: false,
  showEmptyStars: true,
});
</script>
</footer>



</div><iframe style="display: none;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/saved_resource.html"></iframe>

    <ul hidden="">
      <li id="a11y-refresh-page-message">Wenn du dich für eine Auswahl entscheidest, wird die Seite komplett aktualisiert.</li>
      <li id="a11y-new-window-message">Wird in einem neuen Fenster geöffnet.</li>
    </ul>

    <script>
      window.shopUrl = 'https://www.ahead-nutrition.com';
      window.routes = {
        cart_add_url: '/cart/add',
        cart_change_url: '/cart/change',
        cart_update_url: '/cart/update',
        cart_url: '/cart',
        predictive_search_url: '/search/suggest'
      };

      window.cartStrings = {
        error: `Beim Aktualisieren deines Warenkorbs ist ein Fehler aufgetreten. Bitte versuche es erneut.`,
        quantityError: `Du kannst deinem Warenkorb nur [quantity] Stück dieses Artikels hinzufügen.`
      }

      window.variantStrings = {
        addToCart: `In den Warenkorb legen`,
        soldOut: `Ausverkauft`,
        unavailable: `Nicht verfügbar`,
      }

      window.accessibilityStrings = {
        imageAvailable: `Bild [index] ist nun in der Galerieansicht verfügbar`,
        shareSuccess: `Link in die Zwischenablage kopiert`,
        pauseSlideshow: `Slideshow pausieren`,
        playSlideshow: `Slideshow abspielen`,
      }
    </script>
    <script>
  $(document).ready(function(){
    $(document).on('click', ".bundle3 .bundleSelectButton" , function() {
      $("html").removeClass("hasBundle5");
      $("html").addClass("hasBundle3");
    });
    $(document).on('click', ".bundle5 .bundleSelectButton" , function() {
      $("html").removeClass("hasBundle3");
      $("html").addClass("hasBundle5");
    });
    $(document).on('click', ".bundle4 .bundleSelectButton" , function() {
      $("html").removeClass("hasBundle5");
      $("html").removeClass("hasBundle3");
    });
    $(document).on('click', ".show_box__arrow" , function() {
      if ($("html").hasClass("summaryShown")){
        $("html").removeClass("summaryShown");
      }else{
        $("html").addClass("summaryShown");
      }
    });
    $(document).on('click', ".bundle-builder--add-to-cart-form button" , function() {
      localStorage.fromBundle = 'yes';
    });
    try{
      if (localStorage.fromBundle == 'yes'){
        localStorage.fromBundle = 'no';
        document.querySelector("#cart-icon-bubble").click();
        window.liquidAjaxCart.cartRequestUpdate();
      }
    }catch(e){}
  });
</script>

    <!-- Additional Scripts and Configurations -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        var targetNode = document.body; // Watch the entire body for changes

        var config = {
          childList: true,
          subtree: true
        };

        var callback = function(mutationsList, observer) {
          for (var mutation of mutationsList) {
            if (mutation.type === 'childList') {
              var element = document.querySelector('.header__group--left');
              if (element && !element.classList.contains('modified')) {

                // Create the anchor element
                var anchor = document.createElement('a');
                anchor.setAttribute('href', 'https://www.ahead-nutrition.com/pages/informationen-zur-echtheit-der-bewertungen');
                anchor.textContent = 'Über die Echtheit der Bewertungen';

                // Append the anchor to the element
                element.appendChild(anchor);

                element.classList.add('modified'); // Prevents adding the link multiple times
                observer.disconnect(); // Stop watching for changes once we've modified the content
              }
            }
          }
        };

        var observer = new MutationObserver(callback);
        observer.observe(targetNode, config);
      });
    </script>
    <script>
      function newButtonClick(event) {
        // Prevent the default action of the anchor link
        event.preventDefault();

        // Selecting the summary element using the class
        const summaryElement = document.querySelector('.header__icon--summary');
        openMenuDrawer(summaryElement);

        // Update aria-expanded attribute to indicate the new state
        event.currentTarget.setAttribute('aria-expanded', 'true');
      }

      // Selecting the new button using the class
      document.querySelector('.newButtonMO').addEventListener('click', newButtonClick);
    </script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() {
          document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
              // When the tab is inactive or hidden
              document.title = 'Wir vermissen dich! 🍫';
            } else {
              // When the tab is active or visible again
              document.title = 'Willkommen zurück bei ahead!';
            }
          });
        }, 1200000); // 20 minutes in milliseconds
      });
    </script>

    <script type="text/javascript" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/shopify_subdomain.js.download"></script>
    
    <!-- Klaviyo oos -->
    <script src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/onsite.js.download"></script>
    <!-- sovendus offer 
    
    -->

    <script>
      var klaviyo = klaviyo || [];
      klaviyo.init({
        account: "JLhFP6",
        platform: "shopify"
      });
      klaviyo.enable("backinstock",{
        trigger: {
          product_page_text: "Informiere mich, sobald verfügbar",
          product_page_class: "button",
          product_page_text_align: "center",
          product_page_margin: "0px",
        },
        modal: {
          headline: "{product_name}",
          body_content: "Gib deine Email ein, um informiert zu werden:",
          email_field_label: "Email",
          button_label: "Informiert mich!",
          subscription_success_label: "Super! Wir informieren dich per Email sobald das Produkt wieder verfügbar ist. ",
          footer_content: '',
          padding: "400px 10px 0",
          drop_background_color: "#000",
          background_color: "#F1E9DE",
          text_color: "#18181A",
          button_text_color: "#fff",
          button_background_color: "#CB33FB",
          close_button_color: "#CB33FB",
          error_background_color: "#F1E9DE",
          error_text_color: "#18181A",
          success_background_color: "#F1E9DE",
          success_text_color: "#18181A"
        }
      });
    </script>
    <!-- Discount JavaScript -->
    <script>
      var urlParams = new URLSearchParams(window.location.search);
      var discountCode = urlParams.get('discount');

      if (discountCode) {

        // Save the discount code as a session cookie
        document.cookie = `discount_code=${discountCode}; path=/`;

        // Send GET request to "/discount/[discountcode]"
        fetch(`/discount/${discountCode}`)
          .then(function() {

            // After the discount code has been applied, force the cart to update
            return fetch('/cart/update.js', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({
                updates: {},
              }),
            });
          })
          .catch(function(error) {
            console.error('Error:', error);
          });
      }
    </script>
    <!-- Close Cart When Clicking Outside -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const cart = document.querySelector('.my-floating-cartx');

        // Function to close the cart
        function closeCart() {
          cart.classList.remove('js-my-cart-open');
        }

        // Close cart when clicking outside
        document.addEventListener('click', function (event) {
          if (!cart.contains(event.target)) {
            closeCart();
          }
        });
      });
    </script>

  <style> HTML[lang="fr"] .buttonaddcontainer {margin-top: 16px;} </style>
<div id="shopify-block-AbmZNMkJoZTRRcUIvb__10830403595879607806" class="shopify-block shopify-app-block"><style>
  .rio-withoutBranding .FloatingWidget .R-Logo,
  .rio-withoutBranding .CarouselWidget .R-ReviewsioLogo,
  .rio-withoutBranding .ElementsWidget .footer__reviewsLogo-container,
  .rio-withoutBranding .QnaWidget .footer__reviewsLogo-container,
  .rio-withoutBranding .MediaGalleryWidget-prefix .R-ReviewsioLogo,
  .rio-withoutBranding .RatingBarWidget .R-PlatformIcon {
    display: none !important;
  }
</style>
<script>
  
    var reviewsIoStore = 'www.ahead-nutrition.com';
  

  var reviewsIoEnableSyndication = false;

  
    var reviewsIoLang = 'de-informal';
  
</script>



</div><div id="shopify-block-AZ1JPZ1pUYzBybW9yU__6828711692300896689" class="shopify-block shopify-app-block"><div class="influenceio-shopify-init" data-shop="ahead-nutrition.myshopify.com" data-platform="shopify"></div>


</div><div id="shopify-block-Ab2pjN01MMkRjVWV2N__10112296718403049266" class="shopify-block shopify-app-block"><script defer="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/main.js.download"></script>

<div class="influenceio-shopify-init" data-shop="ahead-nutrition.myshopify.com" data-platform="shopify"></div>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    window.influenceioFloatingWidget();
  });
</script>


</div><div id="shopify-block-AQzZUdjQ3SXVxbUpNb__11348531219507317188" class="shopify-block shopify-app-block"><script>
    let shopifyLiquidValuesApp4Ext =   { 
      product: { 
            handle: null,
            productId: null,
            collections: [
                
            ],
        },
        selected_or_first_available_variant: null,
        cartData: {"note":"","attributes":{"igId":"ig_ef0275d3c2f59e4b696c3534911d67e67d5a","_customerReferenceId":"752416b7-a77e-59ef-a9c0-6faa85a5dde6","_elevar__uetsid":"5d112060e52c11ef98ec1fc9c5720faa","_elevar__uetvid":"0f3882a0135511efa48a09be2089c971","_elevar__fbp":"fb.1.1733392564668.154834470","_elevar__ttp":"S_gb6V6KMUHPnGHZFRdremzrvrU","_elevar_ssn_wgs_ga_cmp":"{\"uniqueTS\":1715844140,\"userId\":3456456}","_elevar_ssn_wgs_ga_tid":"GS1.1.1738915236.40.1.0.60","_elevar_visitor_info":"{\"user_id\":\"ee80ceb9-75fe-41ce-b60f-f1cbbb9884dd\",\"session_id\":\"1738915235\",\"session_count\":\"101\",\"consent_v2\":{\"ad_storage\":{\"default\":false,\"update\":false},\"analytics_storage\":{\"default\":false,\"update\":false},\"ad_user_data\":{\"default\":false,\"update\":false},\"ad_personalization\":{\"default\":false,\"update\":false},\"functionality_storage\":{\"default\":false,\"update\":false},\"personalization_storage\":{\"default\":false,\"update\":false},\"security_storage\":{\"default\":true,\"update\":true}},\"market_id\":\"25722967\",\"referrer\":\"https:\/\/www.skailama.com\/\"}","gbbDiscountCode-Bundle Builder":"BB5-JDTXRV8WQE"},"original_total_price":810000,"total_price":810000,"total_discount":0,"total_weight":2034.0,"item_count":3,"items":[{"id":43530481139976,"properties":{"Bundle":"Bundle Builder","Box ID":"2"},"quantity":1,"variant_id":43530481139976,"key":"43530481139976:50c67d7edc856a032bf646c0d8681298","title":"Hazelnut-Cacao - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010104-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":7964092072200,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976","featured_image":{"aspect_ratio":1.0,"alt":"Hazelnut-Cacao","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","handle":"ahead-riegel-hazelnut-cacao","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Hazelnut-Cacao","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0},{"id":39418248364119,"properties":{"Bundle":"Bundle Builder","Box ID":"2"},"quantity":1,"variant_id":39418248364119,"key":"39418248364119:b382e936e2aa1027e3894c79f4f6c940","title":"Coconut-Almond - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010102-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":6610491048023,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-coconut-almond?variant=39418248364119","featured_image":{"aspect_ratio":1.0,"alt":"Coconut-Almond","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/B09GRCR2DL.03.jpg?v=1688630743","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/files\/B09GRCR2DL.03.jpg?v=1688630743","handle":"ahead-riegel-coconut-almond","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Coconut-Almond","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe ✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0},{"id":43530481139976,"properties":{"Bundle":"Bundle Builder","Box ID":"1"},"quantity":1,"variant_id":43530481139976,"key":"43530481139976:f1c2ae5470a30a74cf3fc12a0d74bbf2","title":"Hazelnut-Cacao - 18 Riegel","price":270000,"original_price":270000,"discounted_price":270000,"line_price":270000,"original_line_price":270000,"total_discount":0,"discounts":[],"sku":"010104-1","grams":678,"vendor":"ahead® | The Human Performance Company","taxable":true,"product_id":7964092072200,"product_has_only_default_variant":false,"gift_card":false,"final_price":270000,"final_line_price":270000,"url":"\/products\/ahead-riegel-hazelnut-cacao?variant=43530481139976","featured_image":{"aspect_ratio":1.0,"alt":"Hazelnut-Cacao","height":1500,"url":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","width":1500},"image":"\/\/www.ahead-nutrition.com\/cdn\/shop\/products\/B09QT242YD.02.jpg?v=1682067646","handle":"ahead-riegel-hazelnut-cacao","requires_shipping":true,"product_type":"Schokoriegel","product_title":"Hazelnut-Cacao","product_description":"Zuckerarme Riegel, die die Geschmackswelt revolutionieren✅ \u003c1,7g Zucker pro Riegel✅ \u003c180 kcal✅ Wertvolle Ballaststoffe✅ Gesunde Fette","variant_title":"18 Riegel","variant_options":["18 Riegel"],"options_with_values":[{"name":"Inhalt","value":"18 Riegel"}],"line_level_discount_allocations":[],"line_level_total_discount":0}],"requires_shipping":true,"currency":"INR","items_subtotal_price":810000,"cart_level_discount_applications":[],"checkout_charge_amount":810000}
    }
    window.shopifyLiquidValuesApp4Ext = shopifyLiquidValuesApp4Ext;
</script>

<script id="easybundles-ext-data" type="application/json" data-json=""></script>

<script>
    //console.log("inside app embed file");
    if (window && !window.easybundles_ext_data) {
      let metafieldData;
      
      // Get the JSON data from the data attribute of the script tag
      const jsonDataElement = document.getElementById('easybundles-ext-data');
      const jsonString = jsonDataElement ? jsonDataElement.getAttribute('data-json') : '';

      try {
        // Parse the JSON string
        metafieldData = JSON.parse(jsonString);
      } catch (error) {
        // Log the error if parsing fails
        console.error("Failed to parse metafield data:", error);
        metafieldData = { errorMsg: "This is not a valid JSON" };
      }

      // If the parsing was successful and no error message exists
      if (metafieldData && !metafieldData?.errorMsg && !metafieldData.isUseAppLevelMetafieldEnabled) {
        window.easybundles_ext_data = metafieldData;
        //console.log("app_data from easybundles app embed", window.easybundles_ext_data);
      }

      // Clear the data-json attribute
      if (jsonDataElement) {
        jsonDataElement.setAttribute('data-json', '');
      }
    }
</script>

</div>

<div><link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/style(1).css"><link rel="stylesheet" href="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/loyalty-widget.css"><div class="LoyaltyWidget-prefix"><div class="LoyaltyWidget" style="--base-font-size: 16px; --base-font-family: inherit; --base-maxwidth: 380px; --base-maxheight: 640px; --influenceio-logo-style: var(--logo-normal); --icon-accent-color: #CB33FB; --icon-base-color: #000; --common-border-color: rgba(0,0,0,0.07); --common-border-width: 1px; --launcher-position: fixed; --launcher-position-left: 10px; --launcher-position-right: auto; --launcher-position-top: auto; --launcher-position-bottom: 10px; --launcher-bg-start-color: #CB33FB; --launcher-bg-end-color: #BC2EEBF9; --launcher-gradient-direction: 135deg; --launcher-vertical-padding: 15px; --launcher-horizontal-padding: 20px; --launcher-border-width: 0px; --launcher-border-color: rgba(0,0,0,0.1); --launcher-border-radius: 6px; --launcher-shadow-size: 0px; --launcher-shadow-color: rgba(0,0,0,0.1); --launcher-icon-color: #FFFFFF; --launcher-icon-font-size: 20px; --launcher-text-color: #FFFFFF; --launcher-text-font-size: 16px; --launcher-text-font-weight: 400; --launcher-text-letter-spacing: inherit; --launcher-text-transform: inherit; --panel-position: fixed; --panel-position-left: 10px; --panel-position-right: auto; --panel-position-top: auto; --panel-position-bottom: 80px; --panel-padding: 20px; --panel-bg-color: #FBFBFD; --panel-border-width: 0px; --panel-border-color: rgba(0,0,0,0.1); --panel-border-radius: 10px; --panel-shadow-size: 20px; --panel-shadow-color: rgba(0,0,0,0.1); --header-bg-start-color: #CB33FB; --header-bg-end-color: #CB33FB; --header-gradient-direction: 90deg; --header-bg-opacity: 0.9; --header-border-radius: 0px; --header-bottom-border-width: 0px; --header-bottom-border-color: rgba(0,0,0,0.05); --header-shadow-size: 0px; --header-shadow-color: rgba(0, 0, 0, 0.1); --header-text-color: #FFFFFF; --header-text-font-size: inherit; --header-text-font-weight: inherit; --header-text-line-height: inherit; --header-text-transform: inherit; --subheader-visibility: visible; --card-bg-color: #FFFFFF; --card-vertical-padding: 15px; --card-horizontal-padding: 15px; --card-border-radius: 6px; --card-shadow-size: 6px; --card-shadow-color: rgba(0, 0, 0, 0.1); --card-border-width: 0px; --card-border-color: rgba(0,0,0,0.1); --heading-text-color: #0E1311; --heading-text-font-weight: 700; --heading-text-font-family: inherit; --heading-text-line-height: 1.4; --heading-text-letter-spacing: 0px; --heading-text-transform: none; --body-text-color: #0E1311; --body-text-font-weight: 400; --body-text-font-family: inherit; --body-text-line-height: 1.4; --body-text-letter-spacing: 0px; --body-text-transform: none; --common-button-font-family: inherit; --common-button-font-size: 16px; --common-button-font-weight: 500; --common-button-letter-spacing: 0px; --common-button-text-transform: none; --common-button-vertical-padding: 10px; --common-button-horizontal-padding: 25px; --common-button-border-width: 1px; --common-button-border-radius: 6px; --primary-button-bg-color: #CB33FB; --primary-button-border-color: #CB33FB; --primary-button-text-color: #FFFFFF; --secondary-button-bg-color: transparent; --secondary-button-border-color: rgba(0,0,0,0.2); --secondary-button-text-color: #0E1311; --slider-indicator-bg-color: #E5E5E5; --slider-indicator-button-color: #CB33FB; --slider-indicator-button-border-radius: 0px; --slider-indicator-width: 100%; --slider-indicator-border-radius: 0px; --slider-indicator-height: 10px; --inputfield-text-font-family: inherit; --input-text-font-size: 14px; --inputfield-text-font-weight: 400; --inputfield-text-color: #0E1311; --inputfield-border-color: rgba(0,0,0,0.2); --inputfield-background-color: transparent; --inputfield-border-width: 1px; --inputfield-border-radius: 6px; --tooltip-bg-color: #0E1311; --tooltip-text-color: #FFFFFF;"><div class="R-LauncherButton false" style="box-sizing: border-box;"><i class="R-LauncherButton__icon R-LauncherButton__icon--initial ricon-gift"></i><i class="R-LauncherButton__icon R-LauncherButton__icon--close ricon-thin-close"></i></div></div></div></div>
<script type="text/javascript" id="" charset="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");google_tag_manager["rm"]["8960023"](4)?fbq("init","360528768810086",{external_id:"undefined"}):fbq("init","360528768810086");
fbq("track","PageView",{},{eventID:"undefined"});</script>

<script type="text/javascript" id="" charset="">!function(d,g,e){d.TiktokAnalyticsObject=e;var a=d[e]=d[e]||[];a.methods="page track identify instances debug on off once ready alias group enableCookie disableCookie".split(" ");a.setAndDefer=function(b,c){b[c]=function(){b.push([c].concat(Array.prototype.slice.call(arguments,0)))}};for(d=0;d<a.methods.length;d++)a.setAndDefer(a,a.methods[d]);a.instance=function(b){b=a._i[b]||[];for(var c=0;c<a.methods.length;c++)a.setAndDefer(b,a.methods[c]);return b};a.load=function(b,c){var f="https://analytics.tiktok.com/i18n/pixel/events.js";
a._i=a._i||{};a._i[b]=[];a._i[b]._u=f;a._t=a._t||{};a._t[b]=+new Date;a._o=a._o||{};a._o[b]=c||{};c=document.createElement("script");c.type="text/javascript";c.async=!0;c.src=f+"?sdkid\x3d"+b+"\x26lib\x3d"+e;b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b)};a.load("C6ACNE8CRSBOA6BGKTHG");a.page()}(window,document,"ttq");</script>
<script id="" text="" charset="" type="text/javascript" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/trad.js.download"></script><script type="text/javascript" id="" charset="">(function(a,e,b,f,g,c,d){a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};c=e.createElement(f);c.async=1;c.src="https://www.clarity.ms/tag/"+g;d=e.getElementsByTagName(f)[0];d.parentNode.insertBefore(c,d)})(window,document,"clarity","script","ptrnuypd08");</script><iframe name="__uspapiLocator" tabindex="-1" role="presentation" aria-hidden="true" title="Blank" style="display: none; position: absolute; width: 1px; height: 1px; top: -9999px;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/saved_resource(1).html"></iframe><iframe height="0" width="0" style="display: none; visibility: hidden;" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/saved_resource(2).html"></iframe><iframe tabindex="-1" role="presentation" aria-hidden="true" title="Blank" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/bc-v4.min.html" style="position: absolute; width: 1px; height: 1px; top: -9999px;"></iframe>
<script type="text/javascript" id="" charset="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");google_tag_manager["rm"]["8960023"](72)?fbq("init","612531094043993",{external_id:"ee80ceb9-75fe-41ce-b60f-f1cbbb9884dd"}):fbq("init","612531094043993");
fbq("track","PageView",{},{eventID:"f87b0190-56fe-4396-831e-44a75980743e"});</script>

<script id="" text="" charset="" type="text/javascript" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/klaviyo(1).js.download"></script>
<script type="text/javascript" id="" charset="">Adcell.Tracking.track();</script>

<script type="text/javascript" id="" charset="">var _learnq=_learnq||[];if("undefined")_learnq.push(["identify",{"$email":"undefined"}]);</script><script>window.tmpCartSettings2 = {"userData":{"_id":"6627a56a1ca8324641fc048e","shopName":"ahead-nutrition.myshopify.com","brandName":"ahead® | The Better for You Company","bundleSettings":{"allowMultipleBoxesFromSameBundle":true,"showCompareAtPrice":true,"dontIndexGiftboxBuilderPages_onGoogle":false,"isValidateInventoryEnabled":false,"calculateAutomaticDiscountInPercentage":true,"combineWithOrderDiscounts":true,"isDiscountMethodAutomatic":false,"removeUnUsedVariantImages":true},"counters":{"reviewModal":100,"themeExtensionModal":5,"instructionsModalCnt":1,"viewBundleModalCnt":0,"createBundleModalCnt":0},"countryCode":"DE","countryName":"Germany","createdAt":"2024-04-23T12:11:22.210Z","currency":"EUR","currencyInfo":{"code":"EUR","symbol":"€","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"customSettings":{"initialModalPopupCnt":0,"disableCartSettings":false,"selectorToRenderBundleUpsell":".product-form__buttons-container","addToCartBtnSelectors":"","checkoutBtnSelectors":"","customStyle":null,"addAfterAddTocartBtn":false,"addAftercheckoutBtn":false,"disableApp":false,"loadingGif":"https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/icons/loadingGif.gif","stackDiscounts":true,"showOnlyAdminSelectedVariants":true,"overWriteCheckoutBtn":false,"addGiftMessageToNote":true,"buyNowBtn":"","cartItemQuantityBtnSelectors":"","cartItemRemoveParentSelectors":"","cartItemRemoveSelectors":"","cartItemSelectors":"","checkIfShowBundleAsProductEnabled":false,"customBundleScript":"\n","customCartIntegrationScript":"","customStyleForBuilderPages":".gbbBodyWrapper {\n    margin: 0px !important;\n}\n.gbbPageBody {\n  background: transparent !important;\n}\n.gbbMultipleCategoriesDropdownArrow > svg:nth-child(1) {\n    width: 30px;\n    height: 30px;\n}\n.gbbMultipleCategoriesDropdownArrow {\n    right: 20%;\n    background: #fff;\n    border-radius: 50px;\n}\n.gbbConditionNotificationToast {\n    background: #CB33FB !important;\n    color: #fff !important;\n    border-radius: 10px !important;\n}\n.gbbPrevImage, .gbbNextImage {\n    color:#CB33FB !important;\n}\n.gbbProductItemCompareAtPrice {\n    display: none;\n}\n.gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {\n    color:#1D1D1B !important;\n}\n.gbbMultipleCategoriesDropdownArrow svg path {\n    fill: #CB33FB !important;\n}\n.gbbAddProductPageSubtextWrapper:not(:empty), .gbbPrecuratedBoxPageSubtextWrapper:not(:empty), .gbbPersonalizePageSubtextWrapper:not(:empty), .gbbChooseBoxPageSubtextWrapper:not(:empty), .gbbMultipleCategoriesPageSubtextWrapper:not(:empty) {\n    display: none !important;\n}\n.gbbProductVariantModalContainer {\n    border-radius: 20px;\n}\n\n@media screen and (min-width: 990px) {\n    .gbbMultipleCategoriesRibbonContainer {\n        gap: 4px;\n        overflow-x: scroll;\n        padding: 0px !important;\n    }\n    .gbbExtBundleRedirectButton {\n        font-weight: 800;\n        font-size: 14px;\n        line-height: 19px;\n        padding: 15px 20px;\n        text-align: center;\n        text-decoration: none;\n        background: #F1FF00;\n        border-radius: 50px;\n        width: 80%;\n        margin-top: 10px;\n    }\n    .gbbPageBody {\n        max-width: 1200px;\n        padding: 0 5rem;\n        margin: auto;\n    }\n    .gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {\n        line-height: 28px !important;\n        color:#1D1D1B !important;\n    }\n    .gbbAddProductsPageFooterHTML {\n        padding: 20px;\n        border: 1px solid #7F7F7F;\n        border-radius: 20px;\n        z-index: 2;\n        min-height: auto;\n        background: #fff !important;\n        bottom: 1px;\n    }\n    .gbbProductsFooterHTML {\n        background: #fff !important;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 10px;\n        position: relative;\n        grid-gap: 0px;\n    }\n    .gbbFooterProductsContainer {\n        grid-gap: 20px;\n    }\n    .gbbFooterProductTitle {\n        display: none;\n    }\n    .gbbFooterProductImageContainer {\n        display: grid;\n        width: 70px;\n        height: 70px;\n        border: 1px solid #CB33FB;\n        overflow: hidden;\n        border-radius: 10px;\n    }\n    .gbbFooterProductPrice {\n        display: none;\n    }\n    .gbbFooterProductTextContainer {\n        width: auto !important;\n        justify-content: center;\n        display: flex;\n        font-size: 18px;\n        line-height: 28px;\n        font-weight: 900;\n    }\n    .gbbFooterOriginalTotalValue {\n        color: red;\n    }\n    .gbbFooterProductQtyPriceContainer {\n        display: flex;\n        gap: 5px;\n        margin: auto;\n    }\n    .gbbFooterTotalContainer {\n        text-align: center;\n        font-size: 22px;\n        line-height: 28px;\n        font-weight: 900;\n        color: #1D1D1B !important;\n    }\n    .gbbFooterTotalValueContainer {\n        justify-content: center;\n    }\n    .gbbFooterButtonsWrapper {\n        display: block;\n        margin: auto;\n        width: 500px;\n    }\n    .gbbFooterBackButton, .gbbFooterNextButton {\n        background: #CB33FB !important;\n        padding: 15px 0px;\n        border: none;\n        border-radius: 50px;\n        text-align: center;\n        font-weight: 900;\n        font-size: 18px !important;\n        line-height: 25px;\n    }\n    .gbbFooterProductRemoveButtonIcon > svg:nth-child(1) {\n        background: #CB33FB !important;\n        border-radius: 50% !important;\n        fill: #fff !important;\n        width: 22px !important;\n        height: 22px !important;\n        border: 1px solid #CB33FB !important;\n    }\n    .gbbProductsItemsContainer {\n        display: grid;\n        grid-template-columns: repeat(4, 1fr);\n        gap: 30px;\n    }\n   .gbbProductImageContainerImg {\n        max-height: 100%;\n        width: 100%;\n        padding-bottom: 0;\n        border-radius: 10px;\n    }\n    .gbbProductItem {\n        box-shadow: none;\n        transition: none;\n        display: flex;\n        flex-direction: column;\n        background: #fff !important;\n        color: #1D1D1B !important;\n        border-radius: 10px;\n        padding: 10px;\n    }\n    .gbbProductItem:hover {\n        box-shadow: none;\n        transition: none;\n    }\n    .gbbProductTextContainer {\n        text-align: left;\n        font-size: 18px;\n        line-height: 28px;\n        font-weight: 900;\n    }\n    .gbbProductActionContainer {\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n        padding: 0px 15px 20px;\n        align-items: normal;\n    }\n    .gbbProductItemPricesContainer {\n        font-weight: 700;\n        font-size: 18px;\n        line-height: 25px;\n        text-transform: uppercase;\n        color: #1D1D1B;\n    }\n    .gbbProductItemCompareAtPrice {\n        font-weight: 700;\n        font-size: 18px;\n        line-height: 25px;\n        text-transform: uppercase;\n        color: #1D1D1B;\n    }\n    .gbbProductItemCompareAtPrice {\n        font-weight: 700;\n        font-size: 18px;\n        line-height: 25px;\n        text-transform: uppercase;\n        color: red;\n\n    }\n    .gbbProductQuantityHTML {\n        background-color: #CB33FB;\n        border: 2px;\n        border-radius: 50px;\n        color: #fff;\n        padding: 7px;\n    }\n    .gbbProductQuantityRemoveButton {\n        background: #CB33FB !important;;\n        border-radius: 50px;\n    }\n    .gbbProductQuantityAddButton {\n        background: #CB33FB !important;\n        border-radius: 50px;\n    }\n    .gbbProductQuantityLabel {\n        color: #fff;\n        font-size: 18px;\n        line-height: 28px;\n    }\n    .gbbProductAddButton {\n        background: #CB33FB !important;\n        border-radius: 50px;\n        font-size: 18px;\n        line-height: 28px;\n    }\n    .gbbDiscountMessage {\n        text-align: center;\n        font-size: 18px;\n        line-height: 28px;\n        font-weight: 900;\n        padding: 5px 0px;\n    }\n    .gbbProductDescriptionText {\n        max-height: 100% !important;\n    }\n    .gbbProductVariantModalDetailsContainer {\n        display: grid;\n        grid-gap: 20px;\n        grid-template-rows: 1fr auto;\n        height: 100%;\n    }\n    .gbbProductCardTextContainer {\n        height: 100% !important;\n    }\n    .gbbProductQuantityHTMLContainer {\n        grid-template-columns: auto 1fr;\n    }\n    .gbbProductQuantityHeading {\n        display: flex;\n        margin: auto;\n        font-size: 18px;\n        line-height: 28px;\n        font-weight: 900;\n    }\n    .gbbProductCardActionContainer {\n        grid-template-columns: auto;\n    }\n    .gbbProductVariantAddButton {\n        background: #CB33FB !important;\n        padding: 15px 0px;\n        border: none;\n        border-radius: 50px;\n        text-align: center;\n        font-weight: 900;\n        font-size: 18px !important;\n        line-height: 25px;\n    }\n    .gbbProductVariantModalClose {\n        font-weight: bold;\n        transform: rotate(45deg);\n        font-size: 40px;\n        position: absolute;\n        color: #CB33FB;\n        cursor: pointer;\n        user-select: none;\n        padding: 0;\n        top: 10px;\n        right: 10px;\n    }\n    .gbbActiveImage {\n        border: 1px solid #CB33FB !important;\n        border-radius: 10px;\n    }\n    .gbbProductTabImageContainer img {\n        border-radius: 10px;\n    }\n    .gbbProductVariantModalContentContainer .gbbProductImageContainerImg {\n        max-height: 100% !important;\n    }\n    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown {\n        background: transparent !important;\n        padding: 5px 2px;\n        border-bottom: 2px solid #1d1d1d;\n        text-align: center;\n        font-weight: 900;\n        font-size: 18px !important;\n        line-height: 25px;\n        color: #1d1d1d;\n    }\n    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown, .gbbCategoryContainer {\n        border-top: 0px !important;\n        border-left: 0px !important;\n        border-right: 0px !important;\n        border-radius: 0px;\n    }\n    .gbbCategoryContainer.gbbCategoryContainerTabUI.gbbCategoryContainerTabUIActive {\n        color: #CB33FB;\n        opacity: 100%;\n        border-bottom: 2px solid #CB33FB;\n    }\n    .gbbAddProductPageSubtext {\n        text-align: center;\n        font-size: 40px;\n        font-weight: 900;\n        line-height: 50px;\n        padding: 50px 4rem 30px 4rem;\n        color: #CB33FB !important;\n    }\n}\n@media screen and (max-width: 990px) {\n    .gbbPageBody {\n        padding: 0px;\n    }\n    .gbbAddProductsPageFooterHTML {\n        background: #fff !important;\n        color:#1D1D1B !important;\n        border-top: 3px solid #CB33FB;\n        min-height: auto;\n    }\n    .gbbProductsFooterHTML {\n        background: #fff !important;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 10px;\n        position: relative;\n        grid-gap: 20px;\n        color:#1D1D1B !important;\n    }\n    .gbbFooterProductsContainer {\n        grid-gap: 20px;\n    }\n    .gbbFooterProductTitle {\n        display: none;\n    }\n    .gbbFooterProductImageContainer {\n        display: grid;\n        width: 70px;\n        height: 70px;\n        border: 1px solid #CB33FB;\n        overflow: hidden;\n        border-radius: 10px;\n    }\n    .gbbFooterProductPrice {\n        display: none;\n    }\n    .gbbFooterProductTextContainer {\n        width: auto !important;\n        justify-content: center;\n        display: flex;\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900;\n    }\n    .gbbFooterOriginalTotalValue {\n        color: red;\n    }\n    .gbbFooterProductQtyPriceContainer {\n        display: flex;\n        gap: 5px;\n        margin: auto;\n    }\n    .gbbFooterTotalContainer {\n        text-align: center;\n        font-size: 18px !important;\n        line-height: 18px !important;\n        font-weight: 900;\n        color:#1D1D1B !important\n    }\n    .gbbFooterTotalValueContainer {\n        justify-content: center;\n    }\n    .gbbFooterButtonsWrapper {\n        display: block;\n        margin: auto;\n        width: 100%;\n    }\n    .gbbFooterBackButton, .gbbFooterNextButton {\n        background: #CB33FB !important;\n        padding: 15px 0px;\n        border: none;\n        border-radius: 50px;\n        text-align: center;\n        font-weight: 900;\n        font-size: 16px !important;\n        line-height: 18px;\n    }\n    .gbbFooterProductRemoveButtonIcon > svg:nth-child(1) {\n        background: #CB33FB !important;\n        border-radius: 50% !important;\n        fill: #fff !important;\n        width: 22px !important;\n        height: 22px !important;\n        border: 1px solid #CB33FB !important;\n    }\n    .gbbProductsItemsContainer {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 20px 15px;\n    }\n   .gbbProductImageContainerImg {\n        max-height: 100%;\n        width: 100%;\n        padding-bottom: 0;\n        border-radius: 10px;\n    }\n    .gbbProductItem {\n        box-shadow: none;\n        transition: none;\n        display: flex;\n        flex-direction: column;\n        background: #fff !important;\n        color: #1D1D1B !important;\n        border-radius: 10px;\n        padding: 10px;\n    }\n    .gbbProductItem:hover {\n        box-shadow: none;\n        transition: none;\n    }\n    .gbbProductTextContainer {\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900;\n        padding: 5px 0px;\n    }\n    .gbbProductActionContainer {\n        width: 100%;\n        display: flex;\n        flex-direction: column;\n        padding: 0px 0px 5px;\n        align-items: normal;\n        margin: auto;\n    }\n    .gbbProductButtonWrapper {\n        width: 100%;\n    }\n    .gbbProductItemPricesContainer {\n        font-weight: 700;\n        font-size: 16px !important;\n        line-height: 18px;\n        text-transform: uppercase;\n        color: #1D1D1B;\n    }\n    .gbbProductItemCompareAtPrice {\n        font-weight: 700;\n        font-size: 18px;\n        line-height: 25px;\n        text-transform: uppercase;\n        color: #1D1D1B;\n    }\n    .gbbProductItemCompareAtPrice {\n        font-weight: 700;\n        font-size: 16px !important;\n        line-height: 18px;\n        text-transform: uppercase;\n        color: red;\n\n    }\n    .gbbProductQuantityHTML {\n        background-color: #CB33FB;\n        border: 2px;\n        border-radius: 50px;\n        color: #fff;\n        padding: 1px;\n    }\n    .gbbProductQuantityRemoveButton {\n        background: #CB33FB !important;;\n        border-radius: 50px;\n    }\n    .gbbProductQuantityAddButton {\n        background: #CB33FB !important;\n        border-radius: 50px;\n    }\n    .gbbProductQuantityLabel {\n        color: #fff;\n        font-size: 16px !important;\n        line-height: 18px;\n    }\n    .gbbProductAddButton {\n        background: #CB33FB !important;\n        border-radius: 50px;\n        font-size: 16px !important;\n        line-height: 18px;\n    }\n    .gbbDiscountMessage {\n        text-align: center;\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900;\n        color: #1D1D1B !important;\n        padding: 5px 0px;\n    }\n  \n    .gbbProductQuantityHTMLContainer {\n        grid-template-columns: auto 1fr;\n    }\n    .gbbProductQuantityHeading {\n        display: flex;\n        margin: auto;\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900;\n        color:#1D1D1B !important;\n    }\n    .gbbProductItemTitle {\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900 !important;\n        color: #1D1D1B !important;\n    }\n    .gbbProductItemPrice {\n        font-size: 16px !important;\n        line-height: 18px;\n        font-weight: 900 !important;\n        color: #1D1D1B !important;\n    }\n    .gbbProductVariantAddButton {\n        background: #CB33FB !important;\n        padding: 15px 0px;\n        border: none;\n        border-radius: 50px;\n        text-align: center;\n        font-weight: 900;\n        font-size: 16px !important;\n        line-height: 18px;\n    }\n    .gbbProductVariantModalClose {\n        font-weight: bold;\n        transform: rotate(45deg);\n        font-size: 40px;\n        position: absolute;\n        color: #CB33FB;\n        cursor: pointer;\n        user-select: none;\n        padding: 0;\n        top: 10px;\n        right: 10px;\n    }\n    .gbbActiveImage {\n        border: 1px solid #CB33FB !important;\n        border-radius: 10px;\n    }\n    .gbbProductTabImageContainer img {\n        border-radius: 10px;\n    }\n    .gbbCategoryContainer.gbbCategoryContainerTabUI, .gbbMutipleCategoriesDropdown {\n        background: #CB33FB !important;\n        padding: 15px 0px;\n        border: 1px solid #CB33FB;\n        border-radius: 50px;\n        text-align: center;\n        font-weight: 900;\n        font-size: 16px !important;\n        line-height: 18px;\n        color: #fff;\ndisplay: block;\n    }\n    .gbbCategoryContainer.gbbCategoryContainerTabUI.gbbCategoryContainerTabUIActive {\n        color: #fff;\n        background: #CB33FB !important;\n    }\n    .gbbProductVariantModalContentContainer {\n        display: block;\n    }\n    .gbbProductVariantModalBodyContainer {\n        display: block;\n        width: 100%;\n        margin: auto;\n        padding: 40px 0px 0px;\n    }\n    .gbbProductCardActionContainer {\n        display: block;\n        padding: 20px 0;\n        width: 100%;\n    }\n    .gbbProductVariantModalContentContainer .gbbProductImageContainerImg {\n        max-height: 500px !important;\n    }\n    .gbbProductDescriptionText {\n        color: #1D1D1B !important;\n    }\n    .gbbViewProductsLabelAndTotalContainer {\n        display: flex;\n        flex-direction: column;\n        margin: auto;\n        gap: 10px;\n    }\n    .gbbViewCartProductsLink {\n        text-decoration: none;\n        cursor: pointer;\n        color: #CB33FB;\n        border: 1px solid;\n        border-radius: 100px;\n        padding: 4px 10px;\n        margin: auto;\n    }\n    .gbbCartModalProductTitleContainer, .gbbCartModalProductPrice {\n        display: none;\n    }\n    .gbbCartProductsContainerHeaderLabel {\n        display: none;\n    }\n    .gbbCartProductsModalClose {\n        padding: 0px;\n        font-weight: bold;\n        transform: rotate(45deg);\n        font-size: 40px;\n        position: absolute;\n        top: -10px;\n        right: 5px;\n        color: #CB33FB;\n        cursor: pointer;\n        user-select: none;\n    }\n    div.gbbFooterTotalContainer:nth-child(3) {\n        display: none;\n    }\n    .gbbCartModalProductRemoveButtonIcon > svg:nth-child(1) {\n        background: #CB33FB !important;\n        border-radius: 50% !important;\n        fill: #fff !important;\n        width: 15px !important;\n        height: 15px !important;\n        border: 1px solid #CB33FB !important;\n        \n    }\n    .gbbCartProductImageContainer {\n        border: 1px solid #CB33FB;\n        border-radius: 10px;\n    }\n    .gbbCartModalProductImage {\n        border-radius: 10px;\n    }\n    .gbbAddProductPageSubtext {\n        text-align: center;\n        font-size: 28px;\n        font-weight: 900;\n        line-height: 36px;\n        padding: 30px 4rem 10px 4rem;\n        color: #CB33FB !important;\n    }\n    .gbbCartModalProductQuantity {\n        font-weight: 900;\n        font-size: 16px !important;\n        line-height: 18px;\n        color: #1d1d1d;\n    }\n    .gbbCartModalProductPriceQtyContainer {\n        margin: auto;\n        display: flex;\n\n    }\n    .gbbFooterTotalLabel, .gbbFooterDiscountedTotalValue {\n        line-height: 18px !important;\n        color: #1D1D1B !important;\n    }\n\n}","customStyleForDummyProductPage":".gbbExtBundleUpsellContainer:not(:empty) {\n    display: grid;\n     margin: 0% 0;\n    border-radius: 5px;\n    grid-gap: 5px;\n}","customThemeIntegrationScript":"","enableCustomThemeIntegrationScript":false,"isCartIntegrationEnabled":false,"loadingBgColor":"#F1E9DE","preparingBundleGif":"https://d3ks0ngva6go34.cloudfront.net/public/packagingbundle.gif","redirectToCartEnabled":true,"redirectToCheckoutEnabled":false,"redirectToScript":"","redirectUrlForCheckoutBtn":"","selectorToRenderBundlePostionOnCart":"Over","selectorToRenderBundlePostionOnSideCart":"Over","selectorToRenderBundleProduct":"","selectorToRenderBundleProductOnSideCart":"","sideCartCheckoutBtnSelectors":"","enableStoreFrontGQLAPI":false,"integrations":{"judgeme":{"isEnabled":false,"public_token":""}}},"isAppFree":false,"isSubscription":{"id":33513111816,"name":"plus-jan10","price":"99.00","billing_on":"2024-06-07","status":"active","created_at":"2024-06-03T13:52:05+02:00","updated_at":"2024-06-03T13:52:44+02:00","activated_on":"2024-06-03","return_url":"https://ahead-nutrition.myshopify.com/admin/apps/10b4272bede142b02924feec498b4009","test":false,"cancelled_on":null,"trial_days":0,"trial_ends_on":"2024-06-03","api_client_id":3918921729,"decorated_return_url":"https://ahead-nutrition.myshopify.com/admin/apps/10b4272bede142b02924feec498b4009?charge_id=33513111816","capped_amount":"800.00","balance_used":"0.0","balance_remaining":"800.00","risk_level":0.41039499999999995,"currency":"USD"},"multipleCurrenciesInfo":{"AED":{"code":"AED","symbol":"د.إ.‏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"AFN":{"code":"AFN","symbol":"؋","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"ALL":{"code":"ALL","symbol":"Lek","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"AMD":{"code":"AMD","symbol":"֏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"ANG":{"code":"ANG","symbol":"ƒ","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"AUD":{"code":"AUD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"AWG":{"code":"AWG","symbol":"ƒ","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"AZN":{"code":"AZN","symbol":"₼","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"BAM":{"code":"BAM","symbol":"КМ","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"BBD":{"code":"BBD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"BDT":{"code":"BDT","symbol":"৳","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":0},"BGN":{"code":"BGN","symbol":"лв.","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"BIF":{"code":"BIF","symbol":"FBu","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"BND":{"code":"BND","symbol":"$","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"BOB":{"code":"BOB","symbol":"Bs","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"BSD":{"code":"BSD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"BWP":{"code":"BWP","symbol":"P","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"BZD":{"code":"BZD","symbol":"BZ$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CAD":{"code":"CAD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CDF":{"code":"CDF","symbol":"FC","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CHF":{"code":"CHF","symbol":"CHF","thousandsSeparator":"'","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"CNY":{"code":"CNY","symbol":"¥","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CRC":{"code":"CRC","symbol":"₡","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CVE":{"code":"CVE","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"CZK":{"code":"CZK","symbol":"Kč","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"DJF":{"code":"DJF","symbol":"Fdj","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"DKK":{"code":"DKK","symbol":"kr.","thousandsSeparator":"","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"DOP":{"code":"DOP","symbol":"RD$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"DZD":{"code":"DZD","symbol":"د.ج.‏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"EGP":{"code":"EGP","symbol":"ج.م.‏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"ETB":{"code":"ETB","symbol":"ETB","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"EUR":{"code":"EUR","symbol":"€","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"FJD":{"code":"FJD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"FKP":{"code":"FKP","symbol":"£","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"GBP":{"code":"GBP","symbol":"£","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"GMD":{"code":"GMD","symbol":"D","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"GNF":{"code":"GNF","symbol":"FG","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"GTQ":{"code":"GTQ","symbol":"Q","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"GYD":{"code":"GYD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"HKD":{"code":"HKD","symbol":"HK$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"HNL":{"code":"HNL","symbol":"L.","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"HUF":{"code":"HUF","symbol":"Ft","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"IDR":{"code":"IDR","symbol":"Rp","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"ILS":{"code":"ILS","symbol":"₪","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"INR":{"code":"INR","symbol":"₹","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"ISK":{"code":"ISK","symbol":"kr.","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":0},"JMD":{"code":"JMD","symbol":"J$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"JPY":{"code":"JPY","symbol":"¥","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"KES":{"code":"KES","symbol":"KSh","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"KGS":{"code":"KGS","symbol":"сом","thousandsSeparator":" ","decimalSeparator":"-","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"KHR":{"code":"KHR","symbol":"៛","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"KMF":{"code":"KMF","symbol":"CF","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"KRW":{"code":"KRW","symbol":"₩","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"KYD":{"code":"KYD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"KZT":{"code":"KZT","symbol":"₸","thousandsSeparator":" ","decimalSeparator":"-","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"LAK":{"code":"LAK","symbol":"₭","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"LBP":{"code":"LBP","symbol":"ل.ل.‏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"LKR":{"code":"LKR","symbol":"₨","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":0},"MAD":{"code":"MAD","symbol":"د.م.‏","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"MDL":{"code":"MDL","symbol":"lei","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"MKD":{"code":"MKD","symbol":"ден.","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"MMK":{"code":"MMK","symbol":"K","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"MNT":{"code":"MNT","symbol":"₮","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"MOP":{"code":"MOP","symbol":"MOP$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"MUR":{"code":"MUR","symbol":"₨","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"MVR":{"code":"MVR","symbol":"MVR","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":1},"MWK":{"code":"MWK","symbol":"MK","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"MYR":{"code":"MYR","symbol":"RM","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"NGN":{"code":"NGN","symbol":"₦","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"NIO":{"code":"NIO","symbol":"C$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"NPR":{"code":"NPR","symbol":"₨","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"NZD":{"code":"NZD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"PEN":{"code":"PEN","symbol":"S/.","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"PGK":{"code":"PGK","symbol":"K","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"PHP":{"code":"PHP","symbol":"₱","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"PKR":{"code":"PKR","symbol":"₨","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"PLN":{"code":"PLN","symbol":"zł","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"PYG":{"code":"PYG","symbol":"₲","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"QAR":{"code":"QAR","symbol":"﷼","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"RON":{"code":"RON","symbol":"L","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"RSD":{"code":"RSD","symbol":"Дин.","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"RWF":{"code":"RWF","symbol":"RWF","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"SAR":{"code":"SAR","symbol":"﷼","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"SBD":{"code":"SBD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"SEK":{"code":"SEK","symbol":"kr","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"SGD":{"code":"SGD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"SHP":{"code":"SHP","symbol":"£","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"SLL":{"code":"SLL","symbol":"Le","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"STD":{"code":"STD","symbol":"Db","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"THB":{"code":"THB","symbol":"฿","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"TJS":{"code":"TJS","symbol":"TJS","thousandsSeparator":" ","decimalSeparator":";","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"TOP":{"code":"TOP","symbol":"T$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"TTD":{"code":"TTD","symbol":"TT$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"TWD":{"code":"TWD","symbol":"NT$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"TZS":{"code":"TZS","symbol":"TSh","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"UAH":{"code":"UAH","symbol":"₴","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"UGX":{"code":"UGX","symbol":"USh","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"USD":{"code":"USD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"UYU":{"code":"UYU","symbol":"$U","thousandsSeparator":".","decimalSeparator":",","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"UZS":{"code":"UZS","symbol":"сўм","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2},"VND":{"code":"VND","symbol":"₫","thousandsSeparator":".","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":true,"decimalDigits":0},"VUV":{"code":"VUV","symbol":"VT","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":0},"WST":{"code":"WST","symbol":"WS$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"XAF":{"code":"XAF","symbol":"F","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"XCD":{"code":"XCD","symbol":"$","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"XOF":{"code":"XOF","symbol":"F","thousandsSeparator":" ","decimalSeparator":",","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"XPF":{"code":"XPF","symbol":"F","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":false,"spaceBetweenAmountAndSymbol":false,"decimalDigits":2},"YER":{"code":"YER","symbol":"﷼","thousandsSeparator":",","decimalSeparator":".","symbolOnLeft":true,"spaceBetweenAmountAndSymbol":true,"decimalDigits":2}},"otherInfo":[],"planId":"","shopDomain":"www.ahead-nutrition.com","status":"1","timezone":"","updatedAt":"2025-02-09T22:09:19.701Z","loginData":{"lastLoggedInAt":"2025-01-14T12:10:02.080Z"},"isOnBoardingCompleted":true,"onboardingObject":{"selectedDomain":"food-beverages","selectedBundleTypeId":"discounted-tiered-pricing"},"videoPage":{"backgroundColor":"#F1E9DE","logoImg":"https://db07ji0eqime4.cloudfront.net/redeemPage/giftcard/default-no-logo.jpg"},"lastVisitTime":"2024-08-08T05:49:33.136Z","mantleApiToken":"0b7a1e03-6b43-4c47-a5ed-bc6cec8d36e9","storefrontAccessToken":"3b00df17125d24190a96774f3101eb08","totalBundleRevenue":176333.77999999988,"totalOrdersCount":1459,"reviewData":{"reviewStatus":"REVIEW_GIVEN","reviewGivenDate":"2024-06-04T23:00:50.714Z"},"isAppLevelMetafieldCreated":true,"trackEvents":{"OB Welcome page visited":true,"OB Welcome page button click":true},"SERVER_URL":"https://prod.backend.giftbox.giftkart.app"},"languageData":{"_id":"6627a56b1ca8324641fc04c5","shopName":"ahead-nutrition.myshopify.com","__v":0,"createdAt":"2024-04-23T12:11:23.065Z","en":{"landingPage":{"bannerText":{"id":"bannerText","label":"Banner Text","type":"text","value":"Build your own Bundle in just a few clicks!"},"bannerSubtext":{"id":"bannerSubtext","label":"Banner Subtext","type":"text","value":"Send a custom bundle to your loved one in just a few steps"},"bannerButtonText":{"id":"bannerButtonText","label":"Banner Button Text","type":"text","value":"Start Building your Bundle"},"selectPreCuratedBoxLabel":{"id":"selectPreCuratedBoxLabel","label":"Select Pre-Curated Box Label","type":"text","value":"Or select from a range of pre-curated Gift Boxes"}},"sortBy":{"sortLabel":{"id":"sortLabel","label":"Sort Label","type":"text","value":"Sortieren"},"alphabeticalAToZ":{"id":"alphabeticalAToZ","label":"Alphabetical, A-Z Label","value":"Alphabetisch,A-Z"},"alphabeticalZToA":{"id":"alphabeticalZToA","label":"Alphabetical, Z-A Label","value":"Alphabetisch, Z-A"},"priceHighToLow":{"id":"priceHighToLow","label":"Price, High to Low Label","value":"Preis, Hoch-Niedrig"},"priceLowToHigh":{"id":"priceLowToHigh","label":"Price, Low to High Label","value":"Preis, Niedrig-Hoch"},"featured":{"id":"featured","label":"Featured Label","type":"text","value":""}},"giftBoxPage":{"selectGiftBoxLabel":{"id":"selectGiftBoxLabel","label":"Select Bundle Label","type":"text","value":"Select a Bundle Box"},"giftBoxPageSubtext":{"id":"giftBoxPageSubtext","label":"Gift Box Page Subtext","type":"text","value":""}},"personalizePage":{"selectGreetingCardLabel":{"id":"selectGreetingCardLabel","label":"Select Greeting Card Label","type":"text","value":"Select A Greeting Card"},"clearSelectionButton":{"id":"clearSelectionButton","label":"Clear Selection label","type":"text","value":"Clear Selection"},"noImagesAvailable":{"id":"noImagesAvailable","label":"No Images Available label","type":"text","value":"No Images Available"},"messageLabel":{"id":"messageLabel","label":"Message Label","type":"text","value":"Message"},"senderNamePlaceholder":{"id":"senderNamePlaceholder","label":"Sender Name Placeholder","type":"text","value":"From"},"recipientNamePlaceholder":{"id":"recipientNamePlaceholder","label":"Recipient Name Placeholder","type":"text","value":"To"},"messagePlaceholder":{"id":"messagePlaceholder","label":"Message Placeholder","type":"text","value":"Enter a message here..."},"emailAddressLabel":{"id":"emailAddressLabel","label":"Recipient Email Address Label","type":"text","value":"Recipient Email Address"},"emailAddressPlaceholder":{"id":"emailAddressPlaceholder","label":"Recipient Email Address Placeholder","type":"text","value":"Enter a recipient email address here..."},"emailValidationMessage":{"id":"emailValidationMessage","label":"Email Validation Message","type":"text","value":"Please enter a valid email address"},"sendNow":{"id":"sendNow","label":"Send Now Label","type":"text","value":"Send Now"},"sendLater":{"id":"sendLater","label":"Send Later Label","type":"text","value":"Send Later"},"personalizePageSubtext":{"id":"personalizePageSubtext","label":"Personalize Page Subtext","type":"text","value":""},"messageIsRequiredError":{"id":"messageIsRequiredError","label":"Message is required warning","type":"text","value":"Please enter a message"}},"reviewPage":{"reviewPageBannerText":{"id":"reviewPageBannerText","label":"Review Page Banner Text","type":"text","value":"You’ve made the  Right Choice!"},"reviewPageBannerSubtext":{"id":"reviewPageBannerSubtext","label":"Review Page Banner Subtext","type":"text","value":"Review your bundle and proceed to checkout"},"addOnsLabel":{"id":"addOnsLabel","label":"Add Ons Label","type":"text","value":"Add Ons"},"totalValueLabel":{"id":"totalValueLabel","label":"Total Value Label","type":"text","value":"Bundlepreis:"},"totalLabel":{"id":"totalLabel","label":"Total Label","type":"text","value":"Bundlepreis:"},"productLabel":{"id":"productLabel","label":"Product Header Label","type":"text","value":"Product"},"priceLabel":{"id":"priceLabel","label":"Price Header Text","type":"text","value":"Preis"},"quantityLabel":{"id":"quantityLabel","label":"Quantity Header Text","type":"text","value":"Anzahl:"},"deliveryDateLabel":{"id":"deliveryDateLabel","label":"Delivery Date Label","type":"text","value":"Delivery Date"},"productsLabelText":{"id":"productsLabelText","label":"Products Label Text","type":"text","value":""},"messagesLabelText":{"id":"messagesLabelText","label":"Messages Label Text","type":"text","value":"Messages"},"discountAppliedLabel":{"id":"discountAppliedLabel","label":"Discount Applied Label","type":"text","value":"Rabatt"},"subtotalLabel":{"id":"subtotalLabel","label":"Sub Total Label","type":"text","value":"Subtotal"},"orderDetailsLabel":{"id":"orderDetailsLabel","label":"Order Details Label","type":"text","value":"Order Details"},"itemsLabel":{"id":"itemsLabel","label":"No. of Items Label","type":"text","value":"Item(s)"},"oneTimePurchaseLabel":{"id":"oneTimePurchaseLabel","label":"One-Time Purchase label","type":"text","value":"One-Time Purchase"},"subscribeAndSaveLabel":{"id":"subscribeAndSaveLabel","label":"Subscribe and Save label","type":"text","value":"Subscribe and Save"},"noSubscriptionFoundLabel":{"id":"noSubscriptionFoundLabel","label":"No Subscription plans found label","type":"text","value":"Oops! No Subscription plans were found"},"deliveryFrequencyLabel":{"id":"deliveryFrequencyLabel","label":"Delivery Frequency Label","type":"text","value":"Delivery Frequency"},"createNewBoxLabel":{"id":"createNewBoxLabel","label":"Create New Box Label","type":"text","value":"Create new Box"},"editButtonText":{"id":"editButtonText","label":"Edit Label","type":"text","value":"Edit"},"deliverySchedulerPlaceholderText":{"id":"deliverySchedulerPlaceholderText","label":"Delivery Scheduler Placeholder Text","type":"text","value":"Select a date"}},"productPage":{"selectProductsLabel":{"id":"selectProductsLabel","label":"Select Products Label","type":"text","value":"Select Products"},"productPageSubtext":{"id":"productPageSubtext","label":"Product Page Subtext","type":"text","value":""}},"videoMessage":{"permissionDenied":{"id":"permissionDenied","label":"Permission Denied","type":"text","value":"Permission Denied"},"uploadConfirmation":{"id":"uploadConfirmation","label":"Upload Confirmation","type":"text","value":"Your video has been successfully uploaded!"},"pressToRecord":{"id":"pressToRecord","label":"Press to record","type":"text","value":"Press to record"},"recording":{"id":"recording","label":"Recording","type":"text","value":"Recording...."},"errorMessage":{"id":"errorMessage","label":"Error Message","type":"text","value":"An error occured, Please try again!"},"loading":{"id":"loading","label":"Loading","type":"text","value":"Loading...."},"uploading":{"id":"uploading","label":"Uploading","type":"text","value":"Uploading...."},"sendVideoMessageText":{"id":"sendVideoMessageText","label":"Send Video Message Text","type":"text","value":"Send Video Message"},"giftMessageDeliveryInfo":{"id":"giftMessageDeliveryInfo","label":"Message Delivery Info","type":"text","value":"The message will be sent to the recipient via email as soon as the order is placed"},"saveVideoText":{"id":"saveVideoText","label":"Save Video Text","type":"text","value":"Save Video"},"reRecordVideoText":{"id":"reRecordVideoText","label":"Re-Record Video Text","type":"text","value":"Re-Record Video"}},"navigationSteps":{"productPageStepText":{"id":"productPageStepText","label":"Product Page Step Text","type":"text","value":"Add Products"},"giftBoxStepText":{"id":"giftBoxStepText","label":"Bundle Step Text","type":"text","value":"Add Gift Box"},"personalizeStepText":{"id":"personalizeStepText","label":"Personalize Step Text","type":"text","value":"Personalize"},"multipleCategoriesStepText":{"id":"multipleCategoriesStepText","label":"Multiple Categories Step Text","type":"text","value":"Multiple Categories"}},"general":{"noProductsAvailable":{"id":"noProductsAvailable","label":"No Products Available label","type":"text","value":"nicht verfügbar"},"filtersLabel":{"id":"filtersLabel","label":"Filters Label","type":"text","value":"Filter"},"clearSelection":{"id":"clearSelection","label":"Clear Filters Selection","type":"text","value":"Clear Selection"},"searchLabel":{"id":"searchLabel","label":"Search Label","type":"text","value":"Suchen"},"addToBoxButtonText":{"id":"addToBoxButtonText","label":"Add To Box Button","type":"text","value":"Hinzufügen"},"chooseOptionsButtonText":{"id":"chooseOptionsButtonText","label":"Choose Options Button","type":"text","value":"Variante auswählen"},"loadMoreProductsButtonText":{"id":"loadMoreProductsButtonText","label":"Load More Products Button","type":"text","value":"Mehr Produkte..."},"loadingCheckoutButtonText":{"id":"loadingCheckoutButtonText","label":"Loading Checkout Button","type":"text","value":""},"addedText":{"id":"addedText","label":"Added Label","type":"text","value":"Hinzugefügt"},"addButtonText":{"id":"addButtonText","label":"Add Button Text","type":"text","value":"Hinzufügen"},"nextButtonText":{"id":"nextButtonText","label":"Next Button Text","type":"text","value":"Zum Warenkorb hinzufügen"},"addToCartButtonText":{"id":"addToCartButtonText","label":"Add To Cart Button Text","type":"text","value":"Hinzufügen"},"backButtonText":{"id":"backButtonText","label":"Back Button Text","type":"text","value":"Zurück"},"checkoutButtonText":{"id":"checkoutButtonText","label":"Checkout Button Text","type":"text","value":""},"removeButtonText":{"id":"removeButtonText","label":"Remove Button Text","type":"text","value":"Löschen"},"reviewButtonText":{"id":"reviewButtonText","label":"Review Button Text","type":"text","value":""},"combinationNotAvailable":{"id":"combinationNotAvailable","label":"Combination Not Available","type":"text","value":"Combination Not Available"},"quantity":{"id":"quantity","label":"Quantity Label","type":"text","value":"Anzahl:"},"viewCartProductsLabel":{"id":"viewCartProductsLabel","label":"View Cart Products Label","type":"text","value":"Bundleinhalt"},"selectedProductsLabel":{"id":"selectedProductsLabel","label":"Selected Products Label","type":"text","value":""},"selectBundleProductsText":{"id":"selectBundleProductsText","label":"Select Bundle Products label","type":"text","value":"Bundleprodukte"},"redirectingText":{"id":"redirectingText","label":"Redirecting label","type":"text","value":"Redirecting..."},"preparingBundleText":{"id":"preparingBundleText","label":"Preparing Bundle Label","type":"text","value":"Bundle wird erstellt..."},"productsNotAvailableText":{"id":"productsNotAvailableText","label":"Products Not Available Label","type":"text","value":"Oops! Manche Produkte sind nicht verfügbar"},"discountsMayNotApplyText":{"id":"discountsMayNotApplyText","label":"Discounts may not be applied Label","type":"text","value":""},"removeAllBoxProducts":{"id":"removeAllBoxProducts","label":"Remove all Box Products Label (Cart Page Popup)","type":"text","value":""},"cartPageCheckoutButtonLoadingText":{"id":"cartPageCheckoutButtonLoadingText","label":"Cart Page Checkout Button Loading Text","type":"text","value":""},"inventoryInStockText":{"id":"inventoryInStockText","label":"Inventory in Stock Label","type":"text","value":"in Stock"},"inventoryLimitReachedText":{"id":"inventoryLimitReachedText","label":"Inventory Limit Reached Label","type":"text","value":"No More Stock"}},"discountRules":{"rule1":{"amount":{"id":"amount","label":"Amount","type":"text","value":""},"text":{"id":"text","label":"Text","type":"text","value":""}},"rule2":{"amount":{"id":"amount","label":"Amount","type":"text","value":""},"text":{"id":"text","label":"Text","type":"text","value":""}},"rule3":{"amount":{"id":"amount","label":"Amount","type":"text","value":""},"text":{"id":"text","label":"Text","type":"text","value":""}},"rule4":{"amount":{"id":"amount","label":"Amount","type":"text","value":""},"text":{"id":"text","label":"Text","type":"text","value":""}},"rule5":{"amount":{"id":"amount","label":"Amount","type":"text","value":""},"text":{"id":"text","label":"Text","type":"text","value":""}}},"conditions":{"amount":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":""},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":""},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":""}},"quantity":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":"Bitte mind. ##conditionQuantity## Produkte auswählen!"},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":"Bitte max. ##conditionQuantity## Produkte auswählen!"},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":""}},"weight":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":""},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":""},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":""}}},"multipleCategoriesPage":{"multipleCategoriesSubtext":{"id":"multipleCategoriesSubtext","label":"Multiple Categories Page Subtext","type":"text","value":""}},"multipleCategories":{},"addons":{"maxAddonProductsAllowed":{"id":"maxAddonProductsAllowed","label":"Max Addon Products Allowed message","type":"text","value":" add maximum ##maxAllowedAddons## products to continue"},"addonProductsMandatory":{"id":"addonProductsMandatory","label":"Addon Products Mandatory message","type":"text","value":"Please add atleast one product"}}},"languageMode":"MULTIPLE","updatedAt":"2024-04-29T11:16:05.720Z","mixAndMatchTextData":{"en":{"conditions":{"amount":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":"Add products worth at least ##conditionAmount## on this step"},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":"Add products worth maximum of ##conditionAmount## on this step"},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":"Add products worth ##conditionAmount## on this step"}},"quantity":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":"Add at least ##conditionQuantity## products on this step"},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":"Add a maximum of ##conditionQuantity## products to continue"},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":"Add exactly ##conditionQuantity## products on this step"}},"weight":{"greaterThanOrEqualTo":{"id":"greaterThanOrEqualTo","label":"Greater than condition message","type":"text","value":"Add products weighing at least ##conditionWeight## on this step"},"lessThanOrEqualTo":{"id":"lessThanOrEqualTo","label":"Less than condition message","type":"text","value":"Add products weighing maximum of ##conditionWeight## on this step"},"equalTo":{"id":"equalTo","label":"Equal to condition message","type":"text","value":"Add products weighing ##conditionWeight## on this step"}}},"general":{"noProductsAvailable":{"id":"noProductsAvailable","label":"No Products Available label","type":"text","value":"No Products Available"},"addBundleToCartBtnText":{"id":"addBundleToCartBtnText","label":"Add Bundle Cart label","type":"text","value":"Add Bundle to Cart"},"addBundleToCartLoadingBtnText":{"id":"addBundleToCartLoadingBtnText","label":"Add Bundle Loading label","type":"text","value":"Adding Bundle..."},"inventoryLimitReachedText":{"id":"inventoryLimitReachedText","label":"Inventory Limit Reached Label","type":"text","value":"No More Stock"},"emptyCardText":{"id":"emptyCardText","label":"Add Product Card Text","type":"text","value":"Add Product"}},"footer":{"footerPrevBtnText":{"id":"footerPrevBtnText","label":"Footer Previous Button","type":"text","value":"Prev"},"footerNextBtnText":{"id":"footerNextBtnText","label":"Footer Next Button","type":"text","value":"Next"},"footerFinishBtnText":{"id":"footerFinishBtnText","label":"Footer Finish Button","type":"text","value":"Done"}},"productCard":{"productCardAddBtnText":{"id":"productCardAddBtnText","label":"Product Add to Cart Button","type":"text","value":"Add to Cart"},"productVariantLabelText":{"id":"productVariantLabelText","label":"Product Variant Label","type":"text","value":"Select variant"}}}}},"pageCustomizationData":{"_id":"6627a56b1ca8324641fc04c4","shopName":"ahead-nutrition.myshopify.com","__v":0,"banners":{"landingPageImageSrc":"https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_bannerv2.png","pageBannerImageSrc":"https://d3ks0ngva6go34.cloudfront.net/public/banners/page_banner_temp.png","productReviewImageSrc":"https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_bannerv2.png"},"cartFooter":{"cartFooterBgColor":"#f1f2f3","cartFooterTextColor":"#1d1d1d","cartFooterNextButtonColor":"#1d1d1d","cartFooterNextButtonTextColor":"#ffffff","cartFooterBackButtonColor":"#6d7175","cartFooterBackButtonTextColor":"#ffffff","cartFooterDiscountTextColor":"#1d1d1d"},"colors":{"disabledColor":"gray","primaryColor":"blue","productBox":"blue","secondaryColor":"aqua","textColor":"black"},"createdAt":"2024-04-23T12:11:23.066Z","landingPage":{"landingPageTextColor":"#1d1d1d","landingPageButtonBgColor":"#1d1d1d","landingPageButtonTextColor":"#ffffff"},"navigationBanner":{"navigationBannerTitleColor":"#ffffff","navigationBannerTextColor":"#ffffff","navigationBannerStepCompletionColor":"#1d1d1d","navigationBannerStepDoneColor":"#ffffff","navigationBannerStepTextColor":"#1d1d1d"},"previewPage":{"bannerTextColor":"#ffffff"},"primaryFont":"","productCard":{"productCardBgColor":"#fff","productCardTextColor":"#1d1d1d","productCardButtonColor":"#CB33FB","productCardButtonTextColor":"#ffffff"},"quickSettings":{"isQuickSettingsEnabled":true,"colors":{"primaryColor":"#000000","buttonBgColor":"#000000","buttonTextColor":"#ffffff"}},"summaryBlock":{"summaryBlockAddToCartButtonColor":"#1d1d1d","summaryBlockAddToCartButtonTextColor":"#ffffff","summaryBlockBackButtonColor":"#252525","summaryBlockBackButtonTextColor":"#ffffff"},"updatedAt":"2025-01-10T09:38:04.717Z","templateLevelConfig":{},"categoryBlock":{"categoryBgColor":"#f5f5f5"},"generalSettings":{"scrollBar":{"scrollBarColor":"#1d1d1d"},"conditionToast":{"conditionToastBgColor":"#1d1d1d","conditionToastTextColor":"#ffffff"},"icon":{"iconBgColor":"#1d1d1d","iconTextColor":"#ffffff"},"productPage":{"productPageTitleColor":"#1d1d1d"},"bundle":{"bundleBgColor":"#F1E9DE"}}},"stepsConfigurationData":{"_id":"6627a5ea1ca8324641fc382a","bundleId":"1","shopName":"ahead-nutrition.myshopify.com","__v":0,"bundleChecklist":{"publishBundle":true,"reviewDefaultLanguageText":true,"changeBundleColors":true},"bundleChecklistStatus":"IN_PROGRESS","bundleDesignTemplate":"BUILD_FROM_SCRATCH","bundleName":"Bundle Builder","bundleStatus":"ACTIVE","createdAt":"2024-04-23T12:13:30.380Z","landingPageData":{"isVisibleOnAdminUi":true,"isLandingPageEnabled":false,"stepImage":"https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_bannerv2.png","bannerText":"Build your own Bundle in just a few clicks!","bannerButtonText":"Build your Custom Bundle","bannerSubtext":"Send a custom bundle to your loved one in just a few steps"},"multipleCategoriesData":{"isMultipleCategoriesEnabled":false,"stepImage":"https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconf3.png"},"personalizationData":{"isVisibleOnAdminUi":true,"isPersonalizationEnabled":false,"personalizeStepText":"Personalize","personalizePageSubtext":"","stepImage":"https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg","giftwrap":{},"giftMessage":{},"giftAddons":{},"greetingCard":{},"scheduleDelivery":{}},"summaryPageData":{"isVisibleOnAdminUi":true,"isSummaryPageEnabled":false,"reviewPageBannerText":"You’ve made the  Right Choice!","reviewPageBannerSubtext":"Review your bundle and proceed to checkout"},"updatedAt":"2025-01-10T09:28:05.020Z","productsData1":{"isVisibleOnAdminUi":true,"stepImage":"https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/icons/Deafult+Image.png","categories":{"category47127":{"categoryId":"category47127","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","title":"Schokoriegel","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":7983459008776,"productId":7983459008776,"title":"Salted Peanut-Caramel","handle":"ahead-riegel-salted-peanut-caramel-vegan","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:40:10+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":8014518911240,"productId":8014518911240,"title":"Crunchy Nougat","handle":"ahead-riegel-crunchy-nougat","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:40:11+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":7964092072200,"productId":7964092072200,"title":"Hazelnut-Cacao","handle":"ahead-riegel-hazelnut-cacao","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:45:11+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":7975881605384,"productId":7975881605384,"title":"Caramel-Cacao","handle":"ahead-riegel-caramel-cacao","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:30:59+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":6610491048023,"productId":6610491048023,"title":"Coconut-Almond","handle":"ahead-riegel-coconut-almond","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:30+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":8018318983432,"productId":8018318983432,"title":"Peanut Butter Jelly","handle":"ahead-riegel-peanut-butter-jelly","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-crunchy-nougat","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:40:12+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]}],"productPersonalization":{"isProductPersonalizationEnabled":false,"isEnabledForSelectedProducts":false,"isEnabledForAllProducts":true,"selectedProducts":[],"formBlocks":[]}},"category56417":{"categoryId":"category56417","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","title":"Proteinriegel","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":8516037869832,"productId":8516037869832,"title":"Peanut Caramel","handle":"protein-bar-peanut-caramel","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T08:50:28+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8340716814600,"productId":8340716814600,"title":"Cookies & Cream","handle":"protein-bar-cookies-cream","tags":["High Protein","Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T13:51:56+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8430865940744,"productId":8430865940744,"title":"Hazelnut Nougat","handle":"protein-bar-hazelnut-nougat","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T14:54:02+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8471614882056,"productId":8471614882056,"title":"Coconut Almond","handle":"protein-bar-coconut-almond","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T12:11:22+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8543024611592,"productId":8543024611592,"title":"Fudge Brownie","handle":"protein-bar-fudge-brownie","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:42+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]}]},"category90196":{"categoryId":"category90196","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","title":"Nussriegel","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":8315970453768,"productId":8315970453768,"title":"Cashew Pretzel","handle":"nut-bar-cashew-prezel","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","stock-bar","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:37+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]},{"id":8303924871432,"productId":8303924871432,"title":"Coconut Almond","handle":"nut-bar-coconut-almond","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T11:10:40+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]},{"id":8358743310600,"productId":8358743310600,"title":"Dark & Salty","handle":"dark-salty","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","stock-bar","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:51:55+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]}]},"category74800":{"categoryId":"category74800","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","multiLangData":{},"title":"Wafer Bars","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":9591240491272,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Crazy Hazel","handle":"cream-filled-wafer-bar-crazy-hazel","status":"ACTIVE","updatedAt":"2025-01-10T09:20:32Z","sellingPlanGroups":[],"productId":9591240491272,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]},{"id":9590405562632,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"White Crazy Hazel","handle":"cream-filled-wafer-bar-crazy-hazel-white","status":"ACTIVE","updatedAt":"2025-01-09T08:45:35Z","sellingPlanGroups":[],"productId":9590405562632,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]},{"id":9591239115016,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"White Crazy Pistachio","handle":"cream-filled-wafer-bar-white-crazy-pistachio","status":"ACTIVE","updatedAt":"2025-01-10T08:55:34Z","sellingPlanGroups":[],"productId":9591239115016,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]}]},"category01076":{"categoryId":"category01076","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","multiLangData":{},"title":"Cremes","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":9555832963336,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel 350g","handle":"sparpaket-white-crazy-hazel-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:16:56Z","sellingPlanGroups":[],"productId":9555832963336,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9555815137544,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Pistachio 350g","handle":"sparpaket-crazy-pistachio-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:07:51Z","sellingPlanGroups":[],"productId":9555815137544,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9555823395080,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel 350g","handle":"sparpaket-crazy-hazel-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:19:26Z","sellingPlanGroups":[],"productId":9555823395080,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8210712330504,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel","handle":"crazy-hazel-6x-tray","status":"ACTIVE","updatedAt":"2024-12-24T00:47:12Z","sellingPlanGroups":[],"productId":8210712330504,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8457981657352,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel","handle":"white-crazy-hazel-6x-tray","status":"ACTIVE","updatedAt":"2025-01-10T08:51:41Z","sellingPlanGroups":[],"productId":8457981657352,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8409704661256,"tags":["exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel Vegan","handle":"sparpaket-crazy-hazel-vegan-6x","status":"ACTIVE","updatedAt":"2025-01-10T07:29:01Z","sellingPlanGroups":[],"productId":8409704661256,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8625939087624,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","limitiert","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel Crunchy","handle":"white-crazy-hazel-crunchy-6x-tray","status":"ACTIVE","updatedAt":"2024-12-22T22:11:08Z","sellingPlanGroups":[],"productId":8625939087624,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9397207171336,"tags":["exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Pistachio","handle":"crazy-pistachio-6x-tray","status":"ACTIVE","updatedAt":"2024-12-22T22:11:06Z","sellingPlanGroups":[],"productId":9397207171336,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]}]},"category74442":{"categoryId":"category74442","categoryImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/multiple_category_category.png","conditions":[],"autoNextStepOnConditionMet":false,"products":[],"categoryBanner":"","multiLangData":{},"title":"Low Sugar Snacks","subTitle":"","productPageKey":"productsData1","uniqueProductsData":[{"id":8536187175176,"tags":["gift","influencer10","Low Sugar","NODATE","nodiscount","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","sale","Vegetarisch","Weniger Kalorien"],"title":"Double Chocolate 24x","handle":"soft-cookie-dc6","status":"ACTIVE","updatedAt":"2025-01-10T09:25:20Z","sellingPlanGroups":[],"productId":8536187175176,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8582864208136,"tags":["BUNDLE","gift","Glutenfrei","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crazy-hazel-6x-tray","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Haselnuss Nougat Sparpaket","handle":"bio-crunchies-nougat-sparpaket","status":"ACTIVE","updatedAt":"2025-01-05T16:23:05Z","sellingPlanGroups":[],"productId":8582864208136,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8442950222088,"tags":["gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Fluffy Hearts Gummies","handle":"gummies-fluffy-hearts","status":"ACTIVE","updatedAt":"2024-12-22T22:11:21Z","sellingPlanGroups":[],"productId":8442950222088,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8452389044488,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sour Cola Gummies","handle":"sour-cola-gummies","status":"ACTIVE","updatedAt":"2024-12-30T11:10:00Z","sellingPlanGroups":[],"productId":8452389044488,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8452391174408,"tags":["Beliebt","gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sweet Peaches Gummies","handle":"sweet-peaches-gummies","status":"ACTIVE","updatedAt":"2024-12-30T11:18:30Z","sellingPlanGroups":[],"productId":8452391174408,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8449594622216,"tags":["gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sweet Cherry Gummies","handle":"sweet-cherry-gummies","status":"ACTIVE","updatedAt":"2025-01-08T14:35:22Z","sellingPlanGroups":[],"productId":8449594622216,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9548840435976,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Almond Butter Cups","handle":"almond-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T06:40:56Z","sellingPlanGroups":[],"productId":9548840435976,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9548895781128,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Dark Chocolate Peanut Butter Cups","handle":"dark-chocolate-peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T09:27:51Z","sellingPlanGroups":[],"productId":9548895781128,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8335681585416,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Peanut Butter Cups","handle":"peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T09:20:17Z","sellingPlanGroups":[],"productId":8335681585416,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9531415658760,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"White Peanut Butter Cups","handle":"white-peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T06:40:55Z","sellingPlanGroups":[],"productId":9531415658760,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9603235152136,"tags":["gift","Glutenfrei","influencer10","Low Sugar","new","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"White Pistachio Butter Cups","handle":"white-pistachio-cups","status":"ACTIVE","updatedAt":"2025-01-10T08:55:36Z","sellingPlanGroups":[],"productId":9603235152136,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8274847957256,"tags":["Beliebt","gift","Glutenfrei","High Protein","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-cheese","recommend:crunchies-nougat","sale","stock-bar","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Paprika","handle":"crispies-paprika","status":"ACTIVE","updatedAt":"2025-01-10T09:20:15Z","sellingPlanGroups":[],"productId":8274847957256,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8566734651656,"tags":["gift","Glutenfrei","High Protein","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-cheese","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Sour Cream & Onion","handle":"crispies-sour-cream","status":"ACTIVE","updatedAt":"2025-01-10T08:50:28Z","sellingPlanGroups":[],"productId":8566734651656,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8274768429320,"tags":["gift","Glutenfrei","High Protein","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-paprika","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Cheese","handle":"crispies-cheese","status":"ACTIVE","updatedAt":"2025-01-10T09:16:41Z","sellingPlanGroups":[],"productId":8274768429320,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]}]}},"productPageStepText":"1","productPageSubtext":"","pageType":"MULTIPLE_CATEGORY","isMultiCategoryTabBasedUIEnabled":true,"productPageKey":"productsData1","autoNextStepOnConditionMet":false,"conditions":[{"type":"quantity","condition":"greaterThanOrEqualTo","value":"3"},{"type":"quantity","condition":"lessThanOrEqualTo","value":"50"}],"displayVariantsAsIndividualProducts":false,"isPageConditionsEnabled":true,"isProductsEnabled":true,"pageBanners":{"mobileBanner":"","desktopBanner":""},"uniqueProductsData":[{"id":7983459008776,"productId":7983459008776,"title":"Salted Peanut-Caramel","handle":"ahead-riegel-salted-peanut-caramel-vegan","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:40:10+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":8014518911240,"productId":8014518911240,"title":"Crunchy Nougat","handle":"ahead-riegel-crunchy-nougat","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:40:11+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":7964092072200,"productId":7964092072200,"title":"Hazelnut-Cacao","handle":"ahead-riegel-hazelnut-cacao","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:45:11+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":7975881605384,"productId":7975881605384,"title":"Caramel-Cacao","handle":"ahead-riegel-caramel-cacao","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:30:59+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":6610491048023,"productId":6610491048023,"title":"Coconut-Almond","handle":"ahead-riegel-coconut-almond","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:30+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":8018318983432,"productId":8018318983432,"title":"Peanut Butter Jelly","handle":"ahead-riegel-peanut-butter-jelly","tags":["Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-crunchy-nougat","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:40:12+02:00","collectionIds":["514121171208"],"collectionNames":["BB-Schokoriegel"]},{"id":8516037869832,"productId":8516037869832,"title":"Peanut Caramel","handle":"protein-bar-peanut-caramel","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T08:50:28+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8340716814600,"productId":8340716814600,"title":"Cookies & Cream","handle":"protein-bar-cookies-cream","tags":["High Protein","Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T13:51:56+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8430865940744,"productId":8430865940744,"title":"Hazelnut Nougat","handle":"protein-bar-hazelnut-nougat","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T14:54:02+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8471614882056,"productId":8471614882056,"title":"Coconut Almond","handle":"protein-bar-coconut-almond","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T12:11:22+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8543024611592,"productId":8543024611592,"title":"Fudge Brownie","handle":"protein-bar-fudge-brownie","tags":["High Protein","Influencer10","Low Sugar","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:42+02:00","collectionIds":["514610495752"],"collectionNames":["BB-Proteinriegel"]},{"id":8315970453768,"productId":8315970453768,"title":"Cashew Pretzel","handle":"nut-bar-cashew-prezel","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","stock-bar","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T14:27:37+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]},{"id":8303924871432,"productId":8303924871432,"title":"Coconut Almond","handle":"nut-bar-coconut-almond","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T11:10:40+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]},{"id":8358743310600,"productId":8358743310600,"title":"Dark & Salty","handle":"dark-salty","tags":["Influencer10","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","stock-bar","Vegetarisch","Weniger Kalorien"],"updated_at":"2024-06-25T13:51:55+02:00","collectionIds":["514610594056"],"collectionNames":["BB-Nussriegel"]},{"id":9591240491272,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Crazy Hazel","handle":"cream-filled-wafer-bar-crazy-hazel","status":"ACTIVE","updatedAt":"2025-01-10T09:20:32Z","sellingPlanGroups":[],"productId":9591240491272,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]},{"id":9590405562632,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"White Crazy Hazel","handle":"cream-filled-wafer-bar-crazy-hazel-white","status":"ACTIVE","updatedAt":"2025-01-09T08:45:35Z","sellingPlanGroups":[],"productId":9590405562632,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]},{"id":9591239115016,"tags":["Bueno","gift","Glutenfrei","influencer10","Low Sugar","neu","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"White Crazy Pistachio","handle":"cream-filled-wafer-bar-white-crazy-pistachio","status":"ACTIVE","updatedAt":"2025-01-10T08:55:34Z","sellingPlanGroups":[],"productId":9591239115016,"collectionIds":["527984361736"],"collectionNames":["BB-Wafer-Bars"]},{"id":9555832963336,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel 350g","handle":"sparpaket-white-crazy-hazel-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:16:56Z","sellingPlanGroups":[],"productId":9555832963336,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9555815137544,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Pistachio 350g","handle":"sparpaket-crazy-pistachio-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:07:51Z","sellingPlanGroups":[],"productId":9555815137544,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9555823395080,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel 350g","handle":"sparpaket-crazy-hazel-350g","status":"ACTIVE","updatedAt":"2025-01-10T09:19:26Z","sellingPlanGroups":[],"productId":9555823395080,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8210712330504,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel","handle":"crazy-hazel-6x-tray","status":"ACTIVE","updatedAt":"2024-12-24T00:47:12Z","sellingPlanGroups":[],"productId":8210712330504,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8457981657352,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel","handle":"white-crazy-hazel-6x-tray","status":"ACTIVE","updatedAt":"2025-01-10T08:51:41Z","sellingPlanGroups":[],"productId":8457981657352,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8409704661256,"tags":["exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Hazel Vegan","handle":"sparpaket-crazy-hazel-vegan-6x","status":"ACTIVE","updatedAt":"2025-01-10T07:29:01Z","sellingPlanGroups":[],"productId":8409704661256,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8625939087624,"tags":["Beliebt","exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","limitiert","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","pre-order","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket White Crazy Hazel Crunchy","handle":"white-crazy-hazel-crunchy-6x-tray","status":"ACTIVE","updatedAt":"2024-12-22T22:11:08Z","sellingPlanGroups":[],"productId":8625939087624,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":9397207171336,"tags":["exc_ch_6er_sparpaket","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Sparpaket Crazy Pistachio","handle":"crazy-pistachio-6x-tray","status":"ACTIVE","updatedAt":"2024-12-22T22:11:06Z","sellingPlanGroups":[],"productId":9397207171336,"collectionIds":["514121269512"],"collectionNames":["BB-Aufstrich"]},{"id":8536187175176,"tags":["gift","influencer10","Low Sugar","NODATE","nodiscount","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","sale","Vegetarisch","Weniger Kalorien"],"title":"Double Chocolate 24x","handle":"soft-cookie-dc6","status":"ACTIVE","updatedAt":"2025-01-10T09:25:20Z","sellingPlanGroups":[],"productId":8536187175176,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8582864208136,"tags":["BUNDLE","gift","Glutenfrei","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crazy-hazel-6x-tray","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Haselnuss Nougat Sparpaket","handle":"bio-crunchies-nougat-sparpaket","status":"ACTIVE","updatedAt":"2025-01-05T16:23:05Z","sellingPlanGroups":[],"productId":8582864208136,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8442950222088,"tags":["gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Fluffy Hearts Gummies","handle":"gummies-fluffy-hearts","status":"ACTIVE","updatedAt":"2024-12-22T22:11:21Z","sellingPlanGroups":[],"productId":8442950222088,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8452389044488,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sour Cola Gummies","handle":"sour-cola-gummies","status":"ACTIVE","updatedAt":"2024-12-30T11:10:00Z","sellingPlanGroups":[],"productId":8452389044488,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8452391174408,"tags":["Beliebt","gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sweet Peaches Gummies","handle":"sweet-peaches-gummies","status":"ACTIVE","updatedAt":"2024-12-30T11:18:30Z","sellingPlanGroups":[],"productId":8452391174408,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8449594622216,"tags":["gift","influencer10","Low Sugar","NODATE","nosub","out-of-stock","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-coconut-almond","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Weniger Kalorien"],"title":"Sweet Cherry Gummies","handle":"sweet-cherry-gummies","status":"ACTIVE","updatedAt":"2025-01-08T14:35:22Z","sellingPlanGroups":[],"productId":8449594622216,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9548840435976,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Almond Butter Cups","handle":"almond-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T06:40:56Z","sellingPlanGroups":[],"productId":9548840435976,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9548895781128,"tags":["gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Dark Chocolate Peanut Butter Cups","handle":"dark-chocolate-peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T09:27:51Z","sellingPlanGroups":[],"productId":9548895781128,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8335681585416,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"Peanut Butter Cups","handle":"peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T09:20:17Z","sellingPlanGroups":[],"productId":8335681585416,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9531415658760,"tags":["Beliebt","gift","Glutenfrei","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"White Peanut Butter Cups","handle":"white-peanut-butter-cups","status":"ACTIVE","updatedAt":"2025-01-10T06:40:55Z","sellingPlanGroups":[],"productId":9531415658760,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":9603235152136,"tags":["gift","Glutenfrei","influencer10","Low Sugar","new","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"title":"White Pistachio Butter Cups","handle":"white-pistachio-cups","status":"ACTIVE","updatedAt":"2025-01-10T08:55:36Z","sellingPlanGroups":[],"productId":9603235152136,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8274847957256,"tags":["Beliebt","gift","Glutenfrei","High Protein","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-cheese","recommend:crunchies-nougat","sale","stock-bar","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Paprika","handle":"crispies-paprika","status":"ACTIVE","updatedAt":"2025-01-10T09:20:15Z","sellingPlanGroups":[],"productId":8274847957256,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8566734651656,"tags":["gift","Glutenfrei","High Protein","influencer10","Laktosefrei","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-cheese","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Sour Cream & Onion","handle":"crispies-sour-cream","status":"ACTIVE","updatedAt":"2025-01-10T08:50:28Z","sellingPlanGroups":[],"productId":8566734651656,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]},{"id":8274768429320,"tags":["gift","Glutenfrei","High Protein","influencer10","Low Sugar","NODATE","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:crazy-hazel","recommend:crispies-paprika","recommend:crunchies-nougat","sale","Vegan","Vegetarisch","Weniger Kalorien"],"title":"Cheese","handle":"crispies-cheese","status":"ACTIVE","updatedAt":"2025-01-10T09:16:41Z","sellingPlanGroups":[],"productId":8274768429320,"collectionIds":["514121302280"],"collectionNames":["BB-Low-Sugar-Snacks"]}],"filterBySearch":{"isSearchEnabled":false,"searchQuery":{"searchField":"title","searchFieldType":"String"}},"filterTypes":{"isFiltersEnabled":true,"categories":{},"filterRule":"OR","filterRuleAcrossCategory":"OR"},"sellingPlanGroupsData":[],"multiLangData":{}},"defaultProductsData":{"isDefaultProductsEnabled":false,"products":[]},"conditionalLogic":{"isEnabled":true,"rules":[]},"customBundleLevelStyle":"","enableRecurringDiscounts":false,"isOneTimePurchaseEnabled":true,"isOrderSubscriptionsEnabled":false,"bundleImg":"https://d3ks0ngva6go34.cloudfront.net/public/icons/link_bundle.png","bundleLink":"https://ahead-nutrition.myshopify.com/apps/gbb/easybundle/1","bundleUpsellConfig":{"isEnabled":false,"showOnAllBundleProducts":false,"selectedProducts":[{"availablePublicationCount":10,"createdAt":"2022-06-22T08:58:10Z","descriptionHtml":"<meta charset=\"utf-8\"><strong data-mce-fragment=\"1\"><meta charset=\"utf-8\">Zuckerarme Riegel, die die Geschmackswelt revolutionieren</strong><br data-mce-fragment=\"1\"><br data-mce-fragment=\"1\"><strong data-mce-fragment=\"1\">✅ &lt;1,7g Zucker pro Riegel</strong><br data-mce-fragment=\"1\"><strong data-mce-fragment=\"1\">✅ &lt;180 kcal</strong><br data-mce-fragment=\"1\"><strong data-mce-fragment=\"1\">✅ Wertvolle Ballaststoffe</strong><br data-mce-fragment=\"1\"><strong data-mce-fragment=\"1\">✅ Gesunde Fette</strong>","handle":"ahead-riegel-caramel-cacao","hasOnlyDefaultVariant":false,"id":"gid://shopify/Product/7975881605384","images":[{"id":"gid://shopify/ProductImage/44696865472776","originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.03.jpg?v=1688630683"},{"id":"gid://shopify/ProductImage/44696865341704","originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.02.jpg?v=1688630683"},{"id":"gid://shopify/ProductImage/44696865407240","originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.06.jpg?v=1688630683"},{"id":"gid://shopify/ProductImage/44696865374472","originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.05.jpg?v=1688630683"},{"id":"gid://shopify/ProductImage/44696865440008","originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.04.jpg?v=1688630683"}],"options":[{"id":"gid://shopify/ProductOption/10212943560968","name":"Inhalt","position":1,"values":["18 Riegel"]}],"productType":"Low Sugar Chocolate Bar","publishedAt":"2022-06-22T09:02:33Z","tags":["discount","Influencer10","Laktosefrei","Low Sugar","NONSUBCARTFLOW","nosub","recommend:ahead-bar-probierpaket","recommend:ahead-riegel-salted-peanut-caramel-vegan","recommend:crazy-hazel","recommend:crunchies-nougat","sale","Vegetarisch","Weniger Kalorien"],"templateSuffix":"cc","title":"Caramel-Cacao","totalInventory":8634,"totalVariants":1,"tracksInventory":true,"updatedAt":"2024-04-25T08:35:12Z","variants":[{"availableForSale":true,"barcode":"4260562941258","compareAtPrice":null,"createdAt":"2022-06-22T08:58:11Z","displayName":"Caramel-Cacao - 18 Riegel","fulfillmentService":{"id":"gid://shopify/FulfillmentService/manual","inventoryManagement":false,"productBased":true,"serviceName":"Manual","type":"MANUAL"},"id":"gid://shopify/ProductVariant/43568034578696","inventoryItem":{"__typename":"InventoryItem","id":"gid://shopify/InventoryItem/45395102990600"},"inventoryManagement":"SHOPIFY","inventoryPolicy":"DENY","inventoryQuantity":8634,"position":1,"price":"28.90","product":{"__typename":"Product","id":"gid://shopify/Product/7975881605384"},"requiresShipping":true,"selectedOptions":[{"__typename":"SelectedOption","value":"18 Riegel"}],"sku":"010101-1","taxable":true,"title":"18 Riegel","updatedAt":"2024-04-25T08:33:41Z","weight":678,"weightUnit":"GRAMS"}],"vendor":"ahead® | The Human Performance Company","status":"ACTIVE"}],"showOnSpecificProductPages":[{"productId":"7975881605384","graphqlId":"gid://shopify/Product/7975881605384","handle":"ahead-riegel-caramel-cacao","variants":[],"hasOnlyDefaultVariant":false,"images":[{"originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.03.jpg?v=1688630683"},{"originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.02.jpg?v=1688630683"},{"originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.06.jpg?v=1688630683"},{"originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.05.jpg?v=1688630683"},{"originalSrc":"https://cdn.shopify.com/s/files/1/2136/3937/files/B09KM5V858.04.jpg?v=1688630683"}],"title":"Caramel-Cacao"}],"collectionsSelectedData":[],"showOnSpecificCollectionPages":[],"bundleWidgetText":"Bundeln und bis zu 15% sparen!","bundleWidgetRedirectText":"..."},"productsForBundleLink":[],"selectedProductsForBundleLink":[],"useLinkProductAsDefaultProduct":true,"bundleType":"FULLPAGE_BUNDLE","isStepAdded":true},"discountsData":{"_id":"6627a7dc1ca8324641fd0611","bundleId":"1","shopName":"ahead-nutrition.myshopify.com","__v":0,"createdAt":"2024-04-23T12:21:48.244Z","discountMode":"PERCENTAGE","discountTextBody":{"percentageAndFixed":{"rule1":{"text":"Füge ##discountConditionDiff## Artikel hinzu und spare <span style=\"color:red;\"<strong>5%!</strong></span>"},"rule2":{"text":"<span style=\"color:#1CAE4B;\"<strong>Du sparst bereits 5%</strong> 🎉</span> <br> Füge noch ##discountConditionDiff## Artikel hinzu und spare <span style=\"color:red;\"<strong>10%!</strong></span>"},"rule3":{"text":"<span style=\"color:#1CAE4B;\"<strong>Du sparst bereits 10%</strong> 🎉</span> <br>Füge noch ##discountConditionDiff## Artikel hinzu und spare <span style=\"color:red;\"<strong>15%!</strong></span>"},"rule4":{"text":"Du hast den maximalen Rabatt von <span style=\"color:#1CAE4B;\"<strong> 15%</strong></span> freigeschaltet!"},"rule5":{"text":"Du hast den maximalen Rabatt von <span style=\"color:#1CAE4B;\"<strong> 15%</strong></span> freigeschaltet!"}},"fixedBundlePrice":{"rule1":{"text":"Add ##discountConditionDiff## product(s) to get the bundle at ##discountValueUnit####discountValue##"},"rule2":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule3":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule4":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule5":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"}}},"isDeleted":false,"isDiscountEnabled":true,"isDiscountProgressBarEnabled":false,"isKiteIntegrationEnabled":false,"isShowDiscountsEnabled":true,"rules":[{"discountValue":"5","value":"3","type":"quantity","discountCodePrefix":"BB5"},{"discountValue":"10","value":"4","type":"quantity","discountCodePrefix":"BB10"},{"discountValue":"15","value":"5","type":"quantity","discountCodePrefix":"BB15"},{"discountValue":"15","value":"50","type":"quantity","discountCodePrefix":"BB15"}],"type":"amount","updateMultiLanguage":false,"updatedAt":"2024-05-28T12:12:49.329Z","multiLangData":{"en":{"discountTextBody":{"percentageAndFixed":{"rule1":{"text":"Add ##discountConditionDiff####discountUnit## to get ##discountValue####discountValueUnit## discount!"},"rule2":{"text":"Congrats🎉 Add ##discountConditionDiff####discountUnit## more to get ##discountValue####discountValueUnit## discount!"},"rule3":{"text":"Congrats🎉 Add ##discountConditionDiff####discountUnit## more to get ##discountValue####discountValueUnit## discount!"},"rule4":{"text":"Congrats🎉 Add ##discountConditionDiff####discountUnit## more to get ##discountValue####discountValueUnit## discount!"},"rule5":{"text":" Congrats🎉 Add ##discountConditionDiff####discountUnit## more to get ##discountValue####discountValueUnit## discount!"}},"fixedBundlePrice":{"rule1":{"text":"Add ##discountConditionDiff## product(s) to get the bundle at ##discountValueUnit####discountValue##"},"rule2":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule3":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule4":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"},"rule5":{"text":"Congrats🎉 Add ##discountConditionDiff## product(s) more to get the bundle at ##discountValueUnit####discountValue##"}}}}}}}</script><script>// comment at the first line of the file dec2024
let DEFAULT_addToCartBtnSelectorsApp4 = 'input[name="add"], button[name="add"], form[action*="/cart/add"] input[type="submit"], form[action*="/cart/add"] button[type="submit"], form[action*="/cart/add"] button:not([type="button"]), form[action*="/cart/add"] .gbb__add-to-cart';
let DEFAULT_checkoutBtnSelectorsApp4 = 'button[name="checkout"], input[name="checkout"], form[action*="/cart"] a[href="/checkout"], a[href="/checkout"], form[action="/cart"] input[type="submit"][name="checkout"], form[action="/cart"] button[type="submit"][name="checkout"]';
let DEFAULT_quantityBtnSelectorsApp4 = '.ajaxcart__qty,quantity-input .quantity,.product-form__input, .product-form__quantity ';
let DEFAULT_sideCartSelectorsApp4 = '.cart-notification,cart-notification,.cart-notification-wrapper,#cart-notification, #CartDrawer, .drawer, .drawer-cover, .Drawer';
let DEFAULT_buyNowBtnApp4 = '.shopify-payment-button__button, .shopify-payment-button__button--unbranded';
let DEFAULT_cartFormApp4 = 'form[action="/cart"], form[action="/cart/"], form[action="cart"]';

let DEFAULT_BUNDLE_IMAGE = "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/default_bundle_image.jpg"

let DEFAULT_scheduleDeliveryPickerSelector = ".gbbSummaryPageDeliverOrderDetailsDiv"
let DEFAULT_EMPTY_REVIEWPAGE_TEXT = "It's Lonely in here 😔"
let DEFAULT_EMPTY_REVIEWPAGE_SUBTEXT = "Tap the button to add products"
let DEFAULT_EMPTY_REVIEWPAGE_BANNER = "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/Empty+Gift.png"
let DEFAULT_EMPTY_REVIEWPAGE_BUTTONTEXT = "Go back to the bundle flow"

// const DEFAULT_BODY_OVERFLOW_VALUE = "";
let DEFAULT_BODY_OVERFLOW_VALUE = "";

let CONSTANT_IMAGES_DROPDOWN_BUTTON = "https://d3ks0ngva6go34.cloudfront.net/public/Keyboard+arrow+up.svg";
let CONSTANT_IMAGES_CALENDAR_ICON = "https://d3ks0ngva6go34.cloudfront.net/public/calendar.svg";
let CONSTATNT_IMAGES_FILTER_ICON = "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/filters_icon.png";


const ADDPRODUCT_PAGES_LIST = ["addProductsPage1", "addProductsPage2", "addProductsPage3", "addProductsPage4", "addProductsPage5", "addProductsPage6", "addProductsPage7", "addProductsPage8", "addProductsPage9", "addProductsPage10", "addProductsPage11", "addProductsPage12"]
let CONSTANT_SVG_CIRCLE = `<svg xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"><circle style="stroke:#006600; fill:white" cx="20" cy="20" r="12"></circle></svg>`
const STEP_SVG = ` <svg width="32" height="36" viewBox="0 0 32 36" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M17.5934 34.5608C16.8036 35.1751 15.6978 35.1751 14.9081 34.5608L1.48121 24.1177C0.519403 23.3697 0.528664 21.9129 1.4999 21.1772C2.16804 20.671 3.09271 20.6762 3.75509 21.1899L16.2507 30.8804L28.7464 21.1899C29.4087 20.6762 30.3334 20.671 31.0015 21.1772C31.9728 21.913 31.982 23.3697 31.0202 24.1177L17.5934 34.5608ZM16.2507 26.2483L1.79469 15.0047C0.668966 14.1292 0.668969 12.4277 1.79469 11.5522L14.9081 1.35288C15.6978 0.738648 16.8037 0.738649 17.5934 1.35289L30.7068 11.5522C31.8325 12.4277 31.8325 14.1292 30.7068 15.0047L16.2507 26.2483ZM16.2507 21.5236L26.9045 13.2785L16.2507 5.03333L5.59691 13.2785L16.2507 21.5236Z" fill="#232323" />
    </svg>`
const CONSTANT_ARROW_SVG = `<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
        width="24px" height="24px" viewBox="0 0 512.000000 512.000000"
        preserveAspectRatio="xMidYMid meet">
       <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
       fill="#000000" stroke="none">
       <path d="M2265 5109 c-592 -71 -1125 -334 -1540 -760 -375 -385 -598 -825
       -696 -1374 -21 -116 -24 -161 -24 -415 0 -254 3 -299 24 -415 101 -569 343
       -1031 742 -1420 385 -375 825 -598 1374 -696 116 -21 161 -24 415 -24 254 0
       299 3 415 24 276 49 483 116 720 231 246 121 448 264 654 465 399 389 641 851
       742 1420 21 116 24 161 24 415 0 254 -3 299 -24 415 -49 276 -116 483 -231
       720 -121 246 -264 448 -465 654 -389 399 -852 641 -1420 742 -97 17 -169 22
       -375 25 -140 1 -291 -2 -335 -7z m651 -1430 c36 -13 86 -62 105 -104 24 -51
       24 -109 0 -160 -11 -26 -158 -184 -415 -449 l-397 -410 109 -110 c515 -525
       687 -705 703 -741 51 -111 -16 -244 -138 -275 -36 -9 -55 -8 -98 5 -52 15 -72
       33 -535 507 -265 270 -490 509 -501 529 -22 45 -25 116 -5 162 13 33 942 999
       990 1031 49 32 120 38 182 15z"/>
       </g>
       </svg>`;

const ARROW_DOWN_SVG = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 128 128" fill="none">
<path fill-rule="evenodd" clip-rule="evenodd" d="M35.006 49.4059C36.8805 47.5314 39.9197 47.5314 41.7942 49.4059L64.0001 71.6118L86.206 49.4059C88.0805 47.5314 91.1197 47.5314 92.9942 49.4059C94.8687 51.2804 94.8687 54.3196 92.9942 56.1941L67.3942 81.7941C65.5197 83.6686 62.4805 83.6686 60.606 81.7941L35.006 56.1941C33.1315 54.3196 33.1315 51.2804 35.006 49.4059Z" fill="#4A4A4A"/>
</svg>`;

const CART_SVG = `<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M3 4.50059C3 4.00353 3.40294 3.60059 3.9 3.60059H5.83438C6.88071 3.60059 7.76448 4.37015 7.91285 5.40059H19.5C19.7507 5.40059 19.99 5.50514 20.1604 5.68908C20.3307 5.87302 20.4166 6.11966 20.3974 6.36961L19.9678 11.9537C19.8356 13.673 18.4019 15.0006 16.6775 15.0006H9.05636L9.16772 15.936C9.18568 16.087 9.31365 16.2006 9.46562 16.2006H17.1C17.5971 16.2006 18 16.6035 18 17.1006C18 17.5976 17.5971 18.0006 17.1 18.0006H9.46562C8.40184 18.0006 7.50609 17.2051 7.38034 16.1488L6.13228 5.66512C6.11432 5.51422 5.98635 5.40059 5.83438 5.40059H3.9C3.40294 5.40059 3 4.99764 3 4.50059ZM8.84207 13.2006H16.6775C17.4613 13.2006 18.113 12.5971 18.1731 11.8156L18.5281 7.20059H8.12778L8.84207 13.2006ZM12 20.4006C12 21.0633 11.4627 21.6006 10.8 21.6006C10.1373 21.6006 9.6 21.0633 9.6 20.4006C9.6 19.7378 10.1373 19.2006 10.8 19.2006C11.4627 19.2006 12 19.7378 12 20.4006ZM18 20.4006C18 21.0633 17.4627 21.6006 16.8 21.6006C16.1373 21.6006 15.6 21.0633 15.6 20.4006C15.6 19.7378 16.1373 19.2006 16.8 19.2006C17.4627 19.2006 18 19.7378 18 20.4006Z" fill="${window.tmpCartSettings2?.pageCustomizationData?.cartFooter?.cartFooterNextButtonTextColor || "#ffffff"}"/>
</svg>`

const CONSTANT_CLOSE_ICON_SVG = `<svg fill="${window.tmpCartSettings2?.pageCustomizationData?.generalSettings?.icon?.iconBgColor || "black"}" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 26 26" width="16px" height="16px"
style="background: ${window.tmpCartSettings2?.pageCustomizationData?.generalSettings?.icon?.iconTextColor || "white"}; border-radius: 50%; "><path d="M 13 0.1875 C 5.925781 0.1875 0.1875 5.925781 0.1875 13 C 0.1875 20.074219 5.925781 25.8125 13 25.8125 C 20.074219 25.8125 25.8125 20.074219 25.8125 13 C 25.8125 5.925781 20.074219 0.1875 13 0.1875 Z M 18.78125 17.394531 L 17.390625 18.78125 C 17.136719 19.035156 16.722656 19.035156 16.46875 18.78125 L 13 15.3125 L 9.53125 18.78125 C 9.277344 19.035156 8.863281 19.035156 8.609375 18.777344 L 7.21875 17.394531 C 6.96875 17.136719 6.96875 16.726563 7.21875 16.46875 L 10.6875 13 L 7.222656 9.535156 C 6.96875 9.277344 6.96875 8.863281 7.222656 8.609375 L 8.609375 7.222656 C 8.863281 6.964844 9.28125 6.964844 9.535156 7.222656 L 13 10.6875 L 16.46875 7.222656 C 16.722656 6.964844 17.140625 6.964844 17.390625 7.222656 L 18.78125 8.605469 C 19.035156 8.863281 19.035156 9.277344 18.78125 9.535156 L 15.3125 13 L 18.78125 16.46875 C 19.03125 16.726563 19.03125 17.136719 18.78125 17.394531 Z"/></svg>`

const SEARCH_ICON_SVG = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M9.5 3C11.2239 3 12.8772 3.68482 14.0962 4.90381C15.3152 6.12279 16 7.77609 16 9.5C16 11.11 15.41 12.59 14.44 13.73L14.71 14H15.5L20.5 19L19 20.5L14 15.5V14.71L13.73 14.44C12.5504 15.4465 11.0506 15.9996 9.5 16C7.77609 16 6.12279 15.3152 4.90381 14.0962C3.68482 12.8772 3 11.2239 3 9.5C3 7.77609 3.68482 6.12279 4.90381 4.90381C6.12279 3.68482 7.77609 3 9.5 3ZM9.5 5C7 5 5 7 5 9.5C5 12 7 14 9.5 14C12 14 14 12 14 9.5C14 7 12 5 9.5 5Z" fill="black"/>`

const PLAIN_CHEVRON_UP_SVG = `<svg width="25" height="25" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M6.23966 11.7996C6.5432 12.0814 7.01775 12.0639 7.2996 11.7603L10 8.85221L12.7004 11.7603C12.9823 12.0639 13.4568 12.0814 13.7603 11.7996C14.0639 11.5177 14.0815 11.0432 13.7996 10.7397L10.5496 7.23966C10.4077 7.08683 10.2086 7 10 7C9.79145 7 9.59232 7.08683 9.45041 7.23966L6.20041 10.7397C5.91856 11.0432 5.93613 11.5177 6.23966 11.7996Z" fill="#4A4A4A"/>
</svg>`

var gbbUtils = {
    f: {}
}
window.gbbUtils = gbbUtils;
//console.log


/*
*fn(param1, param2) =>
*param1 is url of script that we suppose to load
*param2 is function that should be called after script is loaded
*/


gbbUtils.f.loadScript = function (a, b) {
    var c = document.createElement("script");
    c.type = "text/javascript";
    c.src = a;
    document.getElementsByTagName("head")[0].appendChild(c)
    c.onload = function () { b() };
};

/*
* we changed loadScript function - if else block for onload is removed as it was not making sense
*fn(param1) =>
*param1 - represents function that should be executed once jquery is loaded
*https://www.w3schools.com/jquery/jquery_noconflict.asp
*/

gbbUtils.f.loadJquery = function (b) {
    gbb.utility.debugConsole("Load JQuery");
    let flag = false;
    if ("undefined" === typeof jQuery || 3.1 > parseFloat(jQuery.fn.jquery)) {
        flag = true;
    }
    if ("undefined" != typeof jQuery && jQuery.post == undefined) {
        flag = true;
    }

    if (flag) {
        gbbUtils.f.loadScript("https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js", function () {
            gbbJquery = jQuery.noConflict(!0);
            b(gbbJquery)
        })
    } else {
        b(jQuery);
    }
};


var gbb = {
    debug: [],
    version: 1.2,
    state: {
        cachedProductData: new Map(),
        cachedProductDataGraphql: new Map(),
        bundleId: "",
        bundleName: "",
        activeBoxId: "",
        submitted: "",
        product_added: "",
        page_type: "",
        insertWrapperOnPage: [],
        cartData: undefined,
        isOverWriteBuyNowBtnTriggered: false,
        timer: undefined,
        freeGiftcardPopupModalTriggered: false,
        atleastOneProduct: {},
        pageHistory: [],
        greetingCardActiveImageSrc: "",
        navigationItems: [],
        currentPageId: "",
        giftBoxCartData: undefined,
        currentFilteredProducts: [], //products state of filteredProducts
        currentChooseGiftBoxProductsState: [],
        scrollPoisitionAfterPageChange: 70,
        gbbUrl: "gbb",
        addProductsFilters: {
            isFiltersActive: false,
            activatedFilters: [],
            allFilters: [],
            priceFilterActive: false,
            minPriceValue: "",
            maxPriceValue: ""
        },
        addProductsSortBy: {
            isSortByEnabled: false,
            sortByCategories: [],
            sortByValue: ""
        },
        setInfiniteScrollTrackerForProducts: true,
        navItemsViewPerPage: 5,
        // productsPerBatch : 300, //used in prefetch
        currentFlow: "",
        variantCustomProperties: {},
        storeCurrencySymbol: undefined,
        currentModalProductData: {},
        CONSTANT_DEBUG_FLAG: undefined,
        languageMode: "",
        giftMessageProductInActiveSession: [],
    },
    constants: {
        themesIds: {
            DAWN_THEME: 887,
            VENTURE_THEME: 775,
            EXPRESS_THEME: 885,
            CRAVE_THEME: 1363,
            SENSE_THEME: 1356,
            CRAFT_THEME: 1368,
        }
    },
    importExternalScript: async function (scriptName) {
        let scriptUrl = "";
        switch (scriptName) {
            case "date-flatpickr":
                scriptUrl = "https://cdn.jsdelivr.net/npm/flatpickr@4.6.13/dist/flatpickr.min.js"
                break;
            case "selfHosted-date-flatpickr":
                scriptUrl = "https://d3ks0ngva6go34.cloudfront.net/storefront/S3-flatpickr.min.js";
                break;
        }
        await new Promise(function (resolve, reject) {
            try {
                // document.body.appendChild(document.createElement('script')).src = url;
                const script = document.createElement('script');
                script.src = scriptUrl;
                console.time(`${scriptName}-onLoad`)
                // script.async = true;
                //attach a link tag for css
                // var link = document.createElement('link');
                // link.rel = 'stylesheet';
                // link.href = 'https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css';
                // document.head.appendChild(link);
                //delay the resolve by 1 second
                //resolve after it has been loaded
                script.onload = function () {
                    console.timeEnd(`${scriptName}-onLoad`)
                    gbb.utility.debugConsole(scriptName, "loaded");
                    gbb.utility.debugConsole("FlatPickrObj", flatpickr);
                    resolve();
                }
                document.body.appendChild(script);
            } catch (e) {
                gbb.utility.triggerSlackNotification(e);
                gbb.utility.debugConsole(scriptName, "error in importing", e);
                reject();
            }
        });
    },
    settings: {}, //object from function
    selectors: {},
    cartInterval: "",
    productinterval: "",
    f: {
        bootstrap: function (settings) {
            gbb.utility.debugConsole("bootstap?");
            gbb.f.initThemeCSS();
            gbb.f.globalListener(settings)
        },
        initThemeCSS: function () {
            // gbb.utility.debugConsole("initThemeCSS?", gbb.selectors.addToCart);
            let addToCartBtnEle = gbb.$(document).find(gbb.selectors.addToCart)
            let checkoutBtnEle = gbb.$(document).find(gbb.selectors.checkoutBtn)

            let buttonToOverRide = gbb.$(addToCartBtnEle).length > 0 ? addToCartBtnEle : checkoutBtnEle;

            if (gbb.settings.app.themeFontFamily == "" && gbb.$("body").length > 0) {
                gbb.settings.app.themeFontFamily = gbb.$("body").css("font-family");
                gbb.$(".gbbPageBody").css("font-family", gbb.settings.app.themeFontFamily);
            }

            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbPageBody").css("font-family", gbb.settings.app.themeFontFamily);
            }
            //find the font color of the theme
            if (gbb.settings.app.themeFontColor == "" && gbb.$("p").length > 0) {
                gbb.settings.app.themeFontColor = gbb.$("p").css("color");
            }
            //theme background color
            if (gbb.settings.app.themeBackgroundColor == "" && gbb.$("body").length > 0) {
                gbb.settings.app.themeBackgroundColor = gbb.$("body").css("background-color");
            }
            if (gbb.settings.app.themeLabelFontColor == "" && gbb.$("label").length > 0) {
                gbb.settings.app.themeLabelFontColor = gbb.$("label").css("color");
            }
            // themeLabelFontFamily
            if (gbb.settings.app.themeLabelFontFamily == "" && gbb.$("label").length > 0) {
                gbb.settings.app.themeLabelFontFamily = gbb.$("label").css("font-family");
            }
            if (gbb.settings.app.themeButtonBackgroundColor == "" && gbb.$(buttonToOverRide).length > 0) {
                gbb.settings.app.themeButtonBackgroundColor = gbb.$(buttonToOverRide).css("background-color");
            }
            if (gbb.settings.app.themButtonTextColor == "" && gbb.$(buttonToOverRide).length > 0) {
                gbb.settings.app.themButtonTextColor = gbb.$(buttonToOverRide).css("color");
            }
            if (gbb.settings.app.themeButtonBorderColor == "" && gbb.$(buttonToOverRide).length > 0) {
                gbb.settings.app.themeButtonBorderColor = gbb.$(buttonToOverRide).css("border-color");
            }
            //box shadow
            if (gbb.settings.app.themeButtonBoxShadow == "" && gbb.$(buttonToOverRide).length > 0) {
                gbb.settings.app.themeButtonBoxShadow = gbb.$(buttonToOverRide).css("box-shadow");
            }
            // button font family
            if (gbb.settings.app.themeButtonFontFamily == "" && gbb.$(buttonToOverRide).length > 0) {
                gbb.settings.app.themeButtonFontFamily = gbb.$(buttonToOverRide).css("font-family");
            }
            if (gbb.settings.app.themeHeaderFontFamily == "" && gbb.$("h1").length > 0) {
                gbb.settings.app.themeHeaderFontFamily = gbb.$("h1").css("font-family");
            }
            if (gbb.settings.app.themeHeaderFontColor == "" && gbb.$("h1").length > 0) {
                gbb.settings.app.themeHeaderFontColor = gbb.$("h1").css("color");
            }

        },

        applyFontToProductPopupCard: function () {
            if (gbb.settings.app.themeFontFamily == "" && gbb.$("body").length > 0) {
                gbb.settings.app.themeFontFamily = gbb.$("body").css("font-family");
                gbb.$(".gbbProductVariantModalContainer").css("font-family", gbb.settings.app.themeFontFamily);
            }
            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbProductVariantModalContainer").css("font-family", gbb.settings.app.themeFontFamily);
            }
        },
        applyFontToFiltersSidebar: function () {
            if (gbb.settings.app.themeFontFamily == "" && gbb.$("body").length > 0) {
                gbb.settings.app.themeFontFamily = gbb.$("body").css("font-family");
                gbb.$(".gbbProductsFiltersContainer").css("font-family", gbb.settings.app.themeFontFamily);
            }

            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbProductsFiltersContainer").css("font-family", gbb.settings.app.themeFontFamily);
            }
        },
        applyFontToFooterCartPopup: function () {
            if (gbb.settings.app.themeFontFamily == "" && gbb.$("body").length > 0) {
                gbb.settings.app.themeFontFamily = gbb.$("body").css("font-family");
                gbb.$(".gbbCartProductsContainerModal").css("font-family", gbb.settings.app.themeFontFamily);
            }

            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbCartProductsContainerModal").css("font-family", gbb.settings.app.themeFontFamily);
            }
        },
        applyFontToPreparingBundlePopup: function () {
            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbPreparingBundleContainerModal").css("font-family", gbb.settings.app.themeFontFamily);
            }
        },
        applyFontToUnavailableProductsPopup: function () {
            if (gbb.settings.app.themeFontFamily && gbb.$("body").length > 0) {
                gbb.$(".gbbUnavailableProductsContainerModal").css("font-family", gbb.settings.app.themeFontFamily);
            }
        },
        getSettings: async function () {

            try {
                //promise

                //find the / next to apps from the url

                let url = window.location.href;
                let pathname = window.location.pathname;

                // extract the variable after apps in the url
                try {
                    if (url) {
                        let gbbUrl = url?.split("/apps/")[1];

                        //split it by the next /
                        gbbUrl = gbbUrl.split("/")[0];

                        if (pathname) {
                            //last ele of pathname
                            let eleArr = pathname.split("/");
                            if (eleArr.length > 0) {
                                let lastEle = eleArr[eleArr.length - 1];
                                gbb.state.bundleId = lastEle;
                            }
                        }


                        gbb.state.gbbUrl = gbbUrl;
                    }

                } catch (e) {
                    gbb.utility.debugError(e);
                }

                if (!gbb.state.bundleId) {
                    // lets read it from the query params
                    // from the query params, the key is going to be 
                    // easybundle=1;
                    //and gbbId = gbb or gbb-1 or gbb-2
                    let urlParams = new URLSearchParams(window.location.search);

                    let bundleId = urlParams.get('easybundle');
                    let gbbUrl = urlParams.get('gbbId') || "gbb"

                    if (bundleId && gbbUrl) {
                        gbb.state.bundleId = bundleId;
                        gbb.state.gbbUrl = gbbUrl
                    }

                }


                // gbb.utility.debugConsole("GET setting of giftlab pro fired")
                // return new Promise(function (resolve, reject) {
                //     //  fetch("https://gift101.pagekite.me/api/cartSettings/get?shopName=abhishek-devlopment-store.myshopify.com",{
                // 	// fetch("https://gbb104.pagekite.me/api/cartSettings/get?shopName=staging-testing-107.myshopify.com",{
                // 	// fetch("https://zurakite.pagekite.me/api/cartSettings/get?shopName=rafaths-dev-store.myshopify.com",

                //     // fetch(`apps/${gbbUrl}/getGlobalData`,{


                // })
                if (window.tmpCartSettings2) {
                    return window.tmpCartSettings2 //TBD
                } else {
                    gbb.utility.debugConsole("tmpCartSettings2 not found");
                    let promiseData = await new Promise((resolve, reject) => {

                        fetch(`/apps/${gbb.state.gbbUrl}/getGlobalData?bundleId=${gbb.state.bundleId}`, {
                            method: 'GET',
                        })
                            .then(response => response.json())
                            .then(success => {
                                if (success.responseCode === 200) {
                                    gbb.utility.debugConsole("success-data:", success.data);
                                    resolve(success.data);
                                } else {
                                    reject(new Error("Unexpected response code."));
                                }
                            })
                            .catch(error => {
                                gbb.utility.debugError(error);
                                reject(error);
                            });
                    });
                    return promiseData;
                }
            } catch (e) {
                gbb.utility.debugError(e);
            }


        },
        pageCustomizationInit: function (tmpCartSettings) {
            try {
                let pageCustomizationData = {
                    banners: {
                        landingPageImageSrc: tmpCartSettings.pageCustomizationData.banners.landingPageImageSrc || "https://d3ks0ngva6go34.cloudfront.net/public/banners/landing_page_banner.jpg",
                        pageBannerImageSrc: tmpCartSettings.pageCustomizationData.banners.pageBannerImageSrc || "https://d3ks0ngva6go34.cloudfront.net/public/banners/page_banner.png",
                        productReviewImageSrc: tmpCartSettings.pageCustomizationData.banners.productReviewImageSrc || "https://d3ks0ngva6go34.cloudfront.net/public/banners/review-page_banner.jpg",
                    },
                    colors: {
                        "primaryColor": tmpCartSettings.pageCustomizationData.colors.primaryColor,
                        "secondaryColor": tmpCartSettings.pageCustomizationData.colors.secondaryColor,
                        "textColor": tmpCartSettings.pageCustomizationData.colors.textColor,
                        "disabledColor": tmpCartSettings.pageCustomizationData.colors.disabledColor,
                        "productBox": tmpCartSettings.pageCustomizationData.colors.productBox,
                    },
                    primaryFont: tmpCartSettings.pageCustomizationData.primaryFont,
                    landingPage: {
                        landingPageTextColor: tmpCartSettings.pageCustomizationData.landingPage.landingPageTextColor,
                        landingPageButtonBgColor: tmpCartSettings.pageCustomizationData.landingPage.landingPageButtonBgColor,
                        landingPageButtonTextColor: tmpCartSettings.pageCustomizationData.landingPage.landingPageButtonTextColor,
                    },
                    cartFooter: {
                        cartFooterBgColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBgColor,
                        cartFooterButtonsContainerBgColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterButtonsContainerBgColor,
                        cartFooterBorderRadius: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBorderRadius,
                        cartFooterProductImageBorderRadius: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterProductImageBorderRadius,
                        cartFooterButtonsContainerBorderRadius: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterButtonsContainerBorderRadius,
                        cartFooterShowHidePrices: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterShowHidePrices == "Hide" ? "hidden" : "visible",
                        cartFooterTextColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterTextColor,
                        cartFooterStrikethroughPriceColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterDiscountedPriceColor,
                        cartFooterFinalPriceFontColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterFinalPriceFontColor,
                        cartFooterFinalPriceFontThickness: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterFinalPriceFontThickness,
                        cartFooterStrikethroughPriceFontThickness: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterStrikethroughPriceFontThickness,
                        cartFooterBackButtonColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBackButtonColor,
                        cartFooterBackButtonTextColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBackButtonTextColor,
                        cartFooterBackButtonBorderColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBackButtonBorderColor,
                        cartFooterBackButtonBorderThickness: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterBackButtonBorderThickness,
                        cartFooterNextButtonTextColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonTextColor,
                        cartFooterNextButtonColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonColor,
                        cartFooterNextButtonBorderColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonBorderColor,
                        cartFooterNextButtonBorderThickness: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonBorderThickness,
                        cartFooterButtonsBorderRadius: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterButtonsBorderRadius,
                        cartFooterButtonsPadding: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterButtonsPadding,
                        cartFooterDiscountTextColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterDiscountTextColor,
                        cartFooterDiscountProgressBarEmptyColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterDiscountProgressBarEmptyColor,
                        cartFooterDiscountProgressBarFilledColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterDiscountProgressBarFilledColor,
                        cartFooterButtonsContainerBgColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterButtonsContainerBgColor,
                        cartFooterDiscountTextVisibility: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterDiscountTextVisibility == "Hide" ? "hidden" : "visible",
                        cartFooterTotalLabelColor: tmpCartSettings?.pageCustomizationData?.cartFooter?.cartFooterTotalLabelColor,
                    },
                    productCard: {
                        productCardBgColor: tmpCartSettings?.pageCustomizationData?.productCard?.productCardBgColor,
                        productCardBorderRadius: tmpCartSettings?.pageCustomizationData?.productCard?.cardBorderRadius,
                        productCardImageBorderRadius: tmpCartSettings?.pageCustomizationData?.productCard?.cardImageBorderRadius,
                        productCardImageFit: tmpCartSettings?.pageCustomizationData?.productCard?.productImageFit,
                        productCardPerRowXtraLargeScreen: tmpCartSettings?.pageCustomizationData?.productCard?.cardsPerRowXL,
                        productCardPerRowLargeScreen: tmpCartSettings?.pageCustomizationData?.productCard?.cardsPerRowL,
                        productCardTextColor: tmpCartSettings?.pageCustomizationData?.productCard?.productCardTextColor,
                        productCardTitleFontSize: tmpCartSettings?.pageCustomizationData?.productCard?.productTitleFontSize,
                        productCardTitleFontWeight: tmpCartSettings?.pageCustomizationData?.productCard?.productTitleFontWeight,
                        productCardFinalPriceVisibility: tmpCartSettings?.pageCustomizationData?.productCard?.productPriceVisibility == "Hide" ? "none" : "block",
                        productCardCompareAtPriceFontColor: tmpCartSettings?.pageCustomizationData?.productCard?.compareAtPriceColor,
                        productCardCompareAtPriceFontSize: tmpCartSettings?.pageCustomizationData?.productCard?.compareAtPriceFontSize,
                        productCardCompareAtPriceFontWeight: tmpCartSettings?.pageCustomizationData?.productCard?.compareAtPriceFontWeight,
                        productCardCompareAtPriceVisibility: tmpCartSettings?.pageCustomizationData?.productCard?.compareAtPriceVisibility == "Hide" ? "none" : "block",
                        productCardFinalPriceFontSize: tmpCartSettings?.pageCustomizationData?.productCard?.finalPriceFontSize,
                        productCardFinalPriceFontColor: tmpCartSettings?.pageCustomizationData?.productCard?.finalPriceFontColor,
                        productCardFinalPriceFontWeight: tmpCartSettings?.pageCustomizationData?.productCard?.finalPriceFontWeight,
                        productCardButtonColor: tmpCartSettings?.pageCustomizationData?.productCard?.productCardButtonColor,
                        productCardButtonTextColor: tmpCartSettings?.pageCustomizationData?.productCard?.productCardButtonTextColor,
                        productCardButtonBorderRadius: tmpCartSettings?.pageCustomizationData?.productCard?.buttonBorderRadius,
                        productCardAllowOnlyOneQuantity: !tmpCartSettings?.pageCustomizationData?.productCard?.allowOnlyOneQuantity ? "block" : "none",
                        productCardQuantitySelectorBgColor: tmpCartSettings?.pageCustomizationData?.productCard?.productCardQuantitySelectorBgColor,// btns wrapper color
                        productCardQuantitySelectorBtnsBgColor: tmpCartSettings?.pageCustomizationData?.productCard?.quantitySelectorBgColor, // btns color
                        productCardQuantitySelectorButtonTextColor: tmpCartSettings?.pageCustomizationData?.productCard?.quantitySelectorButtonTextColor,
                        productCardQuantitySelectorTextColor: tmpCartSettings?.pageCustomizationData?.productCard?.quantitySelectorTextColor,
                        productCardQuantitySelectorBorderRadius: tmpCartSettings?.pageCustomizationData?.productCard?.quantitySelectorButtonBorderRadius,
                    },
                    previewPage: {
                        bannerTextColor: tmpCartSettings?.pageCustomizationData?.productCard?.bannerTextColor,
                    },
                    navigationBanner: {
                        navigationBannerTitleColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerTitleColor,
                        navigationBannerTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerTextColor,
                        navigationBannerStepCompletionColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepCompletionColor,
                        navigationBannerStepDoneColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepDoneColor,
                        navigationBannerStepTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepTextColor || "",
                        navigationBannerStepProgressBarFilledColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepProgressBarFilledColor,
                        navigationBannerStepProgressBarEmptyColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepProgressBarEmptyColor,
                        navigationBannerStepTextFontSize: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepFontSize,
                        navigationBannerCheckColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationCheckColor,
                        navigationBannerStepCompletedBorderColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepCompletedBorderColor,
                        navigationBannerStepCompletedBorderWidth: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepCompletedBorderWidth,
                        navigationBannerStepIncompleteBgColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepIncompleteBgColor,
                        navigationBannerStepIncompleteBorderColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepIncompleteBorderColor,
                        navigationBannerStepIncompleteBorderWidth: tmpCartSettings?.pageCustomizationData?.navigationBanner?.navigationBannerStepIncompleteBorderWidth,
                        navigationBannerTabsActiveBgColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsActiveBgColor,
                        navigationBannerTabsActiveTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsActiveTextColor,
                        navigationBannerTabsInactiveBgColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsInactiveBgColor,
                        navigationBannerTabsInactiveTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsInactiveTextColor,
                        navigationBannerTabsBorderColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsBorderColor,
                        navigationBannerTabsCornerRadius: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsCornerRadius
                    },
                    summaryBlock: {
                        summaryBlockBgColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockBgColor,
                        summaryBlockTextColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockTextColor,
                        summaryBlockAddToCartButtonColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonColor,
                        summaryBlockAddToCartButtonTextColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonTextColor,
                        summaryBlockBackButtonColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockBackButtonColor,
                        summaryBlockBackButtonTextColor: tmpCartSettings.pageCustomizationData.summaryBlock.summaryBlockBackButtonTextColor,
                    },
                    categoryBlock: {
                        categoryBgColor: tmpCartSettings.pageCustomizationData?.categoryBlock?.categoryBgColor,
                        tabActiveBgColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsActiveBgColor || tmpCartSettings.pageCustomizationData?.categoryBlock?.tabActiveBgColor,
                        tabActiveTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsActiveTextColor || tmpCartSettings.pageCustomizationData?.categoryBlock?.tabActiveTextColor,
                        tabInactiveBgColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsInactiveBgColor || tmpCartSettings.pageCustomizationData?.categoryBlock?.tabInactiveBgColor,
                        tabInactiveTextColor: tmpCartSettings?.pageCustomizationData?.navigationBanner?.tabsInactiveTextColor || tmpCartSettings.pageCustomizationData?.categoryBlock?.tabInactiveTextColor,
                    },
                    quickSettings: {
                        isQuickSettingsEnabled: true,
                        colors: {
                            primaryColor: tmpCartSettings.pageCustomizationData?.quickSettings?.colors?.primaryColor,
                            buttonBgColor: tmpCartSettings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor,
                            buttonTextColor: tmpCartSettings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor,
                        }
                    },
                    generalSettings: {
                        conditionToast: {
                            conditionToastBgColor: tmpCartSettings.pageCustomizationData?.generalSettings?.conditionToastBgColor || tmpCartSettings.pageCustomizationData?.generalSettings?.conditionToast?.conditionToastBgColor,
                            conditionToastTextColor: tmpCartSettings.pageCustomizationData?.generalSettings?.conditionToastTextColor || tmpCartSettings.pageCustomizationData?.generalSettings?.conditionToast?.conditionToastTextColor,
                        },
                        scrollBar: {
                            scrollBarColor: tmpCartSettings.pageCustomizationData?.generalSettings?.scrollBarColor || tmpCartSettings.pageCustomizationData?.generalSettings?.scrollBar?.scrollBarColor || "black",
                        },
                        icon: {
                            iconTextColor: tmpCartSettings.pageCustomizationData?.generalSettings?.iconTextColor || tmpCartSettings.pageCustomizationData?.generalSettings?.icon?.iconTextColor || false,
                            iconBgColor: tmpCartSettings.pageCustomizationData?.generalSettings?.iconBgColor || tmpCartSettings.pageCustomizationData?.generalSettings?.icon?.iconBgColor || false,
                            iconColor: tmpCartSettings.pageCustomizationData?.generalSettings?.iconColor || tmpCartSettings.pageCustomizationData?.generalSettings?.icon?.iconColor || false
                        },
                        productPage: {
                            productPageTitleColor: tmpCartSettings.pageCustomizationData?.generalSettings?.productPageTitleColor || tmpCartSettings.pageCustomizationData?.generalSettings?.productPage?.productPageTitleColor || ""
                        },
                        bundle: {
                            bundleBgColor: tmpCartSettings.pageCustomizationData?.generalSettings?.bundleBgColor || tmpCartSettings.pageCustomizationData?.generalSettings?.bundle?.bundleBgColor || null,
                            applyNewPageCustomization: tmpCartSettings.pageCustomizationData?.generalSettings?.applyNewPageCustomization || false
                        }

                    },

                }
                return pageCustomizationData
            } catch (error) {
                gbb.utility.debugError("error in pageCustomizationInit", error);
            }
        },
        setSettings: function (tmpCartSettings) {

            tmpCartSettings = gbb.f.modifySettings(tmpCartSettings)

            var cart_settings = {
                pageCustomizationData: gbb.f.pageCustomizationInit(tmpCartSettings),
                giftwrap: {
                    isGiftWrapEnabled: tmpCartSettings.stepsConfigurationData?.personalizationData?.giftwrap?.isGiftWrapEnabled || false,
                    isGiftWrapEnabledOnPage: tmpCartSettings.stepsConfigurationData?.personalizationData?.giftwrap?.isGiftWrapEnabledOnPage || false,
                    productId: tmpCartSettings.stepsConfigurationData.personalizationData?.giftwrap?.giftwrapProduct?.productId || "",
                    productHandle: tmpCartSettings.stepsConfigurationData.personalizationData?.giftwrap?.giftwrapProduct?.handle || "",
                    productVariants: tmpCartSettings.stepsConfigurationData.personalizationData?.giftwrap?.giftwrapProduct?.variants || [],
                    giftWrapShopifyImgUrl: tmpCartSettings.stepsConfigurationData.personalizationData?.giftwrap?.giftwrapProduct?.images[0]?.src,
                },
                greetingCard: {
                    isGreetingCardEnabled: tmpCartSettings.stepsConfigurationData.personalizationData?.greetingCard?.isGreetingCardEnabled || false,
                    greetingCardProducts: tmpCartSettings.stepsConfigurationData.personalizationData?.greetingCard?.products || [],
                    productId: tmpCartSettings.stepsConfigurationData.personalizationData?.greetingCard?.greetingCardProduct?.productId || "",
                    productHandle: tmpCartSettings.stepsConfigurationData.personalizationData?.greetingCard?.greetingCardProduct?.handle || "",
                    productVariants: tmpCartSettings.stepsConfigurationData.personalizationData?.greetingCard?.greetingCardProduct?.variants || {},
                },
                giftMessage: tmpCartSettings.stepsConfigurationData.personalizationData?.giftMessage || {},
                customerUploads: tmpCartSettings.stepsConfigurationData.personalizationData?.customerUploads || {},
                videoMessage: tmpCartSettings.stepsConfigurationData.personalizationData?.giftMessage || {},
                giftAddons: tmpCartSettings.stepsConfigurationData.personalizationData?.giftAddons || {},
                scheduleDelivery: tmpCartSettings.stepsConfigurationData.personalizationData?.scheduleDelivery || {},
                addonProducts:gbb.gbbAddonProducts.f.addonProductsInit(tmpCartSettings),
                // deliveryScheduler: tmpCartSettings.stepsConfigurationData.personalizationData?.deliveryScheduler || {},

                stepsConfigurationData: tmpCartSettings.stepsConfigurationData || {},
                discountsData: tmpCartSettings.discountsData || {},
                //TODO: remove server url from here and also remove http in fetch call
                SERVER_URL: tmpCartSettings?.userData.SERVER_URL || "localhost:3001",
                app: {
                    disableApp: tmpCartSettings.userData.customSettings.disableApp || false,
                    disableSideCart: tmpCartSettings.userData.customSettings.disableSideCart || false,
                    refreshProductPageOnGiftWrap: tmpCartSettings.userData.customSettings.refreshProductPageOnGiftWrap || false,
                    addToCartBtnSelectors: tmpCartSettings.userData.customSettings.addToCartBtnSelectors || DEFAULT_addToCartBtnSelectorsApp4,
                    checkoutBtnSelectors: tmpCartSettings.userData.customSettings.checkoutBtnSelectors || DEFAULT_checkoutBtnSelectorsApp4,
                    quantityBtnSelectors: tmpCartSettings.userData.customSettings.quantityBtnSelectors || DEFAULT_quantityBtnSelectorsApp4,
                    sideCartSelectors: tmpCartSettings.userData.customSettings.sideCartSelectors || DEFAULT_sideCartSelectorsApp4,
                    themeBackgroundColor: tmpCartSettings.userData.customSettings.themeBackgroundColor || "",

                    //themeFontFamily: tmpCartSettings.userData.customSettings.themeFontFamily || "",
                    themeFontFamily: tmpCartSettings.pageCustomizationData.primaryFont || "",
                    themeFontColor: tmpCartSettings.userData.customSettings.themeFontColor || "",

                    themeButtonBackgroundColor: tmpCartSettings.userData.customSettings.themeButtonBackgroundColor || "",
                    themButtonTextColor: tmpCartSettings.userData.customSettings.themButtonTextColor || "",
                    themeButtonBorderColor: tmpCartSettings.userData.customSettings.themeButtonBorderColor || "",
                    themeButtonBoxShadow: tmpCartSettings.userData.customSettings.themeButtonBoxShadow || "",
                    //button font family
                    themeButtonFontFamily: tmpCartSettings.userData.customSettings.themeButtonFontFamily || "",

                    themeHeaderFontFamily: tmpCartSettings.userData.customSettings.themeHeaderFontFamily || "",
                    themeHeaderFontColor: tmpCartSettings.userData.customSettings.themeHeaderFontColor || "",

                    themeLabelFontColor: tmpCartSettings.userData.customSettings.themeLabelFontColor || "",
                    themeLabelFontFamily: tmpCartSettings.userData.customSettings.themeLabelFontFamily || "",

                    buyNowBtn: tmpCartSettings.userData.customSettings.buyNowBtn || DEFAULT_buyNowBtnApp4,
                    cartForm: tmpCartSettings.userData.customSettings.cartForm || DEFAULT_cartFormApp4,
                    addAfterAddTocartBtn: tmpCartSettings.userData.customSettings.addAfterAddTocartBtn || false,
                    addAftercheckoutBtn: tmpCartSettings.userData.customSettings.addAftercheckoutBtn || false,
                    customStyle: tmpCartSettings.userData.customSettings.customStyle || null,

                    scheduleDeliveryPickerSelector: tmpCartSettings.userData.customSettings.scheduleDeliveryPickerSelector || DEFAULT_scheduleDeliveryPickerSelector,

                    redirectUrlForCheckoutBtn: tmpCartSettings.userData?.customSettings?.redirectUrlForCheckoutBtn ? window.location.origin + tmpCartSettings.userData.customSettings.redirectUrlForCheckoutBtn : window.location.origin + "/cart/checkout",
                    redirectToScript: tmpCartSettings.userData?.customSettings?.redirectToScript ? tmpCartSettings.userData.customSettings.redirectToScript : "",
                    redirectToCheckoutEnabled: tmpCartSettings.userData?.customSettings?.redirectToCheckoutEnabled ? tmpCartSettings.userData.customSettings.redirectToCheckoutEnabled : false,
                    redirectToCartEnabled: tmpCartSettings.userData?.customSettings?.redirectToCartEnabled ? tmpCartSettings.userData.customSettings.redirectToCartEnabled : false,

                    loadingBgColor: tmpCartSettings.userData?.customSettings?.loadingBgColor ? tmpCartSettings.userData.customSettings.loadingBgColor : "#ffffff",
                    stackDiscounts: tmpCartSettings.userData?.customSettings?.stackDiscounts ? tmpCartSettings.userData.customSettings.stackDiscounts : false,
                    // isInfiniteScrollEnabled: tmpCartSettings.userData?.customSettings?.isInfiniteScrollEnabled ? tmpCartSettings.userData.customSettings.isInfiniteScrollEnabled : false,
                    isInfiniteScrollEnabled: true,
                    // conditionalLogicFilterOnFirstPageAswell: tmp
                    productHandlesAreTranslated: tmpCartSettings.userData?.customSettings?.productHandlesAreTranslated ? tmpCartSettings.userData.customSettings.productHandlesAreTranslated : false,
                    addGiftMessageToNote: tmpCartSettings.userData?.customSettings?.addGiftMessageToNote ? tmpCartSettings.userData.customSettings.addGiftMessageToNote : false,
                    addBoxQuantityToProperties: tmpCartSettings.userData?.customSettings?.addBoxQuantityToProperties ? tmpCartSettings.userData.customSettings.addBoxQuantityToProperties : false,
                    enableStoreFrontGQLAPI: localStorage?.getItem("enableSF") || tmpCartSettings.userData?.customSettings?.enableStoreFrontGQLAPI || false,
                    dynamicScriptForHTMLContent: tmpCartSettings.userData?.customSettings?.dynamicScriptForHTMLContent || "",
                    integrations: {
                        judgeme: {
                            isEnabled: tmpCartSettings.userData.customSettings?.integrations?.judgeme?.isEnabled || false,
                            public_token: tmpCartSettings.userData.customSettings?.integrations?.judgeme?.public_token || "",
                        }
                    },
                },
                bundleSettings: {
                    ...tmpCartSettings.userData.bundleSettings,
                    metafieldNameSpaceAndKeys: tmpCartSettings.userData.bundleSettings?.metafieldNameSpaceAndKeys || [],
                    conditionalLogicFilterOnFirstPageAswell: tmpCartSettings.userData.bundleSettings?.conditionalLogicFilterOnFirstPageAswell || false,
                    builderPageSeoData: tmpCartSettings.userData.bundleSettings?.builderPageSeoData || [],
                    removeUnUsedVariantImages: tmpCartSettings.userData?.bundleSettings?.removeUnUsedVariantImages ? tmpCartSettings.userData.bundleSettings.removeUnUsedVariantImages : false,
                    isGiftMessageVirtualProduct: tmpCartSettings.userData.bundleSettings?.isGiftMessageVirtualProduct || false,
                    isValidateInventoryEnabled: tmpCartSettings.userData.bundleSettings?.isValidateInventoryEnabled || false,
                    showCategoryNamesInLineItem: tmpCartSettings.userData.bundleSettings?.showCategoryNamesInLineItem || false
                },
                merchantInfo: tmpCartSettings.userData,
                languageData: tmpCartSettings.languageData,
                STOREFRONT_ACCESS_TOKEN: tmpCartSettings.userData.storefrontAccessToken,
                gbbKiteData: tmpCartSettings.gbbKiteData || null
            }



            gbb.settings = cart_settings
            gbb.state.bundleName = gbb.settings.stepsConfigurationData?.bundleName || ""
            // gbb.utility.debugConsole("settings assigned")
            gbb.f.initializeQtyIncrementDecrement()
            gbb.gbbAddProductsPage.state.validateQuantityPerProduct = tmpCartSettings.stepsConfigurationData?.validateQuantityPerProduct ?? {
                isEnabled:false,
                allowedQuantity:Number.MAX_SAFE_INTEGER
            }
        },
        initializeQtyIncrementDecrement: function () {
            try {
                const { stepsConfigurationData, bundleSettings } = gbb.settings || {};
                const state = gbb.gbbAddProductsPage.state;

                if (stepsConfigurationData && stepsConfigurationData.incrementProductQtyBy > 0 && stepsConfigurationData.decrementProductQtyBy > 0) {
                    state.incrementProductQtyBy = stepsConfigurationData.incrementProductQtyBy;
                    state.decrementProductQtyBy = stepsConfigurationData.decrementProductQtyBy;
                } else if (bundleSettings && bundleSettings.incrementProductQtyBy > 0 && bundleSettings.decrementProductQtyBy > 0) {
                    state.incrementProductQtyBy = bundleSettings.incrementProductQtyBy;
                    state.decrementProductQtyBy = bundleSettings.decrementProductQtyBy;
                }
            } catch (error) {
                gbb.utility.debugError("error in initializeQtyIncrementDecrement", error);
            }
        },
        prefetchData: async function () {
            // gbb.utility.debugConsole("prefetchData")
            console.time("prefetchData")
            gbb.settings.shopifyData = {};
            //fetch data from shopify which will use handle to fetch data
            const settings = gbb.settings;
            let greetingCardProductPromise, giftWrapProductPromise, giftMessagePromise, productsDataPromise, productsData1Promise, productsData2Promise, productsData3Promise, productsData4Promise, giftAddonsProductsPromise, multipleCategoriesPromise, defaultProductsDataPromise, addonProductsPromise;
            //greetingCard.greetingCardProduct -> isGreetingCardEnabled
            //fetch data from shopify for greeting card product which will be called only if isGreetingCardEnabled is true
            if (gbb.settings.greetingCard.isGreetingCardEnabled) {
                const products = gbb.settings.greetingCard.greetingCardProducts ? gbb.settings.greetingCard.greetingCardProducts : [];
                const listOfHandles = products.map(product => product.handle);
                let listOfProductIds = products.map(product => product.productId);
                let fetchOptions = { listOfProductIds }

                greetingCardProductPromise = gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, products, fetchOptions);
            }

            if (gbb.settings.giftMessage.messageProduct?.isMessageProductEnabled) {
                giftMessagePromise = gbb.utility.getProductDataV2(settings.giftMessage.messageProduct?.product?.handle || settings.giftMessage?.messageProduct?.product?.productHandle)
            }


            // giftwrap.giftwrapProduct -> isGiftWrapEnabled

            if (gbb.settings.giftwrap.isGiftWrapEnabled) {
                giftWrapProductPromise = gbb.utility.getProductDataV2(settings.giftwrap.giftwrapProduct?.handle || settings.giftwrap.productHandle)
            }

            // giftAddons.addOnProducts[] -> isGiftAddonsEnabled




            if (gbb.settings?.giftAddons?.isGiftAddonsEnabled) {
                const products = gbb.settings.giftAddons.addOnProducts;
                const listOfHandles = products.map(product => product.handle);
                let listOfProductIds = products.map(product => product.productId);
                let fetchOptions = { listOfProductIds }

                giftAddonsProductsPromise = gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, products, fetchOptions);
                //giftAddonsProductsPromise = gbb.utility.getProductsBulk(settings.giftAddons.addOnProducts.map(product => product.handle))
            }

            //insert here
            if (gbb.settings?.stepsConfigurationData?.defaultProductsData?.isDefaultProductsEnabled && gbb.settings?.stepsConfigurationData?.defaultProductsData?.products?.length > 0) {
                const products = gbb.settings?.stepsConfigurationData?.defaultProductsData?.products;
                const listOfHandles = products.map(product => product.handle);
                let listOfProductIds = products.map(product => product.productId);
                let fetchOptions = { listOfProductIds }

                defaultProductsDataPromise = gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, products, fetchOptions);
            }

            let fetchsixtyProductsEachStep = []
            let fetchsixtyProductsEachStepByProductId = [];
            if (gbb.settings.stepsConfigurationData?.productsData1?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData1?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData1?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData1?.uniqueProductsData

                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData1?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)
                }
            }

            if (gbb.settings.stepsConfigurationData?.productsData2?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData2?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData2?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData2?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData2?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData3?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData3?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData3?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData3?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData3?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)
                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData4?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData4?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData4?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData4?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData4?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)
                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData5?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData5?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData5?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData5?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData5?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData6?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData6?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData6?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData6?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData6?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData7?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData7?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData7?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData7?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData7?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData8?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData8?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData8?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData8?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData8?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData9?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData9?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData9?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData9?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData9?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }

            if (gbb.settings.stepsConfigurationData?.productsData10?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData10?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData10?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData10?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData10?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }

            if (gbb.settings.stepsConfigurationData?.productsData11?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData11?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData11?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData11?.uniqueProductsData

                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData11?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }
            if (gbb.settings.stepsConfigurationData?.productsData12?.isProductsEnabled &&
                gbb.settings.stepsConfigurationData?.productsData12?.uniqueProductsData &&
                gbb.settings.stepsConfigurationData?.productsData12?.uniqueProductsData?.length > 0) {
                let uniqueProductsData = gbb.settings.stepsConfigurationData?.productsData12?.uniqueProductsData
                let fetchLimit = 50
                if (gbb.settings.stepsConfigurationData?.productsData12?.pageType == "MULTIPLE_CATEGORY") {
                    fetchLimit = 200
                }
                for (let i = 0; i < Math.min(uniqueProductsData.length, fetchLimit); i += 1) {
                    fetchsixtyProductsEachStep.push(uniqueProductsData[i].handle);
                    fetchsixtyProductsEachStepByProductId.push(uniqueProductsData[i].productId)

                }
            }


            if (gbb.settings.app.enableStoreFrontGQLAPI) {
                // gbb.utility.getcachedProductDataForGraphql(fetchsixtyProductsEachStepByProductId);
            } else {
                gbb.utility.getcachedProductData(fetchsixtyProductsEachStep)
            }


            if (gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.isMultipleCategoriesEnabled && gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.categories) {
                gbb.settings.stepsConfigurationData.multipleCategoriesData.categories = Object.values(gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.categories)

                for (let i = 0; i < gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.categories.length; i++) {
                    const item = gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.categories[i];
                    let products = item.products
                    let tempArr = [];
                    let additionalProducts = [];
                    let resObj = await gbb.utility.getProductsFromCollections(item.collectionsData);
                    if (resObj && resObj.length > 0) {
                        additionalProducts = resObj;
                    }
                    if (additionalProducts && additionalProducts.length > 0) {
                        products.push(...additionalProducts);
                    }
                    products = products.filter((product) => {
                        if (product) {
                            return product;
                        }
                    })
                    let listOfHandles = products.map(product => product.handle)
                    let listOfProductIds = products.map(product => product.productId)
                    let fetchOptions = { listOfProductIds }

                    tempArr.push(gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, products, fetchOptions));

                    let allData = await Promise.all(tempArr)
                    allData = Object.values(allData[0]);

                    gbb.utility.setMapForVariantId(allData);


                    gbb.settings.stepsConfigurationData.multipleCategoriesData.categories[i].dataFromShopify = [
                        ...allData
                    ]
                }
            }

            // addon code changes - Dec '24 
            if (gbb.settings.addonProducts?.isEnabled) {
                let productHandlesArray = []
                let productIdsArray = []
                let products = []
                let tiersToMap = gbb.settings.addonProducts?.tiers || []
                for (let i = 0; i < tiersToMap.length; i++) {
                    let currentTier = tiersToMap[i]
                    let selectedAddonProducts = currentTier.selectedAddonProducts || []
                    selectedAddonProducts.forEach((addonProduct) => {
                        // making this extensive where we are avoiding duplicates
                        if (productHandlesArray.includes(addonProduct.handle)) {
                            //skip -
                            // continue the loop 
                            return
                        }
                        products.push(addonProduct)
                        productHandlesArray.push(addonProduct.handle)
                        productIdsArray.push(addonProduct.productId || addonProduct.id)
                    })
                }
                let fetchOptions = { listOfProductIds: productIdsArray }
                addonProductsPromise = gbb.utility.getProductsBulkForRelevantVariants(productHandlesArray, products, fetchOptions);//remove await 
            }

            let [greetingCardData, giftWrapData, giftMessageData,
                giftAddonsData, multipleCategoriesData, defaultProductsData, addonProductsData]
                =
                await Promise.all([greetingCardProductPromise, giftWrapProductPromise, giftMessagePromise, giftAddonsProductsPromise,
                    multipleCategoriesPromise, defaultProductsDataPromise, addonProductsPromise]);

            //assign data to global variable
            gbb.settings.shopifyData = {
                ...gbb.settings.shopifyData,
                greetingCardData: greetingCardData,
                giftWrapData: giftWrapData,
                giftMessageData: giftMessageData,
                giftAddonsData: giftAddonsData,
                multipleCategoriesData: gbb.settings?.stepsConfigurationData?.multipleCategoriesData,
                defaultProductsData: defaultProductsData,
                addonProductsData: addonProductsData
            }
            if (addonProductsData) {
                gbb.gbbAddonProducts.f.setPrefetchedAddonsData(addonProductsData)
                gbb.gbbAddonProducts.state.productsShopifyData = addonProductsData
                // gbb.utility.setMapForVariantId(addonProductsData);
                gbb.gbbAddonProducts.f.setMapForVariantId_addons(addonProductsData)
            }
            if (greetingCardData) {
                let extraInfo = {
                    shouldVariantTitleBeConvertedToProductTitle: false
                }
                gbb.utility.setMapForVariantId(greetingCardData, extraInfo);
            }

            if (giftWrapData) {
                let giftWrapDataObj = {};
                giftWrapDataObj[giftWrapData.handle] = giftWrapData;
                gbb.utility.setMapForVariantId(giftWrapDataObj);
            }

            if (giftMessageData) {
                //convert the giftMessageData to an object
                //with the key as the handle
                let giftMessageDataObj = {};
                giftMessageDataObj[giftMessageData.handle] = giftMessageData;
                gbb.utility.setMapForVariantId(giftMessageDataObj);
            }

            // if (giftAddonsData) {
            //     gbb.utility.setMapForVariantId(giftAddonsData);
            // }

            if (defaultProductsData) {
                gbb.utility.setMapForVariantId(defaultProductsData);
            }


            console.timeEnd("prefetchData")

        },
        setNavigationItems: function () {
            let navigationItems = [];
            if (gbb.settings?.stepsConfigurationData?.landingPageData?.isLandingPageEnabled) {
                navigationItems.push({
                    "id": "landingPage",
                    "rank": 1,
                    "text": "Landing Page",
                    "isActive": false,
                    "src": "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbLandingPage.init,
                    "isNavBarItem": false
                    // "showFn": glpro.glproGiftWrap.action.show,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                })
            }
            //only push this in router pages
            if (gbb.settings?.stepsConfigurationData?.productsData1?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage1",
                    "rank": 2,
                    "text": gbb.settings?.stepsConfigurationData?.productsData1?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData1?.stepImage ? gbb.settings?.stepsConfigurationData.productsData1?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage1,
                    "showFn": gbb.gbbAddProductsPage.action.showPage1,
                    "prefetchFn": gbb.gbbAddProductsPage.prefetchDataPage1,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }
            if (gbb.settings?.stepsConfigurationData?.productsData2?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage2",
                    "rank": 3,
                    "text": gbb.settings?.stepsConfigurationData?.productsData2?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData2?.stepImage ? gbb.settings?.stepsConfigurationData.productsData2?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage2,
                    "prefetchFn": gbb.gbbAddProductsPage.prefetchDataPage2,
                    "intialFetchFn": gbb.gbbAddProductsPage.intialFetchForPage2,
                    "showFn": gbb.gbbAddProductsPage.action.showPage2,

                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                    // "initFn": glpro.glproGiftWrap.init,
                    // "showFn": glpro.glproGiftWrap.action.show,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                }
                navigationItems.push(navigationItem)
            }
            // if (gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.isMultipleCategoriesEnabled) {
            //     let navigationItem = {
            //         "id": "multipleCategoriesPage",
            //         "rank": 4,
            //         "text": gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.multipleCategoriesStepText || "",
            //         "isActive": false,
            //         "src": gbb.settings.stepsConfigurationData.multipleCategoriesData?.stepImage ? gbb.settings?.stepsConfigurationData?.multipleCategoriesData?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
            //         "isCompleted": false,
            //         "initFn": gbb.gbbMultipleCategoriesPage.init,
            //         "isNavBarItem": true,
            //         "updatePageStatusFn": gbb.gbbMultipleCategoriesPage.updatePageStatus,
            //         // "initFn": glpro.glproGiftWrap.init,
            //         "showFn": gbb.gbbMultipleCategoriesPage.action.showMultipleCategoriesPage,
            //         // "hideFn": glpro.glproGiftWrap.action.hide,
            //     }
            //     navigationItems.push(navigationItem)
            // }
            if (gbb.settings?.stepsConfigurationData?.productsData3?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage3",
                    "rank": 5,
                    "text": gbb.settings?.stepsConfigurationData?.productsData3?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData3?.stepImage ? gbb.settings?.stepsConfigurationData.productsData3?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage3,
                    "prefetchFn": gbb.gbbAddProductsPage.prefetchDataPage3,
                    "intialFetchFn": gbb.gbbAddProductsPage.intialFetchForPage3,
                    "showFn": gbb.gbbAddProductsPage.action.showPage3,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                    // "initFn": glpro.glproGiftWrap.init,
                    // "showFn": glpro.glproGiftWrap.action.show,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                }
                navigationItems.push(navigationItem)
            }
            if (gbb.settings?.stepsConfigurationData?.productsData4?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage4",
                    "rank": 6,
                    "text": gbb.settings?.stepsConfigurationData?.productsData4?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData4?.stepImage ? gbb.settings?.stepsConfigurationData.productsData4?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage4,
                    "showFn": gbb.gbbAddProductsPage.action.showPage4,
                    "prefetchFn": gbb.gbbAddProductsPage.prefetchDataPage4,
                    "intialFetchFn": gbb.gbbAddProductsPage.intialFetchForPage4,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                    // "initFn": glpro.glproGiftWrap.init,
                    // "showFn": glpro.glproGiftWrap.action.show,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData5?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage5",
                    "rank": 7,
                    "text": gbb.settings?.stepsConfigurationData?.productsData5?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData5?.stepImage ? gbb.settings?.stepsConfigurationData.productsData5?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage5,
                    "showFn": gbb.gbbAddProductsPage.action.showPage5,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData6?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage6",
                    "rank": 8,
                    "text": gbb.settings?.stepsConfigurationData?.productsData6?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData6?.stepImage ? gbb.settings?.stepsConfigurationData.productsData6?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage6,
                    "showFn": gbb.gbbAddProductsPage.action.showPage6,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData7?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage7",
                    "rank": 9,
                    "text": gbb.settings?.stepsConfigurationData?.productsData7?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData7?.stepImage ? gbb.settings?.stepsConfigurationData.productsData7?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage7,
                    "showFn": gbb.gbbAddProductsPage.action.showPage7,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData8?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage8",
                    "rank": 10,
                    "text": gbb.settings?.stepsConfigurationData?.productsData8?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData8?.stepImage ? gbb.settings?.stepsConfigurationData.productsData8?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage8,
                    "showFn": gbb.gbbAddProductsPage.action.showPage8,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData9?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage9",
                    "rank": 11,
                    "text": gbb.settings?.stepsConfigurationData?.productsData9?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData9?.stepImage ? gbb.settings?.stepsConfigurationData.productsData9?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage9,
                    "showFn": gbb.gbbAddProductsPage.action.showPage9,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData10?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage10",
                    "rank": 12,
                    "text": gbb.settings?.stepsConfigurationData?.productsData10?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData10?.stepImage ? gbb.settings?.stepsConfigurationData.productsData10?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage10,
                    "showFn": gbb.gbbAddProductsPage.action.showPage10,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.productsData11?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage11",
                    "rank": 13,
                    "text": gbb.settings?.stepsConfigurationData?.productsData11?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData11?.stepImage ? gbb.settings?.stepsConfigurationData.productsData11?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage11,
                    "showFn": gbb.gbbAddProductsPage.action.showPage11,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }
            if (gbb.settings?.stepsConfigurationData?.productsData12?.isProductsEnabled) {
                let navigationItem = {
                    "id": "addProductsPage12",
                    "rank": 14,
                    "text": gbb.settings?.stepsConfigurationData?.productsData12?.productPageStepText || "",
                    "isActive": false,
                    "src": gbb.settings?.stepsConfigurationData.productsData12?.stepImage ? gbb.settings?.stepsConfigurationData.productsData12?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbAddProductsPage.initPage12,
                    "showFn": gbb.gbbAddProductsPage.action.showPage12,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbAddProductsPage.updatePageStatus,
                }
                navigationItems.push(navigationItem)
            }

            if (gbb.settings?.stepsConfigurationData?.personalizationData?.isPersonalizationEnabled) {
                let navigationItem = {
                    "id": "personalizationPage",
                    "rank": 7,
                    "text": gbb.settings?.stepsConfigurationData?.personalizationData?.personalizeStepText,
                    "isActive": false,
                    "src": gbb.settings.stepsConfigurationData.personalizationData?.stepImage ? gbb.settings?.stepsConfigurationData?.personalizationData?.stepImage : "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbPersonalizePage.init,
                    "isNavBarItem": true,
                    "updatePageStatusFn": gbb.gbbPersonalizePage.updatePageStatus,
                    // "initFn": glpro.glproGiftWrap.init,
                    "showFn": gbb.gbbPersonalizePage.action.showPersonalizationPage,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                }
                navigationItems.push(navigationItem)
            }
            if (gbb.settings?.stepsConfigurationData?.summaryPageData?.isSummaryPageEnabled) {
                navigationItems.push({
                    "id": "reviewPage",
                    "rank": 8,
                    "text": "Review Page",
                    "isActive": false,
                    "src": "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/stepsconfV2.jpeg",
                    "isCompleted": false,
                    "initFn": gbb.gbbReviewPage.init,
                    "isNavBarItem": false
                    // "showFn": glpro.glproGiftWrap.action.show,
                    // "hideFn": glpro.glproGiftWrap.action.hide,
                })
            }
            //add more pages to routerPages
            // gbb.utility.debugConsole("navigationItems:", navigationItems);
            return navigationItems;
        },
        getNavItem: function (id) {
            let navigationItems = gbb.state.navigationItems;
            let navigationItem = navigationItems.filter(function (item) {
                return item.id === id;
            })
            return navigationItem[0];
        },
        getNextNavigationItem: function () {

            let navigationItems = gbb.state.navigationItems;
            let currentPageId = gbb.state.currentPageId;

            let currentPageItem = gbb.f.getNavItem(currentPageId);

            // find the index of the current navigation item
            let currentPageIndex = navigationItems.indexOf(currentPageItem);
            // gbb.utility.debugConsole(currentPageIndex);
            // get the next navigation item making sure its not the last one, if its then return null
            if (currentPageIndex === navigationItems.length - 1) {
                return null;
            }
            else {
                return navigationItems[currentPageIndex + 1];
            }
        },
        getPreviousNavigationItem: function () {

            let navigationItems = gbb.state.navigationItems;
            let currentPageId = gbb.state.currentPageId;

            let currentPageItem = gbb.f.getNavItem(currentPageId);

            // find the index of the current navigation item
            let currentPageIndex = navigationItems.indexOf(currentPageItem);
            // gbb.utility.debugConsole(currentPageIndex);
            if (currentPageIndex == 0) {
                return null;
            }
            return navigationItems[currentPageIndex - 1];
        },
        // Assuming stepsConfiguration has the required data
        cacheAllProductsData: async function () {
            try {
                let allProducts = [];
                let productPages = [
                    gbb.settings.stepsConfigurationData?.productsData1,
                    gbb.settings.stepsConfigurationData?.productsData2,
                    gbb.settings.stepsConfigurationData?.productsData3,
                    gbb.settings.stepsConfigurationData?.productsData4,
                    gbb.settings.stepsConfigurationData?.productsData5,
                    gbb.settings.stepsConfigurationData?.productsData6,
                    gbb.settings.stepsConfigurationData?.productsData7,
                    gbb.settings.stepsConfigurationData?.productsData8,
                    gbb.settings.stepsConfigurationData?.productsData9,
                    gbb.settings.stepsConfigurationData?.productsData10,
                    gbb.settings.stepsConfigurationData?.productsData11,
                    gbb.settings.stepsConfigurationData?.productsData12
                ];

                // Loop through all product data pages
                for (let i = 0; i < productPages.length; i++) {
                    const productsData = productPages[i];
                    if (productsData && productsData.isProductsEnabled && productsData.uniqueProductsData) {
                        // Get product handles and IDs
                        let productHandles = productsData.uniqueProductsData.map(product => product.handle);
                        let productIds = productsData.uniqueProductsData.map(product => product.productId);

                        // Fetch data for each product
                        for (let j = 0; j < productHandles.length; j++) {
                            let handle = productHandles[j];
                            let productId = productIds[j];

                            // Check if it's already in the cache
                            if (!gbb.state.cachedProductData.has(productId)) {
                                // Fetch product data using utility functions
                                let productData = await gbb.utility.getProductDataV2(handle);

                                // Cache the product data
                                gbb.state.cachedProductData.set(productId, productData);
                                allProducts.push(productData);
                            }
                        }
                    }
                }

                gbb.utility.debugConsole('All products have been fetched and cached:', gbb.state.cachedProductData);
            } catch (error) {
                console.error('Error while caching products data:', error);
            }
        },

        updateNavigationsItems: function (stepId, isStatusActive, isStepCompleted) {
            gbb.state.navigationItems.find((item) => {
                if (item.id == stepId) {
                    if (isStatusActive && isStatusActive == true) {
                        item.isActive = true;
                    } else {
                        item.isActive = false;
                    }
                    if (isStepCompleted && isStepCompleted == true) {
                        item.isCompleted = true;
                    } else {
                        item.isCompleted = false;
                    }
                }
            })
        },
        markPreviousNavigationItemsAsCompleted: function (currentNavItem) {
            let navigationItems = [...gbb.state.navigationItems];
            let currentPageId = currentNavItem.id;

            //split the navigation items into two arrays, one before the current page and one after

            let currentPageIndex = navigationItems.indexOf(currentNavItem);
            let navigationItemsBeforeCurrentPage = navigationItems.slice(0, currentPageIndex);
            let navigationItemsAfterCurrentPage = navigationItems.slice(currentPageIndex + 1, navigationItems.length);

            //mark all the navigation items before the current page as completed
            navigationItemsBeforeCurrentPage.forEach(function (item) {
                gbb.f.updateNavigationsItems(item.id, false, true);
            })
            //mark all the navigation items after the current page as not completed
            navigationItemsAfterCurrentPage.forEach(function (item) {
                gbb.f.updateNavigationsItems(item.id, false, false);
            })

            gbb.f.updateNavigationsItems(currentPageId, true, false);


        },
        getNavigationItemsToDisplay: function (startFromNavItemId) {
            // let navigationItems =JSON.parse(JSON.stringify(gbb.state.navigationItems));
            // gbb.utility.debugConsole("before: gbb.state.navigationItems.length:", gbb.state.navigationItems.length)
            let navigationItems = [...gbb.state.navigationItems];


            let blackListedNavigationItems = ["landingPage", "reviewPage"];

            navigationItems = navigationItems.filter(function (item) {
                return !blackListedNavigationItems.includes(item.id);
            })

            // startFromNavItemId = "landingPage" when user is on landing page
            // Q: why does getNavigationItemsToDisplay get fired at all when user is on landing page?

            // A: because we also display navigation items on landing page
            // so to solve this, we just set startFromNavItemId to the first navigation item

            if (startFromNavItemId == "landingPage") {
                startFromNavItemId = navigationItems[0].id;
            }
            gbb.state.navigationItemsToRender = navigationItems;

            // if screen is less than 768px, then change gbb.state.navItemsViewPerPage to 4
            if (window.innerWidth < 768) {
                gbb.state.navItemsViewPerPage = 4
            }

            let navItem = gbb.f.getNavItem(startFromNavItemId);

            // find the index of the current navigation item
            let navItemIndex = gbb.state.navigationItemsToRender.indexOf(navItem);

            let startIndex = navItemIndex;
            if (startIndex + gbb.state.navItemsViewPerPage > navigationItems.length) {
                startIndex = navigationItems.length - gbb.state.navItemsViewPerPage;
                if (startIndex < 0) {
                    startIndex = 0;
                }
            }

            let endIndex = Math.min(startIndex + gbb.state.navItemsViewPerPage, navigationItems.length);
            let navigationItemsToDisplay = navigationItems.slice(startIndex, endIndex);


            return navigationItemsToDisplay;

        },
        insertDiscountProgressBar: async function () {

            gbb.state.giftBoxCartData = await gbb.utility.getGiftBoxProductsFromCart()


            //check if gbbDiscountProgressBar is enabled
            if (gbb.settings.discountsData.isDiscountEnabled) {
                //check if element exists
                if (gbb.$('.gbbDiscountComponent').length == 0) {
                    gbb.gbbDiscountComponent.init(gbb.settings)
                }
                //update the discount progress bar relative to the current cartTotal
                gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();
            }
        },
        renderTagsPillsHTML: function (product, noteAttribute, category) {
            try {
                const tagsArray = product.tags;

                // const pillHTML 
                const userObjectForTagsAndPills = gbb.state.tagsPillsData || [];
                let tagsAndPillHTMLContainer = gbb.$("<div>").addClass("gbbTagsAndPillHTMLContainer")
                if (userObjectForTagsAndPills && userObjectForTagsAndPills.length < 1) {
                    return "";
                } else if (userObjectForTagsAndPills && userObjectForTagsAndPills.length > 0) {
                    for (let i = 0; i < userObjectForTagsAndPills.length; i++) {
                        const item = userObjectForTagsAndPills[i];
                        const currentKey = item.tagKey;
                        let tagsAndPillHTML = gbb.$("<div>").addClass("gbbTagsAndPillHTML")
                        const currentValueHtml = item.tagValueHTML;
                        // item.tagText
                        if (tagsArray.includes(currentKey)) {
                            tagsAndPillHTML.html(currentValueHtml);
                            tagsAndPillHTMLContainer.append(tagsAndPillHTML);
                        }
                    }
                }
                return tagsAndPillHTMLContainer;

            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        setSelectors: function () {
            let settings = gbb.settings
            gbb.selectors = {
                addToCart: settings.app.addToCartBtnSelectors,
                checkoutBtn: settings.app.checkoutBtnSelectors,
                sideCartSelectors: settings.app.sideCartSelectors,
                buyNowBtn: settings.app.buyNowBtn,
                cartForm: settings.app.cartForm,
                productPageWrapperV2: '.gbbProductPageWrapperV2',
                cartPageWrapperV2: '.gbbCartPageWrapperV2',
                quantityBtnSelectors: settings.app.quantityBtnSelectors,
                scheduleDeliveryPickerSelector: settings.app.scheduleDeliveryPickerSelector,
            }
        },
        setDefaultThemeStyles: function () {
            try {
                DEFAULT_BODY_OVERFLOW_VALUE = gbb.$('body').css('overflow-y');
                return;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        setCustomStyling: function () {
            let customStyle = gbb.settings.app.customStyle
            if (customStyle) {
                var styleSheet = document.createElement("style")
                styleSheet.innerText = customStyle
                document.body.appendChild(styleSheet)

            }
        },
        getPageType: function () {
            var pageType = "";
            if (window.location.pathname.includes("/cart") && !window.location.pathname.includes("/products")) {
                pageType = "cart";
            } else if (window.location.pathname.includes("/products")) {
                pageType = "product";
            } else if (window.location.pathname.includes("/collections")) {
                pageType = "COLLECTION";
            } else if (window.location.pathname.includes("/")) {
                pageType = "HOME";
            } else if ("undefined" != typeof Shopify && "undefined" != typeof Shopify.Checkout) {
                pageType = "CHECKOUT";
            } else {
                pageType = "PAGE_NOT_FOUND";
            }
            return pageType;
        },
        getProductPageHandle: function () {
            if ("product" === gbb.state.page_type && shopifyLiquidValuesApp4.product.handle) {
                // let pattern = /(?<=\\/products\\/)((?!\\?|\\$).)+/g
                // if(window && window.location && window.location.href){
                //     return window.location.href.match(pattern)[0]
                // }
                return shopifyLiquidValuesApp4.product.handle
            }
            return "undefined"
        },
        applyButtonCSS: function (element) {

            //apply gbb.settings.app.themButtonTextColor themeButtonBackgroundColor themeButtonBorderColor to the button
            if (gbb.settings.app.themButtonTextColor != "") {
                element.css("color", gbb.settings.app.themButtonTextColor);
            }
            if (gbb.settings.app.themeButtonBackgroundColor != "") {
                element.css("background-color", gbb.settings.app.themeButtonBackgroundColor);
            }
            if (gbb.settings.app.themeButtonBorderColor != "") {
                element.css("border", "1px solid")
                element.css("border-color", gbb.settings.app.themeButtonBorderColor);
            }
            // box shadow
            if (gbb.settings.app.themeButtonBoxShadow != "") {
                element.css("box-shadow", gbb.settings.app.themeButtonBoxShadow);
            }
            //themeButtonFontFamily
            if (gbb.settings.app.themeButtonFontFamily != "") {
                element.css("font-family", gbb.settings.app.themeButtonFontFamily);
            }


        },
        resetButtonCSS: function (element) {
            //reset the button css
            element.css("color", "");
            element.css("background-color", "");
            element.css("border", "");
            element.css("border-color", "");
            element.css("box-shadow", "");
        },
        applyHeaderCSS: function (element) {
            //apply gbb.settings.app.themeFontFamily themeFontColor to the header
            if (gbb.settings.app.themeHeaderFontFamily != "") {
                element.css("font-family", gbb.settings.app.themeHeaderFontFamily);
            }
            if (gbb.settings.app.themeHeaderFontColor != "") {
                element.css("color", gbb.settings.app.themeHeaderFontColor);
            }
        },
        applyLabelCSS: function (element) {
            //apply gbb.settings.app.themeLabelFontColor to the label
            if (gbb.settings.app.themeLabelFontColor != "") {
                element.css("color", gbb.settings.app.themeLabelFontColor);
            }
            if (gbb.settings.app.themeLabelFontFamily != "") {
                element.css("font-family", "inherit");
            }
        },
        applyBackgroundColorCss: function (element) {

        },
        applyTextColorCss: function (element) {

        },
        applyPrimaryColorCss: function (element) {
            element.css("background", gbb.settings.pageCustomizationData.colors.primaryColor);
        },
        applySecondaryColorCss: function (element) {
            element.css("background", gbb.settings.pageCustomizationData.colors.secondaryColor);
        },
        applyTextColorCss: function (element) {
            element.css("color", gbb.settings.pageCustomizationData.colors.textColor);
        },
        applyDisabledColorCss: function (element) {
            element.css("color", gbb.settings.pageCustomizationData.colors.disabledColor);
        },
        applyActiveImageStyle: function (element) {
            element.css("border", `2px solid ${gbb.settings?.pageCustomizationData?.productCard.productCardButtonColor}`)
        },
        removeActiveImageStyle: function (element) {
            element.css("border", "none")
        },
        applySelectedVariantStyle: function (element) {
            element.css("background", gbb.settings?.pageCustomizationData?.productCard.productCardButtonColor);
            element.css("color", gbb.settings.pageCustomizationData.productCard.productCardButtonTextColor)
        },
        removeSelectedVariantStyle: function (element) {
            element.css("background", "#f1f2f3")
            element.css("color", "#000000")
        },
        getSelectedVariant: function () {
            if ("product" === gbb.state.page_type) {
                if (ShopifyAnalytics && ShopifyAnalytics.meta && ShopifyAnalytics.meta.selectedVariantId) {
                    return ShopifyAnalytics.meta.selectedVariantId
                }
                if (document.querySelector('[name="id"]') && document.querySelector('[name="id"]').value) {
                    return document.querySelector('[name="id"]').value
                }
                return undefined
            }
        },
        getElements: function (settings) {
            return {
                gbbHTMLWrapperParent: gbb.$(gbb.$.parseHTML('<div class="gbbHTMLWrapper"></div>')),
                gbbHeaderWrapperParent: gbb.$(gbb.$.parseHTML('<div class="gbbHeaderWrapper"></div>')),
                gbbBodyWrapperParent: gbb.$(gbb.$.parseHTML('<div class="gbbBodyWrapper"></div>')),
                //change this for sidebar position
                gbbFooterWrapperParent: gbb.$(gbb.$.parseHTML('<div class="gbbFooterWrapper"></div>')),

                addToCartBtn: gbb.$(document).find(gbb.selectors.addToCart),
                addToCartButtonCloned: undefined,
                checkoutBtn: gbb.$(document).find(gbb.selectors.checkoutBtn),
                cartForm: gbb.$(document).find(gbb.selectors.cartForm),
                productPageWrapperV2: gbb.$(gbb.$.parseHTML('<div class="gbbPageWrapper gbbProductPageWrapperV2"> <div class="gbbGiftOptionsPageEleWrapper"></div>  <div class="gbbLandingPageWrapper"></div><div class="gwmGiftMessageWrapper"></div> </div>')),
                cartPageWrapperV2: gbb.$(gbb.$.parseHTML('<div class="gbbPageWrapper gbbCartPageWrapperV2"> <div class="gbbCartGiftOptionsPageEleWrapper"></div><div class="gwmCartGiftMsgAndWrapWrapper"></div><div class="gwmCartGiftMessageWrapper"></div></div>')),
                buyNowBtn: gbb.$(document).find(gbb.selectors.buyNowBtn)
            }
        },
        renderNavigationHTML: function (parentHTML, noteAttribute, navigationItems) {
            let navigationHTML = gbb.$("<div>").addClass("gbbNavigationItemsContainer");


            let navigationArrowsContainer = gbb.$("<div>").addClass("gbbNavigationArrowsContainer");
            // let navigationItems = gbb.gbbModal.setNavigationItems();
            // let navigationItems = gbb.state.navigationItems;

            // navigationItems = gbb.f.getNextFiveNavigationItems(navigationItems);


            let stepsCount = 0;
            navigationItems = navigationItems.filter((element) => {
                if (element.isNavBarItem && element.isNavBarItem == true) {
                    stepsCount++;
                    return element;
                }
            })

            let navigationItemHTML = gbb.$("<div>").addClass("gbbNavigationItem");
            //run a for loop with each navigation item with the following properties text, onclick function, isActive

            if (stepsCount == 1) {
                return;
            } else {
                if (parentHTML && stepsCount == 2) {
                    if (noteAttribute == "landingPage") {
                        parentHTML.css("margin", "0% 15%");
                    } else {
                        parentHTML.css("margin", "0% 0%");
                    }

                    if (window.innerWidth > 600) {
                        if (noteAttribute != "landingPage") {
                            parentHTML.css("margin", "0% 0%");
                        }

                    }
                }
                for (let i = 0; i < navigationItems.length; i++) {
                    let navigationItemContainer = navigationItemHTML.clone();
                    let _navigationImageContainer = gbb.$("<div>").addClass("gbbNavigationStepImgContainer");

                    let _navigationImage = gbb.$("<img>").addClass("gbbNavigationImage");
                    let item = navigationItems[i];
                    if (stepsCount == 2 && item.id != "personalizationPage") {
                        // _navigationImageContainer.css("justify-self", "start");
                    }

                    if (item.isActive) {
                        let borderWidth = gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepCompletedBorderWidth || "4px";
                        _navigationImageContainer.addClass("gbbNavigationStepImgContainerActive");
                        _navigationImageContainer.css("border", `${borderWidth} solid ${gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepCompletionColor}`);
                    } else {
                        _navigationImageContainer.removeClass("gbbNavigationStepImgContainerActive");
                    }

                    if (item.isCompleted) {
                        let divToBeInserted;
                        // gbb.settings.pageCustomizationData.customImage = "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/icons/Deafult+Image.png"
                        if (gbb.settings.merchantInfo?.customSettings?.navCompletedImage) {
                            let tickMarkImg = gbb.$("<img>").addClass("gbbtickMarkImg").addClass("gbbNavigationImage")
                            tickMarkImg.attr("src", gbb.settings.merchantInfo?.customSettings?.navCompletedImage);
                            divToBeInserted = tickMarkImg;
                        } else {
                            let tickMarkDiv = gbb.$("<div>").addClass("gbbtickMark");

                            tickMarkDiv.append(`<svg width="30" height="30" viewBox="0 0 74 74" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M29.4459 54.1897C29.0348 54.1897 28.6494 54.1249 28.2897 53.9954C27.93 53.868 27.5959 53.6501 27.2876 53.3417L14.0293 40.0834C13.464 39.5181 13.1937 38.7853 13.2183 37.885C13.2451 36.9867 13.5411 36.2549 14.1063 35.6896C14.6716 35.1244 15.3911 34.8417 16.2647 34.8417C17.1383 34.8417 17.8577 35.1244 18.423 35.6896L29.4459 46.7126L55.5772 20.5813C56.1425 20.016 56.8753 19.7334 57.7756 19.7334C58.6739 19.7334 59.4057 20.016 59.9709 20.5813C60.5362 21.1466 60.8188 21.8784 60.8188 22.7766C60.8188 23.677 60.5362 24.4098 59.9709 24.9751L31.6043 53.3417C31.2959 53.6501 30.9619 53.868 30.6022 53.9954C30.2425 54.1249 29.857 54.1897 29.4459 54.1897Z" fill=${gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepDoneColor || "#ffffff"} ></svg>`);
                            let tickMarkPseudo = gbb.$("<div>").addClass("gbbtickMarkPseudo");

                            tickMarkDiv.css("border", "none");

                            tickMarkPseudo.css("background-color", gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepDoneColor || "#ffffff");
                            //tickMarkDiv.addClass("gbbtickMarkPseudo");

                            _navigationImageContainer.css("border", "none");

                            _navigationImageContainer.css("background-color", gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepCompletionColor);
                            divToBeInserted = tickMarkDiv;
                        }
                        _navigationImageContainer.html(divToBeInserted);
                        //item.src = "https://d3ks0ngva6go34.cloudfront.net/public/stepsconfiguration/step_completed.png"
                    } else {
                        _navigationImage.attr("src", item.src);
                        _navigationImageContainer.append(_navigationImage);
                    }
                    let _navigationTitleContainer = gbb.$("<div>").addClass("gbbNavigationTitleContainer");
                    let _navigationTitle = gbb.$("<p>").addClass("gbbNavigationTitle");
                    // _navigationTitle.css("color", gbb.settings.pageCustomizationData?.navigationBanner?.navigationBannerTextColor);

                    navigationItemContainer.attr("id", item.id);

                    //TODO: allowNavigationClick flag to be added in the future
                    if (true || gbb.settings.stepsConfigurationData.allowNavigationClick) {
                        navigationItemContainer.on("click", item.showFn)
                    }

                    _navigationTitle.text(item.text || "");
                    _navigationTitle.css("color", gbb.settings.pageCustomizationData?.navigationBanner?.navigationBannerStepTextColor || "black");


                    _navigationTitleContainer.append(_navigationTitle);
                    navigationItemContainer.append(_navigationImageContainer);
                    navigationItemContainer.append(_navigationTitleContainer);

                    // navigationItemContainer.append()
                    navigationHTML.append(navigationItemContainer);
                }

                // gbb.utility.debugConsole("navigationItems", navigationItems)

                let currentNavigationItemIndex = gbb.state.navigationItemsToRender.findIndex((item) => {
                    return item.id == navigationItems[0].id
                })

                // gbb.utility.debugConsole("currentNavigationItemIndex", currentNavigationItemIndex);

                if (currentNavigationItemIndex > -1) {

                    let previousNavigationItemsButton = gbb.$("<div>").addClass("gbbPreviousNavigationItemsButton")
                    previousNavigationItemsButton.append(CONSTANT_ARROW_SVG);
                    previousNavigationItemsButton.find("g").css("fill", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconTextColor || "black");

                    previousNavigationItemsButton.css("background", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconBgColor || "white");

                    let currentIndex = currentNavigationItemIndex

                    let nextStartIndex = Math.max(currentIndex - gbb.state.navItemsViewPerPage, 0);

                    let previousItem = gbb.state.navigationItemsToRender[nextStartIndex];

                    //now fetch the previous 5 items if they exist
                    previousNavigationItemsButton.on("click", () => {
                        const navItems = gbb.f.getNavigationItemsToDisplay(previousItem.id)
                        // gbb.utility.debugConsole(navItems);
                        gbb.$(".gbbNavigationItemsContainer").replaceWith(gbb.f.renderNavigationHTML("", gbb.state.currentPageId, navItems));
                    })

                    if (gbb.state.navigationItemsToRender.length > gbb.state.navItemsViewPerPage) {
                        navigationHTML.append(previousNavigationItemsButton);
                    }

                }

                if (currentNavigationItemIndex < gbb.state.navigationItemsToRender.length - 1) {
                    let nextNavigationItemsButton = gbb.$("<div>").addClass("gbbNextNavigationItemsButton")
                    nextNavigationItemsButton.append(CONSTANT_ARROW_SVG);
                    nextNavigationItemsButton.find("g").css("fill", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconTextColor || "black");
                    nextNavigationItemsButton.css("background", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconBgColor || "white");

                    let currentIndex = currentNavigationItemIndex

                    let nextIndex = currentIndex + gbb.state.navItemsViewPerPage;

                    if (nextIndex > gbb.state.navigationItemsToRender.length - 1) {
                        nextIndex = gbb.state.navigationItemsToRender.length - 1;
                    }

                    let nextItem = gbb.state.navigationItemsToRender[nextIndex];


                    nextNavigationItemsButton.on("click", () => {
                        const navItems = gbb.f.getNavigationItemsToDisplay(nextItem.id)
                        // gbb.utility.debugConsole("next navItems are",navItems);
                        gbb.$(".gbbNavigationItemsContainer").replaceWith(gbb.f.renderNavigationHTML("", gbb.state.currentPageId, navItems));
                    })

                    if (gbb.state.navigationItemsToRender.length > gbb.state.navItemsViewPerPage) {
                        navigationHTML.append(nextNavigationItemsButton);
                    }

                }


                if (navigationItems.length > 0 && gbb.$('.gbbProductsCardLayoutV2').length > 0) {
                    // render steps progress bar
                    setTimeout(() => {
                        gbb.$('.gbbNavigationItemsContainer').css('::before', {
                            'content': 'none'
                        })
                        let stepsProgressBarHTML = gbb.f.renderStepsProgressBar()

                        //calculate the width for progressbar
                        let navItems = gbb.$('.gbbNavigationItem');

                        let startColumn = navItems.first();
                        let endColumn = navItems.last();

                        let startCenter = startColumn.offset().left + startColumn.width() / 2;
                        let endCenter = endColumn.offset().left + endColumn.width() / 2;

                        let progressBarWidth = endCenter - startCenter;
                        stepsProgressBarHTML.css('width', progressBarWidth);
                        // ================================================ //

                        // calculate the filled progressbar width
                        // 1st step to the last step completed 
                        let activeStepIndex = 0
                        let lastCompletedStepIndex = 0
                        for (let i = 0; i < navigationItems.length; i++) {
                            let step = navigationItems[i]
                            if (step.isNavBarItem && step.isActive) {
                                activeStepIndex = i;
                            }
                            if (step.isNavBarItem && step.isCompleted) {
                                lastCompletedStepIndex = i;
                            }
                        }
                        if (activeStepIndex == 0 && lastCompletedStepIndex != 0) {
                            activeStepIndex = lastCompletedStepIndex;
                        }// when you have more than navItemsViewPerPage navItems 
                        /*
                        for eg : you have 10 steps 
                        so in step navigations we will have pagination // TO BE DONE @mufadal
                         */
                        let lastCompletedStep = navItems.eq(activeStepIndex);
                        let lastCompletedStepCenter = lastCompletedStep.offset().left + lastCompletedStep.width() / 2;

                        let filledProgressBarWidth = lastCompletedStepCenter - startCenter;
                        stepsProgressBarHTML.find('.gbbStepsProgressBarFilled').css('width', filledProgressBarWidth);

                        navigationHTML.append(stepsProgressBarHTML)
                    }, 100)
                }
                // navigationHTML.append(navigationArrowsContainer);
                //navigationHTML.append(navigationImages);
                return navigationHTML;
            }
        },
        renderStepsProgressBar: function (parentHTML, noteAttribute, navigationItems) {
            let stepsProgressBarHTML = gbb.$("<div>").addClass("gbbStepsProgressBarContainer");
            let stepsProgressBar = gbb.$("<div>").addClass("gbbStepsProgressBar");
            stepsProgressBar.css('background', gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepProgressBarEmptyColor || '#eeeeee')
            let stepsProgressBarFilled = gbb.$("<div>").addClass("gbbStepsProgressBarFilled");
            stepsProgressBarFilled.css('background', gbb.settings.pageCustomizationData.navigationBanner.navigationBannerStepProgressBarFilledColor || '#1E1E1E')
            stepsProgressBar.append(stepsProgressBarFilled)
            stepsProgressBarHTML.append(stepsProgressBar);
            return stepsProgressBarHTML;
        },
        addParamsToUrl: function (key, value) {
            // get the navigation item and attach it to the url params
            let urlParams = new URLSearchParams(window.location.search);
            urlParams.set(key, value);
            window.history.replaceState({}, "", `${window.location.pathname}?${urlParams.toString()}`);
        },
        getParamValueFromUrl: function (key) {
            // get the navigation item from the url params
            let urlParams = new URLSearchParams(window.location.search);
            let value = urlParams.get(key);
            // gbb.utility.debugConsole("getParamValueFromUrl:", value);
            return value;
        },


        processAdditionalLogicAsPerUseCase: function () {
            try {
                // check localStorage for extraInfoFromLinkDummyProductPage
                let extraInfoFromLinkDummyProductPage = sessionStorage.getItem("extraInfoFromLinkDummyProductPage");
                let linkProductSetting = gbb.settings.stepsConfigurationData.useLinkProductAsDefaultProduct;

                if (typeof linkProductSetting == "undefined") {
                    //this is a fallback because we have customer who have
                    // this flag on user level but not bundle level
                    linkProductSetting = true;
                }

                if (linkProductSetting == false) {
                    //should we also clear the sessionStorage here?
                    sessionStorage.removeItem("extraInfoFromLinkDummyProductPage");
                    return;
                }
                if (extraInfoFromLinkDummyProductPage) {
                    extraInfoFromLinkDummyProductPage = JSON.parse(extraInfoFromLinkDummyProductPage);
                    if (extraInfoFromLinkDummyProductPage?.addDummyProductToDefaultProducts == true) {
                        // add the dummy product to the default products
                        let dummyProductsData = extraInfoFromLinkDummyProductPage?.dummyProductsData.length > 0 ? extraInfoFromLinkDummyProductPage?.dummyProductsData : null;
                        for (let i = 0; i < dummyProductsData?.length; i++) {
                            let dummyProduct = dummyProductsData[i];
                            if (dummyProduct) {
                                let defaultProductsData = gbb.settings.stepsConfigurationData.defaultProductsData || { products: [], isDefaultProductsEnabled: false };
                                defaultProductsData.products.push(dummyProduct);
                                defaultProductsData.isDefaultProductsEnabled = true;
                                gbb.settings.stepsConfigurationData.defaultProductsData = defaultProductsData;
                            }
                        }
                    }
                }
            } catch (e) {
                gbb.utility.debugConsole("error in processAdditionalLogicAsPerUseCase:", e)
            }
        },

        renderFiltersSearchSortHeaderHTML: function (noteAttribute) {
            let gbbFiltersSearchSortHeader = gbb.$("<div>").addClass("gbbFiltersSearchSortHeader");

            let gbbFiltersMainButtonWrapper = gbb.$("<div>").addClass("gbbFiltersMainButtonWrapper");
            let gbbFiltersCheckboxLabel = gbb.$("<div>").addClass("gbbFiltersCheckboxLabel");

            let activatedFiltersCount = gbb.utility.getActivatedFilters(noteAttribute).length > 0 ? " ( " + gbb.utility.getActivatedFilters(noteAttribute).length + " )" : ""
            gbbFiltersCheckboxLabel.text((gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.filtersLabel) || "Filters1") + activatedFiltersCount);

            let gbbFiltersDropDownButton = gbb.$("<div>").addClass("gbbFiltersDropDownButton");
            // gbbFiltersDropDownButton.css("background", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconBgColor || "white");
            gbbFiltersDropDownButton.css("color", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconTextColor || "#000000");

            // gbbFiltersDropDownButton.append(`<svg version="1.0" xmlns="http://www.w3.org/2000/svg"
            //         width="auto" height="30px" viewBox="0 0 512.000000 512.000000"
            //         preserveAspectRatio="xMidYMid meet">
            //        <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)"
            //        fill=${gbb.settings.pageCustomizationData.quickSettings.colors.primaryColor || "#000000"} stroke="none">
            //        <path d="M893 4335 c-154 -42 -300 -175 -349 -318 l-16 -46 -221 -3 c-213 -3
            //        -223 -4 -254 -26 -67 -48 -67 -156 0 -204 31 -22 41 -23 254 -26 l221 -3 16
            //        -46 c22 -65 68 -133 129 -190 162 -154 382 -186 586 -87 101 49 223 193 251
            //        294 l6 25 1760 5 1759 5 32 23 c67 48 67 156 0 204 l-32 23 -1759 5 -1760 5
            //        -6 25 c-28 101 -150 245 -251 294 -115 56 -253 71 -366 41z m232 -260 c45 -18
            //        92 -62 123 -114 23 -39 27 -57 27 -121 0 -64 -4 -82 -27 -121 -32 -54 -78 -96
            //        -128 -117 -45 -19 -145 -19 -191 1 -92 38 -159 137 -159 237 0 87 39 156 123
            //        220 49 37 161 44 232 15z"/>
            //        <path d="M3976 3059 c-156 -37 -327 -194 -365 -338 l-7 -26 -1760 -5 -1759 -5
            //        -32 -23 c-67 -48 -67 -156 0 -204 l32 -23 1759 -5 1760 -5 6 -25 c28 -101 150
            //        -245 251 -294 155 -75 323 -75 471 0 99 50 209 175 244 277 l16 46 221 3 c213
            //        3 223 4 254 26 67 48 67 156 0 204 -31 22 -41 23 -254 26 l-221 3 -16 46 c-50
            //        145 -196 277 -353 318 -62 16 -186 18 -247 4z m220 -264 c49 -20 105 -76 130
            //        -130 60 -128 -3 -287 -135 -342 -46 -20 -146 -20 -191 -1 -84 35 -148 121
            //        -157 210 -20 194 172 337 353 263z"/>
            //        <path d="M2433 1775 c-144 -39 -267 -139 -328 -266 -19 -41 -35 -79 -35 -86 0
            //        -10 -201 -13 -992 -15 l-993 -3 -32 -23 c-67 -48 -67 -156 0 -204 l32 -23 993
            //        -3 c791 -2 992 -5 992 -15 0 -7 16 -45 35 -86 148 -309 575 -377 818 -128 54
            //        54 127 178 127 214 0 10 201 13 993 15 l992 3 32 23 c67 48 67 156 0 204 l-32
            //        23 -992 3 c-792 2 -993 5 -993 15 0 7 -16 46 -35 86 -101 210 -356 326 -582
            //        266z m247 -273 c179 -89 178 -354 -3 -446 -153 -78 -330 6 -366 174 -28 131
            //        53 260 187 296 60 17 113 10 182 -24z"/>
            //        </g>
            //        </svg>`);
            gbbFiltersDropDownButton.append(`<svg width="20" height="19" viewBox="0 0 20 19" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0 5.58863H15.2086V3.47401H0V5.58863ZM17.9738 0C17.2102 0 16.5912 0.676247 16.5912 1.51044V7.5522C16.5912 8.3864 17.2102 9.06264 17.9738 9.06264C18.7374 9.06264 19.3564 8.3864 19.3564 7.5522V1.51044C19.3564 0.676247 18.7374 0 17.9738 0ZM9.67822 12.5367V10.5731C9.67822 9.73889 9.05921 9.06264 8.29562 9.06264C7.53203 9.06264 6.91301 9.73889 6.91301 10.5731V16.6148C6.91301 17.449 7.53203 18.1253 8.29562 18.1253C9.05921 18.1253 9.67822 17.449 9.67822 16.6148V14.6513H19.3564V12.5367H9.67822ZM0 14.6513H5.53041V12.5367H0V14.6513Z" fill="#1E1E1E"}/>
                    </svg>`)
            gbbFiltersMainButtonWrapper.append(gbbFiltersDropDownButton);
            gbbFiltersMainButtonWrapper.append(gbbFiltersCheckboxLabel);

            gbbFiltersMainButtonWrapper.on("click", () => {
                gbb.utility.toggleFiltersSideBar(noteAttribute);
                if (gbb.utility.getFiltersState(noteAttribute)) {
                    // let gbbFiltersSideBarContainer = gbb.$("<div>").addClass("gbbFiltersSideBarContainer").addClass("gbbFiltersSideBarContainerSlideIn");
                    // gbbFiltersSideBarContainer.append(gbb.f.renderFiltersSideBarHTML(noteAttribute));
                    // gbb.$(".gbbPageBody").append(gbbFiltersSideBarContainer);
                    gbb.$("body").append(gbb.f.renderFiltersSideBarHTML(noteAttribute));
                    gbb.f.applyFontToFiltersSidebar();
                } else {
                    gbb.$("body").find(".gbbFiltersSideBarContainer").remove()
                }
            })

            let gbbSearchBarMainWrapper = gbb.$("<div>").addClass("gbbSearchBarMainWrapper");


            let gbbSortByMainWrapper = gbb.$("<div>").addClass("gbbSortByMainWrapper");
            gbbSortByMainWrapper.text("Sort By");

            let filtersInfo = gbb.utility.getFiltersInfo(noteAttribute)
            if (filtersInfo?.isFiltersEnabled && filtersInfo?.categories?.length > 0) {
                gbbFiltersSearchSortHeader.append(gbbFiltersMainButtonWrapper);
            }
            //gbbFiltersSearchSortHeader.append(gbbSearchBarMainWrapper);
            // gbbFiltersSearchSortHeader.append(gbb.f.renderSortByHTML(noteAttribute));
            if (gbb.gbbAddProductsPage?.state?.filterBySearch?.isSearchEnabled) {
                gbbFiltersSearchSortHeader.append(gbb.f.renderSearchBoxHTML(noteAttribute));
            }
            return gbbFiltersSearchSortHeader;
        },
        renderSortByHTML: function (noteAttribute) {
            const gbbSortByDropDownContainer = gbb.$("<div>").addClass("gbbSortByDropDownContainer");
            const gbbSortByDropDownSelect = gbb.$("<select>").addClass("gbbSortByDropDownSelect");

            let sortBy = gbb.utility.getSortByValues(noteAttribute);
            if (!sortBy.isSortByEnabled) {
                return;
            }
            let sortByCategories = [];
            Object.keys(sortBy?.sortByCategories).forEach((element) => {
                sortByCategories.push(sortBy?.sortByCategories[element])
            });



            sortByCategories?.forEach((category, index) => {
                if (index == 0) {
                    let optionEle = gbb.$("<option>").attr("value", "featured")
                        .text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.sortBy.featured) || "Featured");
                    gbbSortByDropDownSelect.append(optionEle);
                }
                if (category.id != "priceHighToLow" && category.id != "priceLowToHigh" && category.isEnabled) {
                    let optionEle = gbb.$("<option>").attr("value", category.id)
                        .text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.sortBy[category.id])); //add code for multi language here
                    //choose this value as default if value found sortBy.sortByValue
                    if (category.id === sortBy?.sortByValue) {
                        optionEle.attr("selected", "selected");
                    }

                    gbbSortByDropDownSelect.append(optionEle);

                }
            });
            gbbSortByDropDownSelect.change(async (event) => {
                gbb.utility.setSortByValues(noteAttribute, event.target.value);
                let products = await gbb.utility.getFilteredSortedProductsData(noteAttribute);
            })
            gbbSortByDropDownContainer.append(gbbSortByDropDownSelect);
            return gbbSortByDropDownContainer;
        },
        renderSearchBoxHTML: function (noteAttribute) {
            try {
                let gbbSearchBarMainWrapper = gbb.$("<div>").addClass("gbbSearchBarMainWrapper");
                let gbbSearchBarInput = gbb.$("<input>").addClass("gbbSearchBarInput").attr("type", "text").attr("placeholder", gbb.utility.renderLanguageValue(gbb.settings.languageData.general.searchLabel) || 'Search1').attr('value', gbb.gbbAddProductsPage.state?.filterBySearch?.searchQuery?.searchText || '');
                let gbbSearchBarIcon = gbb.$("<div>").addClass("gbbSearchBarIcon");
                gbbSearchBarIcon.append(SEARCH_ICON_SVG)
                gbbSearchBarMainWrapper.append(gbbSearchBarIcon);
                gbbSearchBarMainWrapper.append(gbbSearchBarInput);
                gbbSearchBarInput.on("input", async (event) => {
                    let searchedValue = event.target.value
                    let searchedProducts = await gbb.gbbAddProductsPage.f.handleSearchBundleInput(searchedValue, noteAttribute);
                    let activeCategory = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
                    await gbb.gbbAddProductsPage.f.renderProductsCardContainer(searchedProducts, noteAttribute, 'searchProductsFlow', activeCategory)
                })
                return gbbSearchBarMainWrapper;
            } catch (error) {
                gbb.utility.debugConsole("error in renderSearchBoxHTML", error)
            }
        },
        renderFiltersSideBarHTML: function (noteAttribute) {
            //contains entire filter sidebar
            let gbbProductsFiltersMainContainer = gbb.$("<div>").addClass("gbbProductsFiltersMainContainer");
            let gbbProductsFiltersContainer = gbb.$("<div>").addClass("gbbProductsFiltersContainer");

            let gbbProductsFiltersContainerHeader = gbb.$("<div>").addClass("gbbProductsFiltersContainerHeader");
            let gbbProductsFiltersContainerHeaderLabels = gbb.$("<div>").addClass("gbbProductsFiltersContainerHeaderLabels");

            let gbbProductsFiltersContainerLabel = gbb.$("<div>").addClass("gbbProductsFiltersContainerLabel");
            gbbProductsFiltersContainerLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.filtersLabel) || "Filters1");
            let gbbProductsFiltersClearLabel = gbb.$("<div>").addClass("gbbProductsFiltersClearLabel");
            gbbProductsFiltersClearLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.clearSelection) || "Clear Selection1");

            gbbProductsFiltersClearLabel.on("click", async (event) => {
                gbb.gbbAddProductsPage.f.resetSearchTextValue()
                gbb.utility.clearAllFilters(noteAttribute);

                let filteredProducts = await gbb.utility.getFilteredSortedProductsData(noteAttribute)
                // currentPageHTML.html(gbb.f.renderProductsHTML(filteredProducts, noteAttribute))
                gbb.utility.toggleFiltersSideBar(noteAttribute);
                setTimeout(() => {
                    gbbProductsFiltersContainer.addClass("gbbFiltersSideBarContainerSlideOut")
                    gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
                }, 500)
            })
            const gbbFilterModalClose = gbb.$("<div>").addClass("gbbFilterModalClose");
            gbbFilterModalClose.text("+");
            gbbFilterModalClose.on("click", () => {
                gbbProductsFiltersContainer.addClass("gbbFiltersSideBarContainerSlideOut")
                gbb.utility.toggleFiltersSideBar(noteAttribute);
                gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
            })

            gbbProductsFiltersMainContainer.on('click', function (event) {
                if (!gbb.$(event.target).closest(gbbProductsFiltersContainer).length) {
                    gbbProductsFiltersContainer.addClass("gbbFiltersSideBarContainerSlideOut")
                    gbb.utility.toggleFiltersSideBar(noteAttribute);
                    gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
                }
            });

            gbbProductsFiltersContainerHeaderLabels.append(gbbProductsFiltersContainerLabel);
            gbbProductsFiltersContainerHeaderLabels.append(gbbProductsFiltersClearLabel);

            gbbProductsFiltersContainerHeader.append(gbbProductsFiltersContainerHeaderLabels);
            gbbProductsFiltersContainerHeader.append(gbbFilterModalClose);
            gbbProductsFiltersContainer.append(gbbProductsFiltersContainerHeader);
            //contains one particular filter
            let gbbFiltersInfo = gbb.utility.getFiltersInfo(noteAttribute);
            //TODO
            // if(!gbbFiltersInfo.isFiltersEnabled) {
            //     return;
            // }
            if (gbbFiltersInfo.categories == 0) {
                let gbbProductsNoFilters = gbb.$("<div>").addClass("gbbProductsNoFilters");
                gbbProductsNoFilters.text("No filters have been added");
                gbbProductsFiltersContainer.append(gbbProductsNoFilters);
                gbbProductsFiltersMainContainer.append(gbbProductsFiltersContainer);
                return gbbProductsFiltersMainContainer;
            }
            gbbFiltersInfo.categories.forEach((filterCategory, index) => {

                let isFilterTagsVisible = gbb.utility.getActivatedCategoriesForFilters(noteAttribute, filterCategory);

                let gbbFilterContainer = gbb.$("<div>").attr("data-gbbFilterContainer", index).addClass("gbbFilterContainer");
                let gbbFiltersDropDownWrapper = gbb.$("<div>").attr("data-gbbFiltersDropDownWrapper", index).attr("data-role", "collapsible")
                    .addClass("gbbFiltersDropDownWrapper")
                    .addClass("gbbFiltersDropDownWrapper" + index);
                let gbbFilterLabel = gbb.$("<div>").attr("data-gbbFilterLabel", index).addClass("gbbFilterLabel").text(filterCategory.title);
                let gbbFilterDropDownButton = gbb.$("<img>").attr("data-gbbFilterDropDownButton", index).addClass("gbbFilterDropDownButton").addClass("gbbFilterDropDownButton" + index);
                gbbFilterDropDownButton.attr("src", CONSTANT_IMAGES_DROPDOWN_BUTTON);

                gbbFiltersDropDownWrapper.append(gbbFilterLabel);
                gbbFiltersDropDownWrapper.append(gbbFilterDropDownButton);

                gbbFilterContainer.append(gbbFiltersDropDownWrapper);
                if (filterCategory.type == "price") {
                    return;
                    let showPriceFilter = true;
                    gbbFilterDropDownButton.css("transform", "rotate(360deg)");
                    let gbbFilterPriceContainer = gbb.$("<div>").addClass("gbbFilterPriceContainer");
                    let gbbPriceFieldContainer = gbb.$("<div>").addClass("gbbPriceFieldContainer");
                    let gbbPriceFieldLower = gbb.$("<input>")
                        .addClass("gbbPriceFieldLower")
                        .attr("type", "range")
                        .attr("min", filterCategory.minValue)
                        .attr("max", filterCategory.maxValue)
                        .attr("value", gbb.utility.getPriceFilterValues(noteAttribute)?.minValue);


                    let gbbPriceFieldUpper = gbb.$("<input>")
                        .addClass("gbbPriceFieldUpper")
                        .attr("type", "range")
                        .attr("min", filterCategory.minValue)
                        .attr("max", filterCategory.maxValue)
                        .attr("value", gbb.utility.getPriceFilterValues(noteAttribute)?.maxValue);

                    let lowerVal = parseInt(gbbPriceFieldLower[0].value);
                    let upperVal = parseInt(gbbPriceFieldUpper[0].value);


                    gbbPriceFieldContainer.append(gbbPriceFieldLower);
                    gbbPriceFieldContainer.append(gbbPriceFieldUpper);

                    let gbbPriceTextWrap = gbb.$("<div>").addClass("gbbPriceTextWrap");

                    let gbbPriceWrap1 = gbb.$("<div>").addClass("gbbPriceWrap1");
                    //let gbbPriceWrap1Input = gbb.$("<input>").addClass("gbbPriceWrap1Input");
                    gbb.utility.debugConsole("here ar price:", gbb.utility.getPriceFilterValues(noteAttribute)?.minValue)
                    let gbbPriceWrap1Label = gbb.$("<div>").addClass("gbbPriceWrap1Label").text(gbb.utility.getCurrencySymbol() + " " + gbb.utility.getPriceFilterValues(noteAttribute)?.minValue);
                    //gbbPriceWrap1.append(gbbPriceWrap1Input);
                    gbbPriceWrap1.append(gbbPriceWrap1Label);

                    let gbbPriceWrap2 = gbb.$("<div>").addClass("gbbPriceWrap2");
                    //let gbbPriceWrap2Input = gbb.$("<input>").addClass("gbbPriceWrap2Input");
                    let gbbPriceWrap2Label = gbb.$("<div>").addClass("gbbPriceWrap2Label").text(gbb.utility.getCurrencySymbol() + " " + gbb.utility.getPriceFilterValues(noteAttribute)?.maxValue);
                    //gbbPriceWrap2.append(gbbPriceWrap2Input);
                    gbbPriceWrap2.append(gbbPriceWrap2Label);

                    gbbPriceTextWrap.append(gbbPriceWrap1);
                    gbbPriceTextWrap.append(gbbPriceWrap2);

                    gbbPriceFieldLower.on("input", (event) => {
                        lowerVal = parseInt(gbbPriceFieldLower[0].value);
                        upperVal = parseInt(gbbPriceFieldUpper[0].value);
                        if (lowerVal >= upperVal - 4) {
                            gbbPriceFieldUpper[0].value = lowerVal + 4;
                            if (upperVal == gbbPriceFieldUpper[0].max) {
                                gbbPriceFieldLower[0].value = parseInt(gbbPriceFieldUpper[0].max) - 4;
                            }
                        }
                        if (filterCategory?.minValue == lowerVal
                            && filterCategory?.maxValue == upperVal) {
                            gbb.utility.setActivatePriceFilters(noteAttribute, false);
                        } else {
                            gbb.utility.setActivatePriceFilters(noteAttribute, true);
                        }
                        gbbPriceWrap1Label.text(gbb.utility.getCurrencySymbol() + " " + event.target.value);
                        gbbPriceWrap2Label.text(gbb.utility.getCurrencySymbol() + " " + upperVal);
                        gbb.utility.setPriceFilterValues(noteAttribute, lowerVal, upperVal);
                    })

                    gbbPriceFieldLower.mouseup((event) => {
                        let filteredProducts = gbb.utility.getFilteredSortedProductsData(noteAttribute)
                        gbb.utility.toggleFiltersSideBar(noteAttribute);
                        setTimeout(() => {
                            gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
                        }, 500)
                    })

                    gbbPriceFieldUpper.on("input", (event) => {
                        lowerVal = parseInt(gbbPriceFieldLower[0].value);
                        upperVal = parseInt(gbbPriceFieldUpper[0].value);
                        if (upperVal < lowerVal + 4) {
                            gbbPriceFieldLower[0].value = upperVal - 4;
                            if (lowerVal == gbbPriceFieldLower[0].min) {
                                gbbPriceFieldUpper[0].value = 4;
                            }
                        }

                        if (filterCategory?.minValue == lowerVal && filterCategory?.maxValue == upperVal) {
                            gbb.utility.setActivatePriceFilters(noteAttribute, false);
                        } else {
                            gbb.utility.setActivatePriceFilters(noteAttribute, true);
                        }

                        gbbPriceWrap2Label.text(gbb.utility.getCurrencySymbol() + " " + event.target.value);
                        gbbPriceWrap1Label.text(gbb.utility.getCurrencySymbol() + " " + lowerVal);

                        gbb.utility.setPriceFilterValues(noteAttribute, lowerVal, upperVal);
                    })

                    gbbPriceFieldUpper.mouseup((event) => {
                        let filteredProducts = gbb.utility.getFilteredSortedProductsData(noteAttribute)
                        gbb.utility.toggleFiltersSideBar(noteAttribute);
                        setTimeout(() => {
                            gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
                        }, 500)
                    })


                    gbbFiltersDropDownWrapper.on("click", () => {
                        if (!showPriceFilter) {
                            gbb.$(".gbbFilterDropDownButton" + index).css("transform", "rotate(360deg)");
                            gbbFilterPriceContainer.show();
                        } else {
                            gbb.$(".gbbFilterDropDownButton" + index).css("transform", "rotate(180deg)");
                            gbbFilterPriceContainer.hide();
                        }
                        showPriceFilter = !showPriceFilter
                    })

                    gbbFilterPriceContainer.append(gbbPriceFieldContainer);
                    gbbFilterPriceContainer.append(gbbPriceTextWrap);

                    gbbFilterContainer.append(gbbFilterPriceContainer);
                    // if(isFilterTagsVisible) {
                    //     gbbFilterPriceContainer.show();
                    // } else {
                    //     gbbFilterPriceContainer.hide();
                    // }
                    // gbbFiltersDropDownWrapper.on("click",()=>{
                    //     if(isFilterTagsVisible) {
                    //         gbb.$(".gbbFilterDropDownButton"+index).css("transform", "rotate(180deg)");
                    //         gbbFilterTagsContainer.hide();
                    //     } else {
                    //         gbb.$(".gbbFilterDropDownButton"+index).css("transform", "rotate(360deg)");
                    //         gbbFilterTagsContainer.show();
                    //     }
                    //     isFilterTagsVisible = !isFilterTagsVisible;
                    // })

                } else {
                    let gbbFilterTagsContainer = gbb.$("<div>").addClass("gbbFilterTagsContainer").addClass("gbbFilterTagsContainer" + index);

                    filterCategory.tags.forEach((tag, tagIndex) => {
                        //add event listener to tagcontainer
                        let gbbProductsFilterTagContainer = gbb.$("<div>").addClass("gbbProductsFilterTagContainer");
                        let gbbProductsFilterTagCheckbox = gbb.$("<input>").addClass("gbbProductsFilterTagCheckbox").attr("type", "checkbox").attr("val", tag.value);
                        if (gbb.utility.getActivatedFilters(noteAttribute).findIndex(e => e.label == tag.label) != -1) {
                            gbbProductsFilterTagCheckbox.prop("checked", true);
                        }
                        const filterClicked = async () => {
                            gbb.gbbAddProductsPage.f.resetSearchTextValue()
                            if (gbb.utility.getActivatedFilters(noteAttribute).findIndex(e => e.label == tag.label) == -1) {
                                gbb.utility.setActivatedFilters(tag, noteAttribute, "add", filterCategory);
                            } else {
                                gbb.utility.setActivatedFilters(tag, noteAttribute, "remove", filterCategory);
                            }
                            // @ashfaq
                            let filteredProducts = await gbb.utility.getFilteredSortedProductsData(noteAttribute)

                            gbb.utility.toggleFiltersSideBar(noteAttribute);
                            // setTimeout(() => {
                            //     gbb.$("body").find(".gbbProductsFiltersMainContainer").remove()
                            // }, 500)
                        }
                        gbbProductsFilterTagCheckbox.on("click", (event) => {
                            // event.preventDefault();
                            // event.stopPropagation();
                            filterClicked()
                        })

                        let gbbProductsFilterTagLabel = gbb.$("<div>").addClass("gbbProductsFilterTagLabel").text(tag.label);

                        gbbProductsFilterTagLabel.on("click", (event) => {
                            event.preventDefault();
                            event.stopPropagation();
                            if (gbbProductsFilterTagCheckbox.prop("checked")) {
                                gbbProductsFilterTagCheckbox.prop("checked", false);
                            } else {
                                gbbProductsFilterTagCheckbox.prop("checked", true);
                            }
                            filterClicked()
                        })
                        gbbProductsFilterTagContainer.append(gbbProductsFilterTagCheckbox);
                        gbbProductsFilterTagContainer.append(gbbProductsFilterTagLabel);

                        gbbFilterTagsContainer.append(gbbProductsFilterTagContainer);
                    })

                    if (isFilterTagsVisible) {
                        gbbFilterTagsContainer.show();
                    } else {
                        gbbFilterTagsContainer.hide();
                    }
                    gbbFiltersDropDownWrapper.on("click", () => {
                        if (isFilterTagsVisible) {
                            gbb.$(".gbbFilterDropDownButton" + index).css("transform", "rotate(180deg)");
                            gbbFilterTagsContainer.hide();
                        } else {
                            gbb.$(".gbbFilterDropDownButton" + index).css("transform", "rotate(360deg)");
                            gbbFilterTagsContainer.show();
                        }
                        isFilterTagsVisible = !isFilterTagsVisible;
                    })
                    gbbFilterContainer.append(gbbFilterTagsContainer);
                }
                gbbProductsFiltersContainer.append(gbbFilterContainer);
            })
            gbbProductsFiltersMainContainer.append(gbbProductsFiltersContainer);
            return gbbProductsFiltersMainContainer;
        },
        renderProductsHTML: function (products, noteAttribute, category) {

            // products 
            products = JSON.parse(JSON.stringify(products))
            // products?.variants?.length>1 ?alert("multiple variants")
            const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()
            const gbbProductsContainer = gbb.$("<div>").addClass("gbbProductsContainer");
            const gbbProductsLabel = gbb.$("<p>").addClass("gbbProductsLabel");
            let gbbProductsItemsContainer = gbb.$("<div>").addClass("gbbProductsItemsContainer");
            const gbbProductsItemsArray = [];
            let addProductsPageArr = ADDPRODUCT_PAGES_LIST
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                gbbProductsLabel.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.productPage.selectProductsLabel));
            } else if (noteAttribute == "reviewPage") {
                gbbProductsLabel.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.reviewPage.addOnsLabel));
            }
            if (!products || products.length == 0) {
                if (noteAttribute == "reviewPage") { //no need to show no products label when on review page
                    return;
                }
                // else {
                //     const gbbProductsNotAvailable = gbb.$("<p>").addClass("gbbProductsNotAvailable");
                //     gbbProductsNotAvailable.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.general.noProductsAvailable));

                //     //replace gbbProductsNotAvailable class if available
                //     if (gbb.$(".gbbProductsNotAvailable").length > 0) {
                //         gbb.$(".gbbProductsNotAvailable").replaceWith(gbbProductsNotAvailable);
                //     } else {
                //         gbbProductsItemsContainer.append(gbbProductsNotAvailable);
                //     }
                //     return gbbProductsContainer;
                // }  not in use @mufadal
            } else {
                // gbb.utility.debugConsole("Products here is", products)
                //  gbbProductsItemsContainer = gbb.$("<div>").addClass("gbbProductsItemsContainer");
                products = products?.filter((product) => {
                    return product.available == true;
                });

                products.forEach((product, index) => {
                    let currentProductPersonalization = gbb.utility.getCurrentProductPersonalization(product);
                    let doesThisProductHavePersonalization = currentProductPersonalization.isProductPersonalizationEnabled || false;

                    if (doesThisProductHavePersonalization) {
                        product.renderChooseOptionsButton_forcefully = true;
                    }


                    const gbbProductItem = gbb.$("<div>").addClass("gbbProductItem").clone();
                    gbbProductItem.css("background", gbb.settings.pageCustomizationData.productCard.productCardBgColor);
                    gbbProductItem.css("color", gbb.settings.pageCustomizationData.productCard.productCardTextColor);


                    const gbbProductTextContainer = gbb.$("<div>").addClass("gbbProductTextContainer");

                    const gbbProductDynamicContentContainer = gbb.$("<div>").addClass("gbbProductDynamicContentContainer");

                    gbbProductDynamicContentContainer.html(gbb.gbbAddProductsPage.f.renderProductDynamicContent(product,'PRODUCT_CARD'));

                    const gbbProductItemTitle = gbb.$("<div>").addClass("gbbProductItemTitle").css("cursor", "pointer");
                    const gbbProductActionContainer = gbb.$("<div>").addClass("gbbProductActionContainer");
                    const gbbProductReadMore = gbb.$("<div>").addClass("gbbProductReadMore").text("Read More >>");
                    const gbbProductItemPricesContainer = gbb.$("<div>").addClass("gbbProductItemPricesContainer");
                    const gbbProductItemPrice = gbb.$("<div>").addClass("gbbProductItemPrice");
                    const gbbProductItemCompareAtPrice = gbb.$("<div>").addClass("gbbProductItemCompareAtPrice");
                    const gbbProductButtonWrapper = gbb.$("<div>").addClass("gbbProductButtonWrapper");
                    // const gbbProductButton = gbb.$("<button>").addClass("gbbProductAddButton");
                    const gbbProductButton = gbb.$("<div>").addClass("gbbProductAddButton");

                    const gbbProductImageContainer = gbb.$("<div>").addClass("gbbProductImageContainer")
                    const gbbProductImage = gbb.$("<img>").addClass("gbbProductImage");
                    const gbbProductItemOverLay = gbb.$("<div>").addClass("gbbProductItemOverLay");
                    const gbbOverLayIconContainer = gbb.$("<div>").addClass("gbbOverLayIconContainer");

                    gbbProductItem.attr("productId", product?.id)
                    let firstvariantid = product.variants.length > 0 ? product?.variants[0]?.id : "";
                    gbbProductItem.attr("firstvariantid", firstvariantid);
                    if (product.customProductAttribute) {
                        gbbProductItem.attr('custom-product-attribute', product.customProductAttribute)
                    }
                    // gbb.utility.debugConsole("product details array", product.title, index)

                    for (let i = 0; i < product.images.length; i++) {
                        let image = product.images[i];
                        if (!image) {
                            continue;
                        }
                        if (image) {
                            gbbProductImageContainer.append(gbb.$("<img>").addClass('gbbProductImageContainerImg' + i).addClass("gbbProductImageContainerImg").addClass("gbbFade"))
                            gbbProductImageContainer.find('.gbbProductImageContainerImg' + i).attr('src', image).css('display', 'none')
                        }
                        if (i == 0) {
                            gbbProductImageContainer.find('.gbbProductImageContainerImg' + i).css('display', 'block').on("click", () => {
                                gbb.utility.debugConsole("triggering showProductVariantsModal from image click", product.title)
                                event.preventDefault();
                                event.stopPropagation();
                                gbb.f.showProductVariantsModal(product, gbbProductButton, noteAttribute, category)
                            })
                        }
                        if (image) {
                            break;
                        }
                    }
                    //push an anchor tag
                    if (product.images.length > 1) {
                        //let gbbProductSliderNavigatior = gbb.$("<div>").addClass('gbbProductSliderNavigatior')
                        gbbProductImageContainer.append(gbb.$("<a>").addClass('gbbPrevImage'))
                        gbbProductImageContainer.find('.gbbPrevImage').html("&#10094;");
                        //add an onclick event to the anchor tag
                        gbbProductImageContainer.append(gbb.$("<a>").addClass('gbbNextImage'))
                        gbbProductImageContainer.find('.gbbNextImage').html("&#10095;");

                        gbbProductImageContainer.find('.gbbPrevImage').click(function () {
                            gbb.utility.slider.plusSlides(gbbProductImageContainer, 1)
                        })
                        gbbProductImageContainer.find('.gbbNextImage').click(function () {
                            gbb.utility.slider.minusSlides(gbbProductImageContainer, 1)
                        })
                        //gbbProductImageContainer.append(gbbProductImageContainer);
                        //hide the arrows
                        gbbProductImageContainer.find('.gbbPrevImage').css("display", "none");
                        gbbProductImageContainer.find('.gbbNextImage').css("display", "none");
                    }

                    gbbProductImageContainer.append(gbb.f.renderTagsPillsHTML(product, noteAttribute, category));
                    gbbProductItem.append(gbbProductImageContainer);

                    // gbbProductItem.append(gbb.f.renderTagsPillsHTML(product, noteAttribute, category));


                    gbbProductItemTitle.on("click", () => {
                        gbb.f.showProductVariantsModal(product, gbbProductButton, noteAttribute, category)
                    })

                    gbbProductItemOverLay.on("click", () => {
                        gbb.f.showProductVariantsModal(product, gbbProductButton, noteAttribute, category)
                    })





                    // gbbProductReadMore.on("click",()=>{
                    //     gbb.f.showProductVariantsModal(product, gbbProductButton, noteAttribute, category)
                    // })
                    //gbbProductButton.css("background", gbb.settings.pageCustomizationData.productCard.productCardButtonColor);
                    //gbbProductButton.css("color", gbb.settings.pageCustomizationData.productCard.productCardButtonTextColor);

                   

                    let _productPrice = product.price
                    let _compareAtPrice = product.compare_at_price
                    if (isPurchaseTypeSubscription) {
                        _productPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product.variants[0].id);
                        _compareAtPrice = product.price
                    }
                    if (gbb.settings?.merchantInfo?.bundleSettings?.showCompareAtPrice == true && _compareAtPrice && (isPurchaseTypeSubscription || _compareAtPrice > product.price)) {
                        gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(_compareAtPrice));
                    }
                    gbbProductItemPrice.text(gbb.utility.formatPrice(_productPrice));
                    gbbProductItemPricesContainer.append(gbbProductItemCompareAtPrice);
                    gbbProductItemPricesContainer.append(gbbProductItemPrice);

                    if (product.variants?.length == 1 && product.available == true && product.renderChooseOptionsButton_forcefully != true) {
                        let argsObj = {
                            variantId: product.variants[0].id,
                            productData: product,
                        }
                        let uniqueItemKey = gbb.utility.getUniqueIdForVariant(argsObj);
                        // const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(product.variants[0].id);
                        // gbb.utility.debugConsole("isItemInCart:", isItemInCart);
                        let data = {
                            productData: product,
                            variant: product.variants[0],
                            // _boxProduct: product?.properties["_boxProduct"],
                            // _Category: product?.properties["_Category"]
                        }
                        const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(data?.variant?.id, { uniqueItemKey });
                        let typeOfProduct = "singleVariant";
                        //price of the first variant
                        let price = product.variants[0].price;
                        let compareAtPrice = product.variants[0]?.compare_at_price || null
                        compareAtPrice = compareAtPrice > price ? compareAtPrice : null;

                        if (isPurchaseTypeSubscription) {
                            price = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product.variants[0].id);
                            compareAtPrice = product.variants[0].price
                        }
                        if (gbb?.settings?.merchantInfo?.bundleSettings?.showCompareAtPrice && compareAtPrice && (isPurchaseTypeSubscription || compareAtPrice > 0)) {
                            gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(compareAtPrice));
                        } else if (!compareAtPrice) {
                            gbbProductItemCompareAtPrice.text("");
                        }

                        
                        gbbProductItemPrice.text(gbb.utility.formatPrice(price));
                        if (isItemInCart) {
                            //activate quantity button
                            gbb.utility.activateQuantityButtons(gbbProductButton, data, noteAttribute, typeOfProduct, category);
                        } else {
                            gbb.utility.activateAddButton(gbbProductButton, data, noteAttribute, typeOfProduct, category);
                        }
                    } else if (product.renderChooseOptionsButton_forcefully == true || product.variants?.length > 1 && product.available == true) {
                        let variantProduct = gbb.utility.getTheVariantProductPresentInCart(product);
                        let data = {
                            productData: product,
                            variant: variantProduct
                        }
                        let typeOfProduct = "multipleVariants";
                        if (variantProduct && Object.keys(variantProduct).length > 0) {
                            let variantPrice = variantProduct.price
                            if (isPurchaseTypeSubscription) {
                                variantPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(variantProduct.id);
                            }
                            gbb.utility.activateQuantityButtons(gbbProductButton, data, noteAttribute, typeOfProduct, category);
                            gbbProductItemPrice.text(gbb.utility.formatPrice(variantPrice));
                        } else {
                            gbb.utility.activateAddButton(gbbProductButton, data, noteAttribute, typeOfProduct, category);
                        }

                    } else {
                    }

                    // if(product.variants.length == 1 ){
                    //     // gbbProductItemTitle.text(`${product.variants[0].title} (${product?.options[0]?.name})`);
                    //     gbbProductItemTitle.text(`${product.variants[0].title}`);
                    // }else{
                    //     gbbProductItemTitle.text(product.title);
                    // }
                    let gbbProductTitleOnly = gbb.$("<div>").addClass("gbbProductTitleOnly").text(product.title)
                    let gbbVariantTitle = gbb.$("<div>").addClass("gbbVariantTitle").text(product?.variantName);
                    let divsForTitle = [];
                    divsForTitle.push(gbbProductTitleOnly);
                    divsForTitle.push(gbbVariantTitle);

                    gbbProductItemOverLay.append(gbbOverLayIconContainer)
                    // gbbProductItemTitle.text(product.title);
                    gbbProductItemTitle.html(divsForTitle);

                    gbbProductTextContainer.append(gbbProductItemTitle);
                    gbbProductButtonWrapper.append(gbbProductButton);
                    gbbProductActionContainer.append(gbbProductItemPricesContainer);
                    gbbProductActionContainer.append(gbbProductButtonWrapper);
                    gbbProductImageContainer.append(gbbProductItemOverLay);

                    gbbProductItem.append(gbbProductTextContainer);
                    if (gbb.settings?.app?.integrations?.judgeme?.isEnabled) {
                        let starsHTML = gbb.gbbIntegrations?.judgeme?.f?.getStarsHTMLByProductId(product.id);
                        if (starsHTML) {
                            let reviewStarsContainer = gbb.$("<div>").addClass("gbbReviewStarsContainer");
                            let reviewStars = gbb.$("<div>").addClass("gbbReviewStars");
                            reviewStars.html(starsHTML);
                            reviewStarsContainer.append(reviewStars);
                            let appendTo = gbb.$('.gbbProductsCardLayoutV2').length > 0 ? gbbProductItem : gbbProductTextContainer;
                            appendTo.append(reviewStarsContainer);
                        }
                    }
                    if (gbb.settings.bundleSettings?.metafieldNameSpaceAndKeys.length > 0 || gbb.settings.app?.dynamicScriptForHTMLContent) {
                        gbbProductItem.append(gbbProductDynamicContentContainer)
                    }
                    gbbProductItem.append(gbbProductActionContainer);
                    // gbbProductItem.append(gbbProductReadMore);

                    if (isPurchaseTypeSubscription && gbb.gbbSubscriptionProductsPage.state.showDiscountOnProductCards) {
                        const discountRibbon = gbb.gbbSubscriptionProductsPage.f.prepareSubscriptionProductDiscountRibbonUI(product.variants[0])
                        if (discountRibbon) {
                            gbbProductItem.append(discountRibbon)
                        }
                    }
                    if (gbb.state.currentPageId == "personalizationPage" && gbb.gbbAddonProducts.state.isEnabled) {
                        let {type,value,discountText:addonsDiscountRibbonContent} = gbb.gbbAddonProducts.f.prepareDiscountRibbonContentForProductAddons()
                        if (addonsDiscountRibbonContent) {
                            let isFreeProduct = value == 100 // in future for discountType based on amount calculate product price and discounted price for calculatng isFreeProduct
                            if (isFreeProduct) {
                                gbbProductItem.attr("free-addon-product",true)
                            }
                            let ribbonUIOptions = {
                                ribbonContent: addonsDiscountRibbonContent,
                                ribbonClassName: "gbbAddonDiscountRibbon",
                            }
                            let addonDiscountsRibbonHTML = gbb.utility.prepareProductCardRibbonUI(ribbonUIOptions)
                            gbbProductItem.append(addonDiscountsRibbonHTML)
                        }
                    }
                    gbbProductsItemsContainer.append(gbbProductItem);
                    gbbProductsItemsArray.push(gbbProductItem);
                })


                //in gbbProductItemsArray, just figure out the -15 index and loadMoreIndicator as the tag
                let totalNumberOfItemsInArray = gbbProductsItemsArray.length;
                let loadMoreIndicatorItem;

                //attach loadMoreIndicator in the 70% of the array
                if (totalNumberOfItemsInArray > 0) {
                    let indexToAttachLoadMoreIndicator = Math.floor(totalNumberOfItemsInArray * 0.7);
                    loadMoreIndicatorItem = gbbProductsItemsArray[indexToAttachLoadMoreIndicator];
                    //add the data attribute to the loadMoreIndicatorItem
                    loadMoreIndicatorItem.attr("data-load-more-indicator-status", "active");
                }

                //gbbProductsContainer.append(gbbProductsLabel);
                // gbbProductsContainer.append(gbbProductsItemsContainer);
                // gbb.gbbAddProductsPage.f.hideExcessProducts(gbbProductsContainer);
                return gbbProductsItemsArray;
                // return gbbProductsItemsContainer;
            }
        },

        renderFooterButtons: function (noteAttribute, gbbFooterNextButton, renderNewTemplateDesign = false) {

            const gbbFooterButtonsWrapper = gbb.$("<div>").addClass("gbbFooterButtonsWrapper");
            if (renderNewTemplateDesign || gbb.f.getPreviousNavigationItem()) {
                // const gbbFooterBackButton = gbb.$("<button>").addClass("gbbFooterBackButton");
                const gbbFooterBackButton = gbb.$("<div>").addClass("gbbFooterBackButton");
                gbbFooterBackButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.backButtonText));
                gbbFooterBackButton.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonColor);
                gbbFooterBackButton.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonTextColor);
                if (renderNewTemplateDesign && !gbb.f.getPreviousNavigationItem()) {
                    //disable the button
                    gbbFooterBackButton.addClass("gbbDisabled");
                }
                gbbFooterBackButton.on("click", function () {
                    gbb.utility.renderTemporaryLoadingSpinner("show")
                    gbb.giftboxbuilderPage.action.onPrevNavigationBYOB();
                    //add the gbbDisabled class to button
                    gbb.utility.disableElement(gbbFooterBackButton, 1000);
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-back-button-click",
                        attachEventTo: gbbFooterBackButton[0]
                    })
                })
                gbbFooterButtonsWrapper.append(gbbFooterBackButton);
            }
            if (renderNewTemplateDesign) {
                gbbFooterButtonsWrapper.append(gbb.f.renderFooterTotalContainer());
            }
            // const gbbFooterNextButton = gbb.$("<button>").addClass("gbbFooterNextButton");
            //gbbFooterNextButton = gbb.$("<div>").addClass("gbbFooterNextButton");
            gbbFooterNextButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.nextButtonText));
            gbbFooterNextButton.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterNextButtonColor);
            gbbFooterNextButton.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterNextButtonTextColor);
            gbbFooterNextButton.on("click", async function () {
                await gbb.utility.checkConditionsAndProceedToNextPage(noteAttribute, gbbFooterNextButton);
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: "gbb-next-button-click",
                    attachEventTo: gbbFooterNextButton[0]
                })
            })
            gbbFooterButtonsWrapper.append(gbbFooterNextButton);
            return gbbFooterButtonsWrapper;
        },

        renderCartProductsFooterHTMLForMobile: function (noteAttribute, gbbProductsFooterHTML, gbbPageFooterHTML, updateFooterFlow) {
            let renderAddonsMessaging  = gbb.gbbAddonProducts.f.checkIfAddonsMessagingNeeded()
            let renderNewTemplateDesign = gbb.$('.gbbProductsCardLayoutV2').length > 0
            let renderProductSlotsFooter = gbb.settings.stepsConfigurationData?.isProductSlotsEnabled && gbb.gbbAddProductsPage?.state?.isEveryConditionHaveTypeQuantity;
            const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()

            gbbProductsFooterHTML.css("grid-template-columns", "1fr");
            gbbProductsFooterHTML.addClass("gbbProductsFooterHTMLForMobile")
            let _boxData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
            let products = _boxData?.items || [];
            let gbbViewProductsLabelAndTotalContainer = gbb.$("<div>").addClass("gbbViewProductsLabelAndTotalContainer");

            const gbbFooterTotalContainer = gbb.f.renderFooterTotalContainer();

            let gbbViewCartProductsLink = gbb.$("<div>").addClass("gbbViewCartProductsLink");
            gbbViewCartProductsLink.text(gbb?.settings?.languageData?.general?.viewCartProductsLabel?.value || "View Selected Products");
            gbbViewCartProductsLink.append(" ").append(`(${_boxData.item_count})`)
            gbbViewCartProductsLink.on("click", () => {
                gbb.f.renderCartProductsModal(noteAttribute);
            })

            gbbViewProductsLabelAndTotalContainer.append(gbbViewCartProductsLink);
            gbbViewProductsLabelAndTotalContainer.append(gbbFooterTotalContainer);

            let gbbFooterNextButton = gbb.$("<div>").addClass("gbbFooterNextButton");
            const gbbFooterButtonsWrapper = gbb.f.renderFooterButtons(noteAttribute, gbbFooterNextButton, renderNewTemplateDesign);
            let gbbFooterButtonsContainer = gbb.$(`<div>`).addClass('gbbFooterButtonsContainer')
            const gbbFooterProductsContainer = gbb.$("<div>").addClass("gbbFooterProductsContainer");
            if (renderNewTemplateDesign) {
                if (products.length == 0) {
                    gbb.$('body').css("overflow-y", DEFAULT_BODY_OVERFLOW_VALUE)
                    gbb.gbbAddProductsPage.state.showBoxProductsInFooter = false;
                }// reset drawer values
                products.forEach((product) => {
                    const gbbFooterProductContainer = gbb.$("<div>").addClass("gbbFooterProductContainer");
                    // gbb.utility.debugConsole("product:", product)
                    //attach a data attriute to the product container
                    gbbFooterProductContainer.attr("productId", product?.product_id);
                    gbbFooterProductContainer.attr("variantId", product?.variant_id)

                    gbbFooterProductContainer.attr("_boxProduct", product?.properties["_boxProduct"]);
                    gbbFooterProductContainer.attr("_Category", product?.properties["_Category"]);

                    let argsObj = {
                        variantId: product.variant_id,
                        productData: product,
                    }


                    let uniqueGbbItemKey = gbb.utility.getUniqueIdForVariant(argsObj)
                    gbbFooterProductContainer.attr("_uniqueGbbItemKey", uniqueGbbItemKey);




                    const gbbFooterProductImageContainer = gbb.$("<div>").addClass("gbbFooterProductImageContainer");
                    const gbbFooterProductImage = gbb.$("<img>").addClass("gbbFooterProductImage");
                    gbbFooterProductImage.attr("src", product.image);
                    const gbbFooterProductTextContainer = gbb.$("<div>").addClass("gbbFooterProductTextContainer");
                    const gbbFooterProductTitle = gbb.$("<div>").addClass("gbbFooterProductTitle");
                    const gbbFooterProductQtyPriceContainer = gbb.$("<div>").addClass("gbbFooterProductQtyPriceContainer");
                    const gbbFooterProductPrice = gbb.$("<div>").addClass("gbbFooterProductPrice");
                    const gbbFooterProductQuantity = gbb.$("<div>").addClass("gbbFooterProductQuantity");


                    //a button to remove the product from the cart
                    const gbbFooterProductRemoveButton = gbb.$("<div>").addClass("gbbFooterProductRemoveButton");
                    // x icon for the remove button
                    const gbbFooterProductRemoveButtonIcon = gbb.$("<div>").addClass("gbbFooterProductRemoveButtonIcon");


                    // gbbFooterProductRemoveButtonIcon.css("color", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconTextColor);
                    // gbbFooterProductRemoveButton.css("background", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconBgColor)
                    gbbFooterProductRemoveButtonIcon.append(CONSTANT_CLOSE_ICON_SVG);
                    gbbFooterProductRemoveButton.append(gbbFooterProductRemoveButtonIcon)
                    gbbFooterProductRemoveButton.on("click", async () => {
                        //    await gbb.f.removeProductFromCart({id: product.variant_id});
                        let variant = {
                            id: product.variant_id,
                            _boxProduct: product?.properties["_boxProduct"],
                            _Category: product?.properties["_Category"],
                            _uniqueGbbItemKey: uniqueGbbItemKey
                            // _uniqueGbbItemKey : gbbFooterProductContainer.attr("_uniqueGbbItemKey")
                        }
                        if (gbb.settings.giftMessage.messageProduct && gbb.settings.giftMessage.messageProduct.product && gbb.settings.giftMessage.messageProduct.product.variants) {
                            const variantIdForMessage = gbb.settings.giftMessage.messageProduct.product.variants[0].id;
                            if (variantIdForMessage == product.variant_id) {
                                gbb.gbbPersonalizePage.state.customerUploadsResponse = {};
                            }
                        }
                        await gbb.utility.removeFromCart({ variant: variant });
                        gbb.gbbAddProductsPage.f.updateProductCard(product.product_id, variant.id);
                        gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                    })

                    gbbFooterProductTitle.text(product.title);
                    let _productPrice = product.price
                    if (isPurchaseTypeSubscription) {
                        _productPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product?.variant_id);
                    }
                    gbbFooterProductPrice.text(gbb.utility.formatPrice(_productPrice));
                    gbbFooterProductQuantity.text("x" + product.quantity);
                    gbbFooterProductImageContainer.append(gbbFooterProductImage);

                    gbbFooterProductTextContainer.append(gbbFooterProductTitle);
                    gbbFooterProductQtyPriceContainer.append(gbbFooterProductPrice);
                    gbbFooterProductQtyPriceContainer.append(gbbFooterProductQuantity);
                    gbbFooterProductTextContainer.append(gbbFooterProductQtyPriceContainer);

                    let pageIdTheProductWasAddedFrom = product?.properties["_boxProduct"]
                    // @ashfaq append commented
                    if (gbb.utility.checkIfRemoveButtonShouldBeAppended(product?.variant_id, pageIdTheProductWasAddedFrom)) {
                        gbbFooterProductContainer.append(gbbFooterProductRemoveButton);
                    }

                    gbbFooterProductContainer.append(gbbFooterProductImageContainer);
                    gbbFooterProductContainer.append(gbbFooterProductTextContainer);
                    gbbFooterProductsContainer.append(gbbFooterProductContainer);
                })
                let displayValue = gbb.gbbAddProductsPage.state.showBoxProductsInFooter ? 'grid' : 'none'
                gbbFooterButtonsContainer.css("background", gbb.settings.pageCustomizationData?.cartFooter?.cartFooterButtonsContainerBgColor || '#f6f6f6')
                gbbFooterButtonsContainer.append(gbbFooterButtonsWrapper);
                gbbFooterProductsContainer.css('display', displayValue)
                gbbProductsFooterHTML.append(gbbFooterProductsContainer);
                if (gbbPageFooterHTML.find('.gbbDiscountFooterHTML').length <= 0) {
                    gbbPageFooterHTML.append(gbb.gbbAddProductsPage.f.renderShowBoxProductsInFooterHTML())
                } // if discount is not enable then will show selected products
            }
            else if (products.length > 0) {
                gbbProductsFooterHTML.append(gbbViewProductsLabelAndTotalContainer);
            }
            let footerButtonsContainerForMobile = renderNewTemplateDesign ? gbbFooterButtonsContainer : gbbFooterButtonsWrapper
            if (renderProductSlotsFooter) {
                let gbbSlotFooterProductsContainer = gbb.f.renderProductSlotsFooterHTML(noteAttribute);
                let isDrawerOpen = gbb.gbbAddProductsPage?.state?.showBoxProductsInFooter || false
                if (isDrawerOpen) {
                    gbbSlotFooterProductsContainer.css("display", "none")
                }

                if (updateFooterFlow == "updateFooterWithoutAppending" && gbb.$(".gbbSlotFooterProductsContainerWrapper").length > 0) {
                    if (!isDrawerOpen && products?.length == 0 && !gbb.$(".gbbSlotFooterProductsContainer").is(":visible")) {
                        gbb.$(".gbbSlotFooterProductsContainerWrapper").slideDown(100)
                    }
                    let productsContainer = gbbSlotFooterProductsContainer.find(".gbbSlotFooterProductContainer")
                    gbb.$(".gbbSlotFooterProductsContainer").html(productsContainer)
                    gbb.$(".gbbFooterProductsContainer").replaceWith(gbbFooterProductsContainer)
                    gbb.gbbAddProductsPage.f.autoScrollSlots()
                    gbb.$(".gbbFooterButtonsWrapper").replaceWith(gbbFooterButtonsWrapper)
                    gbb.$(".gbbCartIconWithQuantityContainer").html(gbb.gbbAddProductsPage.f.renderCartIconWithQuantityHTML())
                    let gbbPageFooterHTML = gbb.$(".gbbPageFooterHTML")
                    if (renderAddonsMessaging || gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.settings?.discountsData?.rules?.length > 0) {
                        let discountFooterHTML = gbb.gbbDiscountComponent.f.discountStatusFooterHTML()
                        discountFooterHTML.find(".gbbDiscountMessageContainer").on("click", gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)
                        gbb.$(".gbbDiscountFooterHTML").html(discountFooterHTML)
                    }
                    // gbbPageFooterHTML.find(".gbbDiscountMessageContainer").on("click", gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)
                    return gbbPageFooterHTML
                } else {
                    gbbProductsFooterHTML.append(gbbSlotFooterProductsContainer);
                }
            }
            gbbProductsFooterHTML.append(footerButtonsContainerForMobile);
            gbbPageFooterHTML.append(gbbProductsFooterHTML);
            if (renderNewTemplateDesign) {
                let gbbCartIconWithQuantityContainer = gbb.gbbAddProductsPage.f.renderCartIconWithQuantityHTML()

                gbbCartIconWithQuantityContainer.click(gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)

                gbbPageFooterHTML.append(gbbCartIconWithQuantityContainer)
                gbbPageFooterHTML.find(".gbbDiscountMessageContainer").on("click", gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)
            }
            if (gbb.utility.checkIfBrandingShouldBeVisible()) {
                gbbPageFooterHTML.append(gbb.utility.renderPoweredByLabel());
            }
            return gbbPageFooterHTML;
        },
        renderFooterTotalContainer: function () {
            const gbbFooterTotalContainer = gbb.$("<div>").addClass("gbbFooterTotalContainer");
            let totalLabelTextColor = gbb.settings.pageCustomizationData.cartFooter.cartFooterTotalLabelColor || gbb.settings.pageCustomizationData.cartFooter.cartFooterTextColor;
            const gbbFooterTotalLabel = gbb.$("<div>").addClass("gbbFooterTotalLabel").css("color", totalLabelTextColor)
            const gbbFooterTotalValueContainer = gbb.$("<div>").addClass("gbbFooterTotalValueContainer").css("color", gbb.settings.pageCustomizationData?.cartFooter?.cartFooterTextColor)

            // const gbbFooterOriginalTotalValue = gbb.$("<div>").addClass("gbbFooterOriginalTotalValue").css("color", "#625f5f");
            const gbbFooterOriginalTotalValue = gbb.$("<div>").addClass("gbbFooterOriginalTotalValue").addClass("gbbFooterOriginalTotalValue")
            gbbFooterTotalLabel.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.reviewPage.totalLabel) || "Total");
            gbbFooterOriginalTotalValue.append(gbb.utility.getGiftBoxProductsTotalWithCurrency());

            const gbbFooterDiscountedTotalValue = gbb.$("<div>");
            let finalPriceFontColor = gbb.settings.pageCustomizationData?.cartFooter?.cartFooterFinalPriceFontColor || gbb.settings.pageCustomizationData?.cartFooter?.cartFooterTextColor;
            if (gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled) {
                gbbFooterDiscountedTotalValue.addClass("gbbFooterDiscountedTotalValue").css("color", finalPriceFontColor)
            } else {
                gbbFooterDiscountedTotalValue.addClass("gbbFooterTotalValue").css("color", finalPriceFontColor)
            }
            gbbFooterTotalLabel.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.reviewPage.totalLabel) || "Total");

            let originalTotal = gbb.state.giftBoxCartData
            // originalTotal = parseInt(originalTotal.total_price / 100);
            originalTotal = parseFloat(originalTotal.total_price / 100);

            let discountedTotal = gbb.utility.getGiftBoxProductsDiscountedTotal();
            let formattedDiscountedPrice = gbb.utility.getGiftBoxProductsTotalWithCurrency();

            if (gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.utility.getGiftBoxProductsDiscountedTotal() != originalTotal) {
                discountedTotal = gbb.utility.getGiftBoxProductsDiscountedTotal();
                // formattedDiscountedPrice = gbb.utility.getCurrencySymbol() + "" + parseFloat(discountedTotal).toFixed(2);
                let discountedTotalInShopifyFormat = discountedTotal * 100;
                formattedDiscountedPrice = gbb.utility.formatPrice(discountedTotalInShopifyFormat)
                gbbFooterTotalValueContainer.append(gbbFooterOriginalTotalValue);
            }
            gbbFooterDiscountedTotalValue.append(formattedDiscountedPrice);

            gbbFooterTotalValueContainer.append(gbbFooterDiscountedTotalValue)

            gbbFooterTotalContainer.append(gbbFooterTotalLabel);
            gbbFooterTotalContainer.append(gbbFooterTotalValueContainer);
            return gbbFooterTotalContainer;
        },
        renderProductSlotsFooterHTML: function (noteAttribute) {
            try {
                let gbbSlotFooterProductsContainerWrapper = gbb.$("<div>").addClass("gbbSlotFooterProductsContainerWrapper");
                let gbbSlotFooterProductsContainer = gbb.$("<div>").addClass("gbbSlotFooterProductsContainer");
                let totalNoOfSlotsRequired = gbb.gbbAddProductsPage?.state?.totalProductSlotsRequired || 0;
                let boxData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                let boxProducts = boxData?.items || [];
                boxProducts.forEach((product) => {
                    let gbbSlotFooterProductContainer = gbb.$("<div>").addClass("gbbSlotFooterProductContainer");
                    gbbSlotFooterProductContainer.attr("productId", product?.product_id);
                    gbbSlotFooterProductContainer.attr("variantId", product?.variant_id)

                    gbbSlotFooterProductContainer.attr("_boxProduct", product?.properties["_boxProduct"]);
                    gbbSlotFooterProductContainer.attr("_Category", product?.properties["_Category"]);

                    let argsObj = {
                        variantId: product.variant_id,
                        productData: product,
                    }

                    let uniqueGbbItemKey = gbb.utility.getUniqueIdForVariant(argsObj)
                    gbbSlotFooterProductContainer.attr("_uniqueGbbItemKey", uniqueGbbItemKey);

                    const gbbSlotFooterProductImageContainer = gbb.$("<div>").addClass("gbbSlotFooterProductImageContainer");
                    const gbbSlotFooterProductImage = gbb.$("<img>").addClass("gbbSlotFooterProductImage");
                    gbbSlotFooterProductImage.attr("src", product.image);

                    //a button to remove the product from the cart
                    const gbbSlotFooterProductRemoveButton = gbb.$("<div>").addClass("gbbSlotFooterProductRemoveButton");
                    // x icon for the remove button
                    const gbbSlotFooterProductRemoveButtonIcon = gbb.$("<div>").addClass("gbbSlotFooterProductRemoveButtonIcon");

                    const gbbSlotFooterProductQuantity = gbb.$("<div>").addClass("gbbSlotFooterProductQuantity");
                    gbbSlotFooterProductQuantity.text("x" + product.quantity);
                    gbbSlotFooterProductRemoveButtonIcon.append(CONSTANT_CLOSE_ICON_SVG);
                    gbbSlotFooterProductRemoveButton.append(gbbSlotFooterProductRemoveButtonIcon)
                    gbbSlotFooterProductRemoveButton.on("click", async () => {
                        //    await gbb.f.removeProductFromCart({id: product.variant_id});
                        let variant = {
                            id: product.variant_id,
                            _boxProduct: product?.properties["_boxProduct"],
                            _Category: product?.properties["_Category"],
                            _uniqueGbbItemKey: uniqueGbbItemKey
                            // _uniqueGbbItemKey : gbbSlotFooterProductContainer.attr("_uniqueGbbItemKey")
                        }
                        if (gbb.settings.giftMessage.messageProduct && gbb.settings.giftMessage.messageProduct.product && gbb.settings.giftMessage.messageProduct.product.variants) {
                            const variantIdForMessage = gbb.settings.giftMessage.messageProduct.product.variants[0].id;
                            if (variantIdForMessage == product.variant_id) {
                                gbb.gbbPersonalizePage.state.customerUploadsResponse = {};
                            }
                        }
                        await gbb.utility.removeFromCart({ variant: variant });
                        gbb.gbbAddProductsPage.f.updateProductCard(product.product_id, variant.id);
                        gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                    })

                    gbbSlotFooterProductImageContainer.append(gbbSlotFooterProductImage);

                    let pageIdTheProductWasAddedFrom = product?.properties["_boxProduct"]
                    if (gbb.utility.checkIfRemoveButtonShouldBeAppended(product?.variant_id, pageIdTheProductWasAddedFrom)) {
                        gbbSlotFooterProductContainer.append(gbbSlotFooterProductRemoveButton);
                    }

                    gbbSlotFooterProductContainer.append(gbbSlotFooterProductImageContainer);
                    if (product.quantity > 1) {
                        gbbSlotFooterProductContainer.append(gbbSlotFooterProductQuantity);
                    }
                    gbbSlotFooterProductsContainer.append(gbbSlotFooterProductContainer);
                })

                // render empty slots 
                let totalItemCount = boxData?.item_count || 0;
                for (let startIdx = totalItemCount; startIdx < totalNoOfSlotsRequired; startIdx++) {
                    let gbbSlotFooterProductContainer = gbb.$("<div>").addClass("gbbSlotFooterProductContainer");
                    gbbSlotFooterProductContainer.addClass("gbbSlotFooterProductContainerEmpty");
                    gbbSlotFooterProductContainer.text(`${startIdx + 1}`);
                    gbbSlotFooterProductsContainer.append(gbbSlotFooterProductContainer);
                }
                gbbSlotFooterProductsContainerWrapper.append(gbbSlotFooterProductsContainer);
                return gbbSlotFooterProductsContainerWrapper;
            } catch (error) {
                gbb.utility.debugConsole("error in renderProductSlotsFooterHTML:", error);
            }
        },
        renderCartProductsFooterHTML: function (noteAttribute, options) {
            try {
                let updateFooterFlow = options?.flow
                let renderProductSlotsFooter = gbb.settings.stepsConfigurationData?.isProductSlotsEnabled && gbb.gbbAddProductsPage?.state?.isEveryConditionHaveTypeQuantity;
                const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()
                const renderAddonsMessaging = gbb.gbbAddonProducts.f.checkIfAddonsMessagingNeeded()
                const renderNewTemplateDesign = gbb.$('.gbbProductsCardLayoutV2').length > 0
                //gbb.state.cartData = await gbb.utility.getCart();
                let gbbPageFooterHTML = gbb.$("<div>").addClass("gbbPageFooterHTML");

                let gbbBoxIdContainer = gbb.$("<div>").addClass("gbbPageFooterHTML");
                //gbbBoxIdContainer.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.reviewPage?.boxNumberLabel) || "Box Number:").append(gbb.state?.activeBoxId?.split("box")[1]|| 1);
                //gbbPageFooterHTML.append(gbbBoxIdContainer);

                let gbbProductsFooterHTML;
                gbbProductsFooterHTML = gbb.$("<div>").addClass("gbbProductsFooterHTML");

                gbbProductsFooterHTML.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBgColor)
                gbbProductsFooterHTML.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterTextColor)

                if (renderAddonsMessaging || gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.settings?.discountsData?.rules?.length > 0) {
                    gbbPageFooterHTML.append(gbb.gbbDiscountComponent.f.discountStatusFooterHTML())
                }

                if (window.innerWidth < 600) {
                    return gbb.f.renderCartProductsFooterHTMLForMobile(noteAttribute, gbbProductsFooterHTML, gbbPageFooterHTML, updateFooterFlow);
                }
                const gbbFooterProductsContainer = gbb.$("<div>").addClass("gbbFooterProductsContainer");
                let gbbFooterTotalContainer = gbb.$("<div>");
                let products = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                products = products?.items || [];
                // products = products?.item_count
                products.forEach((product) => {
                    const gbbFooterProductContainer = gbb.$("<div>").addClass("gbbFooterProductContainer");
                    // gbb.utility.debugConsole("product:", product)
                    //attach a data attriute to the product container
                    gbbFooterProductContainer.attr("productId", product?.product_id);
                    gbbFooterProductContainer.attr("variantId", product?.variant_id)

                    gbbFooterProductContainer.attr("_boxProduct", product?.properties["_boxProduct"]);
                    gbbFooterProductContainer.attr("_Category", product?.properties["_Category"]);

                    let argsObj = {
                        variantId: product.variant_id,
                        productData: product,
                    }


                    let uniqueGbbItemKey = gbb.utility.getUniqueIdForVariant(argsObj)
                    gbbFooterProductContainer.attr("_uniqueGbbItemKey", uniqueGbbItemKey);




                    const gbbFooterProductImageContainer = gbb.$("<div>").addClass("gbbFooterProductImageContainer");
                    const gbbFooterProductImage = gbb.$("<img>").addClass("gbbFooterProductImage");
                    gbbFooterProductImage.attr("src", product.image);
                    const gbbFooterProductTextContainer = gbb.$("<div>").addClass("gbbFooterProductTextContainer");
                    const gbbFooterProductTitle = gbb.$("<div>").addClass("gbbFooterProductTitle");
                    const gbbFooterProductQtyPriceContainer = gbb.$("<div>").addClass("gbbFooterProductQtyPriceContainer");
                    const gbbFooterProductPrice = gbb.$("<div>").addClass("gbbFooterProductPrice");
                    const gbbFooterProductQuantity = gbb.$("<div>").addClass("gbbFooterProductQuantity");


                    //a button to remove the product from the cart
                    const gbbFooterProductRemoveButton = gbb.$("<div>").addClass("gbbFooterProductRemoveButton");
                    // x icon for the remove button
                    const gbbFooterProductRemoveButtonIcon = gbb.$("<div>").addClass("gbbFooterProductRemoveButtonIcon");


                    // gbbFooterProductRemoveButtonIcon.css("color", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconTextColor);
                    // gbbFooterProductRemoveButton.css("background", gbb.settings.pageCustomizationData?.generalSettings?.icon?.iconBgColor)
                    gbbFooterProductRemoveButtonIcon.append(CONSTANT_CLOSE_ICON_SVG);
                    gbbFooterProductRemoveButton.append(gbbFooterProductRemoveButtonIcon)
                    gbbFooterProductRemoveButton.on("click", async () => {
                        //    await gbb.f.removeProductFromCart({id: product.variant_id});
                        let variant = {
                            id: product.variant_id,
                            _boxProduct: product?.properties["_boxProduct"],
                            _Category: product?.properties["_Category"],
                            _uniqueGbbItemKey: uniqueGbbItemKey
                            // _uniqueGbbItemKey : gbbFooterProductContainer.attr("_uniqueGbbItemKey")
                        }
                        if (gbb.settings.giftMessage.messageProduct && gbb.settings.giftMessage.messageProduct.product && gbb.settings.giftMessage.messageProduct.product.variants) {
                            const variantIdForMessage = gbb.settings.giftMessage.messageProduct.product.variants[0].id;
                            if (variantIdForMessage == product.variant_id) {
                                gbb.gbbPersonalizePage.state.customerUploadsResponse = {};
                            }
                        }
                        await gbb.utility.removeFromCart({ variant: variant });
                        gbb.gbbAddProductsPage.f.updateProductCard(product.product_id, variant.id);
                        gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                    })

                    gbbFooterProductTitle.text(product.title);
                    let _productPrice = product.price;
                    if (isPurchaseTypeSubscription) {
                        _productPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product?.variant_id)
                    }
                    gbbFooterProductPrice.text(gbb.utility.formatPrice(_productPrice));
                    gbbFooterProductQuantity.text("x" + product.quantity);
                    gbbFooterProductImageContainer.append(gbbFooterProductImage);

                    gbbFooterProductTextContainer.append(gbbFooterProductTitle);
                    gbbFooterProductQtyPriceContainer.append(gbbFooterProductPrice);
                    gbbFooterProductQtyPriceContainer.append(gbbFooterProductQuantity);
                    gbbFooterProductTextContainer.append(gbbFooterProductQtyPriceContainer);

                    let pageIdTheProductWasAddedFrom = product?.properties["_boxProduct"]
                    // @ashfaq append commented
                    if (gbb.utility.checkIfRemoveButtonShouldBeAppended(product?.variant_id, pageIdTheProductWasAddedFrom)) {
                        gbbFooterProductContainer.append(gbbFooterProductRemoveButton);
                    }

                    gbbFooterProductContainer.append(gbbFooterProductImageContainer);
                    gbbFooterProductContainer.append(gbbFooterProductTextContainer);
                    gbbFooterProductsContainer.append(gbbFooterProductContainer);
                })
                let gbbFooterNextButton = gbb.$("<div>").addClass("gbbFooterNextButton");
                const gbbFooterButtonsWrapper = gbb.f.renderFooterButtons(noteAttribute, gbbFooterNextButton, renderNewTemplateDesign); // passing renderNewTemplateDesign to change the layout of footer vuttons

                if (renderNewTemplateDesign) {
                    // let displayValue = gbb.gbbAddProductsPage.state.showBoxProductsInFooter ? 'grid' : 'none'
                    // gbbFooterProductsContainer.css('display', displayValue)
                    // for every re-render we checking do we need to keep the secion open or closed
                    gbbFooterTotalContainer.addClass('gbbFooterButtonsContainer')
                    gbbFooterTotalContainer.css("background", gbb.settings.pageCustomizationData?.cartFooter?.cartFooterButtonsContainerBgColor || '#f6f6f6')
                    // gbbFooterProductsContainer.on("wheel", (event) => {
                    //     event.preventDefault();
                    //     // Detecting the direction of the scroll
                    //     if (event.originalEvent.deltaY < 0) {
                    //         // Scrolling up
                    //         gbb.$(".gbbFooterProductsContainer").scrollLeft(gbb.$(".gbbFooterProductsContainer").scrollLeft() - 50); // Scroll left
                    //     } else {
                    //         // Scrolling down
                    //         gbb.$(".gbbFooterProductsContainer").scrollLeft(gbb.$(".gbbFooterProductsContainer").scrollLeft() + 50); // Scroll right
                    //     }
                    // }) TBD @mufadal
                }
                if (products.length > 0) {
                    if (!renderProductSlotsFooter) {
                        gbbProductsFooterHTML.append(gbbFooterProductsContainer);
                    }
                    if (!renderNewTemplateDesign) {
                        gbbFooterTotalContainer.html(gbb.f.renderFooterTotalContainer())
                    }
                    // In new template design we dont need total price there we have this in renderFooterButtons
                    if (false && renderNewTemplateDesign && gbbPageFooterHTML.find('.gbbDiscountFooterHTML').length <= 0) {
                        gbbPageFooterHTML.append(gbb.gbbAddProductsPage.f.renderShowBoxProductsInFooterHTML())
                    } // if discount is not enable then will show selected products
                } else {
                    gbbProductsFooterHTML.css("grid-template-columns", "1fr");
                    !renderNewTemplateDesign && gbbFooterButtonsWrapper.css("grid-template-columns", "auto 1fr auto");
                    // changing layout for new template design
                    gbbFooterNextButton.css("grid-column", "3/3");
                }

                if (renderProductSlotsFooter) {
                    let productSlotsFooter = gbb.f.renderProductSlotsFooterHTML(noteAttribute)
                    if (updateFooterFlow == "updateFooterWithoutAppending" && gbb.$(".gbbSlotFooterProductsContainerWrapper").length > 0) {
                        let productsContainer = productSlotsFooter.find(".gbbSlotFooterProductContainer")
                        gbb.$(".gbbSlotFooterProductsContainer").html(productsContainer)
                        gbb.$(".gbbFooterButtonsWrapper").replaceWith(gbbFooterButtonsWrapper)
                        gbb.gbbAddProductsPage.f.autoScrollSlots()
                        gbb.$(".gbbCartIconWithQuantityContainer").replaceWith(gbb.gbbAddProductsPage.f.renderCartIconWithQuantityHTML())

                        let gbbPageFooterHTML = gbb.$(".gbbPageFooterHTML")
                        if (renderAddonsMessaging || gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.settings?.discountsData?.rules?.length > 0) {
                            // remove existing discountfooter and append new one 

                            gbb.$(".gbbDiscountFooterHTML").html(gbb.gbbDiscountComponent.f.discountStatusFooterHTML())
                        }
                        return gbbPageFooterHTML
                    } else {
                        gbbProductsFooterHTML.append(productSlotsFooter)
                    }
                }
                gbbFooterTotalContainer.append(gbbFooterButtonsWrapper);
                gbbProductsFooterHTML.append(gbbFooterTotalContainer);
                gbbPageFooterHTML.append(gbbProductsFooterHTML);
                if (renderNewTemplateDesign) {
                    gbbPageFooterHTML.append(gbb.gbbAddProductsPage.f.renderCartIconWithQuantityHTML())
                }
                if (gbb.utility.checkIfBrandingShouldBeVisible()) {
                    gbbPageFooterHTML.append(gbb.utility.renderPoweredByLabel());
                }
                return gbbPageFooterHTML;
            } catch (error) {
                gbb.utility.debugConsole("error in renderCartProductsFooterHTML", error);
            }
        },
        renderCartProductsModal: function (noteAttribute) {
            const gbbCartProductsMainContainer = gbb.$("<div>").addClass("gbbCartProductsMainContainer");
            const gbbCartProductsContainerModal = gbb.$("<div>").addClass("gbbCartProductsContainerModal");

            const gbbCartProductsContainerHeader = gbb.$("<div>").addClass("gbbCartProductsContainerHeader");
            const gbbCartProductsContainerHeaderLabel = gbb.$("<div>").addClass("gbbCartProductsContainerHeaderLabel").text(gbb.settings?.languageData?.general?.selectedProductsLabel?.value || "Selected Products");
            const gbbCartProductsModalClose = gbb.$("<div>").addClass("gbbCartProductsModalClose");
            gbbCartProductsModalClose.text("+");
            gbbCartProductsModalClose.on("click", () => {
                gbb.$("body").find(".gbbCartProductsMainContainer").remove()
                gbb.$("body").css("overflow-y", DEFAULT_BODY_OVERFLOW_VALUE);
            })

            const gbbCartProductsContainerBody = gbb.$("<div>").addClass("gbbCartProductsContainerBody");

            const gbbCartModalProductsContainer = gbb.$("<div>").addClass("gbbCartModalProductsContainer");
            let products = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
            products = products?.items || [];
            products.forEach((product) => {
                const gbbCartModalProductContainer = gbb.$("<div>").addClass("gbbCartModalProductContainer");
                //attach a data attriute to the product container
                gbbCartModalProductContainer.attr("productId", product?.product_id);
                gbbCartModalProductContainer.attr("variantId", product?.variant_id)

                const gbbCartProductImageContainer = gbb.$("<div>").addClass("gbbCartProductImageContainer");
                const gbbCartModalProductImage = gbb.$("<img>").addClass("gbbCartModalProductImage");
                gbbCartModalProductImage.attr("src", product.image);
                const gbbCartModalProductTextContainer = gbb.$("<div>").addClass("gbbCartModalProductTextContainer");

                const gbbCartModalProductTitleContainer = gbb.$("<div>").addClass("gbbCartModalProductTitleContainer");
                const gbbCartModalProductTitle = gbb.$("<div>").addClass("gbbCartModalProductTitle");
                const gbbCartModalProductQuantity = gbb.$("<div>").addClass("gbbCartModalProductQuantity");

                const gbbCartModalProductPriceQtyContainer = gbb.$("<div>").addClass("gbbCartModalProductPriceQtyContainer");
                const gbbCartModalProductPrice = gbb.$("<div>").addClass("gbbCartModalProductPrice");
                //a button to remove the product from the cart
                const gbbCartModalProductRemoveButton = gbb.$("<div>").addClass("gbbCartModalProductRemoveButton");
                // x icon for the remove button
                const gbbCartModalProductRemoveButtonIcon = gbb.$("<div>").addClass("gbbCartModalProductRemoveButtonIcon");

                gbbCartModalProductRemoveButtonIcon.append(CONSTANT_CLOSE_ICON_SVG);


                gbbCartModalProductRemoveButton.append(gbbCartModalProductRemoveButtonIcon)


                gbbCartModalProductRemoveButton.on("click", async () => {
                    //    await gbb.f.removeProductFromCart({id: product.variant_id});
                    let variant = {
                        id: product.variant_id,
                        _boxProduct: product?.properties["_boxProduct"],
                        _Category: product?.properties["_Category"],
                        _uniqueGbbItemKey: gbb.utility.getUniqueIdForVariant({ productData: product })
                    }
                    await gbb.utility.removeFromCart({ variant: variant });
                    gbb.gbbAddProductsPage.f.updateProductCard(product.product_id, variant.id);
                    gbb.$(".gbbCartProductsMainContainer").replaceWith(gbb.f.renderCartProductsModal(noteAttribute));
                    gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                })

                gbbCartModalProductTitle.text(product.title);
                gbbCartModalProductPrice.text(gbb.utility.formatPrice(product.price));
                gbbCartModalProductQuantity.text("x" + product.quantity);
                gbbCartProductImageContainer.append(gbbCartModalProductImage);

                gbbCartModalProductTitleContainer.append(gbbCartModalProductTitle);
                //gbbCartModalProductTitleContainer.append(gbbCartModalProductQuantity);

                gbbCartModalProductTextContainer.append(gbbCartModalProductTitleContainer);
                gbbCartModalProductPriceQtyContainer.append(gbbCartModalProductQuantity);
                gbbCartModalProductPriceQtyContainer.append(gbbCartModalProductPrice);
                gbbCartModalProductTextContainer.append(gbbCartModalProductPriceQtyContainer);

                let pageIdTheProductWasAddedFrom = product?.properties["_boxProduct"]

                // @ashfaq append commented
                if (gbb.utility.checkIfRemoveButtonShouldBeAppended(product?.variant_id, pageIdTheProductWasAddedFrom)) {
                    gbbCartModalProductContainer.append(gbbCartModalProductRemoveButton);
                }

                gbbCartModalProductContainer.append(gbbCartProductImageContainer);
                gbbCartModalProductContainer.append(gbbCartModalProductTextContainer);
                gbbCartModalProductsContainer.append(gbbCartModalProductContainer);
            })

            gbbCartProductsContainerHeader.append(gbbCartProductsContainerHeaderLabel);
            gbbCartProductsContainerHeader.append(gbbCartProductsModalClose);

            gbbCartProductsContainerBody.append(gbbCartModalProductsContainer);

            const gbbModalTotalContainer = gbb.f.renderFooterTotalContainer();
            gbbModalTotalContainer.addClass("gbbModalTotalContainer");

            gbbCartProductsContainerModal.append(gbbCartProductsContainerHeader);
            gbbCartProductsContainerModal.append(gbbCartProductsContainerBody);
            gbbCartProductsContainerModal.append(gbbModalTotalContainer);

            gbbCartProductsMainContainer.append(gbbCartProductsContainerModal);
            gbb.$("body").append(gbbCartProductsMainContainer);
            gbb.$("body").css("overflow-y", "hidden");
            gbb.utility.debugConsole("dummy commit");
            gbb.f.applyFontToFooterCartPopup();
        },
        showProductVariantsModal: async function (product, buttonEle, noteAttribute, category) {
            let selectedVariantsCombination = {};
            gbb.state.currentModalProductData = product || {};
            let addProductsPageArr = ADDPRODUCT_PAGES_LIST
            const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()


            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            //gbb.$(".gbbHTMLWrapper").addClass('gbbDisabled');
            let currentProductPersonalization = gbb.utility.getCurrentProductPersonalization(product);
            let doesThisProductHavePersonalization = currentProductPersonalization.isProductPersonalizationEnabled || false;
            let isValidateInventoryEnabled = gbb.settings?.bundleSettings?.isValidateInventoryEnabled || false;
            let allowQuantityInput = gbb.settings?.bundleSettings?.allowQuantityInput || false;
            let incrementProductQtyBy = gbb.gbbAddProductsPage.state.incrementProductQtyBy || 1
            let decrementProductQtyBy = gbb.gbbAddProductsPage.state.decrementProductQtyBy || 1




            const gbbProductVariantModalMainContainer = gbb.$("<div>").addClass("gbbProductVariantModalMainContainer");
            if (gbb.$('.gbbProductsCardLayoutV2').length > 0) {
                gbbProductVariantModalMainContainer.addClass("gbbProductVariantModalLayoutV2");
            }
            if (gbb.$(".gbbNewPageCustomization").length > 0) {
                gbbProductVariantModalMainContainer.addClass("gbbNewPageCustomization");
            }
            const gbbProductVariantModalContainer = gbb.$("<div>").addClass("gbbProductVariantModalContainer");

            // gbbProductVariantModalContainer.addClass
            const gbbProductVariantModalContentContainer = gbb.$("<div>").addClass("gbbProductVariantModalContentContainer");

            gbbProductVariantModalContainer.attr("productId", product?.id);

            // gbbProductVariantModalContainer.attr("")
            let firstvariantid = product.variants.length > 0 ? product?.variants[0]?.id : "";
            gbbProductVariantModalContainer.attr("firstvariantid", firstvariantid);


            const gbbProductVariantModalBodyContainer = gbb.$("<div>").addClass("gbbProductVariantModalBodyContainer");


            const gbbProductVariantModalImageTitleContainer = gbb.$("<div>").addClass("gbbProductVariantModalImageTitleContainer");
            const gbbProductVariantModalDetailsContainer = gbb.$("<div>").addClass("gbbProductVariantModalDetailsContainer");

            const gbbProductVariantModalHeader = gbb.$("<div>").addClass("gbbProductVariantModalHeader");
            const gbbProductVariantModalClose = gbb.$("<div>").addClass("gbbProductVariantModalClose");
            gbbProductVariantModalClose.text("+");

            gbbProductVariantModalClose.on("click", (event) => {
                gbb.utility.closeVariantsModal()
            })
            //add product image and description here
            const gbbProductTextContainer = gbb.$("<div>").addClass("gbbProductCardTextContainer");
            const gbbProductItemTitle = gbb.$("<div>").addClass("gbbProductItemTitle");
            const gbbProductItemPricesContainer = gbb.$("<div>").addClass("gbbProductItemPricesContainer");
            const gbbProductItemCompareAtPrice = gbb.$("<div>").addClass("gbbProductItemCompareAtPrice");
            const gbbProductItemPrice = gbb.$("<div>").addClass("gbbProductItemPrice");

            if (product.compare_at_price && product.compare_at_price > product.price) {
                gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(product.compare_at_price));
            }
            gbbProductItemPrice.text(gbb.utility.formatPrice(product.price));
            if (product.variants?.length == 1 && product.available == true) {
                let variantPrice = product.variants[0].price;
                let variantCompareAtPrice = product.variants[0].compare_at_price
                if (isPurchaseTypeSubscription) {
                    variantCompareAtPrice = product.variants[0].price;
                    variantPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product.variants[0].id)
                }
                gbbProductItemPrice.text(gbb.utility.formatPrice(variantPrice));
                if (variantCompareAtPrice) {
                    gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(variantCompareAtPrice));
                }
            }
            else if (product.variants?.length > 1 && product.available == true) {
                let variantPrice = product.variants[0].price;
                let variantCompareAtPrice = product.variants[0].compare_at_price
                if (isPurchaseTypeSubscription) {
                    variantCompareAtPrice = product.variants[0].price
                    variantPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(product.variants[0].id)
                }
                gbbProductItemPrice.text(gbb.utility.formatPrice(variantPrice));
                if (isPurchaseTypeSubscription || variantCompareAtPrice > product.variants[0].price) {
                    gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(variantCompareAtPrice));
                }
            }
            // else if (product.variants?.length > 1 && product.available == true) {
            //     gbbProductItemPrice.text(gbb.utility.formatPrice(product.price));
            //     if(product.compare_at_price  && product.compare_at_price > product.price){
            //         gbbProductItemCompareAtPrice.text(gbb.utility.formatPrice(product.compare_at_price));
            //     }
            // }

            const gbbProductDescriptionContainer = gbb.$("<div>").addClass("gbbProductDescriptionContainer");
            const gbbProductDescriptionText = gbb.$("<div>").addClass("gbbProductDescriptionText");

            const gbbProductDynamicContentContainer = gbb.$("<div>").addClass("gbbProductDynamicContentContainer");
            gbbProductDynamicContentContainer.html(gbb.gbbAddProductsPage.f.renderProductDynamicContent(product,'PRODUCT_VARIANTS_MODAL'));


            let description = product?.descriptionHtml?.toString() || product?.description?.toString() || "";  //?.replace(/<[^>]+>/g, '') || ""; //used to remove all HTML tags from a string
            description = description.replace(/\\n/g, "<br>");
            description = gbb.utility.removeIframeTagsFromHtml(description);
            description = gbb.utility.adjustImageTagsInProductDescriptionHtml(description);
            gbbProductDescriptionText.html(description);
            gbbProductDescriptionContainer.append(gbbProductDescriptionText);

            const gbbProductImageContainer = gbb.$("<div>").addClass("gbbProductImageContainer");
            const gbbProductAllImagesContainer = gbb.$("<div>").addClass("gbbProductAllImagesContainer");
            const gbbProductImage = gbb.$("<img>").addClass("gbbProductImage");
            let defaultMedia = {
                src: "https://db07ji0eqime4.cloudfront.net/redeemPage/giftcard/default-no-logo.jpg",
                media_type: "image",
                id: 3656456476
            }
            product.media = product.media ? product.media : [defaultMedia];
            for (let i = 0; i < product.media.length; i++) {
                let media = product.media[i];
                if (!media || !media.src) {
                    continue;
                }
                if (media.src) {
                    gbbProductImageContainer.append(gbb.$("<img>").addClass('gbbProductImageContainerImg' + i).addClass("gbbProductImageContainerImg").addClass("gbbFade"))
                    gbbProductImageContainer.find('.gbbProductImageContainerImg' + i).attr('src', media.src).css('display', 'none')
                }
                if (i == 0) {
                    gbbProductImageContainer.find('.gbbProductImageContainerImg' + i).css('display', 'block')
                }
            }
            //push an anchor tag
            if (product.media.length > 1) {
                //let gbbProductSliderNavigatior = gbb.$("<div>").addClass('gbbProductSliderNavigatior')
                gbbProductImageContainer.append(gbb.$("<a>").addClass('gbbPrevImage'))
                gbbProductImageContainer.find('.gbbPrevImage').html("&#10094;");
                //add an onclick event to the anchor tag
                gbbProductImageContainer.append(gbb.$("<a>").addClass('gbbNextImage'))
                gbbProductImageContainer.find('.gbbNextImage').html("&#10095;");

                gbbProductImageContainer.find('.gbbPrevImage').click(function (event) {
                    event.stopPropagation();
                    event.preventDefault();
                    gbb.utility.slider.minusSlides(gbbProductImageContainer, 1)

                    let prevActiveImage = gbbProductAllImagesContainer.find(".gbbActiveImage")
                    gbb.f.removeActiveImageStyle(prevActiveImage)
                    prevActiveImage.removeClass("gbbActiveImage")

                    let activeImage = gbbProductAllImagesContainer.find(`[imageIndex = ${gbb.utility.slider.state.slideIndex - 1}]`)
                    activeImage.addClass("gbbActiveImage")
                    gbb.f.applyActiveImageStyle(activeImage)
                })
                gbbProductImageContainer.find('.gbbNextImage').click(function (event) {
                    event.stopPropagation();
                    event.preventDefault();
                    gbb.utility.slider.plusSlides(gbbProductImageContainer, 1)

                    gbb.f.removeActiveImageStyle(gbbProductAllImagesContainer.find(".gbbActiveImage"))
                    gbbProductAllImagesContainer.find(".gbbActiveImage").removeClass("gbbActiveImage")

                    let activeImage = gbbProductAllImagesContainer.find(`[imageIndex = ${gbb.utility.slider.state.slideIndex - 1}]`)
                    activeImage.addClass("gbbActiveImage")
                    gbb.f.applyActiveImageStyle(activeImage)
                })
                //gbbProductImageContainer.append(gbbProductImageContainer);
            }

            for (let i = 0; i < product.media.length; i++) {
                let media = product.media[i];
                if (!media || !media.src) {
                    continue;
                }
                if (media.src) {
                    let gbbProductTabImageContainer = gbb.$("<div>").addClass("gbbProductTabImageContainer");
                    gbbProductTabImageContainer.append(gbb.$("<img>")
                        .attr('src', media.src)
                        .attr('imageIndex', i)
                        .attr('mediaId', media.id)
                        .addClass('gbbProducTabImage'))
                    gbbProductTabImageContainer.on("click", (event) => {
                        event.stopPropagation()
                        event.preventDefault()
                        gbb.f.removeActiveImageStyle(gbbProductAllImagesContainer.find(".gbbActiveImage"))
                        gbbProductAllImagesContainer.find(".gbbActiveImage").removeClass("gbbActiveImage")

                        gbbProductTabImageContainer.addClass("gbbActiveImage");
                        let changedVariantDiv = gbbProductAllImagesContainer.find(`[mediaId=${media.id}]`);
                        // let changedVariantDivIndex = parseInt(changedVariantDiv.attr("imageIndex"))
                        let changedVariantDivIndex = parseInt(changedVariantDiv?.parent()?.index())
                        changedVariantDivIndex += 1;

                        gbb.f.applyActiveImageStyle(gbbProductTabImageContainer)
                        gbb.utility.slider.state.slideIndex = changedVariantDivIndex;
                        gbb.utility.slider.showSlides(gbbProductImageContainer, gbb.utility.slider.state.slideIndex)
                    })
                    gbbProductAllImagesContainer.append(gbbProductTabImageContainer)
                }
            }
            let productFormDiv = null;
            if (doesThisProductHavePersonalization) {
                gbbProductVariantModalContainer.addClass("gbbProductVariantModalContainerWithPersonalization");
                productFormDiv = gbb.gbbProductFormStep.f.prepareFormToBeRenderedHTML(currentProductPersonalization, product);
            }


            if (gbb?.settings?.merchantInfo?.bundleSettings?.showCompareAtPrice) {
                gbbProductItemPricesContainer.append(gbbProductItemCompareAtPrice);
            }
            gbbProductItemPricesContainer.append(gbbProductItemPrice);

            // gbbProductItemTitle.text(product.title);
            if (product.variants.length == 1 && gbb.gbbAddProductsPage.state.displayVariantsAsIndividualProducts) {
                // gbbProductItemTitle.text(`${product.variants[0].title} (${product?.options[0]?.name})`);
                gbbProductItemTitle.text(`${product.variants[0].title}`);

            } else {
                gbbProductItemTitle.text(product.title);
            }
            gbbProductTextContainer.append(gbbProductItemTitle);
            if (gbb.settings?.app?.integrations?.judgeme?.isEnabled) {
                let starsHTML = gbb.gbbIntegrations?.judgeme?.f?.getStarsHTMLByProductId(product.id);
                if (starsHTML) {
                    let reviewStarsContainer = gbb.$("<div>").addClass("gbbReviewStarsContainer");
                    let reviewStars = gbb.$("<div>").addClass("gbbReviewStars");
                    reviewStars.html(starsHTML);
                    reviewStarsContainer.append(reviewStars);
                    gbbProductTextContainer.append(reviewStarsContainer);
                }
            }
            gbbProductTextContainer.append(gbbProductItemPricesContainer);
            if (isValidateInventoryEnabled) {
                let gbbVariantInventoryContainer = gbb.$("<div>").addClass("gbbVariantInventoryContainer");
                let activeVariantInfo = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination);
                let totalInventory = activeVariantInfo[0]?.quantityAvailable || 0;
                let inventoryText = gbb.$("<div>").addClass("gbbInventoryText");
                inventoryText.text((`${totalInventory} ${gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryInStockText) || "in Stock1"}`));
                if (totalInventory > 0) {
                    gbbVariantInventoryContainer.append(inventoryText);
                    gbbProductTextContainer.append(gbbVariantInventoryContainer);
                }
            }
            gbbProductTextContainer.append(gbbProductDescriptionContainer);
            // if (gbb.settings.bundleSettings?.metafieldNameSpaceAndKeys.length > 0) {
            //     gbbProductTextContainer.append(gbbProductDynamicContentContainer);
            // }
            if (gbb.settings.bundleSettings?.metafieldNameSpaceAndKeys.length > 0 || gbb.settings.app?.dynamicScriptForHTMLContent) {
                gbbProductTextContainer.append(gbbProductDynamicContentContainer)
            }


            gbbProductAllImagesContainer.find(`[imageIndex = ${0}]`).addClass("gbbActiveImage")
            gbb.f.applyActiveImageStyle(gbbProductAllImagesContainer.find(`[imageIndex = ${0}]`))
            gbbProductVariantModalImageTitleContainer.append(gbbProductImageContainer);
            // gbbProductVariantModalImageTitleContainer.append(gbbProductAllImagesContainer); // HEREr
            gbbProductVariantModalHeader.append(gbbProductVariantModalClose)
            gbbProductVariantModalContentContainer.append(gbbProductVariantModalHeader);

            gbbProductVariantModalDetailsContainer.append(gbbProductTextContainer);


            if (false && gbbProductVariantModalMainContainer.hasClass("gbbProductVariantModalLayoutV2")) {
                const imageSliderContainer = gbb.$("<div>").addClass("gbbImageSliderContainer");
                const prevBtnContainer = gbb.$("<div>").addClass("gbbPrevBtnContainer");
                const nextBtnContainer = gbb.$("<div>").addClass("gbbNextBtnContainer");
                const prevBtn = gbb.$("<div>").addClass("gbbPrevBtn").html("&#x25B2;");
                const nextBtn = gbb.$("<div>").addClass("gbbNextBtn").html("&#x25BC;");
                prevBtnContainer.append(prevBtn);
                nextBtnContainer.append(nextBtn);
                imageSliderContainer.append(prevBtnContainer);
                imageSliderContainer.append(gbbProductAllImagesContainer);
                imageSliderContainer.append(nextBtnContainer);
                gbbProductVariantModalBodyContainer.append(imageSliderContainer)
                gbbProductVariantModalBodyContainer.append(gbbProductVariantModalImageTitleContainer);
            } else {
                gbbProductVariantModalImageTitleContainer.append(gbbProductAllImagesContainer);
                gbbProductVariantModalBodyContainer.append(gbbProductVariantModalImageTitleContainer);
            }

            let variantQuantity = incrementProductQtyBy;

            let gbbProductQuantityHTMLContainer = gbb.$("<div>").addClass("gbbProductQuantityHTMLContainer");
            let gbbProductQuantityHTML = gbb.$("<div>").addClass("gbbProductQuantityHTML");

            let gbbProductQuantityHeading = gbb.$("<div>").addClass("gbbProductQuantityHeading")
            let productCardPageCustomization = gbb.settings.pageCustomizationData?.productCard
            let buttonTextColor = productCardPageCustomization.productCardQuantitySelectorButtonTextColor || productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor
            // let gbbProductQuantityAddButton = gbb.$("<button>").addClass("gbbProductQuantityAddButton")
            let gbbProductQuantityAddButton = gbb.$("<div>").addClass("gbbProductQuantityAddButton")
                // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                .css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                .css("color", productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
            // let gbbProductQuantityRemoveButton = gbb.$("<button>").addClass("gbbProductQuantityRemoveButton")

            let gbbProductQuantityRemoveButton = gbb.$("<div>").addClass("gbbProductQuantityRemoveButton")
                // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                .css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                .css("color", productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
            let gbbProductQuantityLabel = gbb.$("<div>").addClass("gbbProductQuantityLabel");

            let gbbProductQuantityInput = gbb.$("<input>").addClass("gbbProductQuantityInput").attr("type", "number").attr("min", 0);

            gbbProductQuantityAddButton.append(gbb.$("<div>").addClass("gbbProductQuantityAddButtonWrapper").html("+"));
            gbbProductQuantityRemoveButton.append(gbb.$("<div>").addClass("gbbProductQuantityRemoveButtonWrapper").html("-"));

            gbbProductQuantityAddButton.on("click", async (event) => {
                variantQuantity += incrementProductQtyBy;
                gbbProductQuantityLabel.text(variantQuantity);
                gbbProductQuantityInput.val(variantQuantity);
                gbb.utility.validateProductMaxQuantity({
                    currentQuantity:variantQuantity, 
                    product, 
                    selectedVariantsCombination,
                    triggeredFor:"MODAL_QUANTITY_CHANGE"
                })
                if (isValidateInventoryEnabled) {
                    let validationOptions = {
                        product: product,
                        selectedVariantsCombination: selectedVariantsCombination,
                        variantQuantity: variantQuantity + incrementProductQtyBy,
                        gbbProductQuantityAddButton: gbbProductQuantityAddButton
                    }
                    gbb.utility.validateProductQuantityAddButton(validationOptions);
                }
            })

            gbbProductQuantityRemoveButton.on("click", async (event) => {
                if (variantQuantity > 0) {
                    variantQuantity -= decrementProductQtyBy;
                    variantQuantity = variantQuantity < 0 ? 0 : variantQuantity;
                    gbbProductQuantityLabel.text(variantQuantity);
                    gbbProductQuantityInput.val(variantQuantity);
                    gbb.utility.validateProductMaxQuantity({
                        currentQuantity:variantQuantity, 
                        product, 
                        selectedVariantsCombination, 
                        triggeredFor:"MODAL_QUANTITY_CHANGE"
                    })
                    if (isValidateInventoryEnabled) {
                        let validationOptions = {
                            product: product,
                            selectedVariantsCombination: selectedVariantsCombination,
                            variantQuantity: variantQuantity + incrementProductQtyBy,
                            gbbProductQuantityAddButton: gbbProductQuantityAddButton
                        }
                        gbb.utility.validateProductQuantityAddButton(validationOptions);
                    }
                }
            })

            gbbProductQuantityInput.on("change", (event) => {
                let value = parseInt(event.target.value);
                if (value < 0) {
                    value = 0;
                }
                variantQuantity = value;
                gbbProductQuantityLabel.text(variantQuantity);
                gbbProductQuantityInput.val(variantQuantity);
            })
            
            gbbProductQuantityLabel.text(variantQuantity);
            gbbProductQuantityInput.val(variantQuantity);
            
            gbbProductQuantityHeading.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.quantity) || "Quantity");
            
            gbbProductQuantityHTML.append(gbbProductQuantityRemoveButton);
            
            
            
            if (allowQuantityInput) {
                gbbProductQuantityHTML.append(gbbProductQuantityInput);
            } else {

                gbbProductQuantityHTML.append(gbbProductQuantityLabel);
            }

            gbbProductQuantityHTML.append(gbbProductQuantityAddButton);

            gbbProductQuantityHTMLContainer.append(gbbProductQuantityHeading);
            gbbProductQuantityHTMLContainer.append(gbbProductQuantityHTML);
            gbbProductVariantModalDetailsContainer.append(gbbProductQuantityHTMLContainer)

            const gbbProductActionContainer = gbb.$("<div>").addClass("gbbProductCardActionContainer");
            const gbbProductButtonWrapper = gbb.$("<div>").addClass("gbbProductButtonWrapper").html("  ");
            if (product.variants?.length == 1 && product.available == true && product.renderChooseOptionsButton_forcefully != true) {

                if (product.options.length > 0 && product.options[0].name && product.variants[0]?.options?.length > 0) {
                    let options = product.options 
                    options.forEach((option, index) => {
                        selectedVariantsCombination[option.name] = product.variants[0]?.options[index]
                        gbb.utility.debugConsole(selectedVariantsCombination)
                    })
                } 

                // const gbbProductButton = gbb.$("<button>").addClass("gbbProductAddButton");
                const gbbProductButton = gbb.$("<div>").addClass("gbbProductVariantAddButton")
                    // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                    // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                    .css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                    .css("color", gbb.settings.pageCustomizationData?.productCard?.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);

                if (addProductsPageArr.includes(noteAttribute)) {
                    gbbProductButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.addToBoxButtonText));
                } else {
                    gbbProductButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.addButtonText));
                }

                let argsObj = {
                    productData: product,
                    variantId: product.variants[0].id,
                }

                let uniqueItemKey = gbb.utility.getUniqueIdForVariant(argsObj);

                const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(product.variants[0].id, { uniqueItemKey });

                // const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(product.variants[0].id);
                let data = {
                    productData: product,
                    variant: product.variants[0]
                }
                gbbProductButton.on("click", async () => {
                    gbbProductButton.addClass("gbbDisabled");
                    setTimeout(function () {
                        gbbProductButton.prop('disabled', false);
                        gbbProductButton.removeClass("gbbDisabled");
                    }, 500);
                    // { productAmount, category, productQuantity}
                    // data?.variant?.price, category, variantQuantity
                    let options = {
                        productAmount: data?.variant?.price,
                        category: category,
                        productQuantity: variantQuantity,
                        productWeight: data?.variant?.weight,
                        productVariantData: data?.variant
                    }
                    let condition = await gbb.utility.checkStepConditions(noteAttribute, options);

                    let formValidationForProduct = gbb.gbbProductFormStep.f.checkFormValidationForProduct(product);
                    if (!formValidationForProduct) {
                        gbb.gbbProductFormStep.f.displayRequiredFieldMessage();
                        return;
                    } else if (formValidationForProduct) {
                        gbb.utility.addPersonalizationDataToProductProperties();
                    }
                    
                    let typeOfProduct = "singleVariant";
                    if (gbb.settings?.bundleSettings?.isValidateInventoryEnabled && !gbb.utility.allowATCBasedOnProductInventory(data?.variant?.id, variantQuantity)) {
                        gbb.utility.closeVariantsModal()
                        gbb.f.renderConditionNotificationToast((gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryLimitReachedText) || "No More Stock1"))
                        return
                    }
                    if (condition.isConditionMet) {
                        if (isItemInCart && isItemInCart.quantity) {
                            variantQuantity += isItemInCart.quantity
                        }
                        data.qty = variantQuantity;
                        try {
                            let _noteAttribute = product?.customProductAttribute || noteAttribute
                            await gbb.utility.addToCart(data, _noteAttribute, category);
                            await gbb.utility.getGiftBoxProductsFromCart();
                        } catch (e) {
                            // gbb.utility.debugConsole("error generated is", e);
                        }
                        gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                        // gbb.gbbAddProductsPage.f.autoScrollSlotsBasedOnATC("addToCart")
                        if (noteAttribute == "reviewPage") {
                            gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
                        }

                        let newProductItemHTML = gbb.f.renderProductsHTML([product], noteAttribute, category);
                        // gbb.$(".gbbPageBody").find(`[productId='${product.id}']`).replaceWith(newProductItemHTML);
                        let productCardRef = gbb.$(".gbbProductsContainer").find(`[productId='${product.id}']`);
                        // productCard = find the product that has firstvariantid as variantId
                        if (productCardRef.length > 1) {
                            productCardRef = gbb.$(".gbbProductsContainer").find(`[firstvariantid='${product.variants[0].id}']`);

                            //the below code works but is commented because of 
                            // - we dont use filter a lot, especially in case of jquery objects.
                            // - the above code is more readable, understandable and also faster (surprisingly)
                            // @ashfaq benchmarked it
                            // productCardRef = productCardRef.filter(`[firstvariantid='${product.variants[0].id}']`);
                        }

                        productCardRef.replaceWith(newProductItemHTML);

                        gbb.utility.closeVariantsModal()
                        //TODO: handleAutoNextStep
                        await gbb.gbbAddProductsPage.f.handleAutoNextStep();
                    } else {
                        gbb.utility.closeVariantsModal()
                    }
                })

                //gbbProductButtonWrapper.append(gbbProductButton);
                gbbProductActionContainer.append(gbbProductButtonWrapper);
                gbbProductActionContainer.append(gbbProductButton);
                let isThisNewDesign = gbbProductVariantModalMainContainer.hasClass("gbbProductVariantModalLayoutV2")
                if (isThisNewDesign) {
                    gbbProductVariantModalDetailsContainer.append(gbbProductActionContainer)
                }
                gbbProductVariantModalBodyContainer.append(gbbProductVariantModalDetailsContainer);
                gbbProductVariantModalContentContainer.append(gbbProductVariantModalBodyContainer);
                if (isThisNewDesign != true) { // repeating this if block logic coz both have different placements
                    gbbProductVariantModalContentContainer.append(gbbProductActionContainer);
                }
                if (window.innerWidth < 600) {
                    gbbProductVariantModalContentContainer.append(gbbProductDescriptionContainer);
                }

            } else {
                const gbbProductVariantNotAvailableWarning = gbb.$("<div>").addClass("gbbProductVariantNotAvailableWarning");
                // const gbbProductVariantAddButton = gbb.$("<button>").addClass("gbbProductVariantAddButton")
                const gbbProductVariantAddButton = gbb
                    .$("<div>")
                    .addClass("gbbProductVariantAddButton")
                    // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                    // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                    .css("background", gbb.settings?.pageCustomizationData.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData.quickSettings.colors.buttonBgColor)
                    .css("color", gbb.settings?.pageCustomizationData.productCard?.productCardButtonTextColor || gbb.settings.pageCustomizationData.quickSettings.colors.buttonTextColor);

                if (addProductsPageArr.includes(noteAttribute)) {
                    gbbProductVariantAddButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.addToBoxButtonText));
                } else {
                    gbbProductVariantAddButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.addButtonText));
                }

                gbbProductVariantAddButton.on("click", (event) => {
                    gbbProductVariantAddButton.addClass("gbbDisabled");
                    setTimeout(function () {
                        gbbProductVariantAddButton.prop("disabled", false);
                        gbbProductVariantAddButton.removeClass("gbbDisabled");
                    }, 500);
                    gbb.utility.addVariantProductToCart(gbbProductVariantNotAvailableWarning, product, selectedVariantsCombination, noteAttribute, buttonEle, category, variantQuantity);

                });

                gbbProductVariantNotAvailableWarning.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.combinationNotAvailable));

                const gbbProductVariantOptionsContainer = gbb.$("<div>").addClass("gbbProductVariantOptionsContainer");
                gbbProductVariantOptionsContainer.append(gbbProductVariantNotAvailableWarning);

                if (gbb?.settings?.merchantInfo?.customSettings?.showOnlyAdminSelectedVariants) {
                    product.options = gbb.utility.returnOnlyAdminSelectedVariantOptions(product);
                }

                product.options?.forEach((option, index) => {
                    let name = option?.name || "";
                    let nameToCompare = name.replace(new RegExp("'", "g"), "");
                    const gbbProductVariantOptionContainer = gbb.$("<div>").addClass("gbbProductVariantOptionContainer").attr("optionId", nameToCompare);
                    const gbbProductVariantOptionLabel = gbb.$("<div>").addClass("gbbProductVariantOptionLabel");
                    gbbProductVariantOptionLabel.text(option.name);
                    gbbProductVariantOptionContainer.append(gbbProductVariantOptionLabel);
                    const gbbProductVariantOptionValuesContainer = gbb.$("<div>").addClass("gbbProductVariantOptionValuesContainer");

                    //set initial selection to the options of first variant product
                    selectedVariantsCombination[option.name] = product.variants[0].options[index];

                    option.values?.forEach((value, index) => {
                        let valueToCompare = value.replace(new RegExp("'", "g"), "");
                        // const gbbProductVariantOptionValue = gbb.$("<button>")
                        const gbbProductVariantOptionValue = gbb.$("<div>").addClass("gbbProductVariantOptionValue").attr("optionValueId", valueToCompare);
                        //.css("background",gbb.settings.pageCustomizationData?.quickSettings?.colors?.primaryColor)
                        //gbbProductVariantOptionValue.attr("optionValueId"+ value)
                        gbbProductVariantOptionValue.text(value);
                        if (option.values.length == 1 && value == "Default Title") {
                            gbbProductVariantOptionContainer.addClass("gbbProductVariantOptionContainerHidden");
                        }

                        gbbProductVariantOptionValuesContainer.append(gbbProductVariantOptionValue);

                        gbbProductVariantOptionValue.on("click", (event) => {
                            event.preventDefault();
                            
                            let activeVariant = gbbProductVariantOptionContainer.find(".gbbActiveVariant");
                            gbb.f.removeSelectedVariantStyle(activeVariant);
                            activeVariant.removeClass("gbbActiveVariant");
                            
                            gbbProductVariantOptionValue.addClass("gbbActiveVariant");
                            gbb.f.applySelectedVariantStyle(gbbProductVariantOptionValue);
                            selectedVariantsCombination[option.name] = value;
                            
                            if (isValidateInventoryEnabled) {
                                gbb.utility.validateATCAndVariantQuantityAddButton({ product, selectedVariantsCombination, variantQuantity, gbbProductQuantityAddButton, gbbProductVariantModalContainer })
                                let activeVariantInfo = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination);
                                let totalInventory = activeVariantInfo[0]?.quantityAvailable || 0;
                                if (totalInventory > 0) {
                                    gbb.$(".gbbVariantInventoryContainer").show();
                                    gbb.$(".gbbInventoryText").text((`${totalInventory} ${gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryInStockText) || "in Stock1"}`));
                                } else {
                                    gbb.$(".gbbVariantInventoryContainer").hide();
                                }
                            }
                            
                            gbb.utility.handleVariantSelection(
                                gbbProductVariantNotAvailableWarning,
                                product,
                                selectedVariantsCombination,
                                gbbProductVariantAddButton,
                                gbbProductAllImagesContainer,
                                gbbProductImageContainer,
                            );
                            gbb.utility.validateProductMaxQuantity({
                                currentQuantity:variantQuantity, 
                                product, 
                                selectedVariantsCombination, 
                                triggeredFor:"MODAL_QUANTITY_CHANGE"
                            })
                        });
                    });

                    gbbProductVariantOptionContainer.append(gbbProductVariantOptionValuesContainer);
                    gbbProductVariantOptionsContainer.append(gbbProductVariantOptionContainer);

                    let valueToCompare = product.variants[0].options[index];
                    valueToCompare = valueToCompare.replace(new RegExp("'", "g"), "");

                    let activeVariant = gbbProductVariantOptionsContainer.find(`[optionId='${nameToCompare}']`).find(`[optionValueId='${valueToCompare}']`);
                    activeVariant.addClass("gbbActiveVariant");
                    gbb.f.applySelectedVariantStyle(activeVariant);
                });
                gbbProductActionContainer.append(gbbProductButtonWrapper);
                gbbProductActionContainer.append(gbbProductVariantAddButton);

                let isThisNewDesign = gbbProductVariantModalMainContainer.hasClass("gbbProductVariantModalLayoutV2")
                gbbProductVariantModalDetailsContainer.append(gbbProductVariantOptionsContainer);
                if (isThisNewDesign) {
                    gbbProductVariantModalDetailsContainer.append(gbbProductActionContainer)
                }
                gbbProductVariantModalBodyContainer.append(gbbProductVariantModalDetailsContainer);
                gbbProductVariantModalContentContainer.append(gbbProductVariantModalBodyContainer);




                if (isThisNewDesign != true) { // repeating this block coz both conditions have different placements in the design structure
                    gbbProductVariantModalContentContainer.append(gbbProductActionContainer);
                }
                if (window.innerWidth < 600) {
                    gbbProductVariantModalContentContainer.append(gbbProductDescriptionContainer);
                }
            }

            
            if (window.innerWidth < 600) {
                gbbProductButtonWrapper.css("display", "none");
                gbbProductActionContainer.css("grid-template-columns", "1fr")
            }

            if (productFormDiv) {
                gbbProductVariantModalDetailsContainer.append(productFormDiv);
            }

            if (isValidateInventoryEnabled) {
                gbb.utility.validateATCAndVariantQuantityAddButton({ product, selectedVariantsCombination, variantQuantity, gbbProductQuantityAddButton, gbbProductVariantModalContainer })
            }
            gbbProductVariantModalContainer.append(gbbProductVariantModalContentContainer);
            gbbProductVariantModalMainContainer.append(gbbProductVariantModalContainer);
            gbb.$("body").append(gbbProductVariantModalMainContainer);
            gbb.$("body").css("overflow-y", "hidden");
            gbb.f.applyFontToProductPopupCard();
            gbb.gbbBrowser.emitCustomEvent({
                eventName: "gbb-variants-modal-open",
            })

            gbb.utility.validateProductMaxQuantity({
                currentQuantity:variantQuantity, 
                product, 
                selectedVariantsCombination,
                triggeredFor:"MODAL_QUANTITY_CHANGE"
            })
        },
        renderConditionNotificationToast: function (conditionMessage, categoryTitle) {
            const gbbConditionNotificationToastMainContainer = gbb.$("<div>").addClass("gbbConditionNotificationToastMainContainer");
            const gbbConditionNotificationToast = gbb.$("<div>").addClass("gbbConditionNotificationToast");
            const gbbConditionNotificationMessage = gbb.$("<div>").addClass("gbbConditionNotificationMessage");
            const gbbConditionNotificationClose = gbb.$("<div>").addClass("gbbConditionNotificationClose");
            gbbConditionNotificationClose.text("+")
            gbbConditionNotificationClose.on("click", () => {
                gbb.$(".gbbPageFooterHTML").find(".gbbConditionNotificationToast").remove()
            })
            if (categoryTitle) {
                conditionMessage = categoryTitle + " : " + conditionMessage
            }
            gbbConditionNotificationMessage.text(conditionMessage);
            gbbConditionNotificationToast.css("background", gbb.settings?.pageCustomizationData?.generalSettings?.conditionToast?.conditionToastBgColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)

            gbbConditionNotificationToast.css("color", gbb.settings?.pageCustomizationData?.generalSettings?.conditionToast?.conditionToastTextColor || "#ffffff")
            gbbConditionNotificationClose.css("color", gbb.settings?.pageCustomizationData?.generalSettings?.conditionToast?.conditionToastTextColor || "#ffffff")

            gbbConditionNotificationToast.append(gbbConditionNotificationMessage);
            gbbConditionNotificationToast.append(gbbConditionNotificationClose);

            //gbbConditionNotificationToastMainContainer.append(gbbConditionNotificationToast);
            gbb.$(".gbbPageFooterHTML").append(gbbConditionNotificationToast);
            setTimeout(() => {
                gbb.$(".gbbPageFooterHTML").find(".gbbConditionNotificationToast").remove()
            }, 6000)
        },

        getVisibilityMaps: function (data, cartData) {
            try {
                let visibilityMaps = {};

                const updateVisibility = (mapKey, type, id, value) => {
                    if (!visibilityMaps[mapKey][type]) {
                        visibilityMaps[mapKey][type] = {};
                    }
                    visibilityMaps[mapKey][type][id] = {
                        ...visibilityMaps[mapKey][type][id],
                        visibility: value
                    };
                };

                data.rules.forEach((rule, index) => {
                    const ruleKey = `r${index + 1}`; // Dynamic rule key (e.g., r1, r2, ...)
                    visibilityMaps[ruleKey] = {};

                    const actionType = rule.action.actionType; // "hide" or "show"
                    const isHideRule = actionType === "hide";

                    const conditionOperator = "OR" || "AND";

                    let cartProductIds = cartData.items.map((item) => String(item.product_id));
                    let cartTags = cartData.items.flatMap((item) => item.productTags || []);

                    let cartVariantTitles = cartData.items.flatMap((item) => item.options);


                    // Apply the rule to the specified products or tags
                    rule.trigger.selectionValues.forEach((selection) => {

                        // strip gid and stuff productId if exists;
                        if (selection.id && !selection.productId) {
                            selection.productId = selection.id.split("gid://shopify/Product/")[1];
                        }


                        let isVariantTitlePartOfCart = cartVariantTitles.filter(item => item.includes(selection.value)).length > 0;
                        let isAnyOfTheSelectionInCart = isVariantTitlePartOfCart || cartProductIds.includes(selection.productId) || cartTags.includes(selection.value);

                        if (conditionOperator == "AND" && !isAnyOfTheSelectionInCart) {
                            visibilityMaps[ruleKey] = {};
                            return;
                        }

                        if (conditionOperator == "OR" && !isAnyOfTheSelectionInCart) {
                            return;
                        }

                        let isActionBasedOnTag = rule.action.selectionType === "productTags";
                        let isActionBasedOnProduct = rule.action.selectionType === "products";
                        let isActionBasedOnVariantTitle = rule.action.selectionType === "variantTitle";
                        // Apply actions based on the rule
                        rule.action.selectionValues.forEach((actionSelection) => {
                            const visibilityValue = isHideRule ? -1 : 1;

                            if (actionSelection.id && !actionSelection.productId) {
                                actionSelection.productId = actionSelection.id.split("gid://shopify/Product/")[1];
                            }

                            if (isActionBasedOnTag) {
                                updateVisibility(ruleKey, 'tags', actionSelection.value, visibilityValue);
                            } else if (isActionBasedOnProduct) {
                                updateVisibility(ruleKey, 'products', actionSelection.productId, visibilityValue);
                            } else if (isActionBasedOnVariantTitle) {
                                updateVisibility(ruleKey, 'variantTitle', actionSelection.value, visibilityValue);
                            }
                        });
                    });
                });

                return visibilityMaps;
            } catch (error) {
                gbb.utility.debugConsole("error in getVisibilityMaps", error);
            }
        },

        applyVisibilityRulesToProducts: function (uniqueProductsByIds, visibilityMapsData, extraOptions) {
            try {
                let isPageTypeMultiCategory = extraOptions?.pageType == "MULTI_CATEGORY"

                let onlyShownProductIds = [];
                let onlyShownVariantIds = [];
                let productShownByRuleKey = {};
                let productHiddenByRuleKey = {};

                Object.keys(visibilityMapsData).forEach((ruleKey) => {
                    let rule = visibilityMapsData[ruleKey];

                    // Apply product visibility rules
                    Object.keys(rule.products || {}).forEach((productId) => {
                        let visibility = rule.products[productId].visibility;
                        if (visibility === 1) {
                            onlyShownProductIds.push(productId);
                        } else if (visibility === -1 && uniqueProductsByIds[productId]) {
                            uniqueProductsByIds[productId].available = false; // Hide the product
                            // product.available = false; // Hide the product based on tag
                            // product.available = false; // Hide the product based on tag
                        }
                    });

                    // Apply tag visibility rules
                    Object.keys(rule.tags || {}).forEach((tag) => {
                        let visibility = rule.tags[tag].visibility;
                        Object.values(uniqueProductsByIds).forEach((product) => {
                            if (product.tags && product.tags.includes(tag)) {
                                // If the product has the tag
                                if (visibility === 1 && !onlyShownProductIds.includes(product.productId)) {
                                    onlyShownProductIds.push(product.productId);
                                } else if (visibility === -1) {
                                    product.available = false; // Hide the product based on tag
                                }
                            } else {
                                // If the product doesn't have the tag
                                if (visibility === 1) {
                                    // Visibility is 1, but the product doesn't have the tag - ensure it's visible
                                    product.available = false; // Make sure the product is available
                                } else if (visibility === -1) {
                                    // Visibility is -1, but the product doesn't have the tag - hide the product
                                    // product.available = true; // Hide the product since the tag isn't present
                                }
                            }
                        });
                    });


                    // Step 1: Apply visibility rules and populate productVisibilityByRuleKey
                    Object.keys(rule.variantTitle || {}).forEach((itemTitle) => {
                        let visibility = rule.variantTitle[itemTitle].visibility;

                        Object.keys(uniqueProductsByIds).forEach((productId) => {
                            let product = uniqueProductsByIds[productId];
                            let onlyVariantsVisibleForThisProduct = [];

                            if (visibility === 1) {
                                if (!productShownByRuleKey[ruleKey]) productShownByRuleKey[ruleKey] = {};
                            } else if (visibility === -1) {
                                if (!productHiddenByRuleKey[ruleKey]) productHiddenByRuleKey[ruleKey] = {};
                            }

                            if (product.variants && product.variants.length > 0) {
                                product.variants.forEach((variant) => {
                                    let variantTitleOptionArray = variant.variantTitle?.split(" / ") || [];

                                    // Match rule logic (AND/OR)
                                    let matchResults = Object.keys(rule.variantTitle).map((ruleItemTitle) => {
                                        return variantTitleOptionArray.some((variantTitle) => ruleItemTitle.trim().toLowerCase() === variantTitle.trim().toLowerCase());
                                    });

                                    let operationType = "AND";
                                    let checkIfMatchFound;

                                    if (operationType === "AND") {
                                        checkIfMatchFound = matchResults.every((result) => result === true);
                                    } else if (operationType === "OR") {
                                        checkIfMatchFound = matchResults.some((result) => result === true);
                                    }

                                    // Apply visibility based on match results
                                    if (checkIfMatchFound) {
                                        if (visibility === 1) {
                                            productShownByRuleKey[ruleKey][productId] = productShownByRuleKey[ruleKey][productId] || { productId: productId, variants: [] };
                                            productShownByRuleKey[ruleKey][productId].variants.push(variant.variantId);
                                        } else if (visibility === -1) {
                                            productHiddenByRuleKey[ruleKey][productId] = productHiddenByRuleKey[ruleKey][productId] || { productId: productId, variants: [] };
                                            productHiddenByRuleKey[ruleKey][productId].variants.push(variant.variantId);
                                        }
                                    }
                                });
                            }
                        });
                    });

                });


                // Step 2: Update uniqueProductsByIds based on merged results
                let finalShownProducts = {};
                let validProductsToShowFromUniqueProducts;
                // Merge all productShownByRuleKey entries
                Object.keys(productShownByRuleKey).forEach((ruleKey) => {
                    Object.assign(finalShownProducts, productShownByRuleKey[ruleKey]);
                });

                // Apply visibility from the merged shown products
                Object.keys(finalShownProducts).forEach((productId) => {
                    let visibilityData = finalShownProducts[productId];
                    let product = uniqueProductsByIds[productId];

                    if (product) {
                        product.variants = product.variants.filter((variant) => visibilityData.variants.includes(variant.variantId));
                        product.available = product.variants.length > 0;
                    }
                });

                // Apply hidden rules
                Object.keys(productHiddenByRuleKey).forEach((ruleKey) => {
                    Object.keys(productHiddenByRuleKey[ruleKey]).forEach((productId) => {
                        if (uniqueProductsByIds[productId]) {
                            // Remove the variants that should be hidden based on the visibilityData
                            uniqueProductsByIds[productId].variants = uniqueProductsByIds[productId].variants.filter((variant) => {
                                if (productHiddenByRuleKey[ruleKey][productId].variants.includes(variant.variantId)) {
                                    return false; // Remove this variant
                                } else {
                                    variant.available = true; // Keep this variant and mark it as available
                                    return true;
                                }
                            });

                            // If all variants are hidden, mark the product as unavailable
                            if (uniqueProductsByIds[productId].variants && uniqueProductsByIds[productId].variants.length > 0) {
                                let allVariantsAreHidden = uniqueProductsByIds[productId].variants.every((variant) => variant.available === false);
                                if (allVariantsAreHidden) {
                                    uniqueProductsByIds[productId].available = false;
                                }
                            } else {
                                uniqueProductsByIds[productId].available = false; // If no variants remain, mark the product as unavailable
                            }
                        }
                    });
                });


                // Collect product IDs and variant IDs that are set to be shown
                let productIdsToBeShown = Object.keys(uniqueProductsByIds).filter((productId) => uniqueProductsByIds[productId].available);




                onlyShownVariantIds = productIdsToBeShown.reduce((variantIds, productId) => {
                    let product = uniqueProductsByIds[productId];
                    variantIds.push(...product.variants.map((variant) => variant.variantId));
                    return variantIds;
                }, []);

                // Final result
                return { onlyShownProductIds, uniqueProductsByIds, onlyShownVariantIds };

                // The final result
                //   return { onlyShownProductIds, uniqueProductsByIds, onlyShownVariantIds };
            } catch (error) {
                gbb.utility.debugConsole("error applyVisibilityRulesToProducts", error);
            }

        },


        filterOutBasedOnConditionalLogic: function (allProducts) {
            try {
                let cartData = gbb.state.giftBoxCartData;
                let conditionalLogic = gbb.settings.stepsConfigurationData?.conditionalLogic;

                if (!conditionalLogic || !conditionalLogic.isEnabled || conditionalLogic.rules.length < 1) {
                    return allProducts;
                }

                let visibilityMapsData = gbb.f.getVisibilityMaps(conditionalLogic, cartData);

                let uniqueProducts = JSON.parse(JSON.stringify(allProducts));
                let uniqueProductsByIds = gbb.utility.convertArrayToObject(uniqueProducts, "productId");


                let applyVisibilityRulesResult = gbb.f.applyVisibilityRulesToProducts(uniqueProductsByIds, visibilityMapsData);

                // let { onlyShownProductIds, uniqueProductsByIds: updatedProductsByIds } = 
                let onlyShownProductIds = applyVisibilityRulesResult.onlyShownProductIds || [];
                let onlyShownVariantIds = applyVisibilityRulesResult.onlyShownVariantIds || [];
                uniqueProductsByIds = applyVisibilityRulesResult.uniqueProductsByIds


                let resultFilteredArrayOfUniqueProducts;
                if (onlyShownProductIds.length > 0) {
                    resultFilteredArrayOfUniqueProducts = onlyShownProductIds.map(itemId => uniqueProductsByIds[itemId]);
                } else {
                    resultFilteredArrayOfUniqueProducts = Object.values(uniqueProductsByIds).filter(product => product.available !== false);
                }

                // clean undefined and null values
                resultFilteredArrayOfUniqueProducts = resultFilteredArrayOfUniqueProducts.filter(item => item);

                if (resultFilteredArrayOfUniqueProducts.length < 1) {
                    return allProducts;
                }


                return resultFilteredArrayOfUniqueProducts;

            } catch (err) {
                gbb.utility.debugConsole("error came", err);
                return allProducts;
            }
        },


        filterOutBasedOnConditionalLogic_MultipleCategories: function (allCategories) {
            try {
                let cartData = gbb.state.giftBoxCartData;
                let conditionalLogic = gbb.settings.stepsConfigurationData?.conditionalLogic;

                if (!conditionalLogic.isEnabled || conditionalLogic.rules.length < 1) {
                    return allCategories;
                }

                let visibilityMapsData = gbb.f.getVisibilityMaps(conditionalLogic, cartData);

                Object.keys(allCategories).forEach(categoryKey => {
                    let category = allCategories[categoryKey];
                    let uniqueProducts = category.uniqueProductsData;
                    let uniqueProductsByIds = gbb.utility.convertArrayToObject(uniqueProducts, "productId");

                    let extraOptions = {
                        pageType: "MULTIPLE_CATEGORY"
                    }
                    let applyVisibilityRulesResult = gbb.f.applyVisibilityRulesToProducts(uniqueProductsByIds, visibilityMapsData, extraOptions);
                    // applyVisibilityRulesResult = gbb.f.applyVisibilityRulesToVariants(uniqueProductsByIds, visibilityMapsData);
                    let onlyShownProductIds = applyVisibilityRulesResult.onlyShownProductIds || [];
                    uniqueProductsByIds = applyVisibilityRulesResult.uniqueProductsByIds
                    let onlyShownVariantIds = applyVisibilityRulesResult.onlyShownVariantIds || [];


                    let tempValue;
                    if (onlyShownProductIds.length > 0 || onlyShownVariantIds.length > 0) {
                        tempValue = onlyShownProductIds.map(productId => uniqueProductsByIds[productId])
                        // .filter(product => product && product.available !== false);
                    }
                    //  else if (onlyShownProductIds.length < 1 && onlyShownVariantIds.length < 1) {
                    //     tempValue = [];
                    // }
                    else {
                        tempValue = Object.values(uniqueProductsByIds).filter(product => product && product.available !== false);
                    }

                    // when the end result will contain no product, we will just return all the data
                    // earlier we used to return all the data. now we dont
                    tempValue = tempValue.filter(item => item);
                    if (tempValue.length > 0) {
                        category.uniqueProductsData = tempValue;
                    } else {

                        category.categoryVisibility = {
                            hide: true,
                            "reason": "NO_PRODUCTS_MEET_CONDITION_LOGIC"
                        }

                    }

                });

                // just before returning check 
                // if all the categories have category.categoryVisibility.hide as true
                // if at least one of them has not hide as true 
                //then just delete all the others
                let allCategoriesVisibilityHidden = Object.values(allCategories).map((category) => {
                    return category.categoryVisibility?.hide || false
                });

                // allCategoriesVisibility =   if 
                if (allCategoriesVisibilityHidden.includes(false)) {
                    // allCategories = allCategories.filter((category)=>{
                    //     return category.categoryVisibility?.hide == false
                    // })
                    Object.keys(allCategories).forEach((categoryKey) => {
                        if (allCategories[categoryKey].categoryVisibility?.hide == true) {
                            delete allCategories[categoryKey]
                        }
                    })
                }


                return allCategories;
            } catch (err) {
                console.error("Error occurred:", err);
                return allCategories;
            }
        },




        filterOutBasedOnConditionalLogic2: function (allProducts) {
            try {
                let cartData = gbb.state.giftBoxCartData;

                let conditionalLogic = gbb.settings.stepsConfigurationData?.conditionalLogic;


                if (!conditionalLogic.isEnabled || conditionalLogic.length < 1) {
                    return allProducts;
                }



                let visibilityMapsData = gbb.f.getVisibilityMaps(conditionalLogic, cartData);

                let visibilityMapForProducts = visibilityMapsData.visibilityMapForProducts;
                let visibilityMapForTags = visibilityMapsData.visibilityMapForTags



                let uniqueProducts = JSON.parse(JSON.stringify(allProducts));


                let rulesVisibilityArrayForProducts = gbb.utility.convertObjectToArray(visibilityMapForProducts);
                let rulesVisibilityArrayForTags = gbb.utility.convertObjectToArray(visibilityMapForTags);

                let uniqueProductsByIds = gbb.utility.convertArrayToObject(uniqueProducts, "productId");

                let onlyShownProducts = [];




                let resultFilteredArrayOfUniqueProducts = [];

                for (let i = 0; i < rulesVisibilityArrayForProducts.length; i++) {
                    let rule = rulesVisibilityArrayForProducts[i];

                    // if we find 1;
                    Object.keys(rule).forEach(item => {
                        if (rule[item] == 1) {
                            onlyShownProducts.push(item)
                        }

                        if (rule[item] == -1 && uniqueProductsByIds[item]) {
                            // hide the product
                            uniqueProductsByIds[item]["available"] = false
                            // uniqueProductsById
                        }
                    });
                }


                for (let i = 0; i < rulesVisibilityArrayForTags.length; i++) {
                    let rule = rulesVisibilityArrayForTags[i];


                    Object.keys(rule).forEach(item => {
                        let isInternalOperator = "OR";
                        let currentMatchedItems;
                        if (isInternalOperator == "OR") {
                            currentMatchedItems = uniqueProducts.filter((product) => {
                                if (product.tags.includes(item)) {
                                    return product;
                                }

                            })
                        } else if (isInternalOperator == "AND") {
                            //  write an operator similar to above but with AND
                            let currentMatchedItems = uniqueProducts.filter((product) => {
                                // if every 
                                // rule is an object so we cant use includes



                            })

                        }

                        // clean currentMatchedItems to not return undefined


                        if (rule[item] == 1) {
                            currentMatchedItems.forEach((product) => {
                                if (product?.productId) {
                                    onlyShownProducts.push(product?.productId)
                                }
                            })
                        }

                        if (rule[item] == -1) {
                            // hide the product
                            // find the detail in uniqueProductsByIds and set available to false
                            let findSameTagValue = uniqueProducts.find((product) => {
                                return product.tags.includes(item)
                            })

                            if (findSameTagValue && uniqueProductsByIds[findSameTagValue.productId]) {
                                uniqueProductsByIds[findSameTagValue.productId]["available"] = false
                            }
                        }
                    });

                }

                if (onlyShownProducts.length > 0) {
                    let onlyShownProductsData = onlyShownProducts.map((item) => {
                        return uniqueProductsByIds[item]
                    });

                    // return onlyShownProductsData;
                    resultFilteredArrayOfUniqueProducts = onlyShownProductsData;
                } else {
                    Object.keys(uniqueProductsByIds).forEach(item => {
                        if (uniqueProductsByIds[item]["available"] == false) {
                            delete uniqueProductsByIds[item]
                        }
                    });

                    let uniqueProductsArray = gbb.utility.convertObjectToArray(uniqueProductsByIds);
                    // return uniqueProductsArray
                    resultFilteredArrayOfUniqueProducts = uniqueProductsArray
                }


                return resultFilteredArrayOfUniqueProducts;

            } catch (err) {
                gbb.utility.debugConsole("error came", err)
                return allProducts;
            }
        },
        filterOutBasedOnConditionalLogic_MultipleCategories2: function (allCategories) {
            try {
                let cartData = gbb.state.giftBoxCartData;
                let conditionalLogic = gbb.settings.stepsConfigurationData?.conditionalLogic;

                // let allCategories = gbb.gbbAddProductsPage.state.productPageData.categories;
                if (!conditionalLogic.isEnabled || conditionalLogic.length < 1) {
                    return allCategories;
                }

                let visibilityMapsData = gbb.f.getVisibilityMaps(conditionalLogic, cartData);

                let visibilityMapForProducts = visibilityMapsData.visibilityMapForProducts;
                let visibilityMapForTags = visibilityMapsData.visibilityMapForTags;

                Object.keys(allCategories).forEach(categoryKey => {
                    let category = allCategories[categoryKey];
                    let uniqueProducts = category.uniqueProductsData;

                    let uniqueProductsByIds = gbb.utility.convertArrayToObject(uniqueProducts, "productId");

                    let rulesVisibilityArrayForProducts = gbb.utility.convertObjectToArray(visibilityMapForProducts);
                    let rulesVisibilityArrayForTags = gbb.utility.convertObjectToArray(visibilityMapForTags);

                    let onlyShownProducts = [];

                    rulesVisibilityArrayForProducts.forEach(rule => {
                        Object.keys(rule).forEach(productId => {
                            if (rule[productId] == 1 && uniqueProductsByIds[productId]) {
                                onlyShownProducts.push(productId);
                            } else if (rule[productId] == -1 && uniqueProductsByIds[productId]) {
                                uniqueProductsByIds[productId]["available"] = false;
                            }
                        });
                    });

                    for (let i = 0; i < rulesVisibilityArrayForTags.length; i++) {
                        let rule = rulesVisibilityArrayForTags[i];

                        let operator = "OR";
                        let currentMatchedItems;
                        if (operator == "OR") {
                            Object.keys(rule).forEach(item => {
                                currentMatchedItems = uniqueProducts.filter((product) => {
                                    if (product.tags.includes(item)) {
                                        return product;
                                    }
                                })



                                // clean currentMatchedItems to not return undefined


                                if (rule[item] == 1) {
                                    currentMatchedItems.forEach((product) => {
                                        if (product?.productId) {
                                            onlyShownProducts.push(product?.productId)
                                        }
                                    })
                                }

                                if (rule[item] == -1) {
                                    // hide the product
                                    // find the detail in uniqueProductsByIds and set available to false
                                    let findSameTagValue = uniqueProducts.find((product) => {
                                        return product.tags.includes(item)
                                    })

                                    if (findSameTagValue && uniqueProductsByIds[findSameTagValue.productId]) {
                                        uniqueProductsByIds[findSameTagValue.productId]["available"] = false
                                    }
                                }
                            });
                        } else {
                            let isMatchedItemForEveryRule;




                        }

                    }

                    let categoryUniqueProductsData;
                    if (onlyShownProducts.length > 0) {
                        category.uniqueProductsData = onlyShownProducts.map(productId => uniqueProductsByIds[productId]).filter(product => product.available !== false);
                    } else {
                        category.uniqueProductsData = Object.values(uniqueProductsByIds).filter(product => product.available !== false);

                    }
                });

                return allCategories;
            } catch (err) {
                console.error("Error occurred:", err);
                // It seems there's a missing definition for allCategories here in the catch block. Assuming it should return an empty object or similar fallback.
                return {}; // or perhaps return the input unmodified or as best fits your error handling strategy
            }
        },
        convertCamelCaseToKebabCase: function (str) {
            try {
                return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();

            } catch (error) {
                gbb.utility.debugError("error in convertCamelCaseToKebabCase", error);
            }
        },
        setCustomDesignConfigurationValues: function () {
            try {
                let root = document.documentElement;
                let pageCustomizationData = gbb.settings.pageCustomizationData || {}
                const keysToMap = ["productCard", "navigationBanner", "cartFooter"]
                keysToMap.forEach((key) => {
                    let currentKey = pageCustomizationData[key] || {}
                    Object.keys(currentKey).forEach((key) => {
                        let value = currentKey[key];
                        if (value) {
                            let _key = gbb.f.convertCamelCaseToKebabCase(key);
                            root.style.setProperty(`--gbb-${_key}`, value);
                        }

                    })
                })

            } catch (error) {
                gbb.utility.debugConsole("error in setCustomDesignConfigurationValues", error);
            }
        },
        initialize: async function (jQuery) {
            //renderLandingPage(); ->

            //show a loading screen
            gbb.$(".gbbPageFooterHTML").html("<div class='gbbLoadingScreen'><div class='gbbLoadingScreenSpinner'>    </div></div>");
            gbb.$(".gbbLoadingScreen").css("background", gbb?.settings?.app?.loadingBgColor);
            //TODO uncomment
            let tmpCartSettings = await gbb.f.getSettings();
            // tmpCartSettings = gbb.f.modifySettings(tmpCartSettings);
            gbb.f.setSettings(tmpCartSettings)
            gbb.f.setCustomDesignConfigurationValues();
            gbb.f.setSelectors()
            gbb.f.setDefaultThemeStyles();
            // gbb.f.setCustomStyling()
            // gbb.state.page_type = gbb.f.getPageType();
            gbb.elements = gbb.f.getElements(gbb.settings);
            // if ("" === gbb.state.page_type) return false;
            gbb.utility.setLanguageLocale();
            gbb.utility.gbbMultiLangOverrider();
            return gbb.f.bootstrap(gbb.settings);
        },
        globalListener: async function (settings) {
            let isIntervalActive = false
            //if app is disabled reurn
            if (settings?.app?.disableApp) {
                return "<div>App is unavailable</div>"
            } else {
                //gbb.gbbPage.init();
                // initialization will call get settings
                // and therefore we will have the data globally
                //
                gbb.state.cartData = await gbb.utility.getCart()

                // gbb.gbbMainPage.init();
                // gbb.gbbFooter.init();
                // gbb.utility.debugConsole(gbb.settings.languageData);

                gbb.giftboxbuilderPage.init();
            }
        },

        modifySettings: function (settings) {
            try {
                let currentBundleTemplate = settings.stepsConfigurationData.bundleDesignTemplate;

                //    let oldSettings = JSON.parse(JSON.stringify(settings))

                if (currentBundleTemplate && settings.pageCustomizationData?.templateLevelConfig) {
                    settings.pageCustomizationData = settings.pageCustomizationData?.templateLevelConfig[currentBundleTemplate] || settings.pageCustomizationData
                }



                return settings;
            } catch (e) {
                gbb.utility.debugConsole("error in modifySettings", e)
                return settings;
            }
        },
    },
    utility: {
        getcachedProductData: async function (fetchsixtyProductsEachStep) {
            // convert map to array 
            // let cachedProductData = Array.from(gbb.state.cachedProductData.entries());
            // call getProductDataV2 data in batch of 20
            setTimeout(async () => {
                // gbb.utility.debugConsole("getcachedProductData")
                while (fetchsixtyProductsEachStep.length > 0) {
                    let batch = fetchsixtyProductsEachStep.splice(0, 20)
                    let apiCalls = []
                    for (let i = 0; i < batch.length; i++) {
                        apiCalls.push(gbb.utility.getProductDataV2(batch[i]))
                    }
                    await Promise.all(apiCalls)
                }
            },
                1000)

        },
        getcachedProductDataForGraphql: async function (fetchsixtyProductsEachStep) {
            if (gbb.settings.merchantInfo.storefrontAccessToken) {

                // fetchsixtyProductsEachStep.forEach(item=> {
                //     item = "gid://Product/"+ item
                // });

                for (let i = 0; i < fetchsixtyProductsEachStep.length; i++) {
                    let item = fetchsixtyProductsEachStep[i];
                    fetchsixtyProductsEachStep[i] = "gid://shopify/Product/" + item
                    // "gid://shopify/Product/9170602688797"
                }

                let graphQLProductsData = [];

                setTimeout(async () => {
                    // gbb.utility.debugConsole("getcachedProductData")
                    while (fetchsixtyProductsEachStep.length > 0) {
                        let batch = fetchsixtyProductsEachStep.splice(0, 20)
                        // let starttime = 
                        // console.time("fetch-1");
                        let graphQLFetchedData = await gbb.graphQlUtility.getProductsDataByIds(fetchsixtyProductsEachStep.splice(0, 20))
                        graphQLProductsData.push(...graphQLFetchedData)
                        // console.timeEnd("fetch-1")

                        // let apiCalls = []
                        // for (let i = 0; i < batch.length; i++) {
                        //     // apiCalls.push(gbb.utility.getProductDataV2(batch[i]))
                        //     apiCalls.push(gbb.graphQlUtility.getProductsDataByIds(batch[i]))
                        // }
                        // console.time("fetch-2-sync");
                        // await Promise.all(apiCalls)
                        // console.timeEnd("fetch-2-sync");



                    }

                },
                    1000)
            }
            // convert map to array 
            // let cachedProductData = Array.from(gbb.state.cachedProductData.entries());
            // call getProductDataV2 data in batch of 20

        },
        getDynamicDiscountCode: async function () {
            // gbb.utility.getCartDataAfterDiscount()
            // gbb.utility.debugConsole('dyamic called')


            // if kite integration is enabeld then also retyrn early

            let discountData = gbb.settings.discountsData || {}
            if (discountData?.discountMode == 'PRODUCT_SPECIFIC_DISCOUNT' && discountsData?.isKiteIntegrationEnabled) {
                //no need to compute code, just send it back early
                return
            }
            

            if (!gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive) {
                return;
            }

            // let cartData = gbb.gbbDiscountComponent.f.discountEligibleCartData();
            // const bundleQuantity = cartData.bundleQuantity;

            // let cartData = gbb.state.giftBoxCartData;
            // const productIdsPresentInCart = cartData?.items?.map((item) => {
            //     return item?.product_id
            // })


            let bundleDataObj = gbb.utility.calculateCartDiscount();

            const productIdsPresentInCart = bundleDataObj?.cartProductListForDiscounts.map(item => parseInt(item))
            const variantIdsPresentInCart = bundleDataObj?.cartVariantListForDiscounts.map(item => parseInt(item))
            let VariantListPricePresentInCart = bundleDataObj?.cartVarientPriceListForDiscounts;

            let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();
            // let cartTotalAmount = bundleDataObj.cartTotalAmount;
            let cartSubtotalAmount = bundleDataObj.cartSubTotal;

            VariantListPricePresentInCart = VariantListPricePresentInCart.map((price) => {
                return price / parseFloat(activeCurrencyRate)
            })



            let cartValue = cartSubtotalAmount / 100;
            let convertCartValueToStoreCurrencyValue = cartValue / activeCurrencyRate

            let cartDiscount = bundleDataObj.cartDiscount / parseFloat(activeCurrencyRate)
            let cartTotalQty = bundleDataObj.cartTotalQty;
            let discountAmountToBeApplied = cartDiscount / 100;

            if (discountAmountToBeApplied > 0 == false) {
                // gbb.utility.debugConsole("discountAmountToBeApplied is 0")
                return;
            }

            let discountsPerBoxWithCorrectedPrices = {}
            for (let i = 0; i < Object.keys(bundleDataObj?.discountsPerBox).length; i++) {
                let _boxKey = Object.keys(bundleDataObj.discountsPerBox)[i];
                let _boxValue = JSON.parse(JSON.stringify(bundleDataObj.discountsPerBox[_boxKey]));
                _boxValue.boxDiscount = (_boxValue.boxDiscount / 100) / activeCurrencyRate
                _boxValue.boxSubTotal = (_boxValue.boxSubTotal / 100) / activeCurrencyRate
                _boxValue.boxTotalAmount = (_boxValue.boxTotalAmount / 100) / activeCurrencyRate

                discountsPerBoxWithCorrectedPrices[_boxKey] = _boxValue;
            }


            let bodyToBePassed = {
                type: "quantity",
                currency: activeCurrencyRate,
                cartValue: convertCartValueToStoreCurrencyValue,
                bundleId: gbb.state.bundleId,
                discountsPerBox: discountsPerBoxWithCorrectedPrices,
                cartQuantity: cartTotalQty,
                productIds: productIdsPresentInCart,
                variantIds: variantIdsPresentInCart,
                productHandles: bundleDataObj?.cartProductHandlesForDiscounts,
                variantListPrice: VariantListPricePresentInCart,
                discountValue: discountAmountToBeApplied,
                discountCodePrefix: gbb.gbbDiscountComponent.state.discountCodePrefix,
                deviceDetails: navigator && navigator.userAgent ? navigator.userAgent : "Couldnt find device details"
            }

            if (gbb.settings.discountsData.discountMode === "FIXED_BUNDLE_PRICE") {
                bodyToBePassed["type"] = "quantity"
            }
            else if (gbb.gbbDiscountComponent.state.currentDiscountRule?.type === "quantity") {
                bodyToBePassed["type"] = gbb.gbbDiscountComponent.state.currentDiscountRule.type
            } else if (gbb.gbbDiscountComponent.state.currentDiscountRule?.type === "amount") {
                bodyToBePassed["type"] = gbb.gbbDiscountComponent.state.currentDiscountRule.type
            } else {
                bodyToBePassed["type"] = "amount"
            }

            let endPoint = "/dynamicDiscountCodeV2";
            const subscriptionPlanExists = gbb.gbbReviewPage.f.checkIfSubscriptionPlanExists();
            if (subscriptionPlanExists && gbb.gbbBrowser.getSubscriptionType() == "saveSubscription") {
                bodyToBePassed["enableRecurringDiscounts"] = gbb.settings?.stepsConfigurationData?.enableRecurringDiscounts || false;
                bodyToBePassed["subscriptionDiscount"] = true;
                endPoint = "/dynamicDiscountCodeV2"
            }
            const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()
            if (isPurchaseTypeSubscription) {
                bodyToBePassed["enableRecurringDiscounts"] = gbb.settings?.stepsConfigurationData?.enableRecurringDiscounts || false;
                bodyToBePassed["subscriptionDiscount"] = true;
                endPoint = "/dynamicDiscountCodeV2"
            }
            await fetch("/apps/" + gbb.state.gbbUrl + `${endPoint}?bundleId=${gbb.state.bundleId}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(bodyToBePassed)
            }).then((response) => {
                return response.json();
            }).then((data) => {
                if (data) {
                    gbb.utility.debugConsole("discount code", data.data.code);
                    gbb.gbbDiscountComponent.state.discountCode = data.data.code;
                }
            }).catch((error) => {
                gbb.utility.debugConsole(error);
            });
        },
        setCachedGraphqlData: function (data) {
            try {
                // TODO: graphql or REST
                // cachedProductDataGraphql or cachedProductData..... confused
                let cachedProductData = gbb.state.cachedProductDataGraphql;

                for (let i = 0; i < data.length; i++) {
                    let item = data[i];
                    let productId = item?.id;
                    let productData = item;
                    cachedProductData.set(productId, productData)
                }
            } catch (e) {
                gbb.utility.debugConsole("error in setCachedGraphqlData", e)
            }
        },
        getLocale: function () {
            if (window.Shopify && window.Shopify.locale) {
                return window.Shopify.locale
            } else {
                return "en"
            }
        },
        getCountry: function () {
            if (window.Shopify && window.Shopify.country) {
                return Shopify.country
            }
        },
        setLanguageLocale: function () {
            let locale = gbb.utility.getLocale()
            gbb.state.languageMode = gbb.settings.languageData.languageMode
            if (gbb.settings.languageData && gbb.settings.languageData.languageMode == "SINGLE") {
                locale = "en"
            }

            if (!gbb.settings.languageData[locale]) {
                locale = "en"
            }
            gbb.settings.languageData = gbb.settings.languageData[locale]
        },
        getNavItem: function (id) {
            let navigationItems = gbb.state.navigationItems;
            let navigationItem = navigationItems.filter(function (item) {
                return item.id === id;
            })
            return navigationItem[0];
        },
        disableElement: function (element, timeInMs) {
            //use this function to disable element for a specific time,
            // most likely to prevent double click
            element.prop("disabled", true);
            element.addClass("gbbDisabled");
            if (timeInMs >= 0) {
                setTimeout(function () {
                    element.prop("disabled", false);
                    element.removeClass("gbbDisabled");
                }, timeInMs);
            }
        },
        getNextNavigationItem: function () {

            let navigationItems = gbb.gbbModal.state.navigationItems;
            let currentNavigationId = gbb.gbbModal.state.currentNavigationId;

            let currentNavigationItem = gbb.gbbModal.f.getNavItem(currentNavigationId);

            // find the index of the current navigation item
            let currentNavigationIndex = navigationItems.indexOf(currentNavigationItem);
            // gbb.utility.debugConsole(currentNavigationIndex);
            // get the next navigation item making sure its not the last one, if its then return null
            if (currentNavigationIndex === navigationItems.length - 1) {
                return null;
            }
            else {
                return navigationItems[currentNavigationIndex + 1];
            }
        },
        isNavElementLast: function (id) {
            // if it is last then return null
            let navigationItems = gbb.gbbModal.state.navigationItems;
            let currentNavigationId = id;

            //check if the passed id is the last one
            let currentNavigationItem = gbb.gbbModal.f.getNavItem(currentNavigationId);
            let currentNavigationIndex = navigationItems.indexOf(currentNavigationItem);
            if (currentNavigationIndex === navigationItems.length - 1) {
                return true;
            }
            else {
                return false;
            }
        },
        getDate: function (date) {
            let d = new Date(date);
            let month = "" + (d.getMonth() + 1);
            let day = "" + d.getDate();
            let year = d.getFullYear();

            if (month.length < 2) month = "0" + month;
            if (day.length < 2) day = "0" + day;

            return [year, month, day].join("-");
        },
        addToCart: async function ({ variant, parent, qty = 1 }, noteAttribute, category = undefined, defaultProduct = undefined) {
            try {
                if (qty == 0) {
                    return
                }
                let data = {
                    updates: { [variant.id]: qty },
                    attributes: {
                        [variant.id]: noteAttribute,
                    }
                }

                if (category && category != "") {
                    data.attributes.category = category
                    data.attributes.categoryName = gbb.gbbAddProductsPage?.state?.productPageData?.categories[category].title || category
                }

                if (defaultProduct && defaultProduct != "") {
                    data.attributes.defaultProduct = true
                }


                // if properties and variant ids are the same then just add their quantities respective



                await gbb.utility.updateCartV2(data)
                if (false && gbb.$(".gbbProductsCardLayoutV2").length > 0) {
                    let isCurrentPageExhausedATCFooterAnimation = gbb?.gbbAddProductsPage?.state?.pagesWhichHaveExhaustedATCFooterAnimation?.includes(gbb?.state?.currentPageId);
                    //true replace true with actual toggle key when implemented from admin
                    let isATCAnimationEnabled = gbb?.gbbAddProductsPage?.state?.isAnimateFooterOnATCEnabled
                    let isAddingFirstProductToCart = gbb?.state?.giftBoxCartData?.items?.length == 1 && gbb?.state?.giftBoxCartData?.items[0]?.quantity == 1
                    if (isATCAnimationEnabled && (isAddingFirstProductToCart || !isCurrentPageExhausedATCFooterAnimation)) {
                        let currentPageId = gbb?.state?.currentPageId;
                        setTimeout(() => {
                            let isFooterOpen = gbb?.gbbAddProductsPage?.state?.showBoxProductsInFooter || false
                            if (!isFooterOpen) {
                                gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter()
                                !isCurrentPageExhausedATCFooterAnimation && gbb?.gbbAddProductsPage?.state?.pagesWhichHaveExhaustedATCFooterAnimation?.push(currentPageId)
                                setTimeout(() => gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter(), 3000)
                            }
                        }, 100)// doing this cause once file is loaded then will can get smooth animation without setTimeout its rendering the open footer direct
                    }
                }
            } catch (error) {
                gbb.utility.debugError("gbb-utility-addToCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        updateCart: async function (data) {
            try {
                let result = await gbb.$.ajax({
                    type: "POST",
                    url: "/cart/update.js",
                    data: data,
                    dataType: "json",
                });
                return result
            } catch (error) {
                gbb.utility.debugError("gbb-utility-updateCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        updateCartV2: async function (data, noteAttribute) {
            try {

                let variantId = Object.keys(data.updates)[0];

                let quantity = data.updates[variantId];

                let originForVariantDetails = data.attributes[variantId] == "addonProduct" ? "addonProducts" :null
                let productItem = gbb.utility.getVariantDetailsFromCurrentProductsDataSet(variantId, originForVariantDetails) || {};

                if (productItem && productItem != "undefined") {
                }
                else {
                    // gbb.utility.debugConsole("variantId is undefined");
                    // return;
                }

                let result;
                //in data.attributes we get key value pair, but we only need the value
                let attributes = data?.attributes || {}
                // let additionalProperties = {}
                let _properties = {
                    "_boxProduct": data?.attributes[variantId],
                    // "_Bundle ID": gbb.state.bundleId,
                    "Bundle": gbb.settings?.stepsConfigurationData?.bundleName || "",
                    "Box ID": gbb.state?.activeBoxId?.split("box")[1] || 1,

                    "_uniqueGbbItemKey": data?.additionalInfo?._uniqueGbbItemKey || gbb.utility.getUniqueIdForVariant({ variantId, attributes: data.attributes }),
                    ...gbb.state.variantCustomProperties
                }
                if (data?.attributes[variantId] == 'addonProduct') { 
                    _properties["_addon_product"] = true;
                    // _properties["_addon_offer_id"] = gbb.gbbAddonProducts.state.offerId
                }
                //this is for storing the  category name on multiple categories step
                if (data?.attributes.category) {
                    _properties["_Category"] = data?.attributes.category;
                    _properties["_CategoryName"] = data?.attributes.categoryName;
                }

                if (data?.attributes.defaultProduct) {
                    _properties["_DefaultProduct"] = "Yes";
                }

                if (data?.attributes[variantId] == "giftMessage") {
                    let msgAttributes = gbb.utility.prepareMsgAttributesForCart();
                    if (msgAttributes.message) {
                        _properties["Message"] = msgAttributes.message
                    }

                    if (msgAttributes.recipientName) {
                        _properties["Recipient Name"] = msgAttributes.recipientName
                    }

                    if (msgAttributes.senderName) {
                        _properties["Sender Name"] = msgAttributes.senderName
                    }

                    if (msgAttributes.email) {
                        _properties["Recipient Email"] = msgAttributes.email
                    }
                    if (msgAttributes._videoMsgId) {
                        _properties["_videoMsgId"] = msgAttributes._videoMsgId
                        _properties["Video Recorded"] = msgAttributes._videoMsgId ? "yes" : "";
                    }
                    if (msgAttributes._gbbEmailDeliveryDate) {
                        _properties["_gbbEmailDeliveryDate"] = msgAttributes._gbbEmailDeliveryDate;
                    }
                    if (msgAttributes._gbbEmailDeliveryOption) {
                        _properties["_gbbEmailDeliveryOption"] = msgAttributes._gbbEmailDeliveryOption;
                    }

                    // if(msgAttributes.customerUploads){
                    //     _properties["Customer Uploads"] = msgAttributes.customerUploads;
                    // }

                    if (msgAttributes.customerUploads) {
                        //use spread operator and add the customerUploads property to the _properties object
                        _properties = { ..._properties, ...msgAttributes.customerUploads }
                    }

                }
                let argsObj = {
                    properties: _properties,
                    variantId: variantId,
                }

                let uniqueItemKey = _properties?._uniqueGbbItemKey || gbb.utility.getUniqueIdForVariant(argsObj);
                const item = gbb.utility.checkIfItemPresentInGiftBoxCart(variantId, { uniqueItemKey });

                if (item) {
                    // if item is present in cart then update the qty using the change attribute method
                    let _data = {
                        id: item.key || item.id,
                        quantity: quantity,
                        properties: {
                            ...item.properties,
                            ..._properties
                        }
                    }
                    result = await gbb.utility.changeCart(_data);
                }
                else {
                    // if item is not present in cart then add it using the add attribute method
                    let _data = {
                        id: variantId,
                        quantity: quantity,
                        properties: _properties
                    }
                    if (_data.quantity != 0) {
                        gbb.gbbBrowser.addItemToCartSessionStorage({ ..._data, ...productItem });
                    }
                }

                gbb.state.giftBoxCartData = await gbb.utility.getGiftBoxProductsFromCart()
                gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();
                gbb.gbbAddonProducts.f.calculateEligibleAddonProductsTier()
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: "gbb-cart-update",
                    detail: {
                        variantId: variantId,
                        // quantity: item - quantity,
                    }
                })
                return result
            } catch (error) {
                gbb.utility.debugError("gbb-utility-updateCartV2");
                gbb.utility.debugError(error);
                return false
            }
        },
        changeCart: async function (data) {
            try {
                return gbb.gbbBrowser.updateCartItemQuantityAndProperty(data.id, data.quantity, data.properties);
                let result = await gbb.$.ajax({
                    type: "POST",
                    url: "/cart/change.js",
                    data: data,
                    dataType: "json",
                });
                return true
            } catch (error) {
                gbb.utility.debugError("gbb-utility-changeCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        getAttributValueFromCart: function (attributeName) {
            if (gbb.state.giftBoxCartData && gbb.state.giftBoxCartData.attributes && gbb.state.giftBoxCartData.attributes[attributeName] && gbb.state.giftBoxCartData.attributes[attributeName] != "") {
                return gbb.state.giftBoxCartData.attributes[attributeName]
            } else {
                return null
            }
        },
        getProductsInDefaultView: function () {
            return gbb.gbbAddProductsPage.state.uniqueProductsData;
        },
        getCurrencySymbolByCode: function (code) {
            try {
                let merchantCurrencies = gbb?.settings?.merchantInfo?.multipleCurrenciesInfo;
                if (merchantCurrencies.hasOwnProperty(code)) {
                    return merchantCurrencies[code]?.symbol;
                }
                return "";
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        setStoreCurrenyStateFromCart: async function () {
            try {
                if (gbb.state.storeCurrencySymbol) {
                    return;
                } else {
                    if (window && window.Shopify && window.Shopify.currency && window.Shopify.currency.active) {
                        gbb.state.storeCurrencySymbol = gbb.utility.getCurrencySymbol();
                    } else {
                        let _shopifyCartData = await gbb.shopifyUtility.getCart();
                        gbb.state.storeCurrencySymbol = gbb.utility.getCurrencySymbolByCode(_shopifyCartData?.currency);
                    }
                }
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        formatPrice: function (price) {
            if (window && window.Shopify && window.Shopify.currency && window.Shopify.currency.active) {
                //find the currency symbol from  gbb.settings.merchantInfo.multipleCurrencies[window.Shopify.currency.active] get the symbol
                let currencySymbol = gbb.utility.getCurrencySymbol();
                return currencySymbol + "" + parseFloat(price / 100).toFixed(2)
            } else {
                return gbb.state.storeCurrencySymbol + "" + parseFloat(price / 100).toFixed(2)
            }
        },
        formatPriceWithoutSymbol: function (price) {
            if (window && window.Shopify && window.Shopify.currency && window.Shopify.currency.active) {
                //find the currency symbol from  gbb.settings.merchantInfo.multipleCurrencies[window.Shopify.currency.active] get the symbol
                return parseFloat(price / 100).toFixed(2)
            } else {
                return parseFloat(price / 100).toFixed(2)
            }
        },

        //calculate cartDiscount uses getCartDataFromSessionStorage, gets the entire data.
        //then we loop on boxes object and inside each object we use
        //we have discountValue as a variable stored in it,
        // depending on the discountMode we will calculate the discount we have to offer
        //we will multiply the discountValue by boxQuantity and also multiply the quantity of each product by boxQuantity
        // the values returned are cartSubTotal: - 1900
        // cartDiscount: - 520
        // cartTotalAmount - 1380
        // cartTotalqty -
        // cartProductListForDiscounts: []
        calculateCartDiscount: function (cartData) {
            if (!cartData) {
                cartData = gbb.gbbBrowser.getCartDataFromSessionStorage({ forSubscription: true });
            }
            // let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();

            //all the prices in this function are in shopify formats. 
            //.i.e. 100 = 1.00

            let cartSubTotal = 0;
            let cartDiscount = 0;
            let cartTotalAmount = 0;
            let cartTotalQty = 0;
            let cartBlacklistedItemsTotal = 0;
            let cartProductListForDiscounts = [];
            let cartProductHandlesForDiscounts = [];
            let cartVariantListForDiscounts = [];
            let cartVarientPriceListForDiscounts = [];
            let discountMode = gbb.settings.discountsData.discountMode
            let discountsPerBox = {}

            if (gbb.settings.discountsData.isKiteDiscountMessagingEnabled){
                discountMode = gbb.settings.discountsData.kiteDiscountMessaging.discountMode;
            }

            if (cartData && cartData.boxes) {
                Object.keys(cartData.boxes).forEach((item) => {
                    let box = cartData.boxes[item];
                    box = gbb.gbbDiscountComponent.f.discountEligibleCartData(box);
                    //let discountValue = gbb.gbbDiscountComponent.state.currentDiscountRule[box.boxId]?.discountValue || box.discountValue;
                    let discountValue = gbb.gbbDiscountComponent.state.currentDiscountRule[box.boxId]?.discountValue;
                    discountValue = parseFloat(discountValue);
                    let discountValueIsNumber = !isNaN(discountValue) && typeof discountValue == "number";

                    if (discountValueIsNumber && discountMode == "FIXED" || discountMode == "FIXED_BUNDLE_PRICE") {
                        discountValue = parseFloat(discountValue) * 100;
                        let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();
                        discountValue = discountValue * activeCurrencyRate;
                    }


                    let boxQuantity = box.boxQuantity;
                    let boxItemCount = box.item_count;
                    let boxPrice = box.total_price;
                    let boxDiscount = 0;
                    let boxTotalAmount = box.total_price * boxQuantity;
                    let boxTotalQty = box.boxQuantity;

                    let boxProductList = [];
                    let boxProductHandleList = [];
                    let boxVariantList = [];
                    let boxVarientPriceList = [];
                    //check if discountValue in not Nan, or undefinded, or null, check the type of discountValue
                    if (discountValueIsNumber) {
                        if (discountMode == "FIXED") {
                            boxDiscount = discountValue * boxQuantity;
                            boxTotalAmount = ((boxPrice * boxQuantity) - boxDiscount)
                            boxTotalQty = boxQuantity;
                        } else if (discountMode == "PERCENTAGE") {
                            boxDiscount = ((boxPrice * discountValue) / 100) * boxQuantity;
                            boxTotalAmount = ((boxPrice * boxQuantity) - boxDiscount);
                            boxTotalQty = boxQuantity;
                        } else if (discountMode == "FIXED_BUNDLE_PRICE") {
                            boxDiscount = (boxPrice - discountValue) * boxQuantity;

                            //this is written because a floating point error came
                            // boxPrice = 3980
                            // discountValue =3979.9999995
                            if (boxDiscount > 0.0001) {
                                boxDiscount = boxDiscount;
                            } else {
                                boxDiscount = 0;
                            }

                            boxTotalAmount = discountValue * boxQuantity;
                            boxTotalQty = boxQuantity;
                        }
                    }
                    cartSubTotal += boxPrice * boxQuantity;
                    cartDiscount += boxDiscount;
                    cartTotalAmount += boxTotalAmount;
                    cartTotalQty += (boxTotalQty * boxItemCount);


                    if (isNaN(box.blackListedItemsTotalPrice)) {
                        box.blackListedItemsTotalPrice = 0;
                    }

                    cartBlacklistedItemsTotal += box.blackListedItemsTotalPrice;
                    discountsPerBox[box.boxId] = {
                        boxDiscount: boxDiscount,
                        boxSubTotal: boxPrice * boxQuantity,
                        boxTotalAmount: boxTotalAmount,
                        boxTotalQty: boxTotalQty * boxItemCount,
                        boxQuantity: boxQuantity,
                        blackListedItemsTotalPrice: box.blackListedItemsTotalPrice,
                    }
                    // boxProductList = box.products.map((product) => 
                    //push the product.id in the boxProductList
                    box.items.forEach((product) => {
                        if (product.price > 0) {
                            boxProductHandleList.push(product.productHandle)
                            boxProductList.push(product.product_id)
                        }
                    })
                    box.items.forEach((product) => {
                        if (product.price > 0) {
                            boxVariantList.push(product.id)
                            boxVarientPriceList.push(product.price / 100)
                        }
                    })
                    cartProductListForDiscounts.push(boxProductList)
                    cartProductHandlesForDiscounts.push(boxProductHandleList)
                    cartVariantListForDiscounts.push(boxVariantList)
                    cartVarientPriceListForDiscounts.push(boxVarientPriceList)
                })
            }

            //if either of the number is not a number, then return 0
            if (isNaN(cartSubTotal)) {
                cartSubTotal = 0;
            }
            if (isNaN(cartDiscount)) {
                cartDiscount = 0;
            }
            if (isNaN(cartTotalAmount)) {
                cartTotalAmount = 0;
            }
            if (isNaN(cartTotalQty)) {
                cartTotalQty = 0;
            }
            if (isNaN(cartBlacklistedItemsTotal)) {
                cartBlacklistedItemsTotal = 0;
            }


            return {
                cartSubTotal: cartSubTotal,
                cartBlacklistedItemsTotal: cartBlacklistedItemsTotal,
                cartDiscount: cartDiscount,
                cartTotalAmount: cartTotalAmount,
                cartTotalQty: cartTotalQty,
                cartProductListForDiscounts: cartProductListForDiscounts.flat(),
                cartProductHandlesForDiscounts: cartProductHandlesForDiscounts.flat(),
                cartVariantListForDiscounts: cartVariantListForDiscounts.flat(),
                cartVarientPriceListForDiscounts: cartVarientPriceListForDiscounts.flat(),
                discountsPerBox: discountsPerBox,
            }
        },
        removeUnUsedVariantImages: function (product) {
            try {
                const usedMediaIds = new Set();
                product.variants.forEach(variant => {
                    if (variant.featured_media) {
                        usedMediaIds.add(variant.featured_media.id);
                    }
                });

                let allMediasSortedByAltKey = gbb.utility.convertArrayToObjectWithArrays(product.media, "alt");



                // this issue arises whe we find that 
                // not all variants have an image associated with it
                // in that case, all images are product base images
                if (usedMediaIds.size < 1) {
                    return product;
                }

                product.media = product.media.filter(media => usedMediaIds.has(media.id));


                // use the alt key present in the media object to get the media object from allMediasSortedByAltKey
                // and then push it to product.media

                let filteredMedia = JSON.parse(JSON.stringify(product.media));

                filteredMedia.forEach(media => {
                    if (!media.alt){
                        media.alt = media?.id;
                    }
                    let _media = allMediasSortedByAltKey[media.alt];

                    if (_media) {
                        if (_media.length) {
                            product.media.push(..._media);
                        }
                    }
                });

                // sort media by position
                product.media.sort((a, b) => a.position - b.position);
                //  remove duplicates after sorting
                product.media = product.media.filter((media, index, self) =>
                    index === self.findIndex((t) => (
                        t.id === media.id
                    ))
                )



                const usedImageUrls = new Set(product.media.map(media => media.src));

                product.images = product.images.filter(imageUrl => {
                    const httpsImageUrl = imageUrl.startsWith('//') ? 'https:' + imageUrl : imageUrl;
                    return usedImageUrls.has(httpsImageUrl);
                });


                return product;
            } catch (error) {
                gbb.utility.debugConsole("error in removeUnUsedVariantImages", error)
            }
        },

        shiftFirstVariantMedia_toFirstIndexInMediaObj: function (product) {
            try {
                product = JSON.parse(JSON.stringify(product));
                if (product.variants.length > 0) {
                    let firstVariant = product.variants[0];
                    if (firstVariant.featured_media) {
                        let featuredMedia = firstVariant.featured_media;
                        let featuredMediaIndex = product.media.findIndex(media => media.id == featuredMedia.id);
                        if (featuredMediaIndex > -1) {
                            let featuredMedia = product.media.splice(featuredMediaIndex, 1);
                            product.media.unshift(featuredMedia[0]);
                        }
                    }
                }
                return product;
            } catch (error) {
                gbb.utility.debugConsole("error in shiftFirstVariantMedia_toFirstIndexInMediaObj", error)
            }
        },


        getProductData_AfterRemovingUnavailableVariantsAndOptions: function (product) {
            try {
                let productData = JSON.parse(JSON.stringify(product));
                productData.variants = productData?.variants?.filter(variant => variant.available);

                productData.options = productData.options.map(option => {
                    // For each option, filter the values that are included
                    //  in at least one of the variant
                    let values = option.values.filter(value => {
                        for (let variant of productData.variants) {
                            // If the variant's options include the value, 
                            // return true to include it in the filter
                            if (variant.options.includes(value)) {
                                return true;
                            }
                        }
                        // If the value is not found in any variant's options,
                        // return false to exclude it from the filter
                        return false;
                    });

                    // Return the new option object, spreading the previous option 
                    //properties and replacing the 'values' with the filtered ones
                    return {
                        ...option,
                        values
                    };
                })

                //check if productData.variants and productData.options are the same as product.variants and product.options
                //if yes, then return productData : with a removedVariantsAndOptions flag
                if (productData.variants.length != product.variants.length || productData.options.length != product.options.length) {
                    // productData.removedVariantsAndOptions = true;
                    productData.renderChooseOptionsButton_forcefully = true;
                } else {
                    productData.renderChooseOptionsButton_forcefully = false;
                }

                // productData.price = productData.variants[0].price || productData.price
                if (productData.variants && productData.variants.length > 0) {
                    productData.price = productData.variants[0].price || productData.price
                    productData.compare_at_price = productData.variants[0].compare_at_price || productData.compare_at_price
                }

                return productData;
            } catch (error) {
                gbb.utility.debugConsole("error in getProductData_AfterRemovingUnavailableVariantsAndOptions", error)
            }
        },
        getCurrencySymbol: function () {
            if (window && window.Shopify && window.Shopify.currency && window.Shopify.currency.active) {
                let symbol = gbb.settings.merchantInfo.multipleCurrenciesInfo[window.Shopify.currency.active]?.symbol || Shopify.currency.active;
                return symbol;
            } else {
                return gbb.state.storeCurrencySymbol;
            }
        },
        getStoreCurrencySymbol: function () {
            return gbb.settings.merchantInfo.currencyInfo.symbol;
        },

        getProductDataV2: function (productName, options) {
            try {
                let languageValue = window?.Shopify?.routes?.root ? window.Shopify.routes.root : "/"
                return new Promise(async (res, rej) => {
                    if (gbb.state.cachedProductData.has(productName)) {
                        res(gbb.state.cachedProductData.get(productName));
                    } else {
                        let productHandlesAreTranslated = gbb.settings.app.productHandlesAreTranslated || false;
                        let flowForFetch;

                        if (productHandlesAreTranslated && options?.dontRetry != true) {
                            flowForFetch = "HANDLE_TRANSLATED_HANDLES";
                        } else {
                            flowForFetch = "FETCH_DEFAULT_HANDLES";
                        }

                        if (flowForFetch === "FETCH_DEFAULT_HANDLES") {
                            gbb.$.getJSON(languageValue + "products/" + productName + ".js", function (product) {
                                product = gbb.gbbKite.f.modifyProductDataWithDiscountedPrice(product);
                                gbb.state.cachedProductData.set(productName, product);
                                res(product);
                            }).fail(function () {
                                gbb.utility.debugConsole("fail-productName: ", productName);
                                gbb.state.cachedProductData.set(productName, false);
                                res(false);
                            });
                        } else if (flowForFetch === "HANDLE_TRANSLATED_HANDLES") {
                            let _updated = await gbb.utility.getProductDataForTranslatedHandles(productName, languageValue);
                            res(_updated);
                        }
                    }
                });

                return result;
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getProductDataV2");
                gbb.utility.debugError(error);
                return false
            }
        },
            getProductDataForTranslatedHandles: function (productName, languageValue) {
            return new Promise((res, rej) => {
                fetch(languageValue + "products/" + productName)
                    .then(async (response) => {
                        if (!response.ok) throw new Error("Network response was not ok");
                        gbb.utility.debugConsole("Final URL:", response.url); // Log the final redirected URL
                        // response.url = response.url.trim().endsWith("/") ? response.url.slice(0, -1) : response.url;
                        let urlReturned = response.url;

                        // Remove the last character if it is a '/'
                        if (urlReturned[urlReturned.length - 1] === "/") {
                            urlReturned = urlReturned.substring(0, urlReturned.length - 1);
                        }
                        gbb.utility.debugConsole("urlReturned", urlReturned);

                        // Extract the last path segment and get the string before the first '.'
                        let newHandle = urlReturned.split("/").pop().split(".")[0];

                        // console.log("newHandle", newHandle);
                        gbb.utility.debugConsole("newHandle", newHandle);

                        // now call productDataV2 with the final url
                        return await gbb.utility.getProductDataV2(newHandle, { dontRetry: true });
                    })
                    .then(product => {
                        gbb.utility.debugConsole("Product Data:", product);
                        res(product); // resolve the outer promise with the product data
                    })
                    .catch(error => {
                        gbb.utility.debugConsole("fail", error);
                        res(false);
                        // rej(error); // reject the outer promise with the error
                    });
            });
        },
        renderTemporaryLoadingSpinner: function (loaderState) {

            // gbb.$(".gbbPageBody").append(gbb.$("<div>").addClass("gbbEmptyDivWithMaxHeight"));

            //loaderState = "show" => show loader
            //loaderState = "hide" => hide loader
            //loaderState = (empty params) => toggle loader with a timeout 700ms.
            //check switch case for more render details
            if (!loaderState) {
                loaderState = "autoToggle"
            }

            let defaultLoadingGif = "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/storefront/loading-gif.gif";

            // "https://c.tenor.com/n4w0VzWFbtgAAAAC/loading.gif"

            let loadingGif = gbb.settings.merchantInfo?.customSettings?.loadingGif || "";

            if (loadingGif) {
                defaultLoadingGif = loadingGif;
            }

            let loadingScreenDiv = gbb.$("<div>").addClass("gbbLoadingScreen").css("background", gbb?.settings?.app?.loadingBgColor);
            // let loadingScreenDiv =  gbb.$("<img>").addClass("gbbLoadingScreenSpinner").attr("src",defaultLoadingGif );
            // let loadingScreenSpinner = gbb.$("<div>").addClass("gbbLoadingScreenSpinner");

            // let loadingSpinnerGIF = gbb.$("<img>").attr("src", gbb.utility.getAssetUrl("loading.gif"));
            let loadingSpinnerGIF = gbb.$("<img>").addClass("gbbLoadingSpinnerGIF").attr("src", defaultLoadingGif);




            // loadingScreenDiv.append(loadingScreenSpinner);
            loadingScreenDiv.append(loadingSpinnerGIF);
            // loadingScreenDiv.append(loadingSkeleon);
            switch (loaderState) {
                case "show":
                    if (gbb.$(".gbbLoadingScreen").length < 1) {
                        gbb.$(".gbbPageBody").append(loadingScreenDiv);
                        gbb.$("body").addClass("gbbHideScrollBar");
                    }
                    break;
                case "hide":
                    if (gbb.$(".gbbLoadingScreen").length > 0) {
                        setTimeout(function () {
                            gbb.$(".gbbLoadingScreen").remove();
                            gbb.$("body").removeClass("gbbHideScrollBar");
                        }, 500)


                    }
                    break;
                case "autoToggle":
                    if (gbb.$(".gbbLoadingScreen").length > 0) {
                        return
                    }
                    else {
                        gbb.$(".gbbPageBody").append(loadingScreenDiv);
                    }
                    setTimeout(function () {
                        gbb.$(".gbbLoadingScreen").remove();
                    }, 700)
                    break;
                    return;
            }
        },
        getProductsBulk: async function (listOfHandles) {
            try {
                // fire an api call for each product and store it corresponding to its handle/title
                let promises = []
                for (let i = 0; i < listOfHandles.length; i++) {
                    promises.push(gbb.utility.getProductDataV2(listOfHandles[i]))
                }
                let data = await Promise.all(promises)
                //return the data but in for of array of object which title as key

                let result = {}
                for (let i = 0; i < data.length; i++) {
                    result[data[i].handle] = data[i]
                }
                return result;
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getProductsBulk");
                gbb.utility.debugError(error);
                return false
            }
        },
        getProductsBulkForRelevantVariants: async function (listOfHandles, productsData, options) {
            try {
                // fire an api call for each product and store it corresponding to its handle/title



                let promises = [], idsOfVariants = [];
                for (let i = 0; i < productsData.length; i++) {
                    idsOfVariants?.push(productsData[i]?.variants?.map(variant => variant.variantId))
                }

                idsOfVariants = idsOfVariants?.flat()

                let data;

                if (gbb.settings.app.enableStoreFrontGQLAPI) {
                    data = await gbb.graphQlUtility.getProductsDataByIds(options.listOfProductIds)
                    // promises.push(await gbb.graphQlUtility.getProductsDataByIds(options.listOfProductIds))
                } else {

                    for (let i = 0; i < listOfHandles.length; i++) {

                        // TODO: SF API Check
                        // if(storeFrontapi token pres)
                        // 
                        // {
                        // if ( false && options && options.listOfProductIds){

                        promises.push(gbb.utility.getProductDataV2(listOfHandles[i]))


                        // }

                    }
                    data = await Promise.all(promises)
                }


                //remove the data element which are false
                data = data.filter(element => element)

                //return the data but in for of array of object which title as key
                let result = {}
                for (let i = 0; i < data.length; i++) {
                    //getproductdata based on data[i].id
                    let productdata = productsData.find((item) => item.productId == data[i].id)
                    data[i] = gbb.utility.getProductData_AfterRemovingUnavailableVariantsAndOptions(data[i]);

                    let hasTheUserSelectedOnlyOneVariant = productdata?.variants?.length == 1 ? true : false;
                    if (hasTheUserSelectedOnlyOneVariant) {
                        data[i].renderChooseOptionsButton_forcefully = false;
                    }




                    if (productdata && productdata.variants) {
                        let variants = data[i].variants?.filter(variant => idsOfVariants.includes(String(variant.id)));
                        data[i].variants = variants;


                        if (data[i].variants.length < 1) {
                            continue;
                        }

                        data[i].price = data[i].variants[0]?.price || data[i].price
                        data[i].compare_at_price = data[i].variants[0]?.compare_at_price || data[i].compare_at_price



                        if (gbb.settings.bundleSettings.removeUnUsedVariantImages) {
                            data[i] = gbb.utility.removeUnUsedVariantImages(data[i])
                        }

                        result[data[i].handle] = {
                            ...data[i],
                            variants,
                            requiredQuantity: productdata?.requiredQuantity ? productdata?.requiredQuantity : null //used in case of default products only
                        };
                    } else {
                        let variants = data[i].variants
                        data[i].variants = variants;
                        if (gbb.settings.bundleSettings.removeUnUsedVariantImages) {
                            data[i] = gbb.utility.removeUnUsedVariantImages(data[i])
                        }


                        result[data[i].handle] = {
                            ...data[i],
                            variants,
                            requiredQuantity: productdata?.requiredQuantity ? productdata?.requiredQuantity : null
                        }

                    }

                }
                return result;
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getProductsBulkForRelevantVariants");
                gbb.utility.debugError(error);
                return false
            }
        },
        getProductsFromCollections: function (data) {
            try {
                let resObj = []
                for (let i = 0; i < data.length; i++) {
                    let collection = data[i]
                    if (collection && collection.productList.length > 0) {
                        resObj.push(...collection.productList)
                    }

                }
                return resObj
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getProductsFromCollections");
                gbb.utility.debugError(error);
                return false
            }
        },
        removeFromCartBulk: async function (variantIdList, noteAttribute) {
            try {

                // run a for loop to create promises to remove
                // items from the cart in bulk
                for (let i = 0; i < variantIdList.length; i++) {
                    let variant = { id: variantIdList[i] }
                    await gbb.utility.removeFromCart({ variant }, noteAttribute);
                }
                // wait for all promises to resolve
                return true;
            }
            catch (error) {
                gbb.utility.debugError("gbb-utility-removeFromCartBulk");
                gbb.utility.debugError(error);
                return false
            }
        },
        addToCartV2: function (data) {
            try {
                return new Promise((res, rej) => {
                    gbb.$.post('/cart/add.js', data)
                        .done(function () { gbb.utility.debugConsole("success-/cart/add.js': "); res(true) })
                        .fail(function () { gbb.utility.debugConsole("fail-/cart/add.js"); res(false) })
                })
                return result;
            } catch (error) {
                gbb.utility.debugError("gbb-utility-addToCartV2");
                gbb.utility.debugError(error);
                return false
            }
        },
        clearCart: function (data) {
            try {
                return new Promise((res, rej) => {
                    gbb.$.post('/cart/clear.js', data)
                        .done(function () { gbb.utility.debugConsole("success-/cart/clear.js': "); res(true) })
                        .fail(function () { gbb.utility.debugConsole("fail-/cart/clear.js"); res(false) })
                })
                return result;
            } catch (error) {
                gbb.utility.debugError("gbb-utility-clearCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        getCart: async function (data) {
            try {
                const subscriptionPlanExists = gbb.gbbReviewPage.f.checkIfSubscriptionPlanExists();
                if (subscriptionPlanExists && gbb.gbbBrowser?.getSubscriptionType() == "saveSubscription") {
                    return gbb.gbbBrowser.getCartDataForSubscription();
                }
                return gbb.gbbBrowser.getCartDataFromSessionStorage();
                let result = await gbb.$.ajax({
                    type: "GET",
                    url: "/cart.js",
                    dataType: "json",
                });
                return result
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return false
            }
        },

        getGiftBoxProductsFromCart: async function (data) {
            try {
                let data = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(gbb.state.activeBoxId); //change it to -> getRelevantBoxDataFromSessionStorage
                gbb.state.giftBoxCartData = data
                gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();
                return data

            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        getGiftBoxProductsTotalWithCurrency: function (data) {
            try {
                //getGiftBoxProductsFromCart
                // gbb.state.giftBoxCartData = await gbb.utility.getGiftBoxProductsFromCart()
                data = gbb.state.giftBoxCartData
                // if(data.currency){
                // return gbb.utility.getCurrencySymbol() + "" + parseFloat(data.total_price / 100).toFixed(2)
                return gbb.utility.formatPrice(data.total_price)
                // }else{
                // if(Shopify && Shopify.currency && Shopify.currency.active){
                //     return "0.0"+ " " +Shopify.currency.active
                // }else{
                //     return "0.0"
                // }

                // }
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return "0.0"
            }
        },
        getGiftBoxProductsDiscountedTotal: function (boxId) {
            try {
                if (!boxId) {
                    boxId = gbb.state.activeBoxId || "box1";
                }
                let allDiscountsData = gbb.utility.calculateCartDiscount();
                let currentBoxDiscountData = allDiscountsData?.discountsPerBox[boxId];

                if (!currentBoxDiscountData) {
                    return "0.0";
                }

                let discountedTotal = currentBoxDiscountData.boxTotalAmount + currentBoxDiscountData.blackListedItemsTotalPrice || 0;
                discountedTotal = discountedTotal / currentBoxDiscountData.boxQuantity;
                //    let discountedTotal =
                //    return parseInt(discountedTotal / 100);
                //@ashfaq
                return parseFloat(discountedTotal / 100);
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return "0.0"
            }
        },
        getGiftBoxProductsTotalWithCurrency_multipliedByBundleQuantity: function (data) {
            try {
                data = gbb.gbbBrowser.getCartDataFromSessionStorage()
                // data.bundleQuantity = data.bundleQuantity || 1
                return gbb.utility.getCurrencySymbol() + "" + parseFloat(data.total_price * data.bundleQuantity / 100).toFixed(2)
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return "0.0"
            }
        },
        convertArrayToObject: function (array, key) {
            try {
                let obj = {};
                for (let i = 0; i < array.length; i++) {
                    obj[array[i][key]] = array[i];
                }
                return obj;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        convertArrayToObjectWithArrays: function (array, key) {
            try {
                let obj = {};
                for (let i = 0; i < array.length; i++) {
                    if (!obj[array[i][key]]) {
                        obj[array[i][key]] = [];
                    }
                    obj[array[i][key]].push(array[i]);
                }
                return obj;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        getCartTotalQuantity: async function () {
            try {
                let total = 0
                let cartData = await gbb.$.ajax({
                    type: "GET",
                    url: "/cart.js",
                    dataType: "json",
                });
                for (var item of cartData['items']) {
                    total += item["quantity"]
                }
                return total
            } catch (error) {
                gbb.utility.debugError("gbb-utility-getCart");
                gbb.utility.debugError(error);
                return false
            }
        },
        getProductQuantityFromCart: async function ({ variant, parent }) {
            let item = gbb.utility.checkIfItemPresentInGiftBoxCart(variant.id);
            if (!item) {
                return gbb.gbbAddProductsPage.state.incrementProductQtyBy;
            } else {
                return item.quantity;
            }
        },
        checkIfItemPresentInCart: function (searchedVariantId) {
            if (gbb.state.cartData && gbb.state.cartData.items && gbb.state.cartData.items.length && gbb.state.cartData.items.length > 0) {
                for (let i = 0; i < gbb.state.cartData.items.length; i++) {
                    let item = gbb.state.cartData.items[i]
                    if (item && item.variant_id && item.variant_id == searchedVariantId) {
                        return item
                    }
                }
                return false
            } else {
                return false
            }
        },
        checkIfItemPresentInGiftBoxCart: function (searchedVariantId, options) {

            const boxProductValuesInPersonalizationPage = ["giftWrap", "giftMessage", "greetingCard","addonProduct"];

            let uniqueItemKey
            if (options) {
                uniqueItemKey = options.uniqueItemKey
            }

            if (gbb.state.giftBoxCartData && gbb.state.giftBoxCartData.items && gbb.state.giftBoxCartData.items.length && gbb.state.giftBoxCartData.items.length > 0) {

                if (uniqueItemKey) {
                    for (let i = 0; i < gbb.state.giftBoxCartData.items.length; i++) {
                        let item = gbb.state.giftBoxCartData.items[i]
                        if (item && item.properties && item.properties["_uniqueGbbItemKey"] && item.properties["_uniqueGbbItemKey"] == uniqueItemKey) {
                            return item
                        }
                    }

                }

                for (let i = 0; i < gbb.state.giftBoxCartData.items.length; i++) {
                    let item = gbb.state.giftBoxCartData.items[i]
                    let findingByVariantId = item && item.variant_id && item.variant_id == searchedVariantId;
                    let findingByLineItemKey = item && item.key && item.key.includes(searchedVariantId);
                    let isProductAddedFromThisPage = item.properties["_boxProduct"] == gbb.state.currentPageId;

                    let isProductFromThisCategory;
                    if (item.properties["_Category"]) {
                        // isProductFromThisCategory
                        isProductFromThisCategory = item.properties["_Category"] == gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
                        if (isProductFromThisCategory) {
                            isProductAddedFromThisPage = true;
                        } else {
                            isProductAddedFromThisPage = false
                        }
                    }

                    // if boxProduct is giftWrap/giftmessage and "greetingCard" then check if gbb.state.currentPageId personalizationPage

                    if (gbb.state.currentPageId == "personalizationPage") {
                        // Check if the _boxProduct is one of the boxProductValuesInPersonalizationPage
                        if (boxProductValuesInPersonalizationPage.includes(item.properties["_boxProduct"])) {
                            isProductAddedFromThisPage = true;
                        }
                    }


                    if (isProductAddedFromThisPage) {
                        if (findingByVariantId || findingByLineItemKey) {
                            return item
                        }
                    }
                }
                return false
            } else {
                return false
            }
        },
        getUniqueIdForVariant: function ({ productData, variantId, attributes }) {
            try {

                let uniqueId
                if (!variantId) {
                    variantId = String(productData.variant_id);
                }

                uniqueId = variantId;


                if (attributes && Object.keys(attributes)) {
                    // uniqueId = concat attributes._Category
                    attributes.pageId = attributes[variantId];
                    if (attributes.pageId) {
                        uniqueId = uniqueId + "_" + "pageId:" + attributes.pageId;
                    }

                    if (attributes.category) {
                        uniqueId = uniqueId + "_" + "categoryId:" + attributes.category;
                    }

                } else if (productData && productData.properties) {
                    if (productData.properties["_boxProduct"]) {
                        uniqueId = uniqueId + "_" + "pageId:" + productData.properties["_boxProduct"];
                    }

                    if (productData.properties["_Category"]) {
                        uniqueId = uniqueId + "_" + "categoryId:" + productData.properties["_Category"];
                    }
                } else {
                    if (gbb.state.currentPageId) {
                        uniqueId = uniqueId + "_" + "pageId:" + gbb.state.currentPageId;
                    }

                    if (gbb.gbbMultipleCategoriesPage.state.currentCategoryId) {
                        uniqueId = uniqueId + "_" + "categoryId:" + gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
                    }
                }

                return uniqueId;

                // _properties["_uniqueGbbItemKey"] + "_" + data?.attributes.category;

            } catch (e) {
                gbb.utility.debugConsole(e);
            }
        },
        checkIfProductPresentInCart: function (searchedProductId) {
            if (gbb.state.cartData && gbb.state.cartData.items && gbb.state.cartData.items.length && gbb.state.cartData.items.length > 0) {
                for (let i = 0; i < gbb.state.cartData.items.length; i++) {
                    // gbb.utility.debugConsole("cjeckIfProductPresentInCart: ", gbb.state.cartData.items[i])
                    let item = gbb.state.cartData.items[i]
                    if (item && item.id && item.id == searchedProductId) {
                        return item
                    }
                }

                return false
            } else {
                return false
            }
        },
        checkIfGiftOptionsInCart: async function () {
            let isGiftWrapPresent = false, isGreetingPresent = false, isGiftNotePresent = false, iseDeliveryPresent = false, isGiftAddonPresent = false


            let giftWrapVariants = [], greetingCardVariants = [], giftAddonVariants = []
            if (gbb.settings && gbb.settings.giftwrap && gbb.settings.giftwrap.isGiftWrapEnabled && gbb.settings.giftwrap.productVariants) {
                gbb.settings.giftwrap.productVariants?.forEach(item => giftWrapVariants.push(item.id))
            }

            if (gbb.settings && gbb.settings.greetingCard && gbb.settings.greetingCard.isGreetingCardEnabled && gbb.settings.greetingCard.productVariants) {
                gbb.settings.greetingCard.productVariants.forEach(item => greetingCardVariants.push(item.id))
            }

            if (gbb.settings && gbb.settings.giftAddons && gbb.settings.giftAddons.isGiftAddonsEnabled && gbb.settings.giftAddons.addOnProducts && gbb.settings.giftAddons.addOnProducts.length && gbb.settings.giftAddons.addOnProducts.length > 0) {
                for (let i = 0; i < gbb.settings.giftAddons.addOnProducts.length; i++) {
                    let addOnProduct = gbb.settings.giftAddons.addOnProducts[i]
                    addOnProduct.variants?.forEach(item => giftAddonVariants.push(parseInt(item.variantId)))
                }
            }

            if (gbb.state.cartData && gbb.state.cartData.attributes) {
                if (gbb.state.cartData.attributes.gbbGiftMessage) {
                    return true
                }

                if (gbb.state.cartData.attributes.gbbScheduleDelivery) {
                    return true
                }
            }

            if (gbb.state.cartData && gbb.state.cartData.items && gbb.state.cartData.items.length && gbb.state.cartData.items.length > 0) {
                for (let i = 0; i < gbb.state.cartData.items.length; i++) {
                    let item = gbb.state.cartData.items[i]
                    if (item && item.variant_id && item.variant_id) {

                        if (giftWrapVariants.includes(item.variant_id)) {
                            isGiftWrapPresent = true
                        }
                        if (greetingCardVariants.includes(item.variant_id)) {
                            isGreetingPresent = true
                        }
                        if (giftAddonVariants.includes(item.variant_id)) {
                            isGiftAddonPresent = true
                        }
                    }
                }

                if (isGiftWrapPresent || isGreetingPresent || isGiftNotePresent || iseDeliveryPresent || isGiftAddonPresent) {
                    return true
                } else {
                    return false
                }

            } else {
                return false
            }



        },
        convertObjectToArray: function (obj) {
            let arr = []
            for (let key in obj) {
                arr.push(obj[key])
            }
            return arr
        },
        getNoteFromCart: function () {

            if (gbb && gbb.state && gbb.state.giftBoxCartData) {
                // return
                const messageProduct = gbb.state.giftBoxCartData.items.find(item => item.id == gbb.settings.shopifyData?.giftMessageData?.variants[0]?.id);
                if (messageProduct) {
                    return messageProduct.properties["Message"]
                }
            }

        },
        getAttributValueFromMessageItem: function (attributeName) {
            if (gbb && gbb.state && gbb.state.giftBoxCartData && gbb.settings.shopifyData?.giftMessageData && gbb.settings.shopifyData?.giftMessageData?.variants && gbb.settings.shopifyData?.giftMessageData?.variants[0]?.id) {
                // return
                const messageProduct = gbb.state.giftBoxCartData.items.find(item => item.id == gbb.settings.shopifyData?.giftMessageData?.variants[0]?.id);
                if (messageProduct) {
                    return messageProduct.properties[attributeName]
                }
            } else {
                return null
            }
        },
        isCartTotalMoreThan: async function (value) {
            gbb.state.cartData = await gbb.utility.getCart()

            if (gbb.state.cartData && gbb.state.cartData.total_price && ((gbb.state.cartData.total_price) / 100 >= parseFloat(value))) {
                gbb.utility.debugConsole("isCartTotalMoreThan: ", gbb.state.cartData.total_price)
                return true
            } else {
                return false
            }
        },
        isCartEmpty: function () {
            if (gbb.state.cartData && gbb.state.cartData.items.length <= 0) {
                return true;

            } else {
                return false
            }
        },
        setMapForVariantId: function (productsObj, extraInfo) {
            try {
                let data = gbb.utility.productDetailsWith_VariantId_Or_ProductIdAsKey(productsObj, extraInfo)
                gbb.state.currentProductsDataSetForVariants = { ...gbb.state.currentProductsDataSetForVariants, ...data };
            }
            catch (e) {
                gbb.utility.debugError("setMapForVariantId", e)
            }

        },

        cloneAddToCartBtn: function () {
        },
        overWriteBuyNowBtn: function () {

            let buyNowBtnEle = gbb.$(document).find(gbb.selectors.buyNowBtn)

            if (buyNowBtnEle && buyNowBtnEle.length > 0 && gbb.$(document).find(".gbb-overwrite-buy-now-btn").length == 0) {
                buyNowBtnEle.show()
                buyNowBtnEle.unbind().unbind("click").off().off("click");
                newBuyNowBtnEle = buyNowBtnEle.clone()
                buyNowBtnEle.after(newBuyNowBtnEle)
                buyNowBtnEle.hide()
                newBuyNowBtnEle.addClass("gbb-overwrite-buy-now-btn")


                newBuyNowBtnEle.on("click", function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    gbb.$(this).attr("disabled", true);
                    newBuyNowBtnEle.text("loading checkout...");
                    setTimeout(() => { gbb.$(this).attr("disabled", false) }, 3000)
                    addToCartBtnEle = gbb.$(document).find(gbb.selectors.addToCart)
                    sideCartEle = gbb.$(document).find(gbb.selectors.sideCartSelectors)

                    // gbb.$(document).find("body").addClass("loadingCheckoutPage")
                    // gbb.$(document).find("body").text("loading checkout...")

                    if (sideCartEle && sideCartEle.length > 0) {
                        sideCartEle.css("display", "none")
                    }

                    if (addToCartBtnEle && addToCartBtnEle.length > 0) {
                        addToCartBtnEle.trigger("click")
                    }
                    setTimeout(() => {
                        window.location.href = window.location.origin + "/cart/checkout"
                    }, 1000)

                })

            }
        },
        overWriteCheckoutBtn: function () {

            let checkoutBtnEle = gbb.$(document).find(gbb.selectors.checkoutBtnEle)
            if (checkoutBtnEle && checkoutBtnEle.length > 0 && gbb.$(document).find(".gbb-overwrite-checkout-btn").length == 0) {
                checkoutBtnEle.show()
                checkoutBtnEle.unbind().unbind("click").off().off("click");
                let newcheckoutBtnEle = checkoutBtnEle.clone()
                checkoutBtnEle.after(newcheckoutBtnEle)
                checkoutBtnEle.hide()
                newcheckoutBtnEle.addClass("gbb-overwrite-buy-now-btn")


                newcheckoutBtnEle.on("click", function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    gbb.$(this).attr("disabled", true);
                    newcheckoutBtnEle.text("loading checkout...");
                    setTimeout(() => { gbb.$(this).attr("disabled", false) }, 3000)
                    addToCartBtnEle = gbb.$(document).find(gbb.selectors.addToCart)
                    sideCartEle = gbb.$(document).find(gbb.selectors.sideCartSelectors)

                    // gbb.$(document).find("body").addClass("loadingCheckoutPage")
                    // gbb.$(document).find("body").text("loading checkout...")

                    if (sideCartEle && sideCartEle.length > 0) {
                        sideCartEle.css("display", "none")
                    }

                    if (addToCartBtnEle && addToCartBtnEle.length > 0) {
                        addToCartBtnEle.trigger("click")
                    }
                    setTimeout(() => {
                        let properties = gbbExt.state.cartData.properties;
                        window.location.href = window.location.origin + "/cart/checkout"
                    }, 1000)

                })

            }
        },
        emailValidation: function (emailString) {
            var atSymbol = emailString.indexOf("@");
            if (atSymbol < 1) return false;

            var dot = emailString.lastIndexOf(".");
            if (dot <= atSymbol + 2) return false;

            // check that the dot is not at the end
            if (dot === emailString.length - 1) return false;

            return true;
        },
        renderLanguageValue: function (parent) {
            if (parent) {
                return parent.value;
            }
            return;
        },
        slider: {
            state: {
                slideIndex: 1,
            },
            plusSlides: function (selector, n) {
                this.showSlides(selector, this.state.slideIndex += n);
            },
            //minusSlides
            minusSlides: function (selector, n) {
                this.showSlides(selector, this.state.slideIndex -= n);
            },
            showSlides: function (selector, n) {
                var i;
                var slides = selector.find(".gbbProductImageContainerImg"); //takes the entire container so has refernce to all the images inside that container
                if (slides && slides.length) {
                    //     slides = JSON.parse(slides);
                    // }


                    if (n > slides.length) { this.state.slideIndex = 1 }
                    if (n < 1) { this.state.slideIndex = slides.length }
                    for (i = 0; i < slides.length; i++) {
                        slides[i].style.display = "none";
                    }
                    slides[this.state.slideIndex - 1].style.display = "block";
                    //   plusSlides(1)
                }
                // setTimeout(function () { plusSlides(n + 1) }, 2000);
            },
        },
        getAllFilterTagsForProducts: (products, noteAttribute) => {
            let filterTags = []

            products.forEach((element) => {
                let productTags = element.tags ? element.tags : []
                productTags.forEach((tag) => {
                    if (!filterTags.includes(tag)) {
                        filterTags.push(tag);
                    }
                })
            })
            return filterTags;
        },
        getFiltersInAndCondition: ({ allFiltersValue, productTagsSet, product }) => {
            let isAndProductAdded = false;
            let productCollectionNames = product.collectionNames ? product.collectionNames : [];
            for (let i = 0; i < allFiltersValue.length; i++) {
                let filterValue = allFiltersValue[i];
                if (productTagsSet.has(filterValue) || productCollectionNames.includes(filterValue)) {
                    isAndProductAdded = true;
                } else {
                    isAndProductAdded = false;
                    break;
                }
            }
            return isAndProductAdded;
        },

        getFiltersInOrCondition: ({ filters, product, productTagsSet, productTagsString }) => {
            let isProductAdded = false;
            for (let i = 0; i < filters.length; i++) {
                let filter = filters[i];
                for (let j = 0; j < filter.rules.length; j++) {
                    let rule = filter.rules[j];
                    let isThisFilterForCollections = rule.type == "collectionTag" ? true : false;
                    if (isThisFilterForCollections) {
                        if (rule.operatorType == "isEqualTo" || rule.operatorType == "contains") {
                            let selectedCollectionName = rule.tagValue;
                            if (product.collectionNames && product.collectionNames.includes(selectedCollectionName)) {
                                isProductAdded = true;
                                break;
                            }
                        }
                    } else {
                        if (rule.operatorType == "isEqualTo") {
                            if (productTagsSet.has(rule.tagValue)) {
                                isProductAdded = true;
                                break;
                            }
                        } else if (rule.operatorType == "contains") {
                            if (productTagsString.includes(rule.tagValue)) {
                                isProductAdded = true;
                                break;
                            }
                        }
                    }
                }
                if (isProductAdded) {
                    break;
                }
            }
            return isProductAdded;
        },
        getFilteredSortedProductsData: async (noteAttribute, origin) => {
            let products = gbb.utility.getSortedProducts(noteAttribute);
            gbb.state.setInfiniteScrollTrackerForProducts = true;
            let filters = gbb.utility.getActivatedFilters(noteAttribute);
            let filteredProducts = [];
            let minValue = gbb.utility.getPriceFilterValues(noteAttribute).minValue;
            let maxValue = gbb.utility.getPriceFilterValues(noteAttribute).maxValue;
            let filtersInfo = gbb.utility.getFiltersInfo(noteAttribute);


            let filterBasedOnFilterIdOperator = filtersInfo?.filterRuleAcrossCategory;
            let result = [];
            let allFiltersValue = [];
            let totalProducts = [];
            // let uniqueFilterIds = [];
            let filterIdsMap = {};
            filters.forEach((filter) => {

                if (filterIdsMap[filter.filterId]) {
                    filterIdsMap[filter.filterId].push(filter);
                } else {
                    filterIdsMap[filter.filterId] = [filter];
                }


                filter.rules.forEach((rule) => {
                    if (true || rule.type === "productTag") {
                        allFiltersValue.push(rule.tagValue);
                    }
                });

            });
            let filterIdsKeys = Object.keys(filterIdsMap);
            let allEligibleFilters = [];
            let productsToBeFutherFiltered = null;
            filterIdsKeys.forEach((filterIdKey) => {
                productsToBeFutherFiltered = productsToBeFutherFiltered ? productsToBeFutherFiltered : products;
                let filters = filterIdsMap[filterIdKey];
                if (filterBasedOnFilterIdOperator == "OR") {
                    // if (filters.length > 0) {
                    //     allEligibleFilters.push(...filters)
                    // }
                    totalProducts = [...totalProducts, ...calculateProductsToBeFiltered({ allEligibleFilters: filters })];
                    // allEligibleFilters = [...allEligibleFilters,...filters]   
                } else if (filterBasedOnFilterIdOperator == "AND") {
                    allEligibleFilters = [...filters]
                    // when it is and, then we will have to call the calculateProductsToBeFiltered function with the same existing products again and again
                    // so we will have to store the products in a variable and then pass it to the function
                    // productsToBeFutherFiltered
                    productsToBeFutherFiltered = calculateProductsToBeFiltered({ allEligibleFilters, productsToBeFutherFiltered });
                }
            });

            if (filterBasedOnFilterIdOperator == "OR") {
                totalProducts = [...new Set(totalProducts)];
            } else {
                // totalProducts = [...calculateProductsToBeFiltered(allEligibleFilters)];
                // productsToBeFutherFiltered is not iteratable error

                totalProducts = productsToBeFutherFiltered?.length > 0 ? [...productsToBeFutherFiltered] : []
            }

            function calculateProductsToBeFiltered(options) {
                filteredProducts = [];


                if (filtersInfo?.filterRuleAcrossCategory == "OR") {
                    allFiltersValue = [];
                    let filterArr = options.allEligibleFilters;
                    filterArr.forEach((filter) =>
                        filter.rules.forEach((rule) => {
                            if (true || rule.type === "productTag") {
                                allFiltersValue.push(rule.tagValue);
                            }
                        })
                    );
                }

                if (filtersInfo?.filterRuleAcrossCategory == "AND") {
                    let filterArr = options.allEligibleFilters;
                    let productsToBeFutherFiltered = options.productsToBeFutherFiltered;
                    products = productsToBeFutherFiltered;
                    filters = filterArr;
                }



                if (filters.length == 0) {
                    filteredProducts = gbb.utility.getSortedProducts(noteAttribute);
                } else {
                    products.forEach((product) => {
                        let productTags = product.tags;
                        let productTagsSet = new Set(productTags);
                        let productTagsString = productTags.toString();
                        let filterConditionRule = filtersInfo?.filterRule ? filtersInfo.filterRule : "OR";

                        switch (filterConditionRule) {
                            case "AND":
                                let isProductToBeAddedForAnd = false;
                                isProductToBeAddedForAnd = gbb.utility.getFiltersInAndCondition({ allFiltersValue, productTagsSet, product });
                                if (isProductToBeAddedForAnd) {
                                    filteredProducts.push(product);
                                }
                                break;
                            case "OR":
                                let isProductToBeAdded = false;
                                isProductToBeAdded = gbb.utility.getFiltersInOrCondition({ filters, product, productTagsSet, productTagsString });
                                if (isProductToBeAdded) {
                                    filteredProducts.push(product);
                                }
                                break;

                            default:
                                break;
                        }
                    });
                }

                if (minValue && maxValue) {
                    filteredProducts.forEach((product) => {
                        let productPrice = gbb.utility.formatPriceWithoutSymbol(product.price);
                        productPrice = parseFloat(productPrice);
                        if (productPrice >= minValue && productPrice <= maxValue) {
                            result.push(product);
                        }
                    });
                    filteredProducts = result;
                }
                return filteredProducts;
            };

            if (filters.length == 0) {
                totalProducts = gbb.utility.getSortedProducts(noteAttribute);
            }

            // gbb.gbbAddProductsPage.f.renderProductsCardContainer(filteredProducts, noteAttribute);
            if (!origin || origin != 'searchProductsFlow') {
                let activeCategoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
                await gbb.gbbAddProductsPage.f.renderProductsCardContainer(totalProducts, noteAttribute, "filtersFlow", activeCategoryId);
            }
            // return filteredProducts;
            return totalProducts;
        },

        OldgetFilteredSortedProductsData: (noteAttribute) => {
            let products = gbb.utility.getSortedProducts(noteAttribute);
            let filters = gbb.utility.getActivatedFilters(noteAttribute);
            let filteredProducts = [];
            let minValue = gbb.utility.getPriceFilterValues(noteAttribute).minValue;
            let maxValue = gbb.utility.getPriceFilterValues(noteAttribute).maxValue;
            let result = [];
            let allFiltersValue = [];
            filters.forEach((filter) => {
                filter.rules.forEach((rule) => {
                    if (true || rule.type === "productTag") {
                        allFiltersValue.push(rule.tagValue);
                    }
                });
            });
            if (filters.length == 0) {
                filteredProducts = products;
            } else {
                products.forEach((product) => {
                    let productTags = product.tags;
                    let productTagsSet = new Set(productTags);
                    let productTagsString = productTags.toString();


                    // now check that product.tags[] contains all the values in allFiltersValue
                    let isAndProductAdded = false;
                    for (let i = 0; i < allFiltersValue.length; i++) {
                        let filterValue = allFiltersValue[i];
                        if (productTagsSet.has(filterValue)) {
                            isAndProductAdded = true;
                        } else {
                            isAndProductAdded = false;
                            break;
                        }
                    }

                    if (isAndProductAdded) {
                        filteredProducts.push(product);
                    }

                    //below part in another function

                    for (i = 0; i < filters.length; i++) {
                        let filter = filters[i];
                        filter
                        let isProductAdded = false;
                        for (let j = 0; j < filter.rules.length; j++) {
                            let rule = filter.rules[j];
                            let isThisFilterForCollections = rule.type == "collectionTag" ? true : false;
                            if (isThisFilterForCollections) {
                                if (rule.operatorType == "isEqualTo" || rule.operatorType == "contains") {
                                    // if product.collectionName == rule.tagValue
                                    let selectedCollectionName = rule.tagValue;
                                    if (product.collectionNames && product.collectionNames.includes(selectedCollectionName)) {
                                        filteredProducts.push(product);
                                        isProductAdded = true;
                                        break;
                                    }
                                    // if(product.collectionIds && product.collectionIds.includes(rule.tagValue)){
                                    //     filteredProducts.push(product);
                                    //     isProductAdded = true;
                                    //     break;
                                    // }
                                }
                            } else if (!isThisFilterForCollections) {
                                if (rule.operatorType == "isEqualTo") {
                                    if (productTagsSet.has(rule.tagValue)) {
                                        filteredProducts.push(product);
                                        isProductAdded = true;
                                        break;
                                    }
                                } else if (rule.operatorType == "contains") {
                                    if (productTagsString.includes(rule.tagValue)) {
                                        filteredProducts.push(product);
                                        isProductAdded = true;
                                        break;
                                    }
                                }
                            }
                        }
                        if (isProductAdded) {
                            break;
                        }

                    }
                })
            }
            if (minValue && maxValue) {
                filteredProducts?.forEach((product) => {
                    let productPrice = gbb.utility.formatPriceWithoutSymbol(product.price)
                    productPrice = parseFloat(productPrice);
                    if (productPrice >= minValue && productPrice <= maxValue) {
                        result.push(product);
                    }
                })
                filteredProducts = result;
            }
            //let filterAndSortedData = apply filter on sorteduniqueProductsData
            //RenderProductCartcontainer(filterAndSortedData)
            gbb.gbbAddProductsPage.f.renderProductsCardContainer(filteredProducts, noteAttribute)
            return filteredProducts;
        },
        clearAllFilters: (noteAttribute) => {
            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            if (addProductsPageArr.includes(noteAttribute)) {
                gbb.state.addProductsFilters.isFiltersActive = false;
                gbb.state.addProductsFilters.activatedFilters = [];
            }
        },

        checkIfSelectedVariantCombinationIsAvailable: function (product, selectedVariantsCombination) {
            try{

            
            let availableVariant = [];
            let productVariants = product?.variants;

            // Helper function to check if all selected variants are in options
            function allSelectedVariantsAreInOptions(selectedVariants, options) {
                return selectedVariants.every(value => options.includes(value));
            }

            // Helper function to check if there are no extra options outside the selected variants
            function noExtraOptionsInVariantOptions(selectedVariants, options) {
                return options.every(option => selectedVariants.includes(option));
            }

            // Extract the selected values from the combination object
            const selectedValues = Object.values(selectedVariantsCombination);

            for (let index = 0; index < productVariants.length; index++) {
                let variantOptions = productVariants[index]['options'] ? productVariants[index]['options'] : [];

                // Check if both conditions are met
                let isAllselectedVariantsAreInOptions = allSelectedVariantsAreInOptions(selectedValues, variantOptions)
                let isNoExtraOptionsInVariantOptions = noExtraOptionsInVariantOptions(selectedValues, variantOptions); 
                if (selectedValues?.length <=0) { // for the first 
                    isNoExtraOptionsInVariantOptions = true
                }
                const isVariantPresent = 
                    isAllselectedVariantsAreInOptions &&
                    isNoExtraOptionsInVariantOptions

                if (isVariantPresent && productVariants[index]['available'] == true) {
                    availableVariant.push(productVariants[index]);
                    break;
                }
            }
            return availableVariant;
            }catch(e){
                gbb.utility.debugConsole("error in e",e)
            }
        },
        checkIfSelectedVariantCombinationIsAvailableV2: function (product, selectedVariantsCombination) {
            let isVariantPresent = false;
            let availableVariant = [];
            let productVariants = product?.variants; // [black/sage,sage/sage]- [sage/sage] -> [black/sage]
            for (let index = 0; index < productVariants.length; index++) {
                let variantOptions = productVariants[index]['options'] ? productVariants[index]['options'] : [];
                isVariantPresent = Object.keys(selectedVariantsCombination).every((element, index) => {
                    // sage -> 
                    return variantOptions.includes(selectedVariantsCombination[element]);
                })
                if (isVariantPresent && productVariants[index]['available'] == true) {
                    availableVariant.push(productVariants[index]);
                    break;
                }
            }
            return availableVariant;
        },
        removeFromCart: async function ({ variant, parent, qty = 0 }, noteAttribute, category) {


            let data = { updates: { [variant.id]: qty }, attributes: { [variant.id]: noteAttribute } }

            data.additionalInfo = { ...variant }


            if (category && category != "") {
                data.attributes.category = category
            }
            await gbb.utility.updateCartV2(data)
            gbb.state.giftBoxCartData = await gbb.utility.getGiftBoxProductsFromCart()
            gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();

        },
        activateAddButton: function (buttonEle, data, noteAttribute, typeOfProduct, category) {
            let incrementProductQtyBy = gbb.gbbAddProductsPage.state.incrementProductQtyBy || 1;
            buttonEle.css("background", gbb.settings.pageCustomizationData.productCard.productCardButtonColor);
            buttonEle.css("color", gbb.settings.pageCustomizationData.productCard.productCardButtonTextColor);
            const isMultipleVariants = (typeOfProduct == "multipleVariants" ? true : false);

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                if (isMultipleVariants) {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.general.chooseOptionsButtonText) || "Choose Options1");
                }
                else {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.addToBoxButtonText) || "Add To Box1");
                }
            } else if (noteAttribute == "reviewPage") {
                if (isMultipleVariants) {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.general.chooseOptionsButtonText) || "Choose Options1");
                }
                else {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.addButtonText) || "Add1");
                }
            } else {
                if (isMultipleVariants) {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.general.chooseOptionsButtonText) || "Choose Options1");
                }
                else {
                    buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.addToCartButtonText) || "Add To Cart1");
                }
            }
            //buttonEle.removeClass("gbbProductRemoveButton")
            buttonEle.off("click")
            buttonEle.on("click", async function (event) {
                // buttonEle.prop('disabled', true);
                // buttonEle.addClass("gbbDisabled");
                // setTimeout(function () {
                //     gbb.utility.debugConsole("after timeeout")
                //     buttonEle.prop('disabled', false);
                //     buttonEle.removeClass("gbbDisabled");
                // }, 500);
                gbb.utility.debugConsole("add button clicked")
                //activate quantity buttons
                //TODO
                if (!event) {
                    return
                }
                // window.event11 = event;
                buttonEle = gbb.$(event.currentTarget);
                if (typeOfProduct == "multipleVariants") {
                    gbb.f.showProductVariantsModal(data.productData, buttonEle, noteAttribute, category)
                    return;
                } else {
                    let options = {
                        productAmount: data?.variant?.price,
                        category: category,
                        productWeight: data?.variant?.weight,
                        productVariantData: data?.variant,
                        productQuantity: incrementProductQtyBy,
                    }
                    if (gbb.settings?.bundleSettings?.isValidateInventoryEnabled && !gbb.utility.allowATCBasedOnProductInventory(data?.variant?.id, incrementProductQtyBy)) {
                        gbb.f.renderConditionNotificationToast((gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryLimitReachedText) || "No More Stock1"))
                        return
                    }
                    let condition = await gbb.utility.checkStepConditions(noteAttribute, options);
                    if (condition.isConditionMet) {
                        if (!data.qty || data.qty == 0) {
                            data.qty = incrementProductQtyBy;
                        }
                        //TODO: migration addButtonLoadingText
                        // buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.addButtonLoadingText) || "Adding...");
                        gbb.utility.activateQuantityButtons(buttonEle, data, noteAttribute, typeOfProduct, category);
                        try {
                            let _noteAttribute = data?.productData?.customProductAttribute || noteAttribute
                            await gbb.utility.addToCart(data, _noteAttribute, category);
                            await gbb.utility.getGiftBoxProductsFromCart();
                        } catch (e) {
                            gbb.utility.debugConsole("error generated is", e);
                        }



                        await gbb.gbbAddProductsPage.f.handleAutoNextStep();


                        gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                        // gbb.gbbAddProductsPage.f.autoScrollSlotsBasedOnATC("addToCart")
                        gbb.utility.showAddedToCartText(buttonEle);
                        if (noteAttribute == "reviewPage") {
                            gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
                        }
                    }
                }
            })
        },
        activateQuantityButtons: async function (buttonEle, data, noteAttribute, typeOfProduct, category) {
            let allowQuantityInput = gbb.settings?.bundleSettings?.allowQuantityInput || false;
            let incrementProductQtyBy = gbb.gbbAddProductsPage.state.incrementProductQtyBy || 1;
            let decrementProductQtyBy = gbb.gbbAddProductsPage.state.decrementProductQtyBy || 1;
            let gbbProductQuantityHTML = gbb.$("<div>").addClass("gbbProductQuantityHTML");
            if (gbb.$('.gbbProductsCardLayoutV2').length > 0) {
                gbbProductQuantityHTML.css("background", gbb.settings.pageCustomizationData?.productCard?.productCardQuantitySelectorBgColor)
            }
            // let gbbProductQuantityAddButton = gbb.$("<button>").addClass("gbbProductQuantityAddButton")
            let productCardPageCustomization = gbb.settings.pageCustomizationData?.productCard
            let buttonTextColor = productCardPageCustomization.productCardQuantitySelectorButtonTextColor || productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor
            let gbbProductQuantityAddButton = gbb.$("<div>").addClass("gbbProductQuantityAddButton")
                // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                .css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                .css("color", productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
            // let gbbProductQuantityRemoveButton = gbb.$("<button>").addClass("gbbProductQuantityRemoveButton")
            let gbbProductQuantityRemoveButton = gbb.$("<div>").addClass("gbbProductQuantityRemoveButton")
                // .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                // .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                .css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                .css("color", productCardPageCustomization.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
            let gbbProductQuantityLabel = gbb.$("<div>").addClass("gbbProductQuantityLabel");

            let gbbProductQuantityInput = gbb.$("<input>").addClass("gbbProductQuantityInput").attr("type", "number").attr("min", 0);

            let currentQuantity = await gbb.utility.getProductQuantityFromCart(data);

            gbbProductQuantityAddButton.append(gbb.$("<div>").addClass("gbbProductQuantityAddButtonWrapper").html("+"));
            gbbProductQuantityRemoveButton.append(gbb.$("<div>").addClass("gbbProductQuantityRemoveButtonWrapper").html("-"));
            gbbProductQuantityLabel.text(currentQuantity);
            gbbProductQuantityInput.val(currentQuantity);

            // add data attribute to gbbProductQuantityInputContainer of previous qty currentQty
            gbbProductQuantityInput.attr("data-previous-qty", currentQuantity);
            const gbbProductQuantityAddButtonFunction = async (event) => {
                let options = {
                    productAmount: data?.variant?.price,
                    category: category,
                    productWeight: data?.variant?.weight,
                    productVariantData: data?.variant,
                    productQuantity: incrementProductQtyBy
                }
                let product = data.productData;
                let formValidationForProduct = gbb.gbbProductFormStep.f.checkFormValidationForProduct(product);
                if (!formValidationForProduct) {
                    gbb.gbbProductFormStep.f.displayRequiredFieldMessage();
                    return;
                } else if (formValidationForProduct) {
                    gbb.utility.addPersonalizationDataToProductProperties();
                }
                if (gbb.settings?.bundleSettings?.isValidateInventoryEnabled && !gbb.utility.allowATCBasedOnProductInventory(data?.variant?.id, incrementProductQtyBy)) {
                    gbb.f.renderConditionNotificationToast((gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryLimitReachedText) || "No More Stock1"))
                    return
                }
                let condition = await gbb.utility.checkStepConditions(noteAttribute, options);
                // CHECK_INVENTORY
                if (condition.isConditionMet) {
                    currentQuantity += incrementProductQtyBy;
                    data.qty = currentQuantity
                    gbbProductQuantityHTML = gbb.$(event.currentTarget.parentElement)
                    gbbProductQuantityLabel = gbbProductQuantityHTML.find(".gbbProductQuantityLabel");
                    gbbProductQuantityLabel.text(currentQuantity);
                    gbbProductQuantityInput.val(currentQuantity);
                    gbb.utility.validateProductMaxQuantity({
                        currentQuantity, 
                        gbbProductQuantityHTML,
                        triggeredFor:"CARD_QUANTITY_INCREMENT"
                    })
                    gbbProductQuantityInput.attr("data-previous-qty", currentQuantity);
                    // gbb.utility.disableElement(gbbProductQuantityAddButton);
                    let _noteAttribute = product?.customProductAttribute || noteAttribute
                    await gbb.utility.addToCart(data, _noteAttribute, category);
                    await gbb.utility.getGiftBoxProductsFromCart()
                    // gbb.utility.disableElement(gbbProductQuantityAddButton,0);


                    await gbb.gbbAddProductsPage.f.handleAutoNextStep();

                    gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                    // gbb.gbbAddProductsPage.f.autoScrollSlotsBasedOnATC("addToCart")
                    gbb.utility.showAddedToCartText(buttonEle);
                    if (noteAttribute == "reviewPage") {
                        gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
                    }
                }
            }

            const gbbProductQuantitySubstractButtonFunction = async (event) => {

                if (!event) {
                    return
                } else {
                    // window.event1 = event;
                }
                gbbProductQuantityRemoveButton.prop('disabled', true);
                //add a disabled class
                gbbProductQuantityRemoveButton.addClass("gbbDisabled");

                if (currentQuantity <= 0 || currentQuantity <= decrementProductQtyBy) {
                    currentQuantity = 0
                } else {
                    currentQuantity -= decrementProductQtyBy;
                }

                data.qty = currentQuantity
                let _noteAttribute = data.productData.customProductAttribute || noteAttribute
                await gbb.utility.removeFromCart(data, _noteAttribute, category);
                gbbProductQuantityRemoveButton.prop('disabled', false);
                gbbProductQuantityRemoveButton.removeClass("gbbDisabled");
                // let addButtonEle = gbb.$("<button>").addClass("gbbProductAddButton");
                let addButtonEle = gbb.$("<div>").addClass("gbbProductAddButton");
                // window.gbbProductQuantityHTML = gbbProductQuantityHTML;
                gbbProductQuantityHTML = gbb.$(event.currentTarget.parentElement)
                if (currentQuantity <= 0) {
                    gbbProductQuantityHTML.replaceWith(addButtonEle);
                    gbbProductQuantityInput.val(0);
                    gbbProductQuantityInput.attr("data-previous-qty", currentQuantity);
                    gbb.utility.activateAddButton(addButtonEle, data, noteAttribute, typeOfProduct, category)
                } else {
                    gbb.utility.validateProductMaxQuantity({
                        currentQuantity, 
                        gbbProductQuantityHTML,
                        triggeredFor:"CARD_QUANTITY_DECREMENT"
                    })
                    gbbProductQuantityLabel = gbbProductQuantityHTML.find(".gbbProductQuantityLabel");
                    gbbProductQuantityLabel.text(currentQuantity);
                    gbbProductQuantityInput.val(currentQuantity);
                    gbbProductQuantityInput.attr("data-previous-qty", currentQuantity);
                }
                await gbb.utility.getGiftBoxProductsFromCart()
                gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                // gbb.gbbAddProductsPage.f.autoScrollSlotsBasedOnATC("removeFromCart")

                if (noteAttribute == "reviewPage") {
                    gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
                }
            }

            gbbProductQuantityAddButton.on("click", async (event) => {
                //get current quantity -> do +1 and update cart
                gbb.utility.debugConsole("add button clicked")
                gbbProductQuantityAddButtonFunction(event);
            })

            gbbProductQuantityInput.on("change", async (event) => {
                let previousValue = parseInt(gbbProductQuantityInput.attr("data-previous-qty"));
                let currentValue = parseInt(gbbProductQuantityInput.val());

                let differenceInValues = currentValue - previousValue;
                if (differenceInValues > 0) {
                    for (let i = 0; i < differenceInValues; i++) {
                        await gbbProductQuantityAddButtonFunction(event);
                    }
                } else if (differenceInValues < 0) {
                    for (let i = 0; i < Math.abs(differenceInValues); i++) {
                        await gbbProductQuantitySubstractButtonFunction(event);
                    }
                }

            })

            // gbbProductQuantityInput.on("input", async (event) => {
            //     let previousValue = parseInt(gbbProductQuantityInput.attr("data-previous-qty"));
            //     let currentValue = parseInt(gbbProductQuantityInput.val());

            //     let differenceInValues = currentValue - previousValue;
            //     if (differenceInValues > 0) {
            //         for (let i = 0; i < differenceInValues; i++) {
            //             await gbbProductQuantityAddButtonFunction(event);
            //         }
            //     } else if (differenceInValues < 0) {
            //         for (let i = 0; i < Math.abs(differenceInValues); i++) {
            //             await gbbProductQuantitySubstractButtonFunction(event);
            //         }
            //     }

            //     // Update the previous value to the current value

            // });


            gbbProductQuantityRemoveButton.on("click", async (event) => {
                //get current quantity ->  do -1 and update cart
                //if quantity becomes zero after previous step
                //activate add button
                await gbbProductQuantitySubstractButtonFunction(event);

                //disable button after on click for 500ms
                // let btnElements = {gbbProductQuantityRemoveButton, gbbProductQuantityLabel, gbbProductQuantityHTML};
                // let dataToBePassedToActivateAddButton = {data, noteAttribute, category, typeOfProduct};
                // gbb.utility.handleQuantityRemoveButton(btnElements, dataToBePassedToActivateAddButton);
            })


            gbbProductQuantityHTML.append(gbbProductQuantityRemoveButton)

            if (allowQuantityInput) {
                gbbProductQuantityHTML.append(gbbProductQuantityInput);
            } else {
                gbbProductQuantityHTML.append(gbbProductQuantityLabel);
            }

            gbbProductQuantityHTML.append(gbbProductQuantityAddButton);

            buttonEle.replaceWith(gbbProductQuantityHTML);
            

            gbb.utility.validateProductMaxQuantity({
                currentQuantity, 
                gbbProductQuantityHTML,
                triggeredFor:"CARD_QUANTITY_INCREMENT"
            })
        },
        handleQuantityRemoveButton: async function (btnElements, dataToBePassedToActivateAddButton) {
            let { gbbProductQuantityRemoveButton, gbbProductQuantityLabel, gbbProductQuantityHTML } = btnElements;
            let { data, noteAttribute, category, typeOfProduct } = dataToBePassedToActivateAddButton;
            gbbProductQuantityRemoveButton.prop('disabled', true);
            //add a disabled class
            gbbProductQuantityRemoveButton.addClass("gbbDisabled");
            currentQuantity -= 1;
            data.qty = currentQuantity
            await gbb.utility.removeFromCart(data, noteAttribute);
            gbbProductQuantityRemoveButton.prop('disabled', false);
            gbbProductQuantityRemoveButton.removeClass("gbbDisabled");
            // let addButtonEle = gbb.$("<button>").addClass("gbbProductAddButton");
            let addButtonEle = gbb.$("<div>").addClass("gbbProductAddButton");
            if (currentQuantity <= 0) {
                gbbProductQuantityHTML.replaceWith(addButtonEle);
                gbb.utility.activateAddButton(addButtonEle, data, noteAttribute, typeOfProduct, category)
            } else {
                gbbProductQuantityLabel.text(currentQuantity);
            }
            await gbb.utility.getGiftBoxProductsFromCart()
            gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
            if (noteAttribute == "reviewPage") {
                gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
            }
        },
        activateSoldOutButton: function (buttonEle, data, noteAttribute) {
            let { variant, parent } = data;
            buttonEle.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.soldOut) || "Sold Out")
            buttonEle.addClass("gbbProductSoldOutButton")
            buttonEle.off("click")
        },
        handleVariantSelection: function (warningElement, product, selectedVariantsCombination, productButtonElement, gbbProductAllImagesContainer, gbbProductImageContainer) {
            try {
                let availableVariant = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination);
                const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()

                const modalRef = gbb.$(".gbbProductVariantModalContainer")
                if (availableVariant.length == 0) {
                    productButtonElement.addClass('gbbDisabled');
                    warningElement.css('display', 'block');

                    //select the image
                } else {
                    productButtonElement.removeClass('gbbDisabled');
                    warningElement.css('display', 'none');
                    modalRef.find(".gbbProductItemCompareAtPrice").text("");
                    if (availableVariant[0]?.compare_at_price && availableVariant[0]?.compare_at_price > availableVariant[0]?.price) {
                        modalRef.find(".gbbProductItemCompareAtPrice").text(gbb.utility.formatPrice(availableVariant[0]?.compare_at_price));
                    }
                    let productPrice = availableVariant[0]?.price
                    if (isPurchaseTypeSubscription) {
                        productPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(availableVariant[0]?.id)
                    }
                    modalRef.find(".gbbProductItemPrice").text(gbb.utility.formatPrice(productPrice));
                    //if the image is not already selected
                    let mediaId;
                    if (availableVariant[0].featured_media && availableVariant[0].featured_media?.id) {
                        mediaId = availableVariant[0].featured_media.id;
                        //find the active class image and check it's media id
                        let activeImage = gbbProductAllImagesContainer.find(".gbbActiveImage");
                        let activeImageIndex = activeImage.attr("imageIndex");
                        let activeImageMediaId = activeImage.attr("mediaId");

                        //find the div of the new variant through mediaId and then assign it slide index
                        let changedVariantDiv = gbbProductAllImagesContainer.find(`[mediaId=${mediaId}]`);
                        // let changedVariantDivIndex = parseInt(changedVariantDiv.attr("imageIndex"))
                        let changedVariantDivIndex = parseInt(changedVariantDiv?.parent()?.index())
                        changedVariantDivIndex += 1;

                        if (activeImageMediaId != mediaId && gbb.utility.slider.state.slideIndex != changedVariantDivIndex) {

                            gbb.utility.slider.state.slideIndex = changedVariantDivIndex//current changes image index;
                            // gbb.utility.slider.state.slideIndex = activeImageIndex//current changes image index;
                            gbb.utility.slider.showSlides(gbbProductImageContainer, gbb.utility.slider.state.slideIndex)
                            // gbb.utility.slider.showSlides(gbbProductImageContainer, gbb.utility.slider.state.slideIndex)

                            gbb.f.removeActiveImageStyle(gbbProductAllImagesContainer.find(".gbbActiveImage"))
                            gbbProductAllImagesContainer.find(".gbbActiveImage").removeClass("gbbActiveImage")

                            gbb.f.applyActiveImageStyle(gbbProductAllImagesContainer.find(`[mediaId=${mediaId}]`))
                            gbbProductAllImagesContainer.find(`[mediaId=${mediaId}]`).addClass("gbbActiveImage")
                        }
                    }
                }
            } catch (error) {
                gbb.utility.debugConsole("Error in handleVariantSelection", error)
            }
        },
        addPersonalizationDataToProductProperties: function (product) {

            let formSubmissionObj = JSON.parse(JSON.stringify(gbb.gbbProductFormStep.state.formSubmissionData));
            let resultKeyValuePair = {};
            let formSubmissionObjKeys = Object.keys(formSubmissionObj);
            //iterate and just copy the values
            formSubmissionObjKeys.forEach((key) => {
                if (formSubmissionObj[key].value) {
                    resultKeyValuePair[key] = formSubmissionObj[key].value;
                }
            });
            let productPersonalizationMetaData = formSubmissionObj;
            gbb.state.variantCustomProperties = { ...gbb.state.variantCustomProperties, ...resultKeyValuePair, productPersonalizationMetaData };

        },
        addVariantProductToCart: async function (warningElement, product, selectedVariantsCombination, noteAttribute, buttonEle, category, quantity = 1) {
            let availableVariant = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination);
            if (availableVariant.length == 0) {
                warningElement.css('display', 'block');
            } else {
                let data = {
                    productData: product,
                    variant: availableVariant[0]
                }
                warningElement.css('display', 'none');
                let productData = data.productData;
                let uniqueItemKey = gbb.utility.getUniqueIdForVariant({ productData, variantId: data?.variant?.id })
                const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(data?.variant?.id, { uniqueItemKey });
                // if (isItemInCart && isItemInCart.quantity) {
                //     quantity += isItemInCart.quantity
                //     data.qty = quantity
                // } else {
                //     data.qty = quantity
                // }
                let options = {
                    productAmount: data?.variant?.price,
                    category: category,
                    productQuantity: quantity,
                    productWeight: data?.variant?.weight,
                    productVariantData: data?.variant

                }
                if (gbb.settings?.bundleSettings?.isValidateInventoryEnabled && !gbb.utility.allowATCBasedOnProductInventory(data?.variant?.id, quantity)) {
                    // gbb.utility.closeVariantsModal()
                    gbb.f.renderConditionNotificationToast((gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.inventoryLimitReachedText) || "No More Stock1"))
                    return
                }
                let condition = await gbb.utility.checkStepConditions(noteAttribute, options);
                let formValidationForProduct = gbb.gbbProductFormStep.f.checkFormValidationForProduct(product);
                if (!formValidationForProduct) {
                    gbb.gbbProductFormStep.f.displayRequiredFieldMessage();
                    return;
                } else if (formValidationForProduct) {
                    gbb.utility.addPersonalizationDataToProductProperties();
                }

                if (condition.isConditionMet) {
                    if (isItemInCart && isItemInCart.quantity) {
                        quantity += isItemInCart.quantity
                    }
                    data.qty = quantity;
                    let _noteAttribute = product?.customProductAttribute || noteAttribute
                    await gbb.utility.addToCart(data, _noteAttribute, category)
                    let newProductItemHTML = gbb.f.renderProductsHTML([product], noteAttribute, category);
                    // gbb.$(".gbbPageBody").find(`[productId='${product.id}']`).replaceWith(newProductItemHTML);
                    let productCardRef = gbb.$(".gbbProductsContainer").find(`[productId='${product.id}']`);

                    if (productCardRef.length > 1) {
                        productCardRef = gbb.$(".gbbProductsContainer").find(`[firstvariantid='${data.variant.id}']`);
                    }
                    productCardRef.replaceWith(newProductItemHTML);

                    // if (condition.isConditionMet) {
                    //     gbb.utility.debugConsole("condition is met")
                    //     console.log("conditions", condition.conditions);
                    //     debugger
                    //     let argOptions = {
                    //         // conditions : condition.conditions,
                    //         condition: condition
                    //         // categoryId: category,
                    //         // pageType,
                    //     };
                    // }

                    await gbb.gbbAddProductsPage.f.handleAutoNextStep();



                    //gbb.utility.activateQuantityButtons(buttonEle, data, noteAttribute, "multipleVariants", category)
                    //buttonEle.addClass("gbbProductRemoveButton")
                    gbb.utility.closeVariantsModal()
                    gbb.$(".gbbHTMLWrapper").removeClass('gbbDisabled');
                    gbb.utility.showAddedToCartText(buttonEle);
                    await gbb.utility.getGiftBoxProductsFromCart()
                    gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(noteAttribute, { flow: "updateFooterWithoutAppending" }));
                    if (noteAttribute == "reviewPage") {
                        gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE");
                    }



                } else {
                    gbb.utility.closeVariantsModal()
                }
            }
        },
        activateAFilter: function () {
        },
        removeAFilter: function () {

        },
        getTheVariantProductPresentInCart: function (product) {
            let variantPresent;
            let productVariants = product.variants;
            for (let index = 0; index < productVariants.length; index++) {
                variantPresent = gbb.utility.checkIfItemPresentInGiftBoxCart(productVariants[index].id);
                if (variantPresent) {
                    return variantPresent;
                }
            }
            // product.variants.forEach((variant) => {
            //     variantPresent = gbb.utility.checkIfItemPresentInGiftBoxCart(variant.id);
            //     if(variantPresent) {
            //         return variantPresent;
            //     }
            // })
            return false;
        },
        showAddedToCartText: function (buttonEle) {
            // add a new element next to the buttonEle and show the text
            let addedToCartText = gbb.$("<div>").addClass("gbbAddedToCartText").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.addedText) || "Added")
            buttonEle.after(addedToCartText)
            setTimeout(function () {
                addedToCartText.remove();
            }, 2000)
        },
        getCurrentPageSelectedProducts: function (noteAttribute) {
            let products = [];

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                // products = gbb.state.currentFilteredProducts[keyAttribute];
                products = gbb.state.currentFilteredProducts;
            } else {
                products = [];
            }

            return products;
        },
        setProductsToOriginalState: function (noteAttribute) {
            let tempProductsArr = [];

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            let data;
            if (noteAttribute == "addProductsPage1") {
                data = gbb.settings.stepsConfigurationData.productsData1.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage2") {
                data = gbb.settings.stepsConfigurationData.productsData2.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage3") {
                data = gbb.settings.stepsConfigurationData.productsData3.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage4") {
                data = gbb.settings.stepsConfigurationData.productsData4.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage5") {
                data = gbb.settings.stepsConfigurationData.productsData5.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage6") {
                data = gbb.settings.stepsConfigurationData.productsData6.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage7") {
                data = gbb.settings.stepsConfigurationData.productsData7.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage8") {
                data = gbb.settings.stepsConfigurationData.productsData8.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage9") {
                data = gbb.settings.stepsConfigurationData.productsData9.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage10") {
                data = gbb.settings.stepsConfigurationData.productsData10.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage11") {
                data = gbb.settings.stepsConfigurationData.productsData11.uniqueProductsData;
            } else if (noteAttribute == "addProductsPage12") {
                data = gbb.settings.stepsConfigurationData.productsData12.uniqueProductsData;
            }
            if (data) {
                Object.keys(data).forEach((product) => {
                    tempProductsArr.push(data[product])
                });
            }
            gbb.state.currentFilteredProducts = tempProductsArr;
            return tempProductsArr;
        },
        getOriginalStateProducts: function (noteAttribute) {
            let tempProductsArr = [];

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                let data = gbb.settings.shopifyData[keyAttribute]
                if (data) {
                    Object.keys(data).forEach((product) => {
                        tempProductsArr.push(data[product])
                    });
                }
            }
            return tempProductsArr;
        },
        initializeFiltersInfo: function (productPageKey) {
            gbb.state.addProductsFilters.isFiltersEnabledByAdmin = gbb.settings.stepsConfigurationData[productPageKey].filterTypes?.isFiltersEnabled || false
            let categories = Object.values(gbb.settings.stepsConfigurationData[productPageKey].filterTypes?.categories || {});
            gbb.state.addProductsFilters.allFilters = categories || [];
            categories?.forEach((category) => {
                if (category.type == "price") {
                    gbb.state.addProductsFilters.minPriceValue = category.minValue;
                    gbb.state.addProductsFilters.maxPriceValue = category.maxValue;
                }
            })

        },
        getFiltersInfo: function (noteAttribute) {
            let filtersInfo = {
                isFiltersEnabled: false,
                categories: {},
                filterRule: "OR",
                filterRuleAcrossCategory: "OR"
            };


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                filtersInfo.isFiltersEnabled = gbb.settings.stepsConfigurationData[keyAttribute]?.filterTypes?.isFiltersEnabled;
                filtersInfo.filterRule = gbb.settings.stepsConfigurationData[keyAttribute]?.filterTypes?.filterRule || "OR";
                filtersInfo.filterRuleAcrossCategory = gbb.settings.stepsConfigurationData[keyAttribute]?.filterTypes?.filterRuleAcrossCategory || filtersInfo.filterRule;
                filtersInfo.categories = gbb.state.addProductsFilters.allFilters;
            }

            return filtersInfo;
        },
        setPriceFilterValues: function (noteAttribute, minValue, maxValue) {


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                gbb.state.addProductsFilters.minPriceValue = minValue;
                gbb.state.addProductsFilters.maxPriceValue = maxValue;
            }


            return;
        },
        getPriceFilterValues: function (noteAttribute) {
            let values = {};


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                values.minValue = gbb.state.addProductsFilters.minPriceValue;
                values.maxValue = gbb.state.addProductsFilters.maxPriceValue;
            }
            return values;
        },
        toggleFiltersSideBar: function (noteAttribute) {


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                gbb.state.addProductsFilters.isFiltersActive = !gbb.state.addProductsFilters.isFiltersActive
            }

            return;
        },
        getFiltersState: function (noteAttribute) {
            let isActive = false;

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                isActive = gbb.state.addProductsFilters.isFiltersActive
            }
            return isActive;
        },
        setActivatedFilters: function (filterTag, noteAttribute, operation, category) {

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey;
            if (category) {
                filterTag.category = category
                filterTag.filterId = category?.filterId || "123"
            }
            if (addProductsPageArr.includes(noteAttribute)) {
                let activatedFilters = gbb.state.addProductsFilters.activatedFilters;
                if (operation == "add") {
                    if (activatedFilters.findIndex(e => e.label == filterTag.label) == -1) {
                        activatedFilters.push(filterTag);
                    }
                } else {
                    activatedFilters = activatedFilters.filter((element) => {
                        return element.label != filterTag.label
                    })
                }
                gbb.state.addProductsFilters.activatedFilters = activatedFilters;

            }
        },
        setActivatePriceFilters: function (noteAttribute, value) {

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                gbb.state.addProductsFilters.priceFilterActive = value;
            }
            return;
        },
        getIsPriceFilterActive: function (noteAttribute) {
            let isPriceFilterActive = false;


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                isPriceFilterActive = gbb.state.addProductsFilters.priceFilterActive
            }
            return isPriceFilterActive;
        },
        getActivatedFilters: function (noteAttribute) {
            let activatedFilters = [];

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                activatedFilters = gbb.state.addProductsFilters.activatedFilters
            }

            return activatedFilters;
        },
        getActivatedCategoriesForFilters: function (noteAttribute, filterCategory) {
            try {
                let activatedFilters = gbb.utility.getActivatedFilters(noteAttribute);
                for (let i = 0; i < activatedFilters.length; i++) {
                    let activatedFilter = activatedFilters[i];
                    if (activatedFilter?.category && activatedFilter.category == filterCategory) {
                        return true;
                    }
                }
                return false;
            } catch (err) {
                gbb.utility.debugConsole(err + "inside getActivatedCategoryForFilters");
            }

        },
        getCurrentPageHTML: function (noteAttribute) {
            let currentPageHTML = "";
            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                currentPageHTML = gbb.$(".gbbPageBody").find(".gbbAddProductsContainerHTML");
            }

            return currentPageHTML;
        },
        setSortByValues: function (noteAttribute, sortByValue) {


            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                gbb.state.addProductsSortBy.isSortByEnabled = gbb.settings.stepsConfigurationData[keyAttribute].sortBy?.isSortByEnabled || false;
                gbb.state.addProductsSortBy.sortByCategories = gbb.settings.stepsConfigurationData[keyAttribute].sortBy?.categories || [];
                gbb.state.addProductsSortBy.sortByValue = sortByValue || "";
            }



            return;
        },
        getSortByValues: function (noteAttribute) {
            let sortBy = {};

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
            if (addProductsPageArr.includes(noteAttribute)) {
                sortBy.isSortByEnabled = gbb.state.addProductsSortBy?.isSortByEnabled || false;
                sortBy.sortByCategories = gbb.state.addProductsSortBy?.sortByCategories || [];
                sortBy.sortByValue = gbb.state.addProductsSortBy?.sortByValue || "";
            }

            return sortBy;
        },
        sortAscending: function (arr, key) {
            return arr.sort(function (a, b) {
                var x = a[key];
                var y = b[key];

                if (typeof x == "string") {
                    x = ("" + x).toLowerCase();
                }
                if (typeof y == "string") {
                    y = ("" + y).toLowerCase();
                }

                return ((x < y) ? -1 : ((x > y) ? 1 : 0));
            });
        },
        sortDescending: function (arr, key) {
            return arr.sort(function (a, b) {
                var x = a[key];
                var y = b[key];

                if (typeof x == "string") {
                    x = ("" + x).toLowerCase();
                }
                if (typeof y == "string") {
                    y = ("" + y).toLowerCase();
                }

                return ((x > y) ? -1 : ((x < y) ? 1 : 0));
            });
        },
        getSortedProducts: function (noteAttribute) {
            let result = gbb.utility.getSortByValues(noteAttribute);
            let activeCategoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
            let totalProducts = []
            if (activeCategoryId) { // changing filter search DB for multicategory -> to get only the products of the active category
                totalProducts = gbb.gbbAddProductsPage.state.productPageData.categories[activeCategoryId].uniqueProductsData
            }
            else {
                totalProducts = gbb.gbbAddProductsPage.state.uniqueProductsData;
            }
            // let products = JSON.parse(JSON.stringify(gbb.gbbAddProductsPage.state.uniqueProductsData));
            let products = JSON.parse(JSON.stringify(totalProducts));


            if (result?.isSortByEnabled) {
                if (result.sortByValue == "alphabeticalAToZ") {
                    products = gbb.utility.sortAscending(products, "title")
                } else if (result.sortByValue == "alphabeticalZToA") {
                    products = gbb.utility.sortDescending(products, "title")
                } else if (result.sortByValue == "priceLowToHigh") {
                    products = gbb.utility.sortAscending(products, "price")
                } else if (result.sortByValue == "priceHighToLow") {
                    products = gbb.utility.sortDescending(products, "price")
                }
            }
            return products;
        },
        /**
         * Generates a stylesheet string based on the settings 
         * and appends it to the head of the HTML document.
         * @returns {string} The generated style string.
         */
        getActiveVariantStyle: function () {
            let style =
                `<style>
                    .gbbActiveVariant {
                            background: ${gbb.settings?.pageCustomizationData?.productCard.productCardButtonColor} !important;
                            color:${gbb.settings.pageCustomizationData.productCard.productCardButtonTextColor} !important;
                        }
                    .gbbActiveImage {
                            border: 2px solid ${gbb.settings?.pageCustomizationData?.productCard.productCardButtonColor} !important;
                    }    
                    .gbbBodyWrapper ::-webkit-scrollbar-thumb{
                        background: ${gbb.settings?.pageCustomizationData?.generalSettings?.scrollBar?.scrollBarColor || "#000000"} !important;
                    }    
                    .gbbActiveMsgDeliveryOptions {
                        border: 1px solid #A2A2A2 !important;
                        background-color: rgb(255, 255, 255) !important;
                    }      
                    .gbbCustomerUploadButton{
                        background-color: ${gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor};
                        color: ${gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor};
                    }      
                    </style>`
            gbb.$('html > head').append(style);
            return style;
        },
        getConditionMessage: function (type, condition) {
            let result = gbb.settings?.languageData?.conditions;
            if (type == "amount") {
                result = result.amount;
            } else if (type == "quantity") {
                result = result.quantity;
            } else if (type == "weight") {
                result = result.weight;
            }
            result = result[condition];
            result = result["value"]
            return result;
        },
        checkConditions: function (value, element, goToNextStep) {
            let result = true;
            // let conditions = additionalInfo.conditions || [];
            let elementMaxValue = element.maxValue || element.value
            switch (element.condition) {
                case "lessThanOrEqualTo": {
                    result = value <= element.value ? true : false;
                    break;
                }
                case "equalTo": {
                    if (!goToNextStep) {
                        result = value <= elementMaxValue ? true : false;
                    } else {
                        // result = value == element.value ? true : false;
                        result = value - element.value >= 0 ? true : false;
                    }
                    break;
                }
                case "greaterThanOrEqualTo": {
                    if (goToNextStep) {
                        result = value >= element.value ? true : false;
                    }
                    break;
                }
            }
            return result;
        },
        checkConditionsAndProceedToNextPage: async function (noteAttribute, gbbFooterNextButton) {
            try {
                let result = await gbb.utility.checkConditionsOnNext(noteAttribute, gbbFooterNextButton);
                if (result.isConditionMet) {
                    gbb.utility.renderTemporaryLoadingSpinner("show");
                    gbb.giftboxbuilderPage.action.onNextNavigationBYOB();
                    let isRenderSlotFooterEnable = gbb.settings.stepsConfigurationData?.isProductSlotsEnabled && gbb.gbbAddProductsPage?.state?.isEveryConditionHaveTypeQuantity
                    if (isRenderSlotFooterEnable) {
                        setTimeout(() => {
                            gbb.gbbAddProductsPage.f.autoScrollSlotsOnNavigation()
                        }, 1000)
                    }
                    gbb.utility.disableElement(gbbFooterNextButton, 1000);
                    return true;
                } else {
                    return false;
                }
            } catch (e) {
                gbb.utility.debugConsole(e);
            }
        },
        checkStepConditions: async function (noteAttribute, { productAmount, category, productQuantity, productWeight }) {
            //this function recognizes what kind of page type it is
            //single category page -> fire checkSingleCategoryPageConditions function
            //multiple category page ->
            //->check if page level conditions are enabled
            //if not enabled-> fire checkMultipleCategoryPageCondition function
            //else -> fire checkSingleCategoryPageConditions function
            // let productAmount = 
            let conditionResult;
            let pageType = gbb?.gbbAddProductsPage?.state?.productPageData?.pageType
            if (gbb.state.currentPageId == 'personalizationPage') {
                let options = {
                    productQtyToAdd : productQuantity
                }
                conditionResult = gbb.gbbAddonProducts.f.checkMaxAddonProductsConditions(options)
            } else if (pageType && pageType == "MULTIPLE_CATEGORY") {
                let globalConditions = gbb.gbbAddProductsPage.state.productPageData?.isPageConditionsEnabled;
                if (!globalConditions) {
                    // let options = {productAmount, goToNextStep, category, checkConditionsForOneCategoryOnNext, productQuantity}  
                    let options = {
                        productAmount: productAmount,
                        goToNextStep: false,
                        category: category,
                        checkConditionsForOneCategoryOnNext: false,
                        productQuantity: productQuantity,
                        productWeight: productWeight
                    }
                    conditionResult = await gbb.utility.checkMultipleCategoryPageCondition(noteAttribute, options);
                } else {
                    let options = {
                        productAmount: productAmount,
                        productQuantity: productQuantity,
                        goToNextStep: false,
                        productWeight: productWeight
                    }

                    conditionResult = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, options);
                }
            } else {
                let options = {
                    productAmount: productAmount,
                    productQuantity: productQuantity,
                    goToNextStep: false,
                    productWeight: productWeight
                }
                // conditionResult = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, productAmount, productQuantity, false);
                conditionResult = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, options);
            }

            return conditionResult;
        },
        checkMultipleCategoryPageConditionOnNext: async function (noteAttribute, categoriesData) {
            //this function is fired when we're trying to go from a "multiple category" page to next page and "pagelevel" conditions are not enabled on this page
            let result;

            let categories = JSON.parse(JSON.stringify(categoriesData));
            //sort the checkMultipleCategoryPageConditionOnNext and place the current category at the first

            let currentCategory = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;

            categories = categories.sort((a, b) => {
                if (a.categoryId == currentCategory) {
                    return -1;
                } else {
                    return 1;
                }
            });



            for (let index = 0; index < categories.length; index++) {
                // let options = {productAmount, goToNextStep, category, checkConditionsForOneCategoryOnNext, productQuantity}
                let options = {
                    productAmount: "",
                    goToNextStep: true,
                    category: categories[index]["categoryId"],
                    checkConditionsForOneCategoryOnNext: true,
                    productQuantity: ""
                }
                // result = await gbb.utility.checkMultipleCategoryPageCondition(noteAttribute, "", true, categories[index]["categoryId"], true, "");
                result = await gbb.utility.checkMultipleCategoryPageCondition(noteAttribute, options);
                if (!result.isConditionMet) {
                    break;
                }
            }
            return result;
        },
        checkMultipleCategoryPageCondition: async function (noteAttribute, { productAmount, goToNextStep, category, checkConditionsForOneCategoryOnNext, productQuantity, productWeight }) {
            //this function tells us if the conditions on multiple category page is satisfied
            //goToNextStep determines if productAmount or productQuantity values should be modified or not
            let categoryTitle;
            let categories = undefined
            categories = gbb.gbbAddProductsPage.state.productPageData.categories;
            categories = gbb.utility.convertObjectToArray(categories)

            if (goToNextStep && !checkConditionsForOneCategoryOnNext) {
                return gbb.utility.checkMultipleCategoryPageConditionOnNext(noteAttribute, categories);
            }
            let conditionResult = gbb.utility.getStepConditionsForMultipleCategoriesPage(categories, category);
            conditions = conditionResult.conditions;
            let categoryData = {
                categoryTitle: conditionResult.categoryTitle,
                categoryId: category
            }

            productAmount = gbb.utility.formatPriceWithoutSymbol(productAmount);
            let cartAmount, cartQuantity, cartResult;

            let pageType = "MULTIPLE_CATEGORY"
            let options = {
                productAmount: productAmount,
                productQuantity: productQuantity,
                goToNextStep: goToNextStep,
                category: category,
                pageType: pageType,
                productWeight: productWeight
            }
            let modifiedValues = await gbb.utility.modifyProductValuesToCheckCondiitons(noteAttribute, options)
            cartAmount = modifiedValues.result.cartAmount;
            cartQuantity = modifiedValues.result.cartQuantity;
            cartResult = modifiedValues.result.cartResult;
            cartWeight = modifiedValues.result.cartWeight;

            let dataForConditionsCheck = {
                conditions: conditions,
                cartAmount: cartAmount,
                cartQuantity: cartQuantity,
                cartResult: cartResult,
                goToNextStep: goToNextStep,
                categoryData: categoryData,
                cartWeight: cartWeight
            }

            let result = gbb.utility.loopThroughEachConditionAndCheck(conditions, dataForConditionsCheck);
            // result = {
            //     ...result,
            //     conditions: conditions
            // }
            return result;
        },
        checkSingleCategoryPageConditions: async function (noteAttribute, { productAmount, productQuantity, goToNextStep, productWeight }) {
            //this function tells us if the conditions on page is satisfied
            //goToNextStep determines if productAmount or productQuantity values should be modified or not
            let conditions = gbb.utility.getStepCondtions(noteAttribute);
            productAmount = gbb.utility.formatPriceWithoutSymbol(productAmount);
            let cartAmount, cartQuantity, cartResult, cartWeight;
            let options = {
                productAmount: productAmount,
                productQuantity: productQuantity,
                goToNextStep: goToNextStep,
                productWeight: productWeight
            }
            let modifiedValues = await gbb.utility.modifyProductValuesToCheckCondiitons(noteAttribute, options)
            cartAmount = modifiedValues.result.cartAmount;
            cartQuantity = modifiedValues.result.cartQuantity;
            cartResult = modifiedValues.result.cartResult;
            cartWeight = modifiedValues.result.cartWeight;
            let dataForConditionsCheck = {
                conditions: conditions,
                cartAmount: cartAmount,
                cartQuantity: cartQuantity,
                cartResult: cartResult,
                cartWeight: cartWeight,
                goToNextStep: goToNextStep
            }
            let result = gbb.utility.loopThroughEachConditionAndCheck(conditions, dataForConditionsCheck)
            // result = {
            //     ...result,
            //     conditions: conditions
            // }
            return result;
        },
        modifyProductValuesToCheckCondiitons: async function (noteAttribute, { productAmount, productQuantity, category, pageType, goToNextStep, productWeight }) {
            let cartResult = await gbb.utility.getStepCartData(noteAttribute, category, pageType);
            let cartQuantity = cartResult.quantity;
            let cartAmount = cartResult.amount;
            let cartWeight = cartResult.weight;
            gbb.utility.debugConsole("cartResult", cartResult);
            gbb.utility.debugConsole("ccartResult cartWeight", cartWeight);
            productAmount = parseInt(productAmount);
            if (!goToNextStep) {
                if (productQuantity) {
                    cartQuantity += productQuantity; //new cart quantity
                    productAmount = productAmount * productQuantity
                    productWeight = productWeight * productQuantity
                } else {
                    cartQuantity += gbb.gbbAddProductsPage.state.incrementProductQtyBy || 1;
                }
                cartAmount += productAmount;
                cartWeight += productWeight;
            }
            return { result: { cartAmount, cartQuantity, cartResult, cartWeight } };
        },
        loopThroughEachConditionAndCheck: function (conditions, { cartAmount, cartQuantity, cartResult, goToNextStep, categoryData, cartWeight }) {
            let categoryTitle = categoryData?.categoryTitle;
            let categoryId = categoryData?.categoryId;
            let pageType = gbb?.gbbAddProductsPage?.state?.productPageData?.pageType
            let result = {
                isConditionMet: true,
                message: "",
                conditions: conditions
            }

            let maxValue = 0;

            for (let j = 0; j < conditions.length; j++) {
                let currentCondtion = conditions[j]
                if (currentCondtion && currentCondtion.customValue){ // outdoor-dog-supply.com -> when merchant wants to handle conditions dynamically based on some custom logic 
                    // currentCondtion.customValue = "window.customStepCondition"
                    let customConditionValue = eval(currentCondtion.customValue) || currentCondtion.value
                    currentCondtion.value = customConditionValue
                }
                // get maxValue from the conditions array in the value field
                if (parseInt(conditions[j].value) > maxValue) {
                    maxValue = parseInt(conditions[j].value)
                }

                if (conditions[j].condition == "greaterThanOrEqualTo") {
                    maxValue = Number.MAX_SAFE_INTEGER;
                    break;
                }
            }



            for (let index = 0; index < conditions.length; index++) {
                let element = JSON.parse(JSON.stringify(conditions[index]));

                let allValuesFromConditions = conditions.map((condition) => {
                    return parseInt(condition.value)
                });
                element.maxValue = maxValue;

                let isThisLastElement = index - (conditions.length - 1) == 0 ? true : false
                let additionalInfo = {
                    conditions: conditions
                }
                if (element.type == "quantity") {
                    result.isConditionMet = gbb.utility.checkConditions(cartQuantity, element, goToNextStep);

                } else if (element.type == "amount") {
                    result.isConditionMet = gbb.utility.checkConditions(cartAmount, element, goToNextStep);
                } else if (element.type == "weight") {
                    //conver element value to grams
                    let weightValueInGrams = gbb.utility.convertToGrams(element.value, element.unit);
                    let weightConditionObject = {
                        ...element,
                        value: weightValueInGrams
                    }
                    result.isConditionMet = gbb.utility.checkConditions(cartWeight, weightConditionObject, goToNextStep);
                }

                let isAtleastOneTierSatisifed = false;
                if (element.condition == "equalTo") {
                    switch (element.type) {
                        case "quantity":
                            isAtleastOneTierSatisifed = allValuesFromConditions.includes(parseInt(cartQuantity))
                            break;
                        case "amount":
                            isAtleastOneTierSatisifed = allValuesFromConditions.includes(parseInt(cartAmount))
                            break;
                        case "weight":
                            isAtleastOneTierSatisifed = allValuesFromConditions.includes(parseInt(cartWeight))
                            break;
                    }
                }


                if (isAtleastOneTierSatisifed) {
                    result.isConditionMet = true;
                    break;
                }


                if (!result.isConditionMet) {
                    result.message = gbb.utility.getConditionMessage(element.type, element.condition);
                    let quantityVariables = gbb.utility.getQuantityVariables(element, cartResult, additionalInfo);
                    let amountVariables = gbb.utility.getAmountVariables(element, cartResult, additionalInfo);
                    let weightVariables = gbb.utility.getWeightVariables(element, cartResult, additionalInfo);
                    let message = gbb.utility.replaceConditionVariables(result.message, quantityVariables, amountVariables, weightVariables);
                    if (pageType && pageType == "MULTIPLE_CATEGORY") {
                        // scroll to categoryId
                        // write after clicking on category
                        // -100 for the top
                        // dont click on category if it's already clicked
                        if (gbb.utility.isCategoryOpen(categoryId)) {
                            gbb.utility.debugConsole("category already open")
                        } else {
                            gbb.$(`div[categoryId='${categoryId}']`).click()
                        }
                        // gbb.utility.scrollToCategory(categoryId, -100)

                        gbb.f.renderConditionNotificationToast(message, categoryTitle);
                    } else {
                        gbb.f.renderConditionNotificationToast(message);
                    }
                    break;
                }
            }
            return result;
        },
        getPageRankByPageId: function (pageId) {
            try {
                let navigationItems = gbb.state.navigationItems || [];
                let item = navigationItems.find(item => item?.id == pageId);
                return item?.rank;
            } catch (error) {
                gbb.utility.debugConsole("error in getPageRankByPageId", error)
            }
        },
        checkConditionsOnNext: async function (noteAttribute) {
            //this function is fired when we're going from current page to next page
            //if it's a single catgory page -> fire checkSingleCategoryPageConditions function
            //multiple category page ->
            //->check if page level conditions are enabled
            //if not enabled-> fire checkMultipleCategoryPageCondition function
            //else -> fire checkSingleCategoryPageConditions function
            //personalization page -> relevant conditions
            let condition;
            let pageType = gbb?.gbbAddProductsPage?.state?.productPageData?.pageType
            let options = {
                productAmount: "",
                productQuantity: "",
                goToNextStep: true
            }
            if (noteAttribute == "personalizePage" || gbb.state.currentPageId == 'personalizationPage') {
                condition = gbb.utility.checkPersonalizePageConditions();

            } else if (pageType && pageType == "MULTIPLE_CATEGORY") {
                let globalConditions = gbb.gbbAddProductsPage.state.productPageData?.isPageConditionsEnabled;
                if (!globalConditions) {
                    let categories = gbb.gbbAddProductsPage.state.productPageData.categories;
                    categories = gbb.utility.convertObjectToArray(categories)
                    condition = await gbb.utility.checkMultipleCategoryPageConditionOnNext(noteAttribute, categories);
                } else {
                    // condition = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, "", "", true);
                    condition = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, options);
                }

            } else {
                // condition = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, "", "", true);
                condition = await gbb.utility.checkSingleCategoryPageConditions(noteAttribute, options);
            }
            return condition;
        },
        checkPersonalizePageConditions: function () {
            let result = {
                isConditionMet: true, //because if text message and video message are both disabled -> isConditionMet should be true
                message: ""
            }
            if (gbb?.settings?.giftMessage?.isGiftMessageMandatory && (!gbb.gbbPersonalizePage.state?.giftMessage || gbb.gbbPersonalizePage.state?.giftMessage?.trim().length == 0)) {
                let warningMsg = gbb.$(".gbbPageBody").find(".gbbGiftMessageV2RequiredWarning");
                warningMsg.css("display", "block")
                result.isConditionMet = false;
                return result;
            } else {
                let warningMsg = gbb.$(".gbbPageBody").find(".gbbGiftMessageV2RequiredWarning");
                warningMsg.css("display", "none")
                result.isConditionMet = true;
            }

            let isEmailInfoValid = gbb.gbbPersonalizePage.f.verifyEmailFields();
            if (!isEmailInfoValid) {
                result.isConditionMet = false
            }
            let isAddonEnabled = gbb.gbbAddonProducts.state.isEnabled 
            if (isAddonEnabled) {
                let isAddonPageConditionMet = gbb.gbbAddonProducts.f.checkAddonsConditionsOnNext();
                if (!isAddonPageConditionMet) {
                    result.isConditionMet = false;
                    let message = gbb.utility.renderLanguageValue(gbb.settings?.languageData?.addons?.addonProductsMandatory) || "Please add atleast one product1"
                    gbb.f.renderConditionNotificationToast(message)
                }

            }
            return result;
        },
        getQuantityVariables: function (element, cartResult, additionalInfo) {
            let quantityVariables = {};

            let conditions = additionalInfo?.conditions || [];
            let isNextValueSet = false;

            if (element.condition == "equalTo") {
                for (let j = 0; j < conditions.length; j++) {
                    let item = conditions[j];
                    if ((parseInt(item.value) >= parseInt(cartResult.quantity)) && !isNextValueSet) {
                        // nextConditionalQuantity = item.value;
                        isNextValueSet = true;
                        element.value = item.value
                    }
                }
            }

            quantityVariables.currentQuantity = cartResult.quantity;
            quantityVariables.conditionQuantity = element.value;
            quantityVariables.remainingQuantity = Math.abs(quantityVariables.currentQuantity - quantityVariables.conditionQuantity);
            return quantityVariables;
        },
        getAmountVariables: function (element, cartResult, additionalInfo) {
            let amountVariables = {};
            let conditions = additionalInfo?.conditions || [];
            let isNextValueSet = false;

            if (element.condition == "equalTo") {
                for (let j = 0; j < conditions.length; j++) {
                    let item = conditions[j];
                    if ((parseInt(item.value) >= parseInt(cartResult.amount)) && !isNextValueSet) {
                        element.value = item.value
                        isNextValueSet = true;
                    }
                }
            }
            amountVariables.currentAmount = cartResult.amount;
            amountVariables.conditionAmount = element.value;
            amountVariables.remainingAmount = Math.abs(amountVariables.currentAmount - amountVariables.conditionAmount);
            return amountVariables;
        },
        getWeightVariables: function (element, cartResult, additionalInfo) {
            let weightVariables = {};

            let conditions = additionalInfo?.conditions || [];
            let isNextValueSet = false;

            if (element.condition == "equalTo") {
                for (let j = 0; j < conditions.length; j++) {
                    let item = conditions[j];
                    if ((parseInt(item.value) >= parseInt(cartResult.weight)) && !isNextValueSet) {
                        element.value = item.value
                        isNextValueSet = true;
                    }
                }
            }

            weightVariables.currentWeight = cartResult.weight;
            weightVariables.conditionWeight = element.value + String(element.unit);
            weightVariables.remainingWeight = Math.abs(weightVariables.currentWeight - weightVariables.conditionWeight) + String(element.unit);
            return weightVariables;
        },
        replaceConditionVariables: function (message, quantityVariables, amountVariables, weightVariables) {
            for (let [key, value] of Object.entries(quantityVariables)) {
                if (!value) {
                    value = ""
                }
                let VariableName = "##" + key + "##"
                //let VariableName = JSON.stringify(`{{${key}}}`)
                message = message.replace(new RegExp(`${VariableName}`, 'g'), value);
            }
            for (let [key, value] of Object.entries(amountVariables)) {
                if (!value) {
                    value = ""
                }
                let VariableName = "##" + key + "##"
                value = gbb.utility.getCurrencySymbol() + "" + value;
                message = message.replace(new RegExp(`${VariableName}`, 'g'), value);
            }
            for (let [key, value] of Object.entries(weightVariables)) {
                if (!value) {
                    value = ""
                }
                let VariableName = "##" + key + "##"
                message = message.replace(new RegExp(`${VariableName}`, 'g'), value);
            }
            return message;
        },
        getStepCondtions: function (noteAttribute) {
            let conditions = [];

            let addProductsPageArr = ADDPRODUCT_PAGES_LIST;
            let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey

            // convert this to if else
            if (addProductsPageArr.includes(noteAttribute)) {
                conditions = gbb.settings.stepsConfigurationData[keyAttribute].conditions || [];
            }

            return conditions;
        },
        getStepConditionsForMultipleCategoriesPage: function (categories, category) {
            let result = {
                categoryTitle: "",
                conditions: []
            }
            for (let index = 0; index < categories.length; index++) {
                let ele = categories[index];
                if (ele.categoryId == category) {
                    result.conditions = ele.conditions;
                    result.categoryTitle = ele.title || ""
                    break;
                }
            }
            return result;
        },
        getStepCartData: async function (noteAttribute, category, pageType) { //gets the total amount of the products added in a specific step
            let result = {
                amount: 0,
                quantity: 0,
                weight: 0
            }
            let cartData = await gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage() //if we should use the cart state

            let items = cartData.items;
            for (let index = 0; index < items.length; index++) {

                let item = items[index];
                if (item && item.properties && item.properties._boxProduct == noteAttribute) {

                    if (pageType && pageType == "MULTIPLE_CATEGORY") {
                        //document - metch category if MULTIPLE_CATEGORY page, 
                        if (item.properties._Category != category) {
                            continue
                        }
                    }

                    let amount = gbb.utility.formatPriceWithoutSymbol(item.price);
                    amount = amount * item.quantity;
                    result.amount += amount;
                    result.quantity += item.quantity
                    result.weight += item.weight * item.quantity
                }
            }
            return result;
        },
        executeRedirectAction: function () {
            try {

                let regionalLocale = gbb.utility.getRegionalLocaleFromUrl();
                if (gbb.settings.app.stackDiscounts) {
                    let discountString = gbb.gbbBrowser.prepareDiscountString();
                    if (discountString) {
                        gbb.gbbDiscountComponent.state.discountCode = discountString;
                    }
                }

                if (gbb.settings.app.redirectToScript && gbb.settings.app.redirectToScript?.trim()?.length != 0) {
                    const codeString = gbb.settings.app.redirectToScript;
                    eval(codeString);
                } else if (gbb.settings.app.redirectToCheckoutEnabled) {
                    if (gbb.gbbDiscountComponent.state.discountCode) {
                        // https://{domain}/discount/{discountCode}?redirect=/checkout
                        window.location.href = window.location.origin + regionalLocale + "/cart/checkout?discount=" + gbb.gbbDiscountComponent.state.discountCode;
                        // window.location.href =  window.location.origin + "/discount/" + gbb.gbbDiscountComponent.state.discountCode+"?redirect=/checkout";
                    }
                    else {
                        window.location.href = window.location.origin + regionalLocale + "/cart/checkout";
                    }
                } else if (gbb.settings.app.redirectToCartEnabled) {
                    window.location.href = window.location.origin + regionalLocale + "/cart/";
                } else {
                    if (gbb.gbbDiscountComponent.state.discountCode) {
                        window.location.href = window.location.origin + regionalLocale + "/cart/checkout?discount=" + gbb.gbbDiscountComponent.state.discountCode;
                        // window.location.href =  window.location.origin + "/discount/" + gbb.gbbDiscountComponent.state.discountCode+"?redirect=/checkout";
                    }
                    else {
                        window.location.href = window.location.origin + regionalLocale + "/cart/checkout";
                    }
                }
            } catch (err) {
                gbb.utility.debugConsole(err + "inside executeRedirectAction");
            }
        },

        loadCheckoutPage: async function () {

            if (gbb.state.giftBoxCartData?.items?.length > 0 && gbb.settings?.discountsData?.isDiscountEnabled && gbb.gbbDiscountComponent?.state?.discountCode) {
                // window.location.href = window.location.origin + "/discount/" + gbb.gbbDiscountComponent.state.discountCode + "?redirect=" + window.location.pathname
                // const discountResp = await fetch("/discount/" + gbb.gbbDiscountComponent.state.discountCode);
                // if (response.status == 200) {
                // window.location.href = window.location.origin + "/cart/checkout"
                // gbb.utility.executeRedirectAction();
                // }

                await fetch("/discount/" + gbb.gbbDiscountComponent.state.discountCode)
                    .then(resp => resp.json())
                    .then((response) => {
                        //response.data
                        if (response.data.isAutomatic) {
                            setTimeout(() => {
                                gbb.utility.executeRedirectAction();
                            }, 1000);
                        } else {
                            gbb.utility.executeRedirectAction();
                        }
                    }).catch((err) => {
                        gbb.utility.debugConsole(err);
                        gbb.utility.executeRedirectAction();
                    })

                return;
            }

            gbb.utility.executeRedirectAction();
        },
        getVariantDetailsFromCurrentProductsDataSet: function (variantId,origin) { 
            try {
                let variantDetails = gbb.state.currentProductsDataSetForVariants[variantId];
                if (origin == 'addonProducts') {
                    variantDetails = gbb.gbbAddonProducts.state.currentProductsDataSetForVariants_addons[variantId]
                }
                return variantDetails;
            } catch (error) {
                gbb.utility.debugError("error in getVariantDetailsFromCurrentProductsDataSet",error)
            }
        },
        getProductDetailsFromState: function (productId, variantId) {
            let productDetails = {};
            let productsDbToSearchIn = gbb.gbbAddProductsPage.state.currentProductsDataset
            let addonProductsState = gbb.gbbAddonProducts.state
            let isAddonProductDataSetExists = addonProductsState?.addonProductsDataSet?.length > 0
            let isCurrentPageTypePersonalization = gbb.state.currentPageId == 'personalizationPage'
            let eligibleTierForAddons = addonProductsState?.eligibleTierForAddons || {}

            if (isCurrentPageTypePersonalization && Object.keys(eligibleTierForAddons).length>0 && isAddonProductDataSetExists) {
                productsDbToSearchIn = addonProductsState?.addonProductsDataSet
            }

            for (let i = 0; i < productsDbToSearchIn?.length; i++) {
                let product = productsDbToSearchIn[i];
                if (product.id == productId) {
                    let variantDetails;
                    productDetails = product;
                    let isDisplayVariantsAsIndividualProductsEnabled = gbb.gbbAddProductsPage.state.displayVariantsAsIndividualProducts

                    if (isCurrentPageTypePersonalization) {
                        let activeTierIndex = eligibleTierForAddons?.tierIndex
                        isDisplayVariantsAsIndividualProductsEnabled = addonProductsState.tiers[activeTierIndex]?.displayVariantsAsIndividualProducts_addons// read from addon
                    }

                    if (variantId && isDisplayVariantsAsIndividualProductsEnabled) {
                        let origin = isCurrentPageTypePersonalization ? "addonProducts": null
                        variantDetails = gbb.utility.getVariantDetailsFromCurrentProductsDataSet(variantId, origin)
                        gbb.utility.debugConsole("variants name is ", variantDetails.title);
                        product.variants = [variantDetails];
                        product = gbb.gbbAddProductsPage.f.updateProductDataWithFirstVariantData(product);
                        productDetails = product;
                        break;  // Exit the loop once we found the product
                    }
                }
            }
            return productDetails;
        },
        closeVariantsModal: function () {
            try {
                gbb.utility.slider.state.slideIndex = 1;
                gbb.state.variantCustomProperties = {};
                gbb.state.currentModalProductData = {};
                gbb.gbbProductFormStep.state.formSubmissionData = {};
                // gbb.$("body").css("overflow-y", "auto");
                gbb.$("body").find(".gbbProductVariantModalContainer").remove()
                gbb.$("body").find(".gbbProductVariantModalMainContainer").remove()
                gbb.$("body").css("overflow-y", DEFAULT_BODY_OVERFLOW_VALUE);
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: "gbb-variants-modal-close",
                })
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        productDetailsWith_VariantId_Or_ProductIdAsKey: function (products, extraInfo) {
            //products is an objects with product handle as key
            //this function returns an object with product id as key
            let productsWithIdAsKey = {};
            for (let [key, value] of Object.entries(products)) {
                let product = value
                //if product has variants
                if (product.variants.length > 0) {

                    // if product.variants.length == 1;
                    // change product.featured_image to product.variants[0].image

                    //if there is only one variant in the product
                    // then change the product.featured_image to an image
                    // using product.media[]
                    if (product.variants.length == 1) {
                        let getNewImageAndMediaObjectWhenOnlyOneVariant = gbb.utility.getNewImageAndMediaObjectWhenOnlyOneVariant(product);
                        product.featured_image = getNewImageAndMediaObjectWhenOnlyOneVariant.newFeaturedImage;
                        product.media = getNewImageAndMediaObjectWhenOnlyOneVariant.newMedia;
                        product.images = getNewImageAndMediaObjectWhenOnlyOneVariant.newImages
                    }

                    for (let i = 0; i < product.variants.length; i++) {
                        product.variants[i]["productTags"] = product.tags;
                        product.variants[i].variant_id = product.variants[i].id;
                        product.variants[i].image = product.variants[i].featured_image?.src;
                        if (!product.variants[i].image) {
                            product.variants[i].image = product.featured_image
                        }

                        if (extraInfo == undefined || product.variants[i].title == "" || product?.variants?.length == 1) {
                            product.variants[i].title = product.variants[i].name
                        } else if (!extraInfo.shouldVariantTitleBeConvertedToProductTitle) {
                            product.variants[i].title = product.variants[i].title
                        }
                        product.variants[i].product_id = product.id
                        product.variants[i].productHandle = product.handle;
                        if (product.selling_plan_groups) {
                            //product.variants[i].sellingPlanDetails = gbb.utility.getSellingPlanDetailsForVariant(product?.selling_plan_groups, product.variants[i]?.selling_plan_allocations)
                            product.variants[i].selling_plan_groups = product.selling_plan_groups || [];
                            product.variants[i].selling_plan_allocations = product?.variants[i]?.selling_plan_allocations || [];
                        }
                        productsWithIdAsKey[product.variants[i].id] = product.variants[i];

                    }
                }

                //if product has no variants
                else {
                    productsWithIdAsKey[product.id] = product;
                }
            }

            return productsWithIdAsKey;
        },
        doesThisProductHaveConditions: function (currentProductProperties) {
            // const pagesWhichHaveConditionsOnPages = 
            const categoriesWhichHaveConditions = gbb.gbbAddProductsPage.state.categoriesWhichHaveConditions;
            const pagesWhichHaveConditionsOnPages = gbb.gbbAddProductsPage.state.pagesWhichHaveConditionsOnPages;
            if (pagesWhichHaveConditionsOnPages.includes(currentProductProperties._boxProduct) || categoriesWhichHaveConditions.includes(currentProductProperties._Category)) {
                return true;
            } else {
                return false;
            }

        },
        prepareMsgAttributesForCart: function () {
            try {
                let videoRecordId;
                let videoToggle = gbb.$(".gbbVideoMsgCheckboxField").is(":checked")
                if (videoToggle == false) {
                    videoRecordId = "";
                    gbb.gbbVideoMsg.state.uploadedVideoId = ""
                } else {
                    videoRecordId = gbb.gbbVideoMsg?.state?.uploadedVideoId;
                }

                gbb.gbbVideoMsg.state.uploadedVideoId = videoRecordId;

                if (!gbb.gbbPersonalizePage.state.giftMessage && !gbb.gbbVideoMsg.state.uploadedVideoId) {
                    quantity = 0;
                }



                return {
                    message: gbb.gbbPersonalizePage.state.giftMessage,
                    recipientName: gbb.gbbPersonalizePage.state.recipientName,
                    senderName: gbb.gbbPersonalizePage.state.senderName,
                    customerUploads: gbb.gbbPersonalizePage.state.customerUploadsResponse,
                    _videoMsgId: videoRecordId ? videoRecordId : null,
                    email: gbb.gbbVideoMsg?.state?.emailId,
                    _gbbEmailDeliveryOption: gbb?.gbbPersonalizePage?.state?.emailDeliveryOption,
                    _gbbEmailDeliveryDate: gbb?.gbbPersonalizePage?.state?.emailDatePicker ? gbb?.gbbPersonalizePage?.state?.emailDatePicker?.val() : "",
                }
            } catch (e) {
                gbb.utility.debugConsole(e)
                return false
            }
        },
        getActiveCurrencyRate: function () {
            let currencyRate = 1;
            if (window.Shopify && window.Shopify.currency && window.Shopify.currency.rate) {
                currencyRate = window.Shopify.currency.rate;
            }
            return currencyRate;
        },
        multiplyByBundleQuantity: function (cartData) {
            let cart = { ...cartData }
            cartData.bundleQuantity = cartData.boxQuantity || 1;
            let bundleQuantity = cartData?.bundleQuantity || 1;

            if (bundleQuantity > 1) {
                cart.items.forEach((item) => {
                    item.quantity = item.quantity * bundleQuantity;
                });
                cart.item_count = cart.item_count * bundleQuantity;
                cart.total_price = cart.total_price * bundleQuantity;
            }
            return cart;
        },
        applySellingPlanToAllCartItems: function (cartData) {
            let subscriptionPlan = gbb.gbbBrowser.getSubscriptionPlan();
            if (subscriptionPlan) {
                for (let i = 0; i < cartData.items.length; i++) {
                    delete cartData.items[i]?.selling_plan_allocations;
                    delete cartData.items[i]?.selling_plan_groups;
                    delete cartData.items[i]?.sellingPlanDetails;
                    cartData.items[i].selling_plan = parseInt(subscriptionPlan);
                }
            }
            return cartData;
        },
        applySellingPlanToAllCartItemsV2: function (cartData) {
            let activeSellingPlanId = gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId
            if (activeSellingPlanId) {
                for (let i = 0; i < cartData.items.length; i++) {
                    delete cartData.items[i]?.selling_plan_allocations;
                    delete cartData.items[i]?.selling_plan_groups;
                    delete cartData.items[i]?.sellingPlanDetails;
                    cartData.items[i].selling_plan = parseInt(activeSellingPlanId);
                }
            }
            return cartData
        },
        checkIfBrandingShouldBeVisible: function (type) {
            try {

                // createdAt is more than 2months;
                let todayDate = new Date();
                let createdAt = new Date(gbb.settings.merchantInfo.createdAt);

                let storeIsOld = false;
                let diffTime = Math.abs(todayDate - createdAt);

                let diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays > 14) {
                    storeIsOld = true
                }

                if (!gbb.settings.merchantInfo?.isSubscription && storeIsOld) {
                    return false;
                }

                if (!gbb.settings?.merchantInfo?.isSubscription) {
                    return true;
                }
                if (gbb.settings?.merchantInfo?.isSubscription && gbb.settings?.merchantInfo?.isSubscription.name.search('Free') !== -1 && !type && type !== 'checkout') {
                    return true;
                }
                return false;
            } catch (error) {
                gbb.utility.debugConsole("error in checkIfBrandingShouldBeVisible", error);
                return false;
            }
        },
        renderPoweredByLabel: function () {
            let gbbPoweredByLabel = gbb.$("<a>")
                .attr("href", "https://apps.shopify.com/bundle-builder").attr("target", "_blank")
                .css("text-align", "end").css("display", "block").css("color", "black").css("font-size", "14px").css("text-decoration", "none");
            gbbPoweredByLabel.text("✨Powered By Easy Bundles✨");
            return gbbPoweredByLabel;
        },
        triggerSlackNotification: function (jsonBody) {
            jsonBody = jsonBody || {};

            gbb.utility.debugConsole("jsonBody", jsonBody)
            jsonBody = {
                errorStack: jsonBody?.stack || jsonBody?.error?.stack,
                errorName: jsonBody?.name || jsonBody?.error?.name,
                errorMessage: jsonBody?.message || jsonBody?.error?.message,
                sessionStorage: gbb.gbbBrowser.getCartDataFromSessionStorage(),
                ...jsonBody
            }

            const tempObj = {
                url: window.location.href,
                function: arguments?.callee?.caller?.name || "unknown",
                error: JSON.stringify(jsonBody)
            }


            let url = gbb.settings.SERVER_URL + "/api/utility/slackNotification";
            fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(tempObj),
            }).then((response) => {
                gbb.utility.debugConsole("response", response)
            }).catch((error) => {
                gbb.utility.debugConsole("error", error)
            })

        },
        /** overwrites particular html tags 
        * example: overwrite tab/document name
        * @returns void 
        */
        setBuilderPageHTMLData_SEO: function () {
            try {
                // page
                let seoData = gbb.settings?.bundleSettings.builderPageSeoData || [];

                // 
                // example
                // [{
                //     target: "title",
                //     value: "Bundle Builder"
                //     // attributeToOverwrite field is not needed as attribute to overwrite as it's a text
                // },
                // {
                //     target: "meta[name='description']",
                //     value: "Bundle Builder",
                //     attributeToOverwrite: "content"
                // }]

                seoData.forEach((data) => {
                    if (data.attributeToOverwrite && data.target && data.value) {
                        // gbb.$(data.target).attr("content", data.value);
                        gbb.$(data.target).attr(data.attributeToOverwrite, data.value);
                    }
                    else if (data.target && data.value) {
                        gbb.$(data.target).text(data.value);
                    }
                })

            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        stringifyError: function (error) {
            const properties = Object.getOwnPropertyNames(error);
            const stringifiedError = JSON.stringify(
                (function () {
                    const obj = {};
                    for (let i = 0; i < properties.length; i++) {
                        const prop = properties[i];
                        obj[prop] = error[prop];
                    }
                    return obj;
                })()
            );
            return stringifiedError;
        },
        cleanUpProperties: function (cart) {
            let cartData = { ...cart }
            let propertiesToRemove = ["addProductsPage", "categoryId", "_Category", "category", "_boxProduct", "productPersonalizationMetaData", "_uniqueGbbItemKey"]
            let conditionalPropertiesToRemove = [];
            if (!gbb?.settings?.bundleSettings?.showCategoryNamesInLineItem) {
                conditionalPropertiesToRemove.push("_CategoryName");
                // propertiesToRemove.push("discount")
            }

            // now lets combine 
            propertiesToRemove = [...propertiesToRemove, ...conditionalPropertiesToRemove];

            cartData.items.forEach((item) => {
                propertiesToRemove.forEach((property) => {
                    if (item.properties && item.properties[property]) {
                        delete item.properties[property];
                    }
                });
            })
            return cartData;
        },
        addCustomProperties: function (cartData, propertiesToAdd,addQtyOfProduct=false) {
            try {
                cartData.items.forEach((item) => {
                    for (let [key, value] of Object.entries(propertiesToAdd)) {
                        let valueToAdd = addQtyOfProduct ? `${value}_${item.quantity}` : value;
                        item.properties[key] = valueToAdd
                    }
                })
                return cartData
            } catch (error) {
                gbb.utility.debugConsole('error in addCustomProperties',error)
            }
        },
        checkIfRemoveButtonShouldBeAppended: function (variantId, pageIdTheProductWasAddedFrom) {
            try {
                let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                if (boxCartDataInSessionStorage) {
                    let items = boxCartDataInSessionStorage.items || [];
                    let currentItem = items.find((item) => item.variant_id == variantId && pageIdTheProductWasAddedFrom == item.properties["_boxProduct"]);
                    // let currentite,
                    if (currentItem) {
                        let item = { ...currentItem };
                        let properties = Object.keys(item.properties) || [];
                        if (properties.includes("_DefaultProduct")) {
                            return false;
                        }

                        if (item.properties._boxProduct == "giftMessage" && gbb.state.currentPageId !== "personalizationPage") {
                            if (gbb.settings.stepsConfigurationData.personalizationData.giftMessage.isGiftMessageMandatory) {
                                return false;
                            } else {
                                return true;
                            }
                        }
                        if (gbb.state.currentPageId == 'personalizationPage' && item.properties._boxProduct == 'addonProduct'){
                            return true;
                        }
                        if (pageIdTheProductWasAddedFrom == gbb.state.currentPageId) {
                            if (item.properties && item.properties._boxProduct != gbb.state.currentPageId) {
                                // now check if this doesThisProductHaveConditions
                                let doesThisProductHaveConditions = gbb.utility.doesThisProductHaveConditions(item.properties);
                                let isConditionalProductFilteringEnabled = gbb.settings.stepsConfigurationData.conditionalLogic.isEnabled || gbb.settings.stepsConfigurationData.conditionalLogic.rules.length > 0
                                gbb.utility.debugConsole("doesThisProductHaveConditions", doesThisProductHaveConditions)
                                if (doesThisProductHaveConditions || isConditionalProductFilteringEnabled) {
                                    return false;
                                } else {
                                    return true;
                                }
                            } else {
                                return true;
                            }
                        } else {
                            return false;
                        }
                    }
                }
                return true;
            } catch (err) {
                gbb.utility.debugConsole(err + "inside checkIfRemoveButtonShouldBeAppended");
            }
        },
        updateBoxIdInCartData: function (cartData) {
            try {

                let currentBoxIdFromCart = gbb.gbbBrowser.state.boxIdOffset || 0;
                if (currentBoxIdFromCart == 0) {
                    gbb.utility.debugConsole("Adding to cart....")
                    return cartData;
                } else {
                    gbb.utility.debugConsole("Aheem. Looks like theres already a box in the cart.")
                    gbb.utility.debugConsole("next boxId starts from->", currentBoxIdFromCart + 1)
                    let cartDataUpdated = { ...cartData };

                    let boxKeys = Object.keys(cartDataUpdated?.boxes) || [];

                    for (let i = 0; i < boxKeys.length; i++) {
                        let boxItem = cartDataUpdated.boxes[boxKeys[i]];

                        boxItem.items.forEach(item => {
                            const existingBoxID = item.properties["Box ID"];
                            item.properties["Box ID"] = parseInt(existingBoxID) + currentBoxIdFromCart;
                        });
                    }
                    return cartDataUpdated;
                }
            } catch (error) {
                gbb.utility.debugConsole("error in updateBoxIdInCartData", error)
                return cartData;
            }
        },
        removeAlreadyAddedProductsFromShopifyCart: async function () {
            try {
                let bundleName = gbb?.settings?.stepsConfigurationData?.bundleName;
                let boxIdOffset = parseInt(gbb.gbbBrowser.state.boxIdOffset);
                let qty = 0;
                let data = { updates: {} };
                let result = true;
                if (bundleName) {
                    let shopifyCartItems = await gbb.shopifyUtility.getCart();
                    shopifyCartItems = shopifyCartItems.items;
                    if (shopifyCartItems.length > 0) {
                        for (let i = 0; i < shopifyCartItems.length; i++) {
                            let item = shopifyCartItems[i];
                            let itemBundleName = item.properties["Bundle"];
                            let itemBoxId = parseInt(item.properties["Box ID"]);
                            if (itemBundleName && itemBundleName == bundleName && itemBoxId > boxIdOffset) { //tbd more conditions?
                                data.updates[shopifyCartItems[i]["key"]] = qty;
                            }
                        }
                        if (Object.keys(data?.updates)?.length > 0) {
                            result = await gbb.shopifyUtility.updateCart(data);
                        }
                    }
                }
                return result;
            } catch (err) {
                gbb.utility.debugConsole(err);
                return false;
            }
        },

        renderPreparingBundleModal: function () {
            try {
                const gbbPreparingBundleMainContainer = gbb.$("<div>").addClass("gbbPreparingBundleMainContainer");
                const gbbPreparingBundleContainerModal = gbb.$("<div>").addClass("gbbPreparingBundleContainerModal");

                const gbbPreparingBundleHeader = gbb.$("<div>").addClass("gbbPreparingBundleHeader");
                gbbPreparingBundleHeader.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.preparingBundleText) || "Preparing Bundle...");

                let preparingBundleGif = gbb.settings.merchantInfo?.customSettings?.preparingBundleGif || "https://d3ks0ngva6go34.cloudfront.net/public/packagingbundle.gif";
                const gbbPreparingBundleGifContainer = gbb.$("<div>").addClass("gbbPreparingBundleGifContainer");
                const gbbPreparingBundleGif = gbb.$("<img>").addClass("gbbPreparingBundleGif").attr("src", preparingBundleGif);

                gbbPreparingBundleGifContainer.append(gbbPreparingBundleGif);

                gbbPreparingBundleContainerModal.append(gbbPreparingBundleHeader);
                gbbPreparingBundleContainerModal.append(gbbPreparingBundleGifContainer);
                gbbPreparingBundleMainContainer.append(gbbPreparingBundleContainerModal);
                gbb.$("body").append(gbbPreparingBundleMainContainer);
                gbb.f.applyFontToPreparingBundlePopup();
            } catch (err) {
                gbb.utility.debugConsole("error inside renderPreparingBundleModal:", err);
            }
        },

        renderUnavaibleProductsModal: async function (products) {
            const gbbUnavailableProductsMainContainer = gbb.$("<div>").addClass("gbbUnavailableProductsMainContainer");
            const gbbUnavailableProductsContainerModal = gbb.$("<div>").addClass("gbbUnavailableProductsContainerModal");

            const gbbCartProductsContainerHeader = gbb.$("<div>").addClass("gbbCartProductsContainerHeader");
            const gbbCartProductsContainerHeaderLabel = gbb.$("<div>").addClass("gbbCartProductsContainerHeaderLabel").text(gbb.settings?.languageData?.general?.productsNotAvailableText?.value || "Oops! Some products are not availble..");

            const gbbCartProductsContainerBody = gbb.$("<div>").addClass("gbbCartProductsContainerBody");

            const gbbCartModalProductsContainer = gbb.$("<div>").addClass("gbbCartModalProductsContainer");


            products.forEach((product) => {
                const gbbCartModalProductContainer = gbb.$("<div>").addClass("gbbCartModalProductContainer");
                //attach a data attriute to the product container
                gbbCartModalProductContainer.attr("productId", product?.product_id);
                gbbCartModalProductContainer.attr("variantId", product?.variant_id)

                const gbbCartProductImageContainer = gbb.$("<div>").addClass("gbbCartProductImageContainer");
                const gbbCartModalProductImage = gbb.$("<img>").addClass("gbbCartModalProductImage");
                gbbCartModalProductImage.attr("src", product.image);
                const gbbCartModalProductTextContainer = gbb.$("<div>").addClass("gbbCartModalProductTextContainer");

                const gbbCartModalProductTitleContainer = gbb.$("<div>").addClass("gbbCartModalProductTitleContainer");
                const gbbCartModalProductTitle = gbb.$("<div>").addClass("gbbCartModalProductTitle");
                const gbbCartModalProductQuantity = gbb.$("<div>").addClass("gbbCartModalProductQuantity");

                const gbbCartModalProductPriceQtyContainer = gbb.$("<div>").addClass("gbbCartModalProductPriceQtyContainer");
                const gbbCartModalProductPrice = gbb.$("<div>").addClass("gbbCartModalProductPrice");
                //a button to remove the product from the cart

                gbbCartModalProductTitle.text(product.title);
                gbbCartModalProductPrice.text(gbb.utility.formatPrice(product.price));
                gbbCartModalProductQuantity.text("x" + product.quantity);
                gbbCartProductImageContainer.append(gbbCartModalProductImage);

                gbbCartModalProductTitleContainer.append(gbbCartModalProductTitle);
                //gbbCartModalProductTitleContainer.append(gbbCartModalProductQuantity);

                gbbCartModalProductTextContainer.append(gbbCartModalProductTitleContainer);
                gbbCartModalProductPriceQtyContainer.append(gbbCartModalProductQuantity);
                gbbCartModalProductPriceQtyContainer.append(gbbCartModalProductPrice);
                gbbCartModalProductTextContainer.append(gbbCartModalProductPriceQtyContainer);

                gbbCartModalProductContainer.append(gbbCartProductImageContainer);
                gbbCartModalProductContainer.append(gbbCartModalProductTextContainer);
                gbbCartModalProductsContainer.append(gbbCartModalProductContainer);
            })

            gbbCartProductsContainerHeader.append(gbbCartProductsContainerHeaderLabel);

            gbbCartProductsContainerBody.append(gbbCartModalProductsContainer);

            let checkoutButtonText = gbb?.settings?.languageData?.general?.checkoutButtonText?.value || "Checkout";

            if (gbb.settings.app.redirectToCartEnabled && !gbb.settings.app.redirectToCheckoutEnabled) {
                checkoutButtonText = gbb?.settings?.languageData?.general?.addToCartButtonText?.value || "Add to Cart";
            }
            const gbbUnavailableProductsModalFooter = gbb.$("<div>").addClass("gbbUnavailableProductsModalFooter");
            const gbbUnavailableProductsModalFooterBackBtn = gbb.$("<div>").addClass("gbbUnavailableProductsModalFooterBackBtn");
            gbbUnavailableProductsModalFooterBackBtn.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.backButtonText) || "Back to Bundle")
            gbbUnavailableProductsModalFooterBackBtn.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonColor);
            gbbUnavailableProductsModalFooterBackBtn.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonTextColor);
            gbbUnavailableProductsModalFooterBackBtn.on("click", async () => {
                gbbUnavailableProductsModalFooterBackBtn.addClass("gbbDisabled")
                gbbUnavailableProductsModalFooterCheckoutBtn.addClass("gbbDisabled")
                let removeProducts = await gbb.utility.removeAlreadyAddedProductsFromShopifyCart();
                gbbUnavailableProductsModalFooterBackBtn.removeClass("gbbDisabled")
                gbbUnavailableProductsModalFooterCheckoutBtn.removeClass("gbbDisabled")
                if (removeProducts) {
                    gbb.$("body").find(".gbbUnavailableProductsMainContainer").remove()
                }
                gbb.$("body").find(".gbbSummaryPageCheckoutButton").removeClass("gbbDisabled")

                gbb.$("body").find(".gbbSummaryPageCheckoutButton").text(checkoutButtonText);
                gbb.$("body").find(".gbbSummaryPageCreateNewBoxButton").removeClass("gbbDisabled")
            })

            const gbbUnavailableProductsModalFooterCheckoutBtn = gbb.$("<div>").addClass("gbbUnavailableProductsModalFooterCheckoutBtn");
            gbbUnavailableProductsModalFooterCheckoutBtn.text(checkoutButtonText)
            gbbUnavailableProductsModalFooterCheckoutBtn.css("background", gbb.settings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonColor)
            gbbUnavailableProductsModalFooterCheckoutBtn.css("color", gbb.settings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonTextColor)
            gbbUnavailableProductsModalFooterCheckoutBtn.on("click", async (event) => {
                event.preventDefault();
                event.stopPropagation();
                gbbUnavailableProductsModalFooterBackBtn.addClass("gbbDisabled")
                gbbUnavailableProductsModalFooterCheckoutBtn.addClass("gbbDisabled")
                gbbUnavailableProductsModalFooterCheckoutBtn.text(gbb.settings.languageData.general?.loadingCheckoutButtonText?.value || "Loading ...1")
                await gbb.utility.applyDiscountOnCheckout();
                gbb.gbbBrowser.clearCartDataFromSessionStorage();
                setTimeout(() => {
                    gbb.$("body").find(".gbbUnavailableProductsMainContainer").remove()
                }, 5000)
                await gbb.utility.loadCheckoutPage();
            })

            gbbUnavailableProductsModalFooter.append(gbbUnavailableProductsModalFooterBackBtn);
            gbbUnavailableProductsModalFooter.append(gbbUnavailableProductsModalFooterCheckoutBtn);

            const gbbUnavailableProductsModalDiscountsMayNotApplyText = gbb.$("<div>").addClass("gbbUnavailableProductsModalDiscountsMayNotApplyText");
            gbbUnavailableProductsModalDiscountsMayNotApplyText.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.discountsMayNotApplyText) || "discounts may not be applied")

            gbbUnavailableProductsContainerModal.append(gbbCartProductsContainerHeader);
            gbbUnavailableProductsContainerModal.append(gbbCartProductsContainerBody);
            gbbUnavailableProductsContainerModal.append(gbbUnavailableProductsModalFooter);
            gbbUnavailableProductsContainerModal.append(gbbUnavailableProductsModalDiscountsMayNotApplyText);


            gbbUnavailableProductsMainContainer.append(gbbUnavailableProductsContainerModal);
            gbb.$("body").append(gbbUnavailableProductsMainContainer);
            gbb.f.applyFontToUnavailableProductsPopup();
        },

        handleBackButtonReload : function () {
            try {
                window.addEventListener("pageshow", function (event) {
                    var historyTraversal = event.persisted ||
                        (typeof window.performance != "undefined" &&
                            window.performance.navigation.type === 2);
                    if (historyTraversal) {
                        // Handle page restore.
                        //or just move the user to the first page of the app
                        // alert("historyTraversal")
                        //   gbb.gbbBrowser.redirectToFirstProductPage();
                        window.location.reload();
                    }
                });
            } catch (err) {
                gbb.utility.debugConsole("error inside handleBackButtonReload", err);
            }
        },

        renderActivatePricingPopup: function () {
            try {
                const gbbActivatePricingMainContainer = gbb.$("<div>").addClass("gbbActivatePricingMainContainer");
                const gbbActivatePricingContainerModal = gbb.$("<div>").addClass("gbbActivatePricingContainerModal");

                const gbbActivatePricingHeader = gbb.$("<div>").addClass("gbbActivatePricingHeader");
                const headerHtml = "<span>Oops! Seems like the bundle plan <br/> isn't setup correctly!</span>";
                gbbActivatePricingHeader.html(headerHtml);

                const gbbActivatePricingDescription = gbb.$("<div>").addClass("gbbActivatePricingDescription");
                const descriptionHtml = "<span>Please contact the merchant to complete <br/> your bundle purchase.</span>";
                gbbActivatePricingDescription.html(descriptionHtml);

                const gbbActivatePricingImgContainer = gbb.$("<div>").addClass("gbbActivatePricingImgContainer");
                const gbbActivatePricingImg = gbb.$("<img>").addClass("gbbActivatePricingImg").attr("src", "https://gift-box-builder-app4.s3.us-east-2.amazonaws.com/public/icons/activate_pricing_popup_image.png");

                const gbbActivatePricingButtonContainer = gbb.$("<div>").addClass("gbbActivatePricingButtonContainer");
                const gbbActivatePricingButton = gbb.$("<button>").addClass("gbbActivatePricingButton");
                gbbActivatePricingButton.text('Complete the setup');
                gbbActivatePricingButtonContainer.append(gbbActivatePricingButton);

                gbbActivatePricingButton.on("click", async () => {
                    window.open(`https://${gbb?.settings?.merchantInfo?.shopName}/admin/apps/10b4272bede142b02924feec498b4009/pricing`, "_blank");
                })

                const gbbActivatePricingPoweredByContainer = gbb.$("<div>").addClass("gbbActivatePricingPoweredByContainer");
                const poweredByLabelHtml = "<span>✨Powered by <b>EasyBundles</b>✨</span>";
                gbbActivatePricingPoweredByContainer.html(poweredByLabelHtml);

                const gbbActivatePricingNoteContainer = gbb.$("<div>").addClass("gbbActivatePricingNoteContainer");
                const noteLabelHtml = "<span>NOTE: Once the pricing is activated, refresh this page.</span>";
                gbbActivatePricingNoteContainer.html(noteLabelHtml);

                gbbActivatePricingImgContainer.append(gbbActivatePricingImg);
                gbbActivatePricingContainerModal.append(gbbActivatePricingImgContainer);
                gbbActivatePricingContainerModal.append(gbbActivatePricingHeader);
                gbbActivatePricingContainerModal.append(gbbActivatePricingDescription);
                gbbActivatePricingContainerModal.append(gbbActivatePricingButtonContainer);
                gbbActivatePricingContainerModal.append(gbbActivatePricingNoteContainer);
                gbbActivatePricingContainerModal.append(gbbActivatePricingPoweredByContainer);
                gbbActivatePricingMainContainer.append(gbbActivatePricingContainerModal);
                gbb.$("body").append(gbbActivatePricingMainContainer);

            } catch (err) {
                gbb.utility.debugConsole("error inside renderActivatePricingPopup", err);
            }
        },

        handleCheckoutClick: async function () {
            try {
                // if(gbb.utility.checkIfBrandingShouldBeVisible('checkout')) {
                //     gbb.utility.renderActivatePricingPopup();
                //     return;
                // }
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: "gbb-checkout-initiated",
                })
                gbb.utility.handleBackButtonReload();

                await gbb.utility.removeZeroPriceBoxes();
                let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
                if (!cartData || Object.keys(cartData?.boxes)?.length == 0) {
                    await gbb.utility.loadCheckoutPage();
                    return;
                }
                let isGiftMessageVirtualProduct = gbb.settings.bundleSettings?.isGiftMessageVirtualProduct || false;
                if (isGiftMessageVirtualProduct) {
                    // giftMessageNotAsProduct
                    // remove giftMessageProduct from cartData, and create a new array for it
                    // save this new cartData in session storage
                    // save new array with giftMessage in state
                    gbb.gbbPersonalizePage.f.removeGiftMessageFromSessionStorage(cartData);
                }

                gbb.utility.renderPreparingBundleModal();

                let addGiftMessageToNote = gbb.settings.app.addGiftMessageToNote;

                setTimeout(() => {
                    gbb.$("body").find(".gbbPreparingBundleMainContainer").remove()
                }, 6000)
                let addToCartResult = await gbb.gbbBrowser.addItemsToCart();


                if (addGiftMessageToNote) {
                    let getUpdatedCart = await gbb.shopifyUtility.getCart();
                    let messageToAppend = gbb.utility.extractGiftMessageFromCartItems(getUpdatedCart);
                    await gbb.shopifyUtility.updateCart({ note: messageToAppend })
                }

                
                // setTimeout(() => {
                //     // gbb.utility.renderPreparingBundleModal();
                //     gbb.$("body").find(".gbbPreparingBundleMainContainer").remove()
                // }, 1000)


                if (addToCartResult.data) {
                    await gbb.utility.applyDiscountOnCheckout();
                    gbb.gbbBrowser.clearCartDataFromSessionStorage();
                    setTimeout(() => {
                    // gbb.utility.renderPreparingBundleModal();
                        gbb.$("body").find(".gbbPreparingBundleMainContainer").remove()
                    }, 1000)
                    await gbb.utility.loadCheckoutPage();
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-checkout-success",
                    })
                } else if (!addToCartResult.data && addToCartResult?.failedProductsArr?.length > 0) {
                    //failedProductsArr
                    gbb.utility.renderTemporaryLoadingSpinner("hide")
                    gbb.$("body").find(".gbbPreparingBundleMainContainer").remove()
                    await gbb.utility.renderUnavaibleProductsModal(addToCartResult.failedProductsArr);
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-checkout-failed",
                        detail: {
                            failedProducts: addToCartResult.failedProductsArr
                        }
                    })
                }
                // else {
                //     await gbb.utility.loadCheckoutPage();
                // }

                

            } catch (err) {
                gbb.utility.debugConsole("error inside handleCheckoutClick:", err);
            }
        },

        applyDiscountOnCheckout: async function () {
            try {
                let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
                if (gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive) {
                    await gbb.utility.getDynamicDiscountCode()
                    // await gbb.utility.updateCart({ attributes: { ["gbbDiscountCode"]: gbb.gbbDiscountComponent.state.discountCode} });
                }
                cartData.attributes = {
                    ...cartData.attributes,
                    // "gbbDiscountCode": gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive.discountCode
                    // "gbbDiscountCode":  gbb.gbbDiscountComponent.state.discountCode
                }

                cartData.attributes[`gbbDiscountCode-${gbb.state.bundleName}`] = gbb.gbbDiscountComponent.state.discountCode

                // updateCartAttributes
                if (cartData.attributes) {
                    await gbb.shopifyUtility.updateCart({ attributes: cartData.attributes });
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-bundle-discount-applied",
                    })
                }
            } catch (err) {
                gbb.utility.debugConsole("err inside applyDiscountOnCheckout:", err);
            }
        },
        extractGiftMessageFromCartItems: function (updatedCart) {
            try {
                let cartItems = updatedCart.items;
                // gbb.utility.debugConsole("cartItems", cartItems)
                let messagesPresentInCart = [];
                let messageToAppend = "";
                let isGiftMessageVirtualProduct = gbb.settings.bundleSettings?.isGiftMessageVirtualProduct || false;
                // decision on giftMessageAsProduct
                if (!isGiftMessageVirtualProduct) {
                    for (let i = 0; i < cartItems.length; i++) {
                        let item = cartItems[i];
                        // go deep and check if there are properties to the product
                        // if there is a property, then check if it has a gift message
                        // properties.Message
                        if (item.properties && item.properties.Message) {
                            messagesPresentInCart.push({ "Box ID": item.properties["Box ID"], "Message": item.properties.Message, "To": item.properties["Recipient Name"], "From": item.properties["Sender Name"] })
                        }
                    }

                }

                if (isGiftMessageVirtualProduct) {

                    let items = gbb.state.giftMessageProductInActiveSession || [];
                    if (items) {
                        messagesPresentInCart = items;
                    }

                    // from notes
                    let existingCartNotes = updatedCart?.note || "";
                    messageToAppend += existingCartNotes;
                }

                //sort the messagesPresentInCart by Box ID
                messagesPresentInCart = messagesPresentInCart.sort((a, b) => {
                    return a["Box ID"] - b["Box ID"]
                })
                //now append the message with a ":" separator in between

                if (messageToAppend != "" && messagesPresentInCart.length > 0) {
                    messageToAppend += "|| "
                }

                for (let i = 0; i < messagesPresentInCart.length; i++) {
                    let item = messagesPresentInCart[i];
                    // messageToAppend += `${item["Box ID"]}: ${item.Message} | `

                    if (isGiftMessageVirtualProduct) { // condition for gift message not as product
                        // has a bug, which says same box ID
                        // if(item['Box ID']){
                        //     messageToAppend += `Box Id: ${item["Box ID"]}\n`
                        // }
                        if (item["Bundle Name"]) {
                            messageToAppend += `Bundle Name: ${item["Bundle Name"]}\n`
                        }
                    }

                    if (item.To) {
                        messageToAppend += `To ${item.To},\n`
                    }

                    messageToAppend += `${item.Message}.`

                    if (item.From) {
                        messageToAppend += `\nFrom ${item.From}.`
                    }


                    if (i != messagesPresentInCart.length - 1 && messagesPresentInCart.length > 1) {
                        messageToAppend += `|| `
                    }

                }

                return messageToAppend;
            } catch (err) {
                gbb.utility.debugConsole("error inside extractGiftMessageFromCartItems", err);
            }
        },
        isElementVisible: function (element) {
            try {
                const vanillaJsElement = gbb.$(element)[0];
                if (!vanillaJsElement) {
                    return false;
                }
                const rect = vanillaJsElement.getBoundingClientRect();
                // gbb.utility.debugConsole("isElementVisible rect", rect)
                const viewHeight = Math.max(document.documentElement.clientHeight, window.innerHeight);
                // gbb.utility.debugConsole("isElementVisible viewheight",viewHeight)
                return !(rect.bottom < 0 || rect.top - viewHeight >= 0);
            } catch (err) {
                gbb.utility.debugConsole("error inside isElementVisible", err);
            }
        },
        removeFirstCharacterIfUnderscore: function (str) {
            try {
                if (str.charAt(0) === '_') {
                    str = str.slice(1);
                }
                return str;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        returnOnlyAdminSelectedVariantOptions: function (product) {
            try {
                let result = [];
                const validValues = new Set();
                for (const variant of product?.variants) {
                    if (variant?.option1) {
                        validValues.add(variant.option1);
                    }
                    if (variant?.option2) {
                        validValues.add(variant.option2);
                    }
                    if (variant?.option3) {
                        validValues.add(variant.option3);
                    }
                }
                gbb.utility.debugConsole("validValues:", validValues);
                for (let i = 0; i < product?.options?.length; i++) {
                    let option = product?.options[i];
                    if (option) {
                        gbb.utility.debugConsole("option:", option);
                        const invalidValues = [];
                        for (let j = 0; j < option?.values?.length; j++) {
                            let value = option?.values[j] || "";
                            if (value && !validValues.has(value)) {
                                invalidValues.push(value);
                            }
                            gbb.utility.debugConsole("invalid values:", invalidValues)
                        }
                        product.options[i].values = product?.options[i]?.values?.filter((value) => !invalidValues.includes(value));
                    }
                }
                result = product.options;
                return result;
            } catch (err) {
                gbb.utility.debugConsole(err)
            }
        },
        convertFromStoreCurrencyToCustomer: function (amount) {
            try {
                let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();
                let convertedAmount = parseFloat(amount * activeCurrencyRate).toFixed(2);
                return convertedAmount;
            } catch (err) {
                gbb.utility.debugConsole(err)
            }
        },
        convertFromCustomerCurrencyToStore: function (amount) {
            try {
                let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();
                let convertedAmount = parseFloat(amount / activeCurrencyRate).toFixed(2);
                return convertedAmount;
            } catch (err) {
                gbb.utility.debugConsole(err)
            }
        },
        removeZeroPriceBoxes: async function () {
            try {
                let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
                for (const boxId in cartData.boxes) {
                    const box = cartData.boxes[boxId];
                    if (box.total_price == 0) {
                        await gbb.gbbBrowser.clearRelevantBoxFromSessionStorage(boxId);
                    }
                }
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        removeIframeTagsFromHtml: function (html) {
            try {
                let parser = new DOMParser();
                let doc = parser?.parseFromString(html, 'text/html');
                let iframeElements = doc?.getElementsByTagName('iframe');
                if (!iframeElements || iframeElements.length === 0) {
                    return html; // No <video> tags found, return the original HTML
                }
                for (let i = iframeElements.length - 1; i >= 0; i--) {
                    let iframeElement = iframeElements[i];
                    iframeElement.parentNode.removeChild(iframeElement);
                }
                let modifiedHtml = new XMLSerializer().serializeToString(doc);
                return modifiedHtml;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        adjustImageTagsInProductDescriptionHtml: function (html) {
            try {
                const parser = new DOMParser();
                const doc = parser?.parseFromString(html, 'text/html');

                const imgElements = doc?.getElementsByTagName('img');
                if (!imgElements || imgElements.length === 0) {
                    return html; // No <img> tags found, return the original HTML
                }

                for (let i = 0; i < imgElements.length; i++) {
                    const imgElement = imgElements[i];
                    imgElement.setAttribute('width', '100px');
                    imgElement.setAttribute('height', '100px');
                    imgElement.style.objectFit = 'contain';
                }

                const modifiedHtml = new XMLSerializer().serializeToString(doc);
                return modifiedHtml;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        getNewImageAndMediaObjectWhenOnlyOneVariant: function (product) {
            // return an object know as newFeaturedImage, newMedia,newImages
            try {
                //setting defaults
                let newFeaturedImage = product?.featured_image;
                let newMedia = product.media
                let newImages = product?.images;
                let theresAnImageOrMediaToVariant = product.variants[0]?.image || product.variants[0]?.featured_media?.id || product.variants[0]?.featured_media?.src ? true : false;
                if (product?.variants?.length === 1 && theresAnImageOrMediaToVariant) {
                    //reset the featured image to this variant's featured image
                    newFeaturedImage = product?.variants[0]?.image || product.variants[0]?.featured_image?.src;
                    // change the order of the media but mapping the src to the variant's featured image
                    let indexofNewImage = product?.media.findIndex((media) => media?.src === newFeaturedImage);
                    if (indexofNewImage > -1) {
                        // shuffle the array, so that the ovject with the new featured image is at the front of the array]
                        newMedia = product?.media;
                        let newMediaObject = newMedia.splice(indexofNewImage, 1)[0];
                        newMedia.unshift(newMediaObject);
                    }

                    // change the order of the images but mapping the src to the variant's featured image
                    indexOfImageInImagesArr = product?.images.findIndex((image) => newFeaturedImage.includes(image));
                    if (indexOfImageInImagesArr > -1) {
                        newImages = product?.images;
                        // newImages[indexOfImageInImagesArr] = product?.variants[0]?.image;
                        // unshift the new featured image to the front of the array
                        newImages.unshift(newFeaturedImage);
                    }
                }
                return {
                    newFeaturedImage,
                    newMedia,
                    newImages
                }

            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        isCategoryOpen: function (categoryId) {
            try {
                // Get the parent element
                const parentElement = gbb.$(".gbbCategoryBodyContainer" + categoryId);

                // Check if it exists and has children
                if (parentElement.length > 0) {
                    // Check if gbbProductsContainer is one of the children
                    const gbbProductsItemsContainer = parentElement.find(".gbbProductsItemsContainer");

                    if (gbbProductsItemsContainer.length > 0) {
                        // gbbProductsContainer is not empty
                        gbb.utility.debugConsole("category is open")
                        return true;
                    } else {
                        // gbbProductsContainer is empty
                        gbb.utility.debugConsole("category is not open")
                        return false;
                    }
                } else {
                    // The parent element doesn't exist or has no children
                    gbb.utility.debugConsole("couldnt find category")
                    return false;
                }
            } catch (err) {
                gbb.utility.debugConsole(err, "error in isCategoryOpen");
            }
        },
        convertToGrams: function (weight, weightUnit) {
            try {
                let weightInGrams = 0;
                let weightValue = JSON.parse(JSON.stringify(weight))
                switch (weightUnit) {
                    case "kg":
                    case "KILOGRAMS":
                        weightInGrams = weightValue * 1000;
                        break;
                    case "g":
                    case "GRAMS":
                        weightInGrams = weightValue;
                        break;
                    case "lb":
                    case "POUNDS":
                        weightInGrams = weightValue * 453.592;
                        //round it off
                        weightInGrams = Math.round(weightInGrams);
                        break;
                    case "oz":
                    case "OUNCES":
                        weightInGrams = weightValue * 28.3495;
                        //round it off
                        weightInGrams = Math.round(weightInGrams);
                        break;
                    default:
                        weightInGrams = weightValue;
                        break;
                }
                return weightInGrams;
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        getCurrentProductPersonalization: function (product) {
            try {
                let isProductPersonalizationEnabled = gbb?.gbbAddProductsPage?.state?.productPersonalizationMap && gbb.gbbAddProductsPage.state.productPersonalizationMap[product.id] ? true : false;
                // gbb.gbbAddProductsPage.state.productPersonalizationData
                let productPersonalizationData = gbb?.gbbAddProductsPage?.state?.productPersonalizationMap && gbb.gbbAddProductsPage.state.productPersonalizationMap[product.id] ? gbb.gbbAddProductsPage.state.productPersonalizationMap[product.id] : {};
                return {
                    isProductPersonalizationEnabled,
                    productPersonalizationData
                }
            } catch (err) {
                gbb.utility.debugConsole(err);
            }
        },
        getRegionalLocaleFromUrl: function () {
            let localePresentInUrl = window.location.pathname.split("/") || "";
            // now get locale from Shopify.locale   
            let currentShopifyLocale = Shopify.locale || "";

            let regionalLocale = "";

            if (currentShopifyLocale && currentShopifyLocale != "" && localePresentInUrl) {
                // check if both are same
                if (currentShopifyLocale == localePresentInUrl[1]) {
                    regionalLocale = `/${currentShopifyLocale}`
                } else {
                }
            }

            return regionalLocale;
        },
        debugConsole: function (...messages) {
            try {
                let flag = gbb.state.CONSTANT_DEBUG_FLAG;
                if (flag == false) {
                    return;
                }
                if (flag == true) {
                    for (let message of messages) {
                        console.log(message);
                    }
                    return;
                }
                let isDebug = localStorage.getItem("debug");
                if (isDebug) {
                    for (let message of messages) {
                        console.log(message);
                    }
                    gbb.state.CONSTANT_DEBUG_FLAG = true
                } else {
                    gbb.state.CONSTANT_DEBUG_FLAG = false
                }
            } catch (err) {
                console.error('error inside debugConsole ->', err)
            }
        },
        debugError: function (...messages) {
            try {
                let flag = gbb.state.CONSTANT_DEBUG_FLAG;
                if (flag == false) {
                    return;
                }
                if (flag == true) {
                    for (let message of messages) {
                        console.error(message);
                    }
                    return;
                }
                let isDebug = localStorage.getItem("debug");
                if (isDebug) {
                    gbb.state.CONSTANT_DEBUG_FLAG = true;
                    for (let message of messages) {
                        console.error(message);
                    }
                } else {
                    gbb.state.CONSTANT_DEBUG_FLAG = false
                }
            } catch (err) {
                console.error('error inside the debugError function ->', err)
            }
        },
        gbbMultiLangOverrider: function () {
            try {
                let languageMode = gbb.state.languageMode;
                let languageData = gbb.utility.getLocale();
                if (languageMode != "SINGLE") {

                    gbb.utility.gbbMultiLangDiscountOverrider(languageData)
                    gbb.utility.gbbMultiLangBundleDataOverriding(languageData)
                    gbb.utility.gbbMultiLangPersonalizationOverrider(languageData)
                    gbb.utility.gbbMultiLangSummaryPageOverrider(languageData);
                }
            } catch (error) {
                gbb.utility.debugError("error in gbbMultiLangOverrider", error)
            }
        },
        gbbMultiLangDiscountOverrider: function (languageData) {
            try {
                if (gbb.settings.discountsData != {}) {
                    let discountsData = gbb.settings.discountsData;
                    if (discountsData.multiLangData.hasOwnProperty(languageData)) {
                        discountsData.discountTextBody = discountsData.multiLangData[languageData].discountTextBody;
                        discountsData.discountTextForSuccess = discountsData.multiLangData[languageData].discountTextForSuccess || "";
                    }
                }
            } catch (error) {
                gbb.utility.debugError("error in gbbMultiLangDiscountOverrider", error);
            }
        },
        gbbMultiLangBundleDataOverriding: function (languageData) {
            try {
                let stepsConfigurationData = gbb.settings.stepsConfigurationData;
                for (const key in stepsConfigurationData) {
                    if (key.startsWith("productsData")) {
                        const productData = stepsConfigurationData[key];
                        if (productData && productData.multiLangData && productData?.multiLangData.hasOwnProperty(languageData)) {
                            productData.productPageStepText = productData.multiLangData[languageData].productPageStepText;
                            productData.productPageSubtext = productData.multiLangData[languageData].productPageSubtext;
                        }
                        // Iterate over categories and update titles
                        if (productData && productData.categories) {
                            for (const categoryKey in productData.categories) {
                                const category = productData.categories[categoryKey];
                                if (category.multiLangData && category.multiLangData.hasOwnProperty(languageData)) {
                                    category.title = category.multiLangData[languageData].categoryTitle;
                                    category.subTitle = category.multiLangData[languageData].categorySubtitle;
                                }
                            }
                        }
                    }
                }

            } catch (error) {
                gbb.utility.debugError("error in gbbMultiLangBundleDataOverriding", error);
            }
        },
        gbbMultiLangPersonalizationOverrider: function (languageData) {
            try {
                let personalizationData = gbb.settings.stepsConfigurationData.personalizationData;
                //stepsConfigurationData?.personalizationData?.personalizeStepText
                if (personalizationData && personalizationData.isPersonalizationEnabled && personalizationData.multiLangData && personalizationData?.multiLangData.hasOwnProperty(languageData) || false) {
                    personalizationData.personalizeStepText = personalizationData.multiLangData[languageData].personalizeStepText;
                    personalizationData.personalizePageSubtext = personalizationData.multiLangData[languageData].personalizePageSubtext;
                }

            } catch (error) {
                gbb.utility.debugError("error in gbbMultiLangPersonalizationOverrider", error);
            }
        },
        gbbMultiLangSummaryPageOverrider: function (languageData) {
            try {
                let summaryPageData = gbb.settings.stepsConfigurationData.summaryPageData;
                // gbb.settings?.stepsConfigurationData?.summaryPageData
                //stepsConfigurationData?.summaryPageData?.personalizeStepText
                if (summaryPageData && summaryPageData.isSummaryPageEnabled && summaryPageData.multiLangData && summaryPageData?.multiLangData.hasOwnProperty(languageData) || false) {
                    // reviewPageBannerSubtext
                    // : 
                    // "Review your bundle and proceed to checkout ar"
                    // reviewPageBannerText
                    // : 
                    // "You’ve made the  Right Choice! ar"
                    // reviewPageEmptyStateBannerButtonText
                    // : 
                    // "Go back to the bundle flow"
                    // reviewPageEmptyStateBannerSubText
                    // : 
                    // ""
                    // reviewPageEmptyStateBannerText

                    summaryPageData.reviewPageBannerSubtext = summaryPageData.multiLangData[languageData].reviewPageBannerSubtext;
                    summaryPageData.reviewPageBannerText = summaryPageData.multiLangData[languageData].reviewPageBannerText;
                    summaryPageData.reviewPageEmptyStateBannerButtonText = summaryPageData.multiLangData[languageData].reviewPageEmptyStateBannerButtonText;
                    summaryPageData.reviewPageEmptyStateBannerSubText = summaryPageData.multiLangData[languageData].reviewPageEmptyStateBannerSubText;
                    summaryPageData.reviewPageEmptyStateBannerText = summaryPageData.multiLangData[languageData].reviewPageEmptyStateBannerText;



                }

            } catch (error) {
                gbb.utility.debugError("error in gbbMultiLangPersonalizationOverrider", error);
            }
        },
        groupCartDataBasedOnId_and_Properties: function (items) {
            try {
                function consolidateProducts(products) {
                    const consolidated = [];

                    // Function to check if two properties objects are the same
                    function arePropertiesEqual(props1, props2) {
                        const keys1 = Object.keys(props1);
                        const keys2 = Object.keys(props2);
                        if (keys1.length !== keys2.length) return false;
                        return keys1.every(key => props1[key] === props2[key]);
                    }

                    // Iterate through each product in the input array
                    products.forEach(product => {
                        // Find an existing product in the consolidated array that matches the current product
                        // const existingProduct = consolidated.find(consProduct =>
                        //     consProduct.id === product.id && arePropertiesEqual(consProduct.properties, product.properties)
                        // );

                        // check if products have properties
                        let existingProduct;
                        if (product.properties && Object.keys(product.properties).length > 0) {
                            existingProduct = consolidated.find(consProduct =>
                                consProduct.id === product.id && arePropertiesEqual(consProduct.properties, product.properties));
                        } else {
                            existingProduct = consolidated.find(consProduct => consProduct.id === product.id);
                        }






                        if (existingProduct) {
                            // If found, add the quantity of the current product to the existing one
                            existingProduct.quantity += product.quantity || 1;
                        } else {
                            // If not found, add the current product to the consolidated array
                            consolidated.push({ ...product });
                        }
                    });

                    return consolidated;
                }

                // Example usage
                const products = JSON.parse(JSON.stringify(items));
                const result = consolidateProducts(products);
                // return 
                // console.log(consolidatedProducts);
                return result;
            } catch (e) {
                gbb.utility.debugConsole("error occured in groupCartDataBasedOnId_and_Properties", e)
                return items;
            }

        },
        debounceWrapper: function (callbackFn, delay = 500) {
            gbb.utility.debugConsole('INSIDE DEBOUNCE WRAPPER');
            let timeoutId;
            let lastResult;

            return function (...args) {
                if (timeoutId) {
                    clearTimeout(timeoutId);
                }

                return new Promise((resolve, reject) => {
                    timeoutId = setTimeout(() => {
                        try {
                            lastResult = callbackFn.apply(this, args);
                            resolve(lastResult);
                        } catch (error) {
                            reject(error);
                        }
                    }, delay);
                });
            }
        },
        allowATCBasedOnProductInventory: function (variantId, quantityToAdd = 1) {
            try {
                let qtyAlreadyInCart = 0;
                let cartData = gbb.state?.giftBoxCartData?.items || []
                let isATCAllowed = true
                let originForVariantDetails = gbb.state.currentPageId == 'personalizationPage' ? "addonProducts": null
                let variantDetails = gbb.utility.getVariantDetailsFromCurrentProductsDataSet(variantId, originForVariantDetails) || null
                if (!variantDetails) {
                    gbb.utility.debugConsole("variant details not found : allowATCBasedOnProductInventory")
                    isATCAllowed = false
                    return isATCAllowed;
                }
                if (variantDetails.currentlyNotInStock) { // digital product
                    isATCAllowed = true
                    return isATCAllowed
                }
                // check if variant present alreadyInCart
                if (cartData.length > 0) {
                    for (let i = 0; i < cartData.length; i++) {
                        if (cartData[i].id == variantId) {
                            qtyAlreadyInCart += cartData[i].quantity;
                        }
                    }
                }
                let totalQty = qtyAlreadyInCart + quantityToAdd;
                if (totalQty > variantDetails.quantityAvailable) {
                    isATCAllowed = false
                    return isATCAllowed
                }

                return isATCAllowed

            } catch (error) {
                gbb.utility.debugConsole("error in allowATCBasedOnProductInventory", error)
            }
        },
        isCurrentActiveVariantAllowedToAdd: function ({ product, selectedVariantsCombination, variantQuantity }) {
            try {
                let activeVariantInfo = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination);
                let variantId = activeVariantInfo[0]?.id;
                let isInventoryAvailable = gbb.utility.allowATCBasedOnProductInventory(variantId, variantQuantity);
                return isInventoryAvailable
            } catch (error) {
                gbb.utility.debugConsole("error in isCurrentActiveVariantAllowedToAdd", error)
            }
        },
        validateProductQuantityAddButton: function ({ product, selectedVariantsCombination, variantQuantity, gbbProductQuantityAddButton }) {
            try {
                let isInventoryAvailable = gbb.utility.isCurrentActiveVariantAllowedToAdd({ product, selectedVariantsCombination, variantQuantity });
                if (isInventoryAvailable != true) {
                    gbbProductQuantityAddButton.addClass("gbbVariantInventoryNotAvailable")
                    gbbProductQuantityAddButton.addClass("gbbDisabled")
                } else if (
                    isInventoryAvailable == true &&
                    gbbProductQuantityAddButton.hasClass("gbbVariantInventoryNotAvailable")
                ) {
                    gbbProductQuantityAddButton.removeClass("gbbVariantInventoryNotAvailable")
                    gbbProductQuantityAddButton.removeClass("gbbDisabled")
                }
            } catch (error) {
                gbb.utility.debugConsole("error in validateProductQuantityAddButton", error)
            }
        },
        validateATCAndVariantQuantityAddButton: function ({ product, selectedVariantsCombination, variantQuantity, gbbProductQuantityAddButton, gbbProductVariantModalContainer }) {
            try {
                let validationOptions = {
                    product: product,
                    selectedVariantsCombination: selectedVariantsCombination,
                    variantQuantity: variantQuantity + gbb.gbbAddProductsPage.state.incrementProductQtyBy || 1,// adding 1 to check if we can add 1 more product or not 
                    gbbProductQuantityAddButton: gbbProductQuantityAddButton
                }
                gbb.utility.validateProductQuantityAddButton(validationOptions);
                let currentQty = variantQuantity;
                let isVariantWithCurrentQtyAllowedToAdd = gbb.utility.isCurrentActiveVariantAllowedToAdd({ ...validationOptions, variantQuantity: currentQty })
                if (isVariantWithCurrentQtyAllowedToAdd != true) {
                    gbbProductVariantModalContainer.addClass("gbbVariantInventoryNotAvailable")
                } else {
                    gbbProductVariantModalContainer.removeClass("gbbVariantInventoryNotAvailable")
                }
            } catch (error) {
                gbb.utility.debugConsole("error in validateATCAndVariantQuantityAddButton", error)
            }
        },
        extractIdsFromGraphQlId: function (id) {
            try {
                return Number(id.split("/").pop())
            } catch (error) {
                gbb.utility.debugConsole("error in extractIdsFromGraphQlId", error)
            }
        },
        generateSellingPlanGroupIdByName: function (groupName) {
            try {
                let base64Str = btoa(encodeURIComponent(groupName));
                return "EB_" + base64Str;
            } catch (error) {
                gbb.utility.debugConsole('error in generateSellingPlanGroupIdByName', error)
            }
        },
        prepareProductCardRibbonUI: function ({ ribbonContent, ribbonClassName }) {
            try {
                const gbbDiscountRibbon = gbb.$('<div>').addClass('gbbDiscountRibbon')
                if (ribbonClassName) {
                    gbbDiscountRibbon.addClass(ribbonClassName)
                }
                const gbbDiscountRibbonContent = gbb.$('<div>').addClass('gbbDiscountRibbonContent')
                if (ribbonContent) {
                    gbbDiscountRibbonContent.text(ribbonContent)
                    gbbDiscountRibbon.append(gbbDiscountRibbonContent)
                    return gbbDiscountRibbon
                }
            } catch (error) {
                gbb.utility.debugError('error in prepareProductCardRibbonUI', error)
            }
        },
        checkIfProductUniqueVariantPresentInCart: function ({productData, variantId}) {
            let newProductUniqueId = gbb.utility.getUniqueIdForVariant({ productData, variantId });
            return (gbb?.state?.giftBoxCartData?.items ?? []).find(item => {
                return newProductUniqueId == item?.properties?._uniqueGbbItemKey
            })
        },
        validateProductMaxQuantity: function (
            {
                triggeredFor, 
                currentQuantity, 
                product,
                selectedVariantsCombination,
                gbbProductQuantityHTML
            }
        ) {
            try {
                const validateQuantityPerProduct = gbb?.gbbAddProductsPage?.state?.validateQuantityPerProduct
                if (!validateQuantityPerProduct?.isEnabled) return;

                let isItemInCart
                if (product) {
                    const variantId = gbb.utility.checkIfSelectedVariantCombinationIsAvailable(product, selectedVariantsCombination)?.[0]?.variantId;
                    isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(variantId);
                }
                const updateCardButtons = ({ isMaxQuantityReached }) => {
                    let buttonTextContent = isMaxQuantityReached ? (gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.productAddedBtnText) ?? "Added") : "-";
                    gbbProductQuantityHTML?.toggleClass('productMaxQuantityReached', isMaxQuantityReached);
                    gbbProductQuantityHTML?.find(".gbbProductQuantityAddButton")?.toggle(!isMaxQuantityReached)
                    gbbProductQuantityHTML?.find(".gbbProductQuantityLabel")?.toggle(!isMaxQuantityReached)
                    gbbProductQuantityHTML?.find('.gbbProductQuantityRemoveButtonWrapper').text(buttonTextContent);
                }
                const updateModalButtons = () => {
                    const gbbProductVariantModalBodyContainer = gbb.$(".gbbProductVariantModalBodyContainer");

                    // if total quantity reach max limit disable increment button else enable increment button
                    let isTotalQuantityReachedMaxLimit = (currentQuantity + (isItemInCart?.quantity ?? 0) >= validateQuantityPerProduct?.allowedQuantity);
                    gbbProductVariantModalBodyContainer?.find(".gbbProductQuantityAddButton")?.toggleClass('gbbDisabledForMaximumQuantityLimit', isTotalQuantityReachedMaxLimit);
                   
                    //if cart quantity reached max limit disable "add to box" button and add "added" button text  else enable "add to box" button
                    let isCartQuantityReachedMaxLimit = (isItemInCart && isItemInCart?.quantity >= validateQuantityPerProduct?.allowedQuantity);
                    let generalLanguageData = gbb.settings?.languageData?.general;
                    let buttonTextContent = isCartQuantityReachedMaxLimit 
                            ? (gbb.utility.renderLanguageValue(generalLanguageData?.productAddedBtnText) ?? "Added") 
                            : gbb.utility.renderLanguageValue(generalLanguageData?.addToBoxButtonText);
                    let addToBoxButton = gbbProductVariantModalBodyContainer?.find('.gbbProductVariantAddButton')
                    addToBoxButton?.text(buttonTextContent)
                    addToBoxButton?.toggleClass('gbbDisabledForMaximumQuantityLimit', isCartQuantityReachedMaxLimit);

                    //if total quantity exceed max limit disable "add to box" button button else enable "add to box" button
                    let isTotalQuantityExceedMaxLimit = (isItemInCart && isItemInCart?.quantity + currentQuantity > validateQuantityPerProduct?.allowedQuantity)
                    addToBoxButton?.toggleClass('gbbDisabledForMaximumQuantityLimit', isTotalQuantityExceedMaxLimit);
                }

                switch (triggeredFor) {
                    case "CARD_QUANTITY_INCREMENT":
                        if (currentQuantity >= validateQuantityPerProduct?.allowedQuantity) {
                            updateCardButtons({ isMaxQuantityReached: true })
                        }
                        break;
                    case "CARD_QUANTITY_DECREMENT":
                        if (currentQuantity < validateQuantityPerProduct?.allowedQuantity) {
                            updateCardButtons({ isMaxQuantityReached: false })
                        }
                        break;
                    case "MODAL_QUANTITY_CHANGE":
                        updateModalButtons();
                        break;
                }

            } catch (error) {
                gbb.utility.debugConsole("error in validateProductMaxQuantity", error)
            }
        }
    },
    shopifyUtility: {
        addToCart: async function (cartData) {
            try {
                let result = await gbb.$.ajax({
                    url: "/cart/add.js",
                    data: cartData,
                    type: "POST",
                    dataType: "json",
                })
                return result;
            } catch (error) {
                gbb.utility.debugConsole("error in shopifyUtility.addToCart", error)
                // throw error
                return false
            }
        },
        updateCart: async function (cartData) {
            try {
                let result = await gbb.$.ajax({
                    url: "/cart/update.js",
                    data: cartData,
                    type: "POST",
                    dataType: "json",
                })
                return result;
            } catch (error) {
                gbb.utility.debugConsole("error in shopifyUtility.updateCart", error)
                // throw error
                return false
            }
        },
        getCart: async function () {
            try {
                let result = await gbb.$.ajax({
                    url: "/cart.js",
                    type: "GET",
                    dataType: "json",
                })
                return result;
            } catch (error) {
                gbb.utility.debugConsole("error in shopifyUtility.getCart", error)
                // throw error
                return false
            }
        },
        changeCart: async function (data) {
            try {
                let result = await glpro.$.ajax({
                    type: "POST",
                    url: "/cart/change.js",
                    data: data,
                    dataType: "json",
                });
                return true
            } catch (error) {
                gbb.utility.debugError("glpro-utility-changeCart");
                gbb.utility.debugError(error);
                return false
            }
        },
    },
    graphQlUtility: {
        graphQlAPIWrapper: async function (query, variables) {
            try {
                let shopDomain = window.Shopify.shop;
                let storefrontAccessToken = gbb.state.storefrontAccessToken || gbb.settings.STOREFRONT_ACCESS_TOKEN;

                // debugger;
                // if (gbb.state.cachedProductDataGraphql.has(variables.ids[0])){
                //     return gbb.state.cachedProductDataGraphql.get(variables.ids[0]);
                // }

                const res = await fetch(`https://${shopDomain}/api/2023-10/graphql.json`, {
                    // const res = await fetch(`https://gift-kart-test-01.myshopify.com/api/2024-01/graphql.json`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Shopify-Storefront-Access-Token': storefrontAccessToken,
                    },
                    body: JSON.stringify({ query, variables }),
                })



                const data = await res.json();
                return data;

            } catch (error) {
                gbb.utility.debugConsole("error in graphQlAPIWrapper =>", error);
            }
        },
        gbbCleaningAndArrangingData: function (data) {
            try {
                let cleanedData = gbb.graphQlUtility.flattenGraphQLResponse(data);
                gbb.utility.debugConsole("cleanedData before processing =========>:", cleanedData);

                // remove null, undefined and missing values from the array
                cleanedData = cleanedData.filter(item => item != null && item != undefined);

                cleanedData = gbb.graphQlUtility.dataMappingFromGraphQL(cleanedData);

                return cleanedData;
            } catch (err) {
                gbb.utility.debugConsole("err in gbbCleaningAndArrangingData => ", err);
            }
        },
        dataMappingFromGraphQL: function (cleanedData) {
            try {

                const convertPlanNameToId = (planName) => {
                    let base64Str = btoa(encodeURIComponent(planName));
                    let id = "EB_" + base64Str;
                    return id;
                }

                const getAllMetafieldValuesInArray = (productData) => {
                    // productData.forEach(node => {
                    const metafields = [];
                    Object.keys(productData).forEach(key => {
                        if (key.startsWith('metafield_')) {
                            metafields.push(productData[key]);
                        }
                    });
                    return metafields;
                }

                const transformSellingPlans = (sellingPlanGroups) => {

                    let sellingPlanGroupsFlattened = []

                    let tempArray = []
                    let flattendData = gbb.graphQlUtility.flattenGraphQLResponse({ data: { nodes: sellingPlanGroups } });
                    tempArray = flattendData.map(item => {
                        return {
                            id: convertPlanNameToId(item.name),
                            name: item.name,
                            description: null,
                            options: item.options.map((option, index) => ({
                                name: option.name,
                                position: index + 1,
                                value: option.value
                            })),
                            selling_plans: item.sellingPlans?.map((plan) => {
                                return {
                                    id: parseInt(plan?.id?.split('/').pop()),
                                    gid: plan?.id,
                                    option: plan?.option,
                                    name: plan?.name,
                                    price_adjustments: plan?.priceAdjustments?.map((element, index) => {
                                        let adjustmentType = element?.adjustmentValue?.price ? 'price' : element?.adjustmentValue?.adjustmentAmount ? 'fixed_amount' : 'percentage'
                                        let _adjustmentValue = adjustmentType == 'percentage' ? element?.adjustmentValue?.adjustmentPercentage : adjustmentType == 'price' ? element?.adjustmentValue?.price?.amount : element?.adjustmentValue?.adjustmentAmount?.amount
                                        return {
                                            orderCount: element.orderCount,
                                            position: index + 1,
                                            value_type: adjustmentType,
                                            value: adjustmentType == 'percentage' ? parseFloat(_adjustmentValue) : parseFloat(_adjustmentValue) * 100
                                        }
                                    })
                                }
                            }),
                            recurring_deliveries: item.recurringDeliveries,
                        };
                    });

                    sellingPlanGroupsFlattened.push(tempArray);

                    return sellingPlanGroupsFlattened.flat();
                };
                const getSellingPlansGroupId = (sellingPlansGroup, sellingPlanId) => {
                    for (let i = 0; i < sellingPlansGroup?.length; i++) {
                        let currGroupData = sellingPlansGroup[i];
                        let foundSellingPlan = currGroupData?.selling_plans?.find((sellingPlan) => sellingPlan?.id == sellingPlanId);
                        if (foundSellingPlan) {
                            return currGroupData?.id;
                        }
                    }
                }
                const transformSellingPlanAllocation = (sellingPlanAllocations, sellingPlansGroup, variantDetails) => {
                    let response = gbb.graphQlUtility.flattenGraphQLResponse(sellingPlanAllocations);
                    response = response.map((el) => {
                        let sellingPlanId = parseInt(el?.node?.sellingPlan?.id?.split('/').pop())
                        let _price = parseFloat(variantDetails?.price?.amount) * 100 // read product's price 
                        let _per_delivery_price = _price
                        let priceAdjustmentArray = el?.node?.priceAdjustments || []
                        if (priceAdjustmentArray.length > 0) {
                            _price = parseFloat(priceAdjustmentArray[0]?.price?.amount) * 100
                            _per_delivery_price = parseFloat(priceAdjustmentArray[0]?.perDeliveryPrice?.amount) * 100
                        }
                        return {
                            compare_at_price: parseFloat(el?.node?.priceAdjustments[0]?.compareAtPrice?.amount) * 100,
                            per_delivery_price: _per_delivery_price,
                            price: _price,
                            selling_plan_id: sellingPlanId,
                            selling_plan_group_id: getSellingPlansGroupId(sellingPlansGroup, sellingPlanId) || null,
                            price_adjustments: [{ position: 1, price: _price }]
                        }
                    })
                    return response;
                };
                let newProductArray = JSON.parse(JSON.stringify(cleanedData));
                let returningArray = [];
                for (let i = 0; i < newProductArray.length; i++) {

                    let currProduct = newProductArray[i];
                    let originalProduct = cleanedData[i];

                    currProduct.available = originalProduct.availableForSale;
                    currProduct.featured_image = originalProduct?.featuredImage?.originalSrc;
                    let variantData = currProduct.variants;
                    let ogVariants = originalProduct.variants;
                    // productId
                    let splitProductId = originalProduct.id.split('/');
                    let pureProductId = parseInt(splitProductId[splitProductId.length - 1])

                    currProduct.productId = pureProductId;
                    currProduct.type = originalProduct.productType;
                    currProduct.id = pureProductId
                    currProduct.metafieldsData = getAllMetafieldValuesInArray(originalProduct);

                    currProduct.images = originalProduct?.images?.map(item => item?.originalSrc);

                    //   currProduct.media = originalProduct?.media?.map((item, index) moving to images from media coz we dont get variant media from shopify
                    currProduct.media = originalProduct?.images?.map((item, index) => {
                        return {
                            alt: item.alt,
                            computedPosition: index + 1,
                            gid: item.id,
                            id: item.id?.split('/').pop(),
                            // position: index+1, // since shopify SF Api doesnt provide position
                            src: item?.originalSrc
                        }
                    })

                    currProduct.compare_at_price = originalProduct?.compareAtPriceRange?.maxVariantPrice?.amount || originalProduct?.compareAtPriceRange?.minVariantPrice?.amount
                    currProduct.price = originalProduct?.priceRange?.maxVariantPrice?.amount || originalProduct.priceRange.minVariantPrice.amount

                    currProduct.compare_at_price = currProduct.compare_at_price > 0 ? currProduct.compare_at_price * 100 : null
                    currProduct.price = currProduct.price * 100

                    //   forEach originalProduct
                    //   let productSellingPlans = gbb.graphQlUtility.flattenGraphQLResponse(originalProduct.selling)
                    currProduct.selling_plan_groups = transformSellingPlans(originalProduct?.sellingPlanGroups)
                    // for variants
                    for (let j = 0; j < variantData.length; j++) {
                        variantData[j].available = ogVariants[j].availableForSale
                        variantData[j].image = ogVariants[j]?.image?.url || ogVariants[j]?.image?.originalSrc
                        variantData[j].price = parseFloat(variantData[j].price.amount) * 100;
                        let tempOptions = ogVariants[j]?.selectedOptions;
                        variantData[j].options = tempOptions.map(item => item.value);
                        // variantData[j].op
                        // variantData[]    
                        // derive option1,option2 and option3 values

                        if (tempOptions.length > 0) variantData[j].option1 = tempOptions[0].value;
                        if (tempOptions.length > 1) variantData[j].option2 = tempOptions[1].value;
                        if (tempOptions.length > 2) variantData[j].option3 = tempOptions[2].value;
                        // fixing variantId;
                        // variantData[j].id = variantData[j].variantId;
                        let spliVariantId = variantData[j].id.split('/');
                        let variantId = parseInt(spliVariantId[spliVariantId.length - 1])
                        variantData[j].variantId = variantId;
                        variantData[j].variant_id = variantId;
                        variantData[j].id = variantId
                        // variantData[j].public_title = (concat options by /)
                        variantData[j].public_title = tempOptions.map(item => item.value).join(' / ');
                        // publicTitle????
                        // variantData[j].name = currProduct.title +  " - " + ogVariants[j].title;
                        variantData[j].name = ogVariants[j].title == "Default Title" ? currProduct.title : currProduct.title + " - " + ogVariants[j].title;

                        variantData[j].featured_image = {
                            gid: ogVariants[j]?.image?.id,
                            id: ogVariants[j]?.image?.id?.split('/').pop(),
                            src: ogVariants[j]?.image?.originalSrc
                        }
                        variantData[j].featured_media = {
                            gid: ogVariants[j]?.image?.id,
                            id: ogVariants[j]?.image?.id?.split('/').pop(),
                            src: ogVariants[j]?.image?.originalSrc
                        }
                        variantData[j].compare_at_price = ogVariants[j].compareAtPrice ? parseFloat(ogVariants[j].compareAtPrice.amount) * 100 : null

                        variantData[j].weight = gbb.utility.convertToGrams(variantData[j].weight, variantData[j].weightUnit);
                        variantData[j].weightConvertedToGrams = true

                        variantData[j].selling_plan_allocations = transformSellingPlanAllocation(ogVariants[j]?.sellingPlanAllocations, currProduct.selling_plan_groups, ogVariants[j])



                    }
                    currProduct.variants = variantData;
                    currProduct = gbb.gbbKite.f.modifyProductDataWithDiscountedPrice(currProduct);
                    returningArray.push(currProduct);
                }

                return returningArray;

            } catch (error) {
                gbb.utility.debugConsole("error in dataMappingFromGraphQL ", error);
            }
        },
        flattenGraphQLResponse: function (response) {
            // console.log("response", response);
            const nodes = response.data ? response.data.nodes : [];
            const edges = response.edges ? response.edges : [];

            const flattenNodesOrEdges = (items) => {
                return items.map((item) => {
                    if (item) {
                        const flattenedItem = {};

                        Object.keys(item).forEach((key) => {
                            const value = item[key];
                            if (value && typeof value === "object") {
                                if (value.edges) {
                                    flattenedItem[key] = value.edges.map((edge) => edge.node);
                                } else if (value.node) {
                                    flattenedItem[key] = value.node;
                                } else {
                                    flattenedItem[key] = value;
                                }
                            } else {
                                flattenedItem[key] = value;
                            }
                        });

                        // console.log("flattenedItem", flattenedItem);
                        return flattenedItem;
                    }
                });
            };


            let flattenedNodes = []
            if (nodes.length > 0) {
                flattenedNodes = flattenNodesOrEdges(nodes);
            } else if (edges.length > 0) {
                flattenedNodes = flattenNodesOrEdges(edges);
            }

            // console.log("flattened-nodes", nodes);
            // console.log("flattened-edges", edges);


            // console.log("flattenedNodes", flattenedNodes);

            return flattenedNodes;
        },
        generateMetafieldQueries: function (metafields) {
            return metafields.map(metafield => {
                const { key, namespace } = metafield;
                return `metafield_${namespace}_${key}: metafield(key:"${key}", namespace:"${namespace}"){ 
                    id 
                    key
                    value
                    description
                    type
                }`;
            }).join(' ');
        },

        getProductsDataByIds: async function (productIds) {
            try {


                const metafields = gbb.settings.bundleSettings.metafieldNameSpaceAndKeys

                // const metafields = [
                //     { key: "test", namespace: "gbbNameSpace" },
                //     { key: "test2", namespace: "gbbNameSpace" },
                //     // Add more metafields as needed
                //     ];
                //  gbb.settings.bundleSettings.


                const metafieldQueries = gbb.graphQlUtility.generateMetafieldQueries(metafields);
                const query = `query test($ids: [ID!]!, $countryCode: CountryCode!, $languageCode: LanguageCode!) @inContext(country: $countryCode, language: $languageCode) {    
                nodes(ids: $ids) {
                ... on Product{
                  id
                  availableForSale
                  title
                  handle
                  createdAt
                  description
                  descriptionHtml
                  productType
                  ${metafieldQueries}
                  onlineStoreUrl
                  options{
                    id
                    name
                    values
                  }
                  featuredImage{
                    id
                    originalSrc
                    transformedSrc(maxWidth: 800, maxHeight: 800, crop: CENTER)
                  }
                 updatedAt
                tags
                totalInventory
                vendor
                requiresSellingPlan
                compareAtPriceRange{
                    maxVariantPrice{
                        amount
                        currencyCode
                    }
                    minVariantPrice{
                        amount
                        currencyCode
                    }
                }
                priceRange{
                    maxVariantPrice{
                        amount
                        currencyCode
                    }
                    minVariantPrice{
                        amount
                        currencyCode
                    }
                }
                media(first:100){
                    edges{
                        node{
                            id
                            alt
                            previewImage{
                                url
                                id
                            } 
                            
                        }
                    }

                }
                images(first:100){
                    edges{
                        node{
                            id
                            originalSrc
                            transformedSrc(maxWidth: 800, maxHeight: 800, crop: CENTER)
                        }
                    }
                }
                sellingPlanGroups(first: 100) {
                    edges{
                        node{
                            name
                            appName
                            options{
                                name
                                values
                            }
                            sellingPlans (first:100){
                                edges{
                                    node{
                                        id
                                        name
                                        recurringDeliveries
                                        priceAdjustments {
                                            adjustmentValue {
                                            ... on SellingPlanFixedAmountPriceAdjustment{
                                                adjustmentAmount{
                                                amount
                                                currencyCode
                                                }
                                                }
                                            ... on SellingPlanFixedPriceAdjustment{
                                                 price{
                                                    amount
                                                    currencyCode
                                                    }
                                                 }
                                            ... on SellingPlanPercentagePriceAdjustment{
                                                adjustmentPercentage
                                                }
                                            }
                                            orderCount
                                        }
                                        options{
                                            name
                                            value
                                        }

                                    }
                                }
                            }
                        }
                    }
                }
                variants(first: 100) {
                    edges {
                      node {
                        id
                        sku
                        title
                        price{
                          amount
                          currencyCode
                        }
                        weight
                        weightUnit
                        requiresShipping
                        currentlyNotInStock 
                        compareAtPrice{
                          amount
                          currencyCode
                        }
                        quantityAvailable
                        selectedOptions{
                            name
                            value
                        }
                       
                        availableForSale
                        image {
                          id
                          originalSrc
                          transformedSrc(maxWidth: 800, maxHeight: 800, crop: CENTER)
                        }
                        sellingPlanAllocations(first:100){
                            edges{
                                node{
                                     sellingPlan{
                                         id
                                         name
                                     }
                                    priceAdjustments{
                                        compareAtPrice{
                                            amount
                                            currencyCode
                                        }
                                        perDeliveryPrice{
                                            amount 
                                            currencyCode
                                        }
                                        price{
                                            amount
                                            currencyCode
                                        }
                                        unitPrice{
                                            amount
                                            currencyCode
                                        }
                                    }
                                }
                            }
                        }
                      }
                    }
                  }
                }
              }
              }`;

                
                 
                // remove the product ids that are already present
                let cachedProductData = []
                productIds = productIds.filter((id) => {
                    if (gbb.state.cachedProductDataGraphql.has(+id)) {
                        cachedProductData.push(gbb.state.cachedProductDataGraphql.get(+id))
                    }
                    else return id
                })

                for (let i = 0; i < productIds.length; i++) {
                    let item = productIds[i];
                    if (!String(item).includes("gid")) {
                        productIds[i] = "gid://shopify/Product/" + productIds[i]
                    }
                }




                const variables = {
                    ids: productIds,
                    // countryCode: "IN"  || variables.countryCode,
                    countryCode: gbb.utility.getCountry(),
                    languageCode: gbb.utility.getLocale().toUpperCase().split("-")[0]
                    // languageCode: "EN" || variables.languageCode.toUpperCase()
                };

                let response = []
                let failedProductsData = []

                if (productIds?.length > 0) {
                    response = await gbb.graphQlUtility.graphQlAPIWrapper(query, variables)

                    response?.data?.nodes?.forEach((item, idx) => {
                        if (!item) {
                            failedProductsData.push({
                                id: gbb.utility.extractIdsFromGraphQlId(productIds[idx]),
                                failedToFetch: true
                            })
                        }
                    });

                    response = gbb.graphQlUtility.gbbCleaningAndArrangingData(response);
                    response = [...cachedProductData, ...response, ...failedProductsData]
                    gbb.utility.setCachedGraphqlData(response);
                } else {
                    response = cachedProductData
                }

                response = response.filter(product => !product.failedToFetch)
                return response;

            } catch (error) {
                console.error('error in getProductDataByIds ', error)
            }
        },
    },
    gbbBrowser: {
        state: {
            boxIdOffset: 0,
            gbbDiscountsAlreadyPresentInCart: {},
        },
        addDefaultProductsToBox: function (boxId) {
            try {
                if (!boxId) {
                    boxId = gbb.state.activeBoxId || "box1";
                }
                gbb.state.activeBoxId = boxId;
                let defaultProducts = Object.values(gbb?.settings?.shopifyData?.defaultProductsData);

                for (let i = 0; i < defaultProducts.length; i++) {
                    let currentProduct = defaultProducts[i];
                    for (let j = 0; j < currentProduct.variants?.length; j++) {
                        let currentVariant = currentProduct.variants[j];
                        let quantity = currentProduct?.requiredQuantity || 1;
                        let data = {
                            variant: { id: currentVariant.id },
                            qty: quantity,
                        }
                        gbb.utility.addToCart(data, "defaultProduct", undefined, "defaultProduct");
                    }
                }

            } catch (err) {
                gbb.utility.debugConsole(err + "inside addDefaultProductsToTheCart");
            }
        },
        getRelevantGiftBoxProductsTotalWithCurrency: function (boxId) {
            try {
                //getGiftBoxProductsFromCart
                let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);
                // gbb.state.giftBoxCartData = await gbb.utility.getGiftBoxProductsFromCart()
                let data = boxCartDataInSessionStorage
                // if(data.currency){
                return gbb.utility.getCurrencySymbol() + "" + parseFloat(data.total_price / 100).toFixed(2)
                // }else{
                // if(Shopify && Shopify.currency && Shopify.currency.active){
                //     return "0.0"+ " " +Shopify.currency.active
                // }else{
                //     return "0.0"
                // }

                // }
            } catch (error) {
                gbb.utility.debugError("getRelevantGiftBoxProductsTotalWithCurrency");
                gbb.utility.debugError(error);
                return "0.0"
            }
        },
        getProductsFromAllBoxesFromCart: function (cartDataFromSessionStorage) {
            try {
                let allCartItems = [];
                let addBoxQuantityToProperties = gbb.settings.app.addBoxQuantityToProperties || false;
                if (!cartDataFromSessionStorage) {
                    cartDataFromSessionStorage = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
                    cartDataFromSessionStorage = JSON.parse(cartDataFromSessionStorage);
                }
                if (cartDataFromSessionStorage && cartDataFromSessionStorage.boxes) {
                    Object.keys(cartDataFromSessionStorage?.boxes)?.forEach((box) => {
                        let tempArr = cartDataFromSessionStorage?.boxes[box]["items"] || [];
                        if (addBoxQuantityToProperties) {
                            tempArr.forEach((item) => {
                                item.properties["_Box Quantity"] = cartDataFromSessionStorage?.boxes[box]["boxQuantity"] || 1;
                            })
                        }
                        allCartItems.push(...tempArr)
                    })
                }
                return allCartItems;
            } catch (err) {
                gbb.utility.debugError(err + "getProductsFromAllBoxesFromCart");
            }
        },
        setRelevantBoxDataToSessionStorage: function (boxData, boxId) {
            try {
                const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()// for subscription bundles only

                if (!boxId) {
                    boxId = gbb.state.activeBoxId;
                }
                boxData.items = boxData.items.map((item) => {
                    let productPrice = item.price
                    let originForVariantDetails = item?.properties?._boxProduct == 'addonProduct' ? "addonProducts": null
                    let variantInfo = gbb.utility.getVariantDetailsFromCurrentProductsDataSet(item.variant_id, originForVariantDetails)
                    if (variantInfo) {
                        productPrice = variantInfo.price
                    }
                    if (isPurchaseTypeSubscription) {
                        productPrice = gbb.gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId(item.variant_id)
                    }
                    return {
                        ...item,
                        price: productPrice
                    }
                })
                gbb.state.giftBoxCartData = boxData;

                // // update discount rule
                gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();

                // @rafath why not call getCartDataFromSessionStorage here?
                let cartDataFromSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                if (cartDataFromSessionStorage) {
                    if (gbb.gbbDiscountComponent.state.currentDiscountRule[gbb.state.activeBoxId]) {
                        boxData["discountValue"] = gbb.gbbDiscountComponent.state.currentDiscountRule[gbb.state.activeBoxId]["discountValue"];
                    } else {
                        boxData["discountValue"] = null;
                    }
                    cartDataFromSessionStorage.boxes[boxId] = boxData;
                    gbb.gbbDiscountComponent.f.updateCurrentDiscountRule();
                    sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataFromSessionStorage));
                }
            } catch (err) {
                gbb.utility.debugError(err + "setRelevantBoxDataToSessionStorage");
            }
        },
        addItemToCartSessionStorage: function (itemData) {
            try {
                // if(item && item.quantity == 0){
                //     return 
                // }
                let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                let currentBoxId = gbb.state.activeBoxId;
                if (boxCartDataInSessionStorage && boxCartDataInSessionStorage.items) {
                    boxCartDataInSessionStorage.items.push(itemData);
                    gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(boxCartDataInSessionStorage, currentBoxId);
                }
                else {
                    gbb.utility.debugConsole("no items in session storage")
                }
                gbb.gbbBrowser.updateTotalPriceInSessionStorage()
                gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage()

            } catch (e) {
                gbb.utility.debugError("addItemToCartSessionStorage", e)
                gbb.utility.triggerSlackNotification(e)
            }

        },

        getCartDataFromSessionStorage: function (options) {
            try {

                const subscriptionPlanExists = gbb.gbbReviewPage.f.checkIfSubscriptionPlanExists();

                if (subscriptionPlanExists && options && options?.forSubscription && gbb.gbbBrowser?.getSubscriptionType() == "saveSubscription") {
                    return gbb.gbbBrowser.getCartDataForSubscription();
                }

                let cart = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
                cart = JSON.parse(cart);
                if (cart) { //&& cart.items
                    // gbb.state.giftBoxCartData = cart;
                    return cart;
                }
                else {
                    //return { items: [], attributes: {}, bundleQuantity: 1 };
                }

            } catch (error) {
                gbb.utility.debugError("getCartDataFromSessionStorage", error)
            }
        },
        getRelevantBoxDataFromSessionStorage: function (boxId) {
            try {

                // if(!boxId) {
                //     if(!gbb.state.activeBoxId) {
                //         gbb.state.activeBoxId = "box1"
                //     }
                //     boxId = gbb.state.activeBoxId;


                // }

                // let bundleCartData;
                // bundleCartData = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
                // bundleCartData = JSON.parse(bundleCartData);

                let bundleCartData;
                bundleCartData = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
                bundleCartData = JSON.parse(bundleCartData);

                if (!boxId) {
                    if (!gbb.state.activeBoxId) {
                        gbb.state.activeBoxId = "box1";
                    }
                    boxId = gbb.state.activeBoxId;
                    //find the isBoxActive box and set that as the active box
                    if (bundleCartData && bundleCartData.boxes) {
                        Object.keys(bundleCartData.boxes).forEach((box) => {
                            if (bundleCartData.boxes[box].isBoxActive) {
                                gbb.state.activeBoxId = box;
                                boxId = gbb.state.activeBoxId;
                            }
                        });
                    }
                }



                if (bundleCartData) {
                    let currentBoxData = bundleCartData?.boxes[boxId] || {};
                    if (currentBoxData && currentBoxData.items) {
                        gbb.state.giftBoxCartData = currentBoxData;
                        return currentBoxData;
                    }
                } else {
                    //initialization of the item session storage item happens here
                    bundleCartData = {
                        bundleId: gbb.state.bundleId,
                        attributes: {},
                        boxes: {
                            box1: {
                                boxId: "box1",
                                boxName: "Box - 1",
                                items: [],
                                boxQuantity: 1,
                                isBoxActive: true,
                                total_price: 0
                            }
                        }
                    }
                    gbb.state.activeBoxId = "box1";
                    gbb.state.giftBoxCartData = bundleCartData.boxes["box1"];
                    sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(bundleCartData));
                    if (gbb?.settings?.stepsConfigurationData?.defaultProductsData?.isDefaultProductsEnabled) {
                        gbb.gbbBrowser.addDefaultProductsToBox();
                    }
                }
                return bundleCartData;
            } catch (error) {
                gbb.utility.debugError("getRelevantBoxDataFromSessionStorage", error)
            }
        },
        updateTotalofRelevantBoxPriceInSessionStorage: function (boxId) {
            try {
                if (!boxId) {
                    boxId = gbb.state.activeBoxId
                }
                let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);
                if (boxCartDataInSessionStorage && boxCartDataInSessionStorage.items) {
                    let totalPrice = 0;
                    let totalQuantity = 0;
                    boxCartDataInSessionStorage.items.forEach((item) => {
                        totalPrice += item.price * item.quantity;
                        totalQuantity += item.quantity;
                    })
                    boxCartDataInSessionStorage.total_price = totalPrice;
                    boxCartDataInSessionStorage.item_count = totalQuantity;
                    gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(boxCartDataInSessionStorage, boxId);
                    //sessionStorage.setItem(`gbb-cart-${gbb.state.boxId}`, JSON.stringify(cartDataInSessionStorage));
                }
            } catch (err) {
                gbb.utility.debugConsole(err + "at updateTotalofRelevantBoxPriceInSessionStorage");
            }
        },
        updateTotalPriceInSessionStorage: function () {
            try {
                let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                if (cartDataInSessionStorage && cartDataInSessionStorage.boxes) {
                    let totalPrice = 0;
                    let totalQuantity = 0;
                    Object.keys(cartDataInSessionStorage.boxes).forEach((box) => {
                        let boxItem = cartDataInSessionStorage.boxes[box];
                        boxItem.items.forEach((item) => {
                            totalPrice += item.price * item.quantity;
                            totalQuantity += item.quantity;
                        })
                    })
                    cartDataInSessionStorage.total_price = totalPrice;
                    cartDataInSessionStorage.item_count = totalQuantity;
                    sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
                }
            } catch (e) {
                gbb.utility.debugError("updateTotalPriceInSessionStorage", e)
            }
        },
        updateCartItemQuantityAndProperty: function (variantId, quantity, properties, boxId) {
            try {
                if (!boxId) {
                    boxId = gbb.state.activeBoxId;
                }
                let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);


                // in properties there is _uniqueGbbItemkey;
                // let boxCartDataInSessionStorageIndex = boxCartDataInSessionStorage.items.findIndex((cart) => cart.id == variantId);

                let boxCartDataInSessionStorageIndex = boxCartDataInSessionStorage.items.findIndex(cart => {
                    if (cart.properties && cart.properties["_uniqueGbbItemKey"]) {
                        return cart.properties["_uniqueGbbItemKey"] == properties["_uniqueGbbItemKey"];
                    } else {
                        return cart.id == variantId;
                    }
                });
                boxCartDataInSessionStorage.items[boxCartDataInSessionStorageIndex].quantity = quantity;
                boxCartDataInSessionStorage.items[boxCartDataInSessionStorageIndex].properties = properties;

                //  if quantity is 0 then remove the item from cart
                if (quantity == 0 && boxCartDataInSessionStorageIndex > -1) {
                    boxCartDataInSessionStorage.items.splice(boxCartDataInSessionStorageIndex, 1);
                }

                gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(boxCartDataInSessionStorage)
                //sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(boxCartDataInSessionStorage));
                gbb.gbbBrowser.updateTotalPriceInSessionStorage()
                gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage()
                return boxCartDataInSessionStorage;
            }
            catch (e) {
                gbb.utility.debugError("updateCartItemQuantityAndProperty", e)
            }
        },

        getCartDataForSubscription: function () {
            try {
                //gbb.state.giftboxCartData 
                // gbb.utility.debugConsole("inside getCartDataForSubscription");
                let cart = gbb.gbbBrowser.getCartDataFromSessionStorage();
                cart.total_price = 0;
                cart.item_count = 0;
                Object.keys(cart.boxes).forEach((box) => {
                    let boxItem = cart.boxes[box];
                    boxItem.total_price = 0;
                    boxItem.item_count = 0;
                    boxItem.items.forEach((item) => {
                        let sellingPlanDetails = item.sellingPlanDetails;
                        if (sellingPlanDetails) {
                            let planItem = sellingPlanDetails[cart?.subscriptionPlan];
                            // total_price += (item.quantity) * (item?.price - planItem?.price);
                            // item.price = planItem?.price || planItem?.perDeliveryPrice;
                            item.price = planItem?.price;
                        }
                        boxItem.total_price += item.price * item.quantity;
                        boxItem.item_count += item.quantity;
                    })
                    cart.total_price += boxItem.total_price;
                    cart.item_count += boxItem.item_count;
                    //setRelevantBoxDataToSessionStorage
                    // gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(boxItem, box);
                })

                // gbb.gbbBrowser.updateSubscriptionTotal(cart.total_price)   

                gbb.gbbBrowser.updateTotalPriceInSessionStorage()

                return cart;

            } catch (e) {
                gbb.utility.debugError("getCartDataForSubscription", e)
            }
        },

        updateCartItemSellingDetails: function (variantId, sellingPlanDetails = []) {
            try {
                let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let boxDataInSessionStorageIndex;
                let boxItem;
                let allBoxesKeys = Object.keys(cartDataInSessionStorage?.boxes)

                for (let i = 0; i < allBoxesKeys.length; i++) {
                    boxItem = cartDataInSessionStorage.boxes[allBoxesKeys[i]];
                    boxDataInSessionStorageIndex = boxItem.items.findIndex((cart) => cart.id == variantId)
                    if (boxDataInSessionStorageIndex != -1) {
                        boxItem.items[boxDataInSessionStorageIndex].sellingPlanDetails = sellingPlanDetails;
                        break;
                    }
                }
                cartDataInSessionStorage.boxes[boxItem.boxId] = boxItem;
                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));

                gbb.gbbBrowser.updateTotalPriceInSessionStorage()
                gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage(boxItem.boxId)

                return cartDataInSessionStorage;
            }
            catch (e) {
                gbb.utility.debugError("updateCartItemSellingDetails", e)
            }
        },
        updateCartAttributes: function (attributesvalues) {
            try {
                let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();

                //loop cartDataInSessionStorage attributes and update one by one
                for (let [key, value] of Object.entries(attributesvalues)) {
                    cartDataInSessionStorage.attributes[key] = value;
                }
                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));

                gbb.gbbBrowser.updateTotalPriceInSessionStorage();
                //gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage() #TBD
                return cartDataInSessionStorage;
            }
            catch (e) {
                gbb.utility.debugError("updateCartAttributes", e)
            }
        },
        deleteCartAttributes: function (attributes) {
            try {
                let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let attributesKeys = Object.keys(cartDataInSessionStorage.attributes);
                for (let i = 0; i < attributesKeys.length; i++) {
                    if (attributes.includes(attributesKeys[i])) {
                        delete cartDataInSessionStorage.attributes[attributesKeys[i]];
                    }
                }
                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
                gbb.gbbBrowser.updateTotalPriceInSessionStorage();
                //gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage() #TBD
                return cartDataInSessionStorage;
            } catch (e) {
                gbb.utility.debugError("deleteCartAttributes", e)
            }
        },

        clearRelevantBoxFromSessionStorage: async function (boxId) {
            try {
                let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();

                //ex:allBoxesKeys = [box1, box2, box3, box4]
                let allBoxesKeys = Object.keys(cartDataInSessionStorage?.boxes) || [];
                gbb.gbbDiscountComponent.state.currentDiscountRule[boxId] = null;

                let currentBoxNo = parseInt(boxId.split("box")[1]);

                let lastBoxNo = parseInt(allBoxesKeys[allBoxesKeys.length - 1].split("box")[1]);

                let allBoxesData = JSON.parse(JSON.stringify(cartDataInSessionStorage.boxes));
                let tempAllBoxesData = JSON.parse(JSON.stringify(cartDataInSessionStorage.boxes));


                //allBoxesKeys = [box1, box2, box3, box4]
                for (let index = currentBoxNo; index < lastBoxNo; index++) {
                    let nextBoxIndex = index + 1;
                    let tempCopiedProductsDataObject = JSON.parse(JSON.stringify(tempAllBoxesData["box" + nextBoxIndex]))
                    allBoxesData[`box${index}`] = tempCopiedProductsDataObject;
                    allBoxesData[`box${index}`]["boxName"] = "Box - " + index;
                    allBoxesData[`box${index}`]["boxId"] = "box" + index;
                }
                delete allBoxesData["box" + allBoxesKeys.length];

                cartDataInSessionStorage.boxes = allBoxesData;

                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));

                //update item properties for all boxes
                let newAllBoxesKeys = Object.keys(cartDataInSessionStorage?.boxes) || [];
                for (let i = 0; i < newAllBoxesKeys.length; i++) {
                    let boxItem = cartDataInSessionStorage.boxes[allBoxesKeys[i]];
                    let items = boxItem.items || [];
                    for (let i = 0; i < items.length; i++) {
                        let item = items[i];
                        let _data = {
                            id: item.key || item.id,
                            quantity: item.quantity,
                            properties: {
                                ...item.properties,
                                "Box ID": boxItem?.boxId?.split("box")[1] || 1
                            }
                        }
                        gbb.state.activeBoxId = boxItem.boxId;
                        await gbb.utility.changeCart(_data);
                    }
                }

                gbb.gbbBrowser.updateSubscriptionType("oneTimeSubscription");
                gbb.gbbBrowser.removeSubscriptionPlan();
                if (!cartDataInSessionStorage.boxes || Object.keys(cartDataInSessionStorage.boxes).length == 0) {
                    gbb.gbbBrowser.clearCartDataFromSessionStorage();
                }
                gbb.gbbReviewPage.init();
            } catch (err) {
                gbb.utility.debugConsole(err + "clearRelevantBoxFromSessionStorage");
            }
        },
        clearCartDataFromSessionStorage: function () {
            try {
                gbb.state.activeBoxId = null;
                sessionStorage.removeItem(`gbb-cart-${gbb.state.bundleId}`);
                let isEligibleTierForAddonsExists = gbb.storage.getItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`)
                if (isEligibleTierForAddonsExists) {
                    sessionStorage.removeItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`)
                }
            } catch (e) {
                gbb.utility.debugError("clearCartDataFromSessionStorage", e)
            }
        },
        addItemsToCart: async function () {
            try {
                const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()

                //perform ajax calls and add items to cart, then return the cart data
                //get the bundleQuantity from cartData
                // cartData = gbb.utility.multiplyByBundleQuantity(cartData)
                let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let result = {
                    data: false,
                    failedProductsArr: []
                };
                //for loop and multiply quantity of items by boxQuantity
                for (let boxId in cartData.boxes) {
                    let boxCartData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);
                    cartData.boxes[boxId] = gbb.utility.multiplyByBundleQuantity(boxCartData)
                }

                //now traverse the cartData and remove all items from cart

                let allItems = gbb.gbbBrowser.getProductsFromAllBoxesFromCart(cartData);

                cartData.items = allItems;

                cartData = gbb.utility.cleanUpProperties(cartData);

                if (gbb.gbbAddonProducts.state.isEnabled) {
                    // check if cart contains addon products 
                    let isAddonProductPresentInCart = cartData.items.find(item => item.properties.hasOwnProperty("_addon_product"))
                    if (isAddonProductPresentInCart) {
                        let propertiesToAdd = {
                            _addon_offer_id:gbb.gbbAddonProducts.state.offerId
                        }
                        let addQtyToProducts = true
                        gbb.utility.addCustomProperties(cartData, propertiesToAdd, addQtyToProducts)
                    }
                }

                if (gbb.gbbBrowser.getSubscriptionType() == "saveSubscription" && gbb.gbbBrowser.getSubscriptionPlan()) {
                    cartData = gbb.utility.applySellingPlanToAllCartItems(cartData);
                }

                if (isPurchaseTypeSubscription) {
                    cartData = gbb.utility.applySellingPlanToAllCartItemsV2(cartData);
                }

                let cartDataWithBoxIdCorrected = gbb.utility.updateBoxIdInCartData(cartData);

                // if more than 
                // if ()

                cartDataWithBoxIdCorrected.items = gbb.utility.groupCartDataBasedOnId_and_Properties(cartDataWithBoxIdCorrected.items)


                result.data = await gbb.shopifyUtility.addToCart(cartDataWithBoxIdCorrected)

                if (!result.data) {
                    let response = await gbb.gbbBrowser.addIndividualItemsToCart(cartDataWithBoxIdCorrected);
                    result.data = response.data;
                    result.failedProductsArr = response.failedProductsArr;
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-add-bundle-to-cart-failed",
                        detail: {
                            failedProducts:response.failedProductsArr || []
                        }
                    })
                } else {
                    result.data = true;
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-add-bundle-to-cart-success",
                    })
                }
                // if (result.data) {
                //     gbb.gbbBrowser.clearCartDataFromSessionStorage()
                // }
                return result;
            } catch (error) {
                gbb.utility.debugConsole("error in gbbBrowser.addItemsToCart", error)
                return false
            }
        },
        addIndividualItemsToCart: async function (cartData) {
            let currentProduct;
            let result = {
                data: false,
                failedProductsArr: []
            }
            try {
                //individual ajax calls for each item
                let items = cartData.items;
                let apiResponse = [];
                for (let i = 0; i < items.length; i++) {
                    currentProduct = items[i];
                    let resp = await gbb.shopifyUtility.addToCart(items[i]);
                    apiResponse.push(resp)
                    if (resp && result.data) {
                        result.data = true;
                    }
                    if (!resp) {
                        result.data = false;
                        result.failedProductsArr.push(currentProduct);
                    }
                }
                return result;
            } catch (error) {
                // result.data = false;
                gbb.utility.debugConsole("error in gbbBrowser.addIndividualItemsToCart", error)
                return result;
            }
        },
        initializeRelevantBoxQuantity: function () {
            if (!gbb.gbbBrowser.getRelevantBoxQuantity()) {
                gbb.gbbBrowser.updateRelevantBoxQuantity(1);
            }
        },
        updateRelevantBoxQuantity: function (value, boxId) {
            if (!boxId) {
                boxId = gbb.state.activeBoxId
            }
            let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);
            boxCartDataInSessionStorage.boxQuantity = value;
            // if(gbb.state.giftBoxCartData){ //TBD
            //     gbb.state.giftBoxCartData["bundleQuantity"] = value;
            // }
            gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(boxCartDataInSessionStorage, boxId);
            return boxCartDataInSessionStorage.boxQuantity;
        },
        getRelevantBoxQuantity: function (boxId) {
            if (!boxId) {
                boxId = gbb.state.activeBoxId
            }
            let boxCartDataInSessionStorage = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId)
            if (boxCartDataInSessionStorage) {
                return boxCartDataInSessionStorage.boxQuantity;
            }
            return 0;
        },
        getSubscriptionType: function () {
            let cart = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
            cart = JSON.parse(cart);
            if (cart && cart.subscriptionType) {
                return cart.subscriptionType;
            }
            return 0;
        },
        updateSubscriptionType: function (value) {
            let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
            cartDataInSessionStorage.subscriptionType = value;
            if (gbb.state.giftBoxCartData) {
                gbb.state.giftBoxCartData["subscriptionType"] = value;
            }
            sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
            return cartDataInSessionStorage.subscriptionType;
        },
        getSubscriptionPlan: function () {
            let cart = sessionStorage.getItem(`gbb-cart-${gbb.state.bundleId}`);
            cart = JSON.parse(cart);
            if (cart && cart.subscriptionPlan) {
                return cart.subscriptionPlan;
            }
            return 0;
        },
        updateSubscriptionPlan: function (value) {
            let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
            cartDataInSessionStorage.subscriptionPlan = value;
            if (cartDataInSessionStorage["subscriptionTotal"]) {
                delete cartDataInSessionStorage["subscriptionTotal"];
            }
            if (gbb.state.giftBoxCartData) {
                gbb.state.giftBoxCartData["subscriptionPlan"] = value;
            }
            sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
            return cartDataInSessionStorage.subscriptionPlan;
        },
        prepareDiscountString: function () {
            let getAllDiscountsToApply = gbb.gbbBrowser.state.gbbDiscountsAlreadyPresentInCart;

            let bundleName = gbb.state.bundleName;


            if (gbb.gbbDiscountComponent.state.discountCode) {
                getAllDiscountsToApply = { ...getAllDiscountsToApply, [`gbbDiscountCode-${bundleName}`]: gbb.gbbDiscountComponent.state.discountCode };
            }
            let discountCodeString;
            // {"gbbDiscountCode-1": 'teeboxblandselv-42609929',"gbbDiscountCode-2": 'teeboxblandselv-42609929'}
            if (getAllDiscountsToApply) {
                //convert them to teeboxblandselv-42609929,teeboxblandselv-42609929
                discountCodeString = Object.values(getAllDiscountsToApply).join(",");
            }
            if (discountCodeString) {
                gbb.gbbDiscountComponent.state.discountCode = gbb.gbbDiscountComponent.state.discountCode + "," + discountCodeString;
            }

            return discountCodeString;
        },
        updateSubscriptionTotal: function (value) {
            let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
            cartDataInSessionStorage.subscriptionTotal = value;
            if (gbb.state.giftBoxCartData) {
                gbb.state.giftBoxCartData["subscriptionTotal"] = value;
            }
            sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
            return cartDataInSessionStorage.subscriptionTotal;
        },
        removeSubscriptionPlan: function () {
            let cartDataInSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
            delete cartDataInSessionStorage.subscriptionPlan;
            sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataInSessionStorage));
            return cartDataInSessionStorage.subscriptionPlan;
        },
        createNewBoxInSessionStorage: function (isRedirectAllowed) {
            try {
                let cartDataFromSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let boxKeys = Object.keys(cartDataFromSessionStorage?.boxes) || [];
                let maxBoxKey = 0;
                for (let i = 0; i < boxKeys.length; i++) {
                    let tempBoxKeyNo = parseInt(boxKeys[i]?.split("box")[1]);
                    if (tempBoxKeyNo > maxBoxKey) {
                        maxBoxKey = tempBoxKeyNo;
                    }
                }
                maxBoxKey = maxBoxKey + 1;
                let newBoxId = "box" + maxBoxKey
                let newBox = {
                    boxId: newBoxId,
                    boxName: "Box - " + maxBoxKey,
                    items: [],
                    boxQuantity: 1,
                    isBoxActive: true,
                    total_price: 0
                }

                gbb.gbbPersonalizePage.state.customerUploadsErrors = null;
                gbb.gbbPersonalizePage.state.customerUploadsResponse = null;

                // gbb.gbbBrowser.activateRelevantBoxInSessionStorage(newBoxId,{redirectToFirstProductPage:isRedirectAllowed});
                cartDataFromSessionStorage = gbb.gbbBrowser.activateRelevantBoxInSessionStorage(newBoxId, { redirectToFirstProductPage: isRedirectAllowed });

                gbb.gbbDiscountComponent.state.currentDiscountRule[gbb.state.activeBoxId] = null;
                cartDataFromSessionStorage.boxes[newBoxId] = newBox;
                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataFromSessionStorage));

                if (gbb?.settings?.stepsConfigurationData?.defaultProductsData?.isDefaultProductsEnabled) {
                    gbb.gbbBrowser.addDefaultProductsToBox();
                }
                let isEligibleTierForAddonsExists = gbb.storage.getItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`)
                if (isEligibleTierForAddonsExists) { 
                    sessionStorage.removeItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`)
                }
                return cartDataFromSessionStorage;
            } catch (err) {
                gbb.utility.debugError(err);
            }
        },
        redirectToFirstProductPage: function () {
            try {
                let firstItem = gbb.state.navigationItems[0];
                if (firstItem.id == "landingPage") {
                    firstItem = gbb.state.navigationItems[1];
                }
                firstItem.initFn();
                gbb.f.addParamsToUrl("page", firstItem.id)
            } catch (err) {
                gbb.utility.debugError(err);
            }
        },

        activateRelevantBoxInSessionStorage: function (boxId, options) {
            // options = {redirectToFirstProductPage:true/false}
            try {
                gbb.state.activeBoxId = boxId;
                let cartDataFromSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let boxKeys = Object.keys(cartDataFromSessionStorage?.boxes) || [];
                for (let i = 0; i < boxKeys.length; i++) {
                    let boxItem = cartDataFromSessionStorage.boxes[boxKeys[i]];
                    if (boxItem.isBoxActive) {
                        boxItem.isBoxActive = false;
                        break;
                    }
                }
                for (let i = 0; i < boxKeys.length; i++) {
                    let boxItem = cartDataFromSessionStorage.boxes[boxKeys[i]];
                    if (boxItem.boxId == boxId) {
                        boxItem.isBoxActive = true;
                        break;
                    }
                }
                if (options?.redirectToFirstProductPage) {
                    gbb.gbbBrowser.redirectToFirstProductPage();
                }
                gbb.gbbPersonalizePage.state.customerUploadsResponse = null;
                sessionStorage.setItem(`gbb-cart-${gbb.state.bundleId}`, JSON.stringify(cartDataFromSessionStorage));
                return cartDataFromSessionStorage;
            } catch (err) {
                gbb.utility.debugError(err);
            }
        },
        getCartDataFromShopify: async function () {
            try {
                const cartData = await gbb.shopifyUtility.getCart();
                //now loop through items and check if theres any property on known as Box ID
                // if yes, then save that BoxId as gbb.gbbBrowser.state.boxIdOffset
                let boxIdOffset = 0;
                let listOfBundleNamesPresentInCart = [];
                cartData.items.forEach(item => {
                    if (item.properties["Box ID"]) {
                        //  boxIdOffset = parseInt(item.properties["Box ID"]);
                        boxIdOffset = Math.max(boxIdOffset, parseInt(item.properties["Box ID"]));
                        // this will append duplicate box names, but its not gonna harm or cause a problem, so its fine
                        listOfBundleNamesPresentInCart.push(item.properties["Bundle"]);
                    }
                });

                listOfBundleNamesPresentInCart = [...new Set(listOfBundleNamesPresentInCart)];

                //              cartData.attributes
                // {gbbDiscountCode-1: 'teeboxblandselv-42609929'}

                let gbbDiscountsAlreadyPresentInCart = Object.keys(cartData.attributes).filter(key => key.includes("gbbDiscountCode-"));

                if (gbbDiscountsAlreadyPresentInCart.length > 0) {
                    gbbDiscountsAlreadyPresentInCart.forEach(discountCodeKey => {
                        let discountCode = cartData.attributes[discountCodeKey];
                        // check if this discountCodeKey is present in listOfBundleNamesPresentInCart
                        let discountCodeKeyBoxName = discountCodeKey.split("gbbDiscountCode-")[1];

                        //is discountCodeKeyBoxName present in listOfBundleNamesPresentInCart
                        if (discountCodeKeyBoxName && listOfBundleNamesPresentInCart.includes(discountCodeKeyBoxName)) {
                            // if yes, then add this discountCode to gbb.gbbBrowser.state.gbbDiscountsAlreadyPresentInCart
                            gbb.gbbBrowser.state.gbbDiscountsAlreadyPresentInCart[discountCodeKey] = discountCode;
                        }
                    })
                }

                gbb.gbbBrowser.state.cartDataFromShopifyBeforeLastPage = cartData;

                gbb.utility.debugConsole("boxIdOffset-> set as", boxIdOffset)
                gbb.gbbBrowser.state.boxIdOffset = boxIdOffset;
                return cartData;
            } catch (error) {
                gbb.utility.debugError(error);
                return;
            }
        },
        setSubscriptionBundleDataInSessionStorage: function (payload) {
            try {
                // set payload in session storage with bundleId
                sessionStorage.setItem(`gbb-subscription-bundle-${gbb.state.bundleId}`, JSON.stringify(payload));

            } catch (error) {
                gbb.utility.debugError('error in setSubscriptionBundleDataInSessionStorage', error)
            }
        },
        emitCustomEvent: function ({
            eventName,
            attachEventTo = document,
            detail = '',
            bubbles = true,
            cancelable = false
        }) {
            try {
                gbb.utility.debugConsole("customEvent:",{
                    eventName,
                    attachEventTo,
                    detail,
                });
                let event = new CustomEvent(eventName, {
                    detail: detail, // extra information that can be accessed via e.detail.message
                    bubbles: bubbles,    // Allow event propagation through the DOM if needed
                    // cancelable: cancelable, // we dont want to give other dev power to interrupt our execution / operations
                });
                // Dispatch the event on the specified element (default is document)
                attachEventTo.dispatchEvent(event);
                return attachEventTo
            } catch (error) {
                gbb.utility.debugError(`Error in emitCustomEvent for event: ${eventName}`, error);
            }
        }
    },
    storage: {

        setItem: function (field, value) {
            sessionStorage.setItem(field, value)
        },
        getItem: function (field) {
            return sessionStorage.getItem(field)
        }
    },
    themeSpecificCode: {
        init: function (settings) {
            gbb.themeSpecificCode.f.ventureTheme(settings)
        },

        f: {
            ventureTheme: function () {
                if (window.Shopify && window.Shopify.theme && window.Shopify.theme.theme_store_id && window.Shopify.theme.theme_store_id == gbb.constants.themesIds.VENTURE_THEME) {
                    // reload on save
                    gbb.selectors.sideCartDrawerOverlay = ""
                }
            }
        }
    },
    giftboxbuilderPage: {
        //init, selectGiftBoxPage, AddProductsPage, personalizePage, reviewPage,
        init: async function (settings) {
            gbb.giftboxbuilderPage.initialize(settings)
        },
        initialize: async function (settings) {
            // gbb.giftboxbuilderPage.init(settings)

            // gbb.state.cartData = await gbb.utility.getCart()

            gbb.utility.debugConsole("dummy commit");
            //initialize active variant class
            gbb.utility.getActiveVariantStyle();
            await gbb.utility.setStoreCurrenyStateFromCart();

            gbb.utility.setBuilderPageHTMLData_SEO()

            let navigationItems = gbb.f.setNavigationItems();

            if (gbb.settings.stepsConfigurationData.bundleStatus == "PAUSED") {
                navigationItems = [];
            }

            gbb.state.navigationItems = navigationItems
            let currentNavigationItem;

            gbb.giftboxbuilderPage.f.insertWrapperIntoBody();

            gbb.gbbAddProductsPage.f.createArraysOfPageWhichHaveConditions();

            if (gbb.settings?.stepsConfigurationData?.isProductSlotsEnabled) {
                gbb.gbbAddProductsPage.f.calculateProductSlotsData()
            }
            // document.title = "Easy Bundles"

            gbb.gbbDiscountComponent.f.updateCurrentDiscountRule()
            gbb.gbbKite.init();
            // currentPageId
            //  check the url params and see if there is ?page field

            let navId = gbb.f.getParamValueFromUrl("page")
            let currentFlow = gbb.f.getParamValueFromUrl("currentFlow")
            //check if landing page is enabled or not that's it
            let isLandingPageEnabled = gbb.settings?.stepsConfigurationData?.landingPageData?.isLandingPageEnabled
            if (isLandingPageEnabled && (navId == null || typeof navId == "undefined" || navId == "landingPage")) {
                gbb.gbbLandingPage.init(settings, "GIFTBOXBUILDER_PAGE")
                gbb.utility.renderTemporaryLoadingSpinner("hide")
                //prefetchFn of the next page to be loaded, figure out from navigationitems
                let nextNavigationItem = gbb.f.getNextNavigationItem();
                if (nextNavigationItem) {

                    if (nextNavigationItem.intialFetchFn) {
                        nextNavigationItem.intialFetchFn()
                    }
                }
            } else {
                gbb.utility.renderTemporaryLoadingSpinner("show")
            }


            // initialize all these fns after calling
            // prefetching the data from shopify

            // extract extra info from localStorage extraInfoFromLinkDummyProductPage
            gbb.f.processAdditionalLogicAsPerUseCase();

            const getProductsData = await gbb.f.prefetchData(settings)
            gbb.gbbBrowser.initializeRelevantBoxQuantity();
            const directlyLoadCheckoutPage = gbb.state.navigationItems.length < 1 ? true : false;
            if (directlyLoadCheckoutPage) {
                await gbb.gbbBrowser.getCartDataFromShopify();
                await gbb.utility.handleCheckoutClick();
                return;
            }

            if (navId != null && navId != "landingPage" && typeof navId != "undefined") {
                //find the current navigationItem
                currentNavigationItem = gbb.f.getNavItem(navId);
                gbb.state.currentPageId = currentNavigationItem.id
                //call the initFn
                gbb.f.markPreviousNavigationItemsAsCompleted(currentNavigationItem)
                await currentNavigationItem.initFn()
                gbb.utility.renderTemporaryLoadingSpinner("hide")
            } else {
                //call the initFn of the first item
                let firstItem = gbb.state.navigationItems[0];
                gbb.f.addParamsToUrl("page", firstItem.id)
                gbb.f.addParamsToUrl("currentFlow", "byob")
                gbb.f.markPreviousNavigationItemsAsCompleted(firstItem)

                if (firstItem.id != "landingPage") {
                    await firstItem.initFn()
                    gbb.utility.renderTemporaryLoadingSpinner("hide")
                }
            }

            gbb.utility.renderTemporaryLoadingSpinner("hide")

            await gbb.f.insertDiscountProgressBar();

            let isThisLastNavigationItem = gbb.state.navigationItems.indexOf(currentNavigationItem) == gbb.state.navigationItems.length - 1
            let isThisTheOnlyNavigationItem = gbb.state.navigationItems.length == 1

            if (isThisLastNavigationItem || isThisTheOnlyNavigationItem) {
                gbb.gbbBrowser.getCartDataFromShopify();
            }

            // gbb.giftboxbuilderPage.f.scrollIntoBundleViewForIndependentPage();

        },
        f: {
            applyCustomizationClassToBodyIfNeeded: function (body) {
                try {
                    let applyNewCustomization = gbb.settings.pageCustomizationData?.generalSettings?.bundle?.applyNewPageCustomization;

                    // If customization flag is not set, check against the version release date
                    if (!applyNewCustomization) {
                        let userCreatedAt = gbb.settings.merchantInfo.createdAt;
                        const versionReleaseDate = new Date('2024-09-19T00:00:00Z'); // 19th September 2024

                        applyNewCustomization = new Date(userCreatedAt) >= versionReleaseDate;
                    }

                    // Add class if customization is applicable
                    if (applyNewCustomization) {
                        gbb.$(body).addClass('gbbNewPageCustomization');
                    }
                } catch (error) {
                    gbb.utility.debugError("applyCustomizationClassToBodyIfNeeded", error);
                }
            },
            insertWrapperIntoBody: function () {
                let currentBundleDesignTemplate = gbb.settings.stepsConfigurationData.bundleDesignTemplate
                const gbbHTMLWrapper = gbb.elements.gbbHTMLWrapperParent;
                const gbbBodyWrapper = gbb.elements.gbbBodyWrapperParent;
                gbbHTMLWrapper.append(gbbBodyWrapper);
                gbb.$(".gbbPageBody").html(gbbHTMLWrapper);

                //attach bundle-number  to the html tag
                gbb.$("html").addClass(`bundle-${gbb.state.bundleId}`)
                gbb.$("html").addClass(`gbbBundle-HTML`)


                // add an id too
                if (currentBundleDesignTemplate == 'BUILD_FROM_SCRATCH_NEWPRODUCTCARD') {
                    gbb.$(".gbbPageBody").addClass('gbbProductsCardLayoutV2')
                }
                gbb.giftboxbuilderPage.f.applyCustomizationClassToBodyIfNeeded('.gbbPageBody')
                // if(gbb.settings.pageCustomizationData.)
                gbb.$(".gbbPageBody").attr("id", "gbbBundle")
                gbb.$(".gbbPageBody").addClass(`bundle-${gbb.state.bundleId}`)
                if (gbb.settings.pageCustomizationData.generalSettings.bundle.bundleBgColor) {
                    gbb.$(".gbbPageBody").css("background-color", gbb.settings.pageCustomizationData.generalSettings.bundle.bundleBgColor)
                }
            },
            scrollIntoBundleViewForIndependentPage: function () {
                try {
                    let gbbBundleElement = gbb.$("#gbbBundle").length > 0 && window.easyBundlesConfig;

                    if (gbbBundleElement) {
                        // gbbBundleElement[0].scrollIntoView({ behavior: "smooth", block: "start" });

                        // scroll with some  margin of top 20px;

                        let topPos = gbb.$("#gbbBundle").offset().top - 20;

                        // scroll into it;
                        gbb.$('html, body').animate({
                            scrollTop: topPos
                        }, 1000);
                    }
                } catch (e) {
                    gbb.utility.debugError("error in scrollIntoBundleViewForIndependentPage", e)
                }
            }
        },
        action: {
            onPrevNavigationBYOB: async function () {
                let currentPageItem = gbb.f.getNavItem(gbb.state.currentPageId);
                let scrollPoisitionAfterPageChange = gbb.state.scrollPoisitionAfterPageChange;

                let prevNavigationItem = gbb.f.getPreviousNavigationItem();
                gbb.state.navigationItems.forEach(function (item) {
                    if (item.id == currentPageItem.id) {
                        item.isActive = false;
                    }
                })
                gbb.state.navigationItems.forEach(function (item) {
                    if (item.id == prevNavigationItem.id) {
                        item.isActive = true;
                    }
                })
                //check if its the last navigation item
                if (prevNavigationItem) {

                    gbb.f.markPreviousNavigationItemsAsCompleted(prevNavigationItem)
                    await prevNavigationItem.initFn();

                    gbb.f.addParamsToUrl("page", prevNavigationItem.id)
                    setTimeout(() => {
                        window.scrollTo(0, scrollPoisitionAfterPageChange);
                    }, 700)
                }
                else {
                    gbb.utility.debugConsole("Welcome to the first page bro")
                    // gbb.gbbModal.action.onModalClose();
                }

            },
            onNextNavigationBYOB: async function (nextPageId) {
                // type -> back or next

                //next button click on path 2 -> create your own gift box

                // gbb.giftboxbuilderPage.f.onFooterNextButtonClick(settings)
                // if(nextNavigationItem.updatePageStatusFn){
                // nextNavigationItem
                // }
                // todo,
                let currentPageValidationPassed = true;
                let currentPageItem = gbb.f.getNavItem(gbb.state.currentPageId);
                let nextNavigationItem;

                if (nextPageId) {
                    nextNavigationItem = gbb.f.getNavItem(nextPageId);
                } else {
                    nextNavigationItem = gbb.f.getNextNavigationItem();
                }

                if (currentPageItem.updatePageStatusFn) {
                    currentPageValidationPassed = await currentPageItem.updatePageStatusFn();
                }

                //make next navigation item active
                if (nextNavigationItem) {
                    gbb.state.navigationItems.forEach(function (item) {
                        if (item.id == nextNavigationItem.id) {
                            item.isActive = true;
                        }
                    })
                }

                //is this nextNavigationItem is the last navigation item then call shopifyAddToCart
                let isThisLastNavigationItem = gbb.state.navigationItems.indexOf(nextNavigationItem) == gbb.state.navigationItems.length - 1
                let scrollPoisitionAfterPageChange = gbb.state.scrollPoisitionAfterPageChange;
                //check if its the last navigation item
                if (nextNavigationItem && currentPageValidationPassed) {
                    await nextNavigationItem.initFn();
                    gbb.f.addParamsToUrl("page", nextNavigationItem.id)
                    setTimeout(() => {
                        window.scrollTo(0, scrollPoisitionAfterPageChange);
                        // window.scrollTo(0, 70);
                    }, 700)

                }

                if (isThisLastNavigationItem) {
                    gbb.gbbBrowser.getCartDataFromShopify();
                }

                else if (!nextNavigationItem) {
                    gbb.utility.debugConsole("Welcome to the end bro")
                    let cartData = await gbb.utility.getCart();
                    gbb.state.giftBoxCartData = cartData;
                    await gbb.utility.handleCheckoutClick();
                    // gbb.gbbModal.action.onModalClose();
                }

                // gbbBundle scroll to gbbBundle id attribute
                gbb.giftboxbuilderPage.f.scrollIntoBundleViewForIndependentPage();

            }
        }

    },
    gbbLandingPage: {
        state: {
            buildBoxButtonAction: undefined,
            // giftBoxData: null,
        },
        init: async function (settings, parent) {
            gbb.state.navigationItems = gbb.f.setNavigationItems();
            gbb.state.currentPageId = "landingPage";
            if (gbb?.gbbAddProductsPage?.state?.productPageData) {
                gbb.gbbAddProductsPage.state.productPageData = undefined
            }
            let navItem = gbb.utility.getNavItem(gbb.state.currentPageId)
            gbb.f.markPreviousNavigationItemsAsCompleted(navItem)
            gbb.gbbLandingPage.initialize(settings, parent)
            gbb.gbbLandingPage.f.registerEvents(settings)
            gbb.utility.renderTemporaryLoadingSpinner("hide")

            // gbb.gbbModel.init(settings)
        },
        initialize: function (settings, parent) {

            // gbb.utility.debugConsole("settings:",settings.giftwrap);

            // let {isEnabledOnProductPage, isEnabledOnCartPage} = gbb.gbbLandingPage.f.checkifGiftWrapEnabled(settings.giftwrap, productHandle, parent)
            // if (isEnabledOnProductPage) {
            let gbbLandingPageWrapper = gbb.$("<div>").addClass("gbbLandingPageWrapper");
            const gbbLandingPageHeaderHTML = gbb.gbbLandingPage.f.prepareHeader();
            const gbbLandingPageBodyHTML = gbb.gbbLandingPage.f.prepareUI();
            const gbbLandingPageFooterHTML = gbb.gbbLandingPage.f.prepareFooter();

            gbbLandingPageWrapper.append(gbbLandingPageHeaderHTML);
            gbbLandingPageWrapper.append(gbbLandingPageBodyHTML);
            gbbLandingPageWrapper.append(gbbLandingPageFooterHTML);

            gbb.$("body").attr("data-page", gbb.state.currentPageId)
            gbb.state.landingPageBody = gbbLandingPageWrapper;
            gbb.gbbLandingPage.f.insertIntoMainPageWrapper();
        },
        f: {

            prepareHeader: function () {
                //this is a header
                const gbbLandingPageHeaderHTML = gbb.$("<div>").addClass("gbbLandingPageHeader");
                // gbbLandingPageHeaderHTML.append("<div> <h1> Header Gift Box Builder</h1> </div>");
                // return gbbLandingPageHeaderHTML;
            },
            prepareUI: function () {

                let scrollPoisitionAfterPageChange = gbb.state.scrollPoisitionAfterPageChange;

                window.scrollTo(0, scrollPoisitionAfterPageChange);

                // window.scrollTo(0, 70);
                let gbbLandingPageHTML;

                //gbbLandingPageHTMLContent = create divs with classNams
                gbbLandingPageHTML = gbb.$("<div>").addClass("gbbLandingPageHTMLContent");
                //one image div, 2 text divs, 1 button div and one label div and 1 cards main div
                const landingPageBanner = gbb.$("<div>").addClass("gbbLandingPageBanner");
                //all the text and button goes in this div
                const landingPageBannerImage = gbb.$("<img>").addClass("gbbLandingPageBannerImage");
                const gbbLandingPageBannerTextWrapper = gbb.$("<div>").addClass("gbbLandingPageBannerTextWrapper");
                const landingPageBannerText = gbb.$("<div>").addClass("gbbLandingPageBannerText");
                //subtext
                const landingPageBannerSubText = gbb.$("<div>").addClass("gbbLandingPageBannerSubText");
                //create a button
                const gbbLandingPageBannerButtonWrapper = gbb.$("<div>").addClass("gbbLandingPageBannerButtonWrapper");
                // const gbbLandingPageBannerButton = gbb.$("<button>").addClass("landingPageBannerButton");
                const gbbLandingPageBannerButton = gbb.$("<div>").addClass("landingPageBannerButton");

                landingPageBannerImage.attr("src", gbb.settings.stepsConfigurationData.landingPageData.stepImage);


                landingPageBannerText.text(gbb.settings?.stepsConfigurationData?.landingPageData?.bannerText);
                landingPageBannerSubText.text(gbb.settings?.stepsConfigurationData?.landingPageData?.bannerSubtext);

                landingPageBannerText.css("color", gbb.settings.pageCustomizationData.landingPage.landingPageTextColor);
                landingPageBannerSubText.css("color", gbb.settings.pageCustomizationData.landingPage.landingPageTextColor);

                gbbLandingPageBannerButton.css("background", gbb.settings.pageCustomizationData.landingPage.landingPageButtonBgColor);
                gbbLandingPageBannerButton.css("color", gbb.settings.pageCustomizationData.landingPage.landingPageButtonTextColor);
                gbbLandingPageBannerButton.on("click", function () {
                    gbb.state.currentFlow = "byob";
                    //add params to url
                    gbb.f.addParamsToUrl("currentFlow", "byob")
                    gbb.giftboxbuilderPage.action.onNextNavigationBYOB()
                    // add pointer events none to none
                    // setTimeout(() => {
                    // gbb.utility.renderTemporaryLoadingSpinner();
                    // }, 100)
                    gbbLandingPageBannerButton.css("pointer-events", "none");
                    setTimeout(() => {
                        gbbLandingPageBannerButton.css("pointer-events", "auto");
                    }, 1000)

                    //gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE")
                    //gbb.gbbAddProductsPage.init(gbb.settings, "ADD_PRODUCTS_PAGE");
                    //gbb.gbbAddProductsPage.f.insertIntoMainPageWrapper();
                });
                gbbLandingPageBannerButton.text(gbb.settings?.stepsConfigurationData?.landingPageData?.bannerButtonText);

                //gbbLandingPageBannerTextWrapper.append(landingPageBannerText);
                //gbbLandingPageBannerTextWrapper.append(landingPageBannerSubText);
                gbbLandingPageBannerButtonWrapper.append(gbbLandingPageBannerButton);
                //gbb.f.applyPrimaryColorCss(gbbLandingPageBannerButton);
                gbbLandingPageBannerTextWrapper.append(gbbLandingPageBannerButtonWrapper.clone());

                //Navigation items container
                const landingPageNavigationItemsContainer = gbb.$("<div>").addClass("gbbLandingPageNavigationItemsContainer");




                landingPageBanner.append(landingPageBannerImage);
                let nextNavigationItems = gbb.f.getNavigationItemsToDisplay(gbb.state.currentPageId);
                landingPageNavigationItemsContainer.append(gbb.f.renderNavigationHTML(landingPageNavigationItemsContainer, "landingPage", nextNavigationItems));




                gbbLandingPageHTML.append(landingPageBanner);
                gbbLandingPageHTML.append(landingPageBannerText);
                gbbLandingPageHTML.append(landingPageNavigationItemsContainer);
                gbbLandingPageHTML.append(gbbLandingPageBannerButtonWrapper);



                return gbbLandingPageHTML;

            },
            prepareFooter: function () {
                //this is a footer
                const gbbLandingPageFooterHTML = gbb.$("<div>").addClass("gbbLandingPageFooter");
                // gbbLandingPageFooterHTML.append("<div> <h1>Footer Gift Box Builder</h1> </div>");
                // return gbbLandingPageFooterHTML;
            },
            insertIntoMainPageWrapper: function () {

                gbb.$(".gbbBodyWrapper").html(gbb.state.landingPageBody);
                gbb.$(".gbbBodyWrapper").addClass(`bundle-${gbb.state.bundleId}`);
                gbb.$(".gbbBodyWrapper").children().first().hide();
                gbb.$(".gbbBodyWrapper").children().first().fadeIn(700);

            },
            registerEvents: function (settings) {
                gbb.gbbLandingPage.state.buildBoxButtonAction = function () {
                    gbb.utility.debugConsole("build box button clicked");
                    // window.alert("build box button clicked");
                };
            }

        },
        events: function (settings) {
        },
        action: {
        }
    },
    gbbAddProductsPage: {
        state: {
            buildBoxButtonAction: undefined,
            productPageKey: "",
            //TODO: @abhishek change it here
            fetchCountPerBatch: 24,
            fetchBatchStartIndex: 0,
            uniqueProductsData: [],
            currentProductsDataset: [],
            pagesWhichHaveConditionsOnPages: [],
            categoriesWhichHaveConditions: [],
            displayVariantsAsIndividualProducts: false,
            dataForInfiniteScroll: {
                noteAttribute: "",
                allProductsData: null,
                categoryId: "",
            },
            filterBySearch: {
                isSearchEnabled: false,
                searchQuery: {
                    searchField: 'title',
                    searchFieldType: String,
                    searchText: '',
                }
            },
            showBoxProductsInFooter: false,
            autoNextStepOnConditionMet: false,
            pagesWhichHaveExhaustedATCFooterAnimation: [],
            isAnimateFooterOnATCEnabled: false,
            lastClearedDiscountProgressBarValue: 0,
            totalProductSlotsRequired: 0,
            productSlotsCalculationData: [],
            isEveryConditionHaveTypeQuantity: null,
            incrementProductQtyBy: 1,
            decrementProductQtyBy: 1,
            validateQuantityPerProduct:{
                isEnabled:false,
                allowedQuantity:Number.MAX_SAFE_INTEGER
             }
            // giftBoxData: null,
        },
        initPageX: async function (pageNumber, settings, parent) {
            // Construct the dynamic parts of the state based on the page number
            const pageId = `addProductsPage${pageNumber}`;
            const productPageKey = `productsData${pageNumber}`;
            const productsData = JSON.parse((JSON.stringify(gbb.settings.stepsConfigurationData[productPageKey])))

            if (true || pageId !== gbb.state.currentPageId) {
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: "gbb-page-init",
                    detail: {
                        activePageId: pageId,
                        prevPageId: gbb.state.currentPageId,
                    }
                })
            }

            // Set the global state for the current page
            gbb.state.currentPageId = pageId;
            gbb.gbbMultipleCategoriesPage.state.currentCategoryId = undefined;
            gbb.gbbMultipleCategoriesPage.currentIndex = undefined;
            gbb.gbbAddProductsPage.state.productPageKey = productPageKey;
            gbb.gbbMultipleCategoriesPage.state.currentCategory = undefined;



            // Check if we need to use the filter logic or not
            let uniqueProductsData = productsData.uniqueProductsData;



            // get first page from the array of navigationItems.
            let navigationItems = [...gbb.state.navigationItems];


            let blackListedNavigationItems = ["landingPage", "reviewPage"];

            navigationItems = navigationItems.filter(function (item) {
                return !blackListedNavigationItems.includes(item.id);
            })


            let skipConditionalLogicFiltering = navigationItems[0].id == pageId || productsData?.skipConditionalLogicFiltering || gbb.settings.bundleSettings.conditionalLogicFilterOnFirstPageAswell || false;

            if (skipConditionalLogicFiltering == false) {
                if (productsData.pageType == "MULTIPLE_CATEGORY") {
                    let allCategoriesData = gbb.f.filterOutBasedOnConditionalLogic_MultipleCategories(productsData.categories)

                    productsData.categories = allCategoriesData;
                    // uniqueProductsData = gbb.f.filterOutBasedOnConditionalLogic(productsData.uniqueProductsData);
                } else {
                    // uniqueProductsData = productsData.uniqueProductsData; // Or some default value or logic
                    uniqueProductsData = gbb.f.filterOutBasedOnConditionalLogic(productsData.uniqueProductsData);
                }
            }


            gbb.gbbAddProductsPage.state.productPageData = productsData;
            gbb.gbbAddProductsPage.state.uniqueProductsData = uniqueProductsData;

            // reset search value
            gbb.gbbAddProductsPage.state.filterBySearch.isSearchEnabled = productsData?.filterBySearch?.isSearchEnabled || false
            gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchFieldType = productsData?.filterBySearch?.searchFieldType || `String`
            gbb.gbbAddProductsPage.f.resetSearchTextValue()
            gbb.gbbAddProductsPage.state.dataForInfiniteScroll = {
                noteAttribute: undefined,
                allProductsData: undefined,
                categoryId: undefined,
            }
            if (gbb.settings?.app?.integrations?.judgeme?.isEnabled) {
                await gbb.gbbIntegrations?.judgeme?.init(uniqueProductsData)
            }
            gbb.gbbAddProductsPage.state.showBoxProductsInFooter = false
            // Initialize the page
            if (gbb.$("body").hasClass("gbbBodyOverflowHidden")) {  // when drawer is open and user navigates to another page in that case we will close the footer drawer
                gbb.$("body").removeClass("gbbBodyOverflowHidden")
                // gbb.$("body").css("overflow",DEFAULT_BODY_OVERFLOW_VALUE)
            }
            let bundleType = gbb.settings?.stepsConfigurationData?.bundleType || ''
            let isSubscriptionBundle = bundleType == 'SUBSCRIPTION_BUNDLE'
            if (isSubscriptionBundle) {
                let subscriptionBundlesData = gbb.settings?.stepsConfigurationData?.subscriptionBundlesData || {}
                gbb.gbbSubscriptionProductsPage.f.subscriptionBundlesInit(subscriptionBundlesData)
            }
            await gbb.gbbAddProductsPage.init(settings, parent);
            if (isSubscriptionBundle) {
                gbb.gbbSubscriptionProductsPage.f.autoScrollToActiveSellingPlanNavigation()
             }
        },
        initPage1: async function (settings, parent) {

            await gbb.gbbAddProductsPage.initPageX(1, settings, parent)
            // gbb.state.currentPageId = "addProductsPage1"
            // gbb.gbbAddProductsPage.state.productPageKey = "productsData1"
            // gbb.gbbAddProductsPage.state.productPageData = gbb.settings.stepsConfigurationData.productsData1
            // gbb.gbbAddProductsPage.state.uniqueProductsData = gbb.settings.stepsConfigurationData.productsData1.uniqueProductsData
            // await gbb.gbbAddProductsPage.init(settings, parent)
        },
        initPage2: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(2, settings, parent)
        },
        initPage3: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(3, settings, parent);
        },
        initPage4: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(4, settings, parent);
        },
        initPage5: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(5, settings, parent);
        },
        initPage6: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(6, settings, parent);
        },
        initPage7: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(7, settings, parent);
        },
        initPage8: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(8, settings, parent);
        },
        initPage9: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(9, settings, parent);
        },
        initPage10: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(10, settings, parent);
        },
        initPage11: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(11, settings, parent);
        },
        initPage12: async function (settings, parent) {
            await gbb.gbbAddProductsPage.initPageX(12, settings, parent);
        },
        init: async function (settings, parent) {
            // gbb.utility.debugConsole("INSIDE INIT");
            //clear the dom reference for gbb
            // add the data-page attribute to it as well and attach it on body

            // let productsData = await gbb.utility.getFilteredSortedProductsData(gbb.gbbAddProductsPage.state.uniqueProductsData);
            gbb.gbbAddProductsPage.f.resetFiltersInfo();
            await gbb.utility.getGiftBoxProductsFromCart()
            gbb.gbbAddProductsPage.state.fetchBatchStartIndex = 0
            let navItem = gbb.utility.getNavItem(gbb.state.currentPageId)
            gbb.f.markPreviousNavigationItemsAsCompleted(navItem)
            gbb.$("body").attr("data-page", gbb.state.currentPageId)
            //documentation: gbb.gbbAddProductsPage.state.productPageKey can be productsData1,productsData2, productsData3
            gbb.utility.initializeFiltersInfo(gbb.gbbAddProductsPage.state.productPageKey);

            //documentation: currentPageId  - addProductsPage1, addProductsPage2, addProductsPage3, addProductsPage4
            gbb.utility.setSortByValues(gbb.state.currentPageId);
            gbb.gbbAddProductsPage.f.setMapForProductsThatHavePersonalization();

            await gbb.gbbAddProductsPage.initialize(settings, parent)
            gbb.gbbAddProductsPage.f.registerEvents(settings)
            gbb.utility.renderTemporaryLoadingSpinner("hide")

            gbb.state.setInfiniteScrollTrackerForProducts = true;

            // activate this only on scroll event of page
            if (gbb.settings.app.isInfiniteScrollEnabled) {
                gbb.$(window).on('scroll', gbb.gbbAddProductsPage.events.activateInfiniteScrollForProducts);
            }
        },


        initialFetch: async function (noteAttribute, productsData) {
            //the task of the page is to get uniqueProductsDat from gbb.settings.stepsConfiguration 
            // at a given time only gbb.addProductsPage.state.fetchCountPerBatch
            // and fetch them from shopify  using  getProductsBulk (helpfull methods are present in  gbb.utility)
            //  once fetched they should all be saved in currentPageSelectedProducts for the initFn to render
            let originalProductsData = [...productsData]
            gbb.gbbAddProductsPage.state.currentProductsDataset = [];
            let response;
            // gbb.utility.debugConsole('fetching...')

            //fetchCountPerBatch 24
            //0-24
            //
            let productsToFetch = null
            try {
                //splice and fetch products from uniqueProductsData from gbb.settings.stepsConfiguration
                productsToFetch = originalProductsData.slice(0, gbb.gbbAddProductsPage.state.fetchCountPerBatch)
            } catch (e) {
                gbb.utility.debugError(e)
            }
            if (productsToFetch) {
                let listOfHandles = productsToFetch.map((product) => product.handle);
                let listOfProductIds = productsToFetch.map((product) => product.productId);
                gbb.gbbAddProductsPage.state.fetchBatchStartIndex = gbb.gbbAddProductsPage.state.fetchCountPerBatch;

                //   TOOD: SF API conditional check
                let fetchOptions = { listOfProductIds }
                response = await gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, productsToFetch, fetchOptions);



                // gbb.utility.debugConsole("fetched products", response)
                gbb.utility.setMapForVariantId(response);
                response = gbb.utility.convertObjectToArray(response);

                if (gbb.gbbAddProductsPage.state.displayVariantsAsIndividualProducts) {
                    //  products has something known as variants[];
                    // now duplicate entries if theres more than one variant.
                    //use a for loop
                    // function flattenVariants(products) {
                    const flattened = [];
                    response.forEach((product) => {

                        const { variants, ...productAttrs } = product; // Extract variants and keep the rest of the product attributes

                        variants.forEach((variant) => {
                            let merged = { ...productAttrs, compare_at_price: variant.compare_at_price, variants: [variant] }; // Merge product attributes with variant attributes
                            merged = gbb.gbbAddProductsPage.f.updateProductDataWithFirstVariantData(merged)
                            flattened.push(merged);
                        });
                    });
                    response = flattened;
                    // return flattened;
                    // }
                }
            }
            if (response) {
                return response;
            }
        },

        fetchNextProductsBatch: async function (noteAttribute, allProductsData) {
            try {
                let dataFromDB;
                let resp;
                // let currentCount = gbb.gbbAddProductsPage.state.currentProductsDataset.length
                let currentCount = gbb.gbbAddProductsPage.state.fetchBatchStartIndex;

                //: remove this switch case and put just uniqueProductsData state as dependency
                dataFromDB = allProductsData;

                // if(gbb.state.addProductsFilters.activatedFilters.length>0){
                //     dataFromDB = gbb.state.currentFilteredProducts
                // }

                let productsToFetch = null;
                try {
                    productsToFetch = dataFromDB.slice(currentCount, currentCount + gbb.gbbAddProductsPage.state.fetchCountPerBatch);
                } catch (e) {
                    gbb.utility.debugError(e);
                }
                if (productsToFetch) {
                    // gbb.utility.debugConsole("products to fetch,", productsToFetch)
                    let listOfHandles = productsToFetch.map((product) => product.handle);
                    let listOfProductIds = productsToFetch.map((product) => product.productId);
                    gbb.gbbAddProductsPage.state.fetchBatchStartIndex = gbb.gbbAddProductsPage.state.fetchBatchStartIndex + gbb.gbbAddProductsPage.state.fetchCountPerBatch;
                    let fetchOptions = { listOfProductIds }

                    resp = await gbb.utility.getProductsBulkForRelevantVariants(listOfHandles, productsToFetch, fetchOptions);
                    gbb.utility.debugConsole("fetched products");
                    resp = gbb.utility.convertObjectToArray(resp);
                    gbb.utility.setMapForVariantId(resp);
                    if (gbb.gbbAddProductsPage.state.displayVariantsAsIndividualProducts) {
                        //  products has something known as variants[];
                        // now duplicate entries if theres more than one variant.
                        //use a for loop
                        // function flattenVariants(products) {
                        const flattened = [];
                        resp.forEach((product) => {
                            const { variants, ...productAttrs } = product; // Extract variants and keep the rest of the product attributes

                            variants.forEach((variant) => {
                                let merged = { ...productAttrs, variants: [variant] }; // Merge product attributes with variant attributes
                                merged = gbb.gbbAddProductsPage.f.updateProductDataWithFirstVariantData(merged);
                                flattened.push(merged);
                            });
                        });
                        resp = flattened;
                        // return flattened;
                        // }
                    }

                    //addProductsPage1Data is now currentProducts
                    gbb.gbbAddProductsPage.state.currentProductsDataset = [...gbb.gbbAddProductsPage.state.currentProductsDataset, ...resp];
                }
                // gbb.utility.debugConsole(currentCount, "/", dataFromDB.length)
                if (dataFromDB.length > currentCount) {
                    //activateLoadMore Button
                    // gbb.gbbAddProductsPage.f.activateLoadMoreButton(noteAttribute);
                } else {
                    // gbb.gbbAddProductsPage.f.deactivateLoadMoreButton()
                    gbb.gbbAddProductsPage.f.hideLoadMoreButton();
                }
                return resp;
            } catch (e) {
                gbb.utility.debugError(e);
            }
        },
        updatePageStatus: function () {
            // check the currentPageId



            const listOfPageIds = ADDPRODUCT_PAGES_LIST

            if (listOfPageIds.includes(gbb.state.currentPageId) == false) {
                return;
            }
            let navItem = gbb.f.getNavItem(gbb.state.currentPageId);
            if (navItem) {
                // navItem.addClass("gbbNavItemActive");
                navItem.isCompleted = true;
                navItem.isActive = false

                //if cart items have the values, then mark complete, else mark incomplete
            }

            //update the navigationItems  by filtering the array gbb.state.navigationItems using id
            gbb.state.navigationItems.forEach(function (item) {
                if (item.id == gbb.state.currentPageId) {
                    item = {
                        ...item,
                        navItem
                    }
                }
            })
            return true;

            // if it is addProductsPage, then find the item in the navigation list
            // and set the class to active
            // else set the class to inactive

        },
        initialize: async function (settings, parent) {
            try {
                let productPageData = gbb.gbbAddProductsPage.state.productPageData
                let isTabBasedUIEnabled = gbb.gbbAddProductsPage.state.productPageData?.isMultiCategoryTabBasedUIEnabled || false;
                gbb.gbbAddProductsPage.state.displayVariantsAsIndividualProducts = productPageData.displayVariantsAsIndividualProducts || false

                if (gbb.$(".gbbAddGiftBoxPageWrapper") && gbb.$(".gbbAddGiftBoxPageWrapper").length > 0) {
                    gbb.$(".gbbAddGiftBoxPageWrapper").remove();
                }
                let gbbAddProductsPageWrapper = gbb.$("<div>").addClass("gbbAddGiftBoxPageWrapper");

                let gbbAddProductsPageBodyHTML = ""

                if (productPageData?.pageType == "MULTIPLE_CATEGORY") {
                    if (isTabBasedUIEnabled) {
                        gbbAddProductsPageBodyHTML = await gbb.gbbMultipleCategoriesPage.f.prepareUIV2TabUI(productPageData)
                    } else {
                        gbbAddProductsPageBodyHTML = await gbb.gbbMultipleCategoriesPage.f.prepareUIV2(productPageData)
                    }
                } else {
                    gbbAddProductsPageBodyHTML = await gbb.gbbAddProductsPage.f.prepareUI();
                }





                const gbbAddProductPageSubtextWrapper = gbb.$("<div>").addClass("gbbAddProductPageSubtextWrapper");
                const gbbAddProductPageSubtext = gbb.$("<div>").addClass("gbbAddProductPageSubtext");
                const gbbDiscountComponent = gbb.$("<div>").addClass("gbbDiscountComponent");
                const gbbAddProductPageBanners = gbb.$("<div>").addClass("gbbAddProductPageBanners")


                gbbAddProductPageSubtext.html(productPageData?.productPageSubtext);
                gbbAddProductPageSubtext.css("color", gbb.settings?.pageCustomizationData?.generalSettings?.productPage?.productPageTitleColor || "black");


                if (productPageData?.pageBanners) {
                    if (productPageData.pageBanners?.mobileBanner) {
                        let mobileBanner = gbb.$("<img>").addClass("gbbMobileImageBanner")
                        mobileBanner.attr('src', productPageData.pageBanners?.mobileBanner)
                        gbbAddProductPageBanners.append(mobileBanner);
                    }
                    if (productPageData.pageBanners?.desktopBanner) {
                        let desktopBanner = gbb.$("<img>").addClass("gbbDesktopImageBanner")
                        desktopBanner.attr('src', productPageData.pageBanners?.desktopBanner)
                        gbbAddProductPageBanners.append(desktopBanner);
                    }
                }

                gbbAddProductPageSubtextWrapper.append(gbbAddProductPageSubtext);
                gbbAddProductPageSubtextWrapper.append(gbbAddProductPageBanners);
                const gbbAddProductsPageFooterHTML = gbb.gbbAddProductsPage.f.prepareFooter();
                const gbbAddProductsPageHeaderHTML = gbb.gbbAddProductsPage.f.prepareHeader();

                // if(isTabBasedUIEnabled){
                //     gbbAddProductsPageFooterHTML.addClass("tabBasedUIFooter");
                // }


                gbbAddProductsPageFooterHTML.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBgColor)
                gbbAddProductsPageFooterHTML.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterTextColor)


                gbbAddProductsPageWrapper.append(gbbAddProductsPageHeaderHTML);
                gbbAddProductsPageWrapper.append(gbbAddProductPageSubtextWrapper);
                gbbAddProductsPageWrapper.append(gbbDiscountComponent);

                // ask ashfaq
                // if(isTabBasedUIEnabled){
                //     gbbAddProductsPageBodyHTML.append(gbbAddProductsPageFooterHTML);
                //     gbbAddProductsPageWrapper.append(gbbAddProductsPageBodyHTML);
                // }else{
                gbbAddProductsPageWrapper.append(gbbAddProductsPageBodyHTML);
                gbbAddProductsPageWrapper.append(gbbAddProductsPageFooterHTML);
                // }


                gbb.state.addProductsBody = gbbAddProductsPageWrapper;
                gbb.gbbAddProductsPage.f.insertIntoMainPageWrapper();
            } catch (e) {
                gbb.utility.debugConsole("error in gbbAddProductsPage init", e)
            }
        },
        f: {

            prepareHeader: function () {
                //this is a header
                let bundleType = gbb.settings?.stepsConfigurationData?.bundleType || '';
                let isSubscriptionBundle = bundleType == 'SUBSCRIPTION_BUNDLE'
                const gbbAddProductsPageHeaderHTML = gbb.$("<div>").addClass("gbbAddProductsPageHeader");
                let gbbPageHeader = gbb.$("<div>").addClass("gbbPageHeader");
                let gbbPageHeaderText = gbb.$("<div>").addClass("gbbPageHeaderText");
                gbbPageHeaderText.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.landingPage.bannerText));

                let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
                let currentPage = gbb.state.currentPageId;

                const gbbAddProductsPageBannerImage = gbb.$("<img>").addClass("gbbPageBannerImage");
                gbbAddProductsPageBannerImage.attr("src", gbb.settings.pageCustomizationData.banners.pageBannerImageSrc)
                let navigationItems = gbb.state.navigationItems;
                let stepsCount = 0;
                navigationItems = navigationItems.filter((element) => {
                    if (element.isNavBarItem && element.isNavBarItem == true) {
                        stepsCount++;
                        return element;
                    }
                })
                if (stepsCount == 1) {
                    gbbPageHeader.addClass("gbbPageHeaderWithoutLine");
                }
                const gbbAddProductsPageNavigationContainer = gbb.$("<div>").addClass("gbbAddProductsPageNavigationContainer");
                //gbbPageHeader.append(gbbPageHeaderText);

                let nextNavigationItems = gbb.f.getNavigationItemsToDisplay(gbb.state.currentPageId);

                gbbAddProductsPageNavigationContainer.append(gbb.f.renderNavigationHTML(gbbAddProductsPageNavigationContainer, currentPage, nextNavigationItems));

                // STEP PROGRESS BAR

                gbbAddProductsPageHeaderHTML.append(gbbPageHeader);
                if (isSubscriptionBundle) {
                    let subscriptionBundleWrapper = gbb.gbbSubscriptionProductsPage.f.prepareSubscriptionHeaderHTML()
                    gbbAddProductsPageHeaderHTML.append(subscriptionBundleWrapper)
                }
                gbbAddProductsPageHeaderHTML.append(gbbAddProductsPageNavigationContainer)
                return gbbAddProductsPageHeaderHTML;
            },
            prepareUI: async function () {
                let gbbAddProductsPageHTML = gbb.$("<div>").addClass("gbbAddProductsPageHTML");
                let noteAttribute = gbb.state.currentPageId;
                gbb.utility.setSortByValues(noteAttribute, "featured");

                productsData = gbb.utility.getProductsInDefaultView()
                gbbAddProductsPageHTML.append(await gbb.gbbAddProductsPage.f.renderProductsCardContainer(productsData, noteAttribute, "initFlow"));

                //no navigation will be available if there is only one step enabled - adjust the positioning
                let navigationItems = gbb.state.navigationItems;
                let stepsCount = 0;
                navigationItems = navigationItems.filter((element) => {
                    if (element.isNavBarItem && element.isNavBarItem == true) {
                        stepsCount++;
                        return element;
                    }
                })

                return gbbAddProductsPageHTML;
            },
            prepareFooter: function () {
                const gbbAddProductsPageFooterHTML = gbb.$("<div>").addClass("gbbAddProductsPageFooterHTML");
                let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey
                const currentPage = gbb.state.currentPageId
                gbbAddProductsPageFooterHTML.append(gbb.f.renderCartProductsFooterHTML(currentPage));
                return gbbAddProductsPageFooterHTML;
            },
            prepare_and_updateProductsCardContainerHTML: async function ({ allProductsData, noteAttribute, origin, categoryId }) {
                try {
                    let gbbAddProductsContainerHTML
                    let gbbProductsContainer
                    gbb.gbbAddProductsPage.f.setMapForProductsThatHavePersonalization({ categoryId: categoryId });
                    if (origin == "initFlow") {
                        gbbAddProductsContainerHTML = gbb.$("<div>").addClass("gbbAddProductsContainerHTML");
                    } else {
                        gbbAddProductsContainerHTML = gbb.utility.getCurrentPageHTML(noteAttribute);
                    }

                    let productsDataFirstBatch = await gbb.gbbAddProductsPage.initialFetch(noteAttribute, allProductsData);

                    gbb.gbbAddProductsPage.state.currentProductsDataset = productsDataFirstBatch;


                    let parentProductsContainerSelector = categoryId ? '.gbbMultipleCategoryBody' : '.gbbAddProductsContainerHTML'
                    let isProductContainerExists = gbb.$(parentProductsContainerSelector).find('.gbbProductsContainer').length > 0;
                    let productsCardHTML = gbb.f.renderProductsHTML(productsDataFirstBatch, noteAttribute, categoryId);
                    let gbbProductsItemsContainer = gbb.$("<div>").addClass("gbbProductsItemsContainer");
                    if (isProductContainerExists) {
                        gbbProductsContainer = gbb.$(".gbbProductsContainer");
                        // gbbProductsItemsContainer = gbbProductsItemsContainer.html(productsCardHTML);
                        gbbProductsItemsContainer.html(productsCardHTML);
                        gbbProductsContainer.html(gbbProductsItemsContainer)
                    } else {
                        gbbProductsContainer = gbb.$("<div>").addClass("gbbProductsContainer");

                        gbbProductsItemsContainer.append(productsCardHTML);
                        gbbProductsContainer.append(gbbProductsItemsContainer);
                    }
                    if (productsCardHTML && productsCardHTML.length <= 4) {
                        gbbProductsItemsContainer.addClass("gbbProductsItemsContainerLessProducts");
                    }
                    gbbProductsItemsContainer.attr('total-products', productsCardHTML?.length || 0)
                    // add no products available card
                    if (productsDataFirstBatch.length <= 0 && noteAttribute !== 'reviewPage') {

                        const gbbProductsNotAvailable = gbb.$("<div>").addClass("gbbProductsNotAvailable");
                        gbbProductsNotAvailable.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.general.noProductsAvailable) || 'No Products Found1');

                        //replace gbbProductsNotAvailable class if available
                        if (gbb.$(".gbbProductsNotAvailable").length > 0) {
                            gbb.$(".gbbProductsNotAvailable").replaceWith(gbbProductsNotAvailable);
                        } else {
                            gbbProductsContainer.append(gbbProductsNotAvailable);
                        }
                    }

                    return {
                        gbbAddProductsContainerHTML,
                        gbbProductsContainer,
                    }
                } catch (error) {
                    gbb.utility.debugConsole("error in prepare_and_updateProductsCardContainerHTML", error)

                }

            },
            renderProductsCardContainer: async function (allProductsData, noteAttribute, origin, categoryId) {
                try {
                    let divsArray = [];
                    let { gbbAddProductsContainerHTML, gbbProductsContainer } = await gbb.gbbAddProductsPage.f.prepare_and_updateProductsCardContainerHTML({ allProductsData, noteAttribute, origin, categoryId });

                    let gbbProductsFilterTags = gbb.utility.getAllFilterTagsForProducts(allProductsData, noteAttribute);
                    if (origin == 'initFlow' || !origin) {
                        if (!categoryId) {
                            let filterSearchHeaderHTML = gbb.f.renderFiltersSearchSortHeaderHTML(noteAttribute);
                            divsArray.push(filterSearchHeaderHTML)
                        }
                        divsArray.push(gbbProductsContainer);
                        gbbAddProductsContainerHTML.html(divsArray);
                    } else if (origin == 'filtersFlow') {
                        let filterSearchHeaderHTML = gbb.f.renderFiltersSearchSortHeaderHTML(noteAttribute);
                        gbb.$('.gbbFiltersSearchSortHeader').replaceWith(filterSearchHeaderHTML);
                    }
                    const isLoadMoreButtonRequired = allProductsData.length > gbb.gbbAddProductsPage.state.fetchBatchStartIndex
                    //showLoadMoreButton needed
                    if (isLoadMoreButtonRequired) {
                        origin = origin == 'filtersFlow' ? 'resetLoadMoreRef' : origin;
                        gbb.gbbAddProductsPage.f.activateLoadMoreButton(noteAttribute, gbbAddProductsContainerHTML, allProductsData, categoryId, origin);
                    } else {
                        gbb.gbbAddProductsPage.f.hideLoadMoreButton();
                    }

                    return gbbAddProductsContainerHTML;
                } catch (error) {
                    gbb.utility.debugConsole("error in renderProductsCardContainer", error)
                }
            },
            insertIntoMainPageWrapper: function () {

                gbb.$(".gbbBodyWrapper").html(gbb.state.addProductsBody);
                //find the first child of gbbBodyWrapper and hide it in ui for 700ms
                gbb.$(".gbbBodyWrapper").children().first().hide();
                gbb.$(".gbbBodyWrapper").children().first().fadeIn(700);

                //gbb.$(".gbbNavigationItemsContainer").replaceWith(gbb.f.renderNavigationHTML())
            },
            updateProductCard: function (productId, variantId) {

                let productItem = gbb.$(".gbbProductsContainer").find(`[productId='${productId}']`);

                // now filter based on firstvariantid as well 
                if (variantId) {
                    let productItem_temp = gbb.$(".gbbProductsContainer").find(`[productId='${productId}'][firstvariantid='${variantId}']`);
                    // gbb.utility.debugConsole("productItems array length",productItem.length)
                    // productItem = 
                    if (productItem_temp.length > 0) {
                        productItem = productItem_temp;
                    }

                    // productItem = gbb.$(".gbbProductsContainer").find(``);
                }
                let categoryId = (productItem).parents(".gbbCategoryContainer").attr("categoryid");
                let product = gbb.utility.getProductDetailsFromState(productId, variantId);

                let noteAttribute = gbb.state.currentPageId;

                let newProductItemHTML = gbb.f.renderProductsHTML([product], noteAttribute, categoryId);
                // gbb.$(".gbbPageBody").find(`[productId='${productId}']`).replaceWith(newProductItemHTML);
                productItem.replaceWith(newProductItemHTML);

            },
            resetFiltersInfo: function () {
                // gbb.state.addProductsFilters.isFiltersActive
                // gbb.state.addProductsFilters.activatedFilters
                // gbb.state.addProductsFilters.priceFilterActive
                // gbb.state.addProductsFilters.addProductsActivatedFilters;
                gbb.state.addProductsFilters = {
                    isFiltersActive: false,
                    activatedFilters: [],
                    priceFilterActive: false,
                    addProductsActivatedFilters: []
                }

            },
            resetSearchTextValue: function () {
                gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchText = '';
            },
            hideExcessProducts: function (gbbAddProductsContainerHTML) {
                let productsCount = gbbAddProductsContainerHTML.find(".gbbProductItem").length;
                if (productsCount > (gbb.gbbAddProductsPage.state.fetchCountPerBatch)) {
                    gbbAddProductsContainerHTML.find(".gbbProductItem").each(function (index) {
                        if (index >= (gbb.gbbAddProductsPage.state.fetchCountPerBatch)) {
                            gbb.$(this).hide();
                        }
                    })
                    // commenting out (no use case for this as of now)
                    // gbb.gbbAddProductsPage.f.activateLoadMoreButton();
                }
            },
            loadMoreProducts: async function (noteAttribute, allProductsData, categoryId) {

                // gbb.utility.debugConsole("")

                if (categoryId) {
                    gbb.utility.debugConsole("fetching products from category: ", categoryId)
                }
                let productItemsHTML = gbb.$(".gbbProductItem")
                //find the productItems that are not hidden
                let currentProductItems = gbb.gbbAddProductsPage.state.currentProductsDataset;


                let productsCount = currentProductItems.length;
                let productsToShow = gbb.gbbAddProductsPage.state.fetchCountPerBatch;
                //: this condition is not in shape
                if (true) {

                    let startIndex = productsCount - 1;
                    gbb.utility.debugConsole("fetching starts.. in loadMoreProducts")
                    const productsData = await gbb.gbbAddProductsPage.fetchNextProductsBatch(noteAttribute, allProductsData)
                    if (productsData && productsData.length > 0) {
                        let productItems = gbb.f.renderProductsHTML(productsData, noteAttribute, categoryId);
                        if (productItems && productItems.length > 0) {
                            gbb.$(".gbbProductsItemsContainer").append(productItems);
                        }
                    }

                    //append product items to the container

                    let dbDataCount = allProductsData.length
                    let fetchBatchStartIndex = gbb.gbbAddProductsPage.state.fetchBatchStartIndex
                    if (fetchBatchStartIndex >= dbDataCount) {
                        //scrollBarListener is disabled
                        gbb.utility.debugConsole("scrollBarListener is disabled from loadMoreProductsFn:")
                        gbb.state.setInfiniteScrollTrackerForProducts = false;
                        gbb.$(".gbbLoadMoreProductsButton").hide();
                    }
                }
            },
            activateLoadMoreButton: function (noteAttribute, parentEle, allProductsData, categoryId, origin) {

                // if already present
                if (origin == 'resetLoadMoreRef' || gbb.gbbAddProductsPage.state.filterBySearch?.searchQuery?.searchText?.length > 0) {
                    // continue processing
                }
                else if (!categoryId) {
                    if (gbb.$(".gbbLoadMoreProductsButton").length > 0) {
                        // alert("already found load more btuton")
                        return;
                    }
                }

                let attachButtonTo = parentEle || gbb.$(".gbbLoadMoreProductsButton").parent();
                gbb.gbbAddProductsPage.state.dataForInfiniteScroll = {
                    noteAttribute: noteAttribute,
                    allProductsData: allProductsData,
                    categoryId: categoryId
                }

                let loadMoreButton = gbb.$("<div>").addClass("gbbLoadMoreProductsButton");
                loadMoreButton.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.general?.loadMoreProductsButtonText) || "Load More Products1");
                loadMoreButton.on("click", async function () {
                    gbb.utility.disableElement(loadMoreButton, 500);
                    await gbb.gbbAddProductsPage.f.loadMoreProducts(noteAttribute, allProductsData, categoryId);
                })
                // if (gbb.$(".gbbLoadMoreProductsButton").length <= 0) {
                //     gbb.$(attachButtonTo).append(loadMoreButton);
                // } else {
                //     let loadMoreBtn = gbb.$(".gbbLoadMoreProductsButton")
                //     loadMoreBtn.text('REPLACED')
                //     loadMoreBtn.replaceWith(loadMoreButton)
                // } In multicategory we were updating dom -> then we were updating parentEle container -> here we were loosing load more btn ref
                if (gbb.$(".gbbLoadMoreProductsButton").length > 0) {
                    gbb.$(".gbbLoadMoreProductsButton").remove()
                }
                gbb.$(attachButtonTo).append(loadMoreButton);

                return loadMoreButton

            },
            hideLoadMoreButton: function () {
                //scrollBarListener is disabled
                gbb.utility.debugConsole("scrollBarListener is disabled from hideLoadMoreButton:")
                gbb.state.setInfiniteScrollTrackerForProducts = false;
                gbb.$(".gbbLoadMoreProductsButton").hide();
            },
            registerEvents: function (settings) {
                gbb.gbbAddProductsPage.state.buildBoxButtonAction = function () {
                    gbb.utility.debugConsole("build box button clicked");
                };
            },
            renderNextPage: async function (pageId) {
               try {
                   let noteAttribute = gbb.state.currentPageId
                   let currentPageRank = gbb.utility.getPageRankByPageId(noteAttribute)
                   let pageToRenderRank = gbb.utility.getPageRankByPageId(pageId)
                   let renderPrevStep = pageToRenderRank < currentPageRank
                   let condition = !renderPrevStep && await gbb.utility.checkConditionsOnNext(noteAttribute, "", true);
                   if (renderPrevStep || condition.isConditionMet) {
                       gbb.utility.renderTemporaryLoadingSpinner("show")
                       gbb.giftboxbuilderPage.action.onNextNavigationBYOB(pageId);
                   }
               } catch (error) {
                    gbb.utility.debugConsole("error in renderNextPage", error)
               }
            },
            createArraysOfPageWhichHaveConditions: function () {

                // each of these fields has an array of conditions, if empty then check if they have an object with key as "categories"
                // if they have an object with key as "categories" then check if the objects keys have a conditions array
                // if they have a conditions array then check if the conditions array is empty
                // if not empty then copy the category id and push to the array 
                let pagesWhichHaveConditionsOnPages = [];
                let pagesWhichHaveConditionOnCategories = [];
                let categoriesWhichHaveConditions = [];

                // so in gbb.settings.stepsConfigurationData
                // there are fields such as productsData1 ...... till 12.
                for (let i = 0; i < Object.keys(gbb.settings.stepsConfigurationData).length; i++) {
                    // object keys are productsData1, productsData2, productsData3, productsData4, productsData5, productsData6, productsData7, productsData8, productsData9, productsData10, productsData11, productsData12
                    // so we are looping through each of these keys
                    let _key = Object.keys(gbb.settings.stepsConfigurationData)[i];
                    let currData = gbb.settings.stepsConfigurationData[_key];
                    _key = String(_key)
                    if (_key.includes("productsData")) {
                        //now check if the productsData has a conditions array
                        if (currData?.conditions?.length > 0) {
                            // if it has a conditions array then push the page name to the pagesWhichHaveConditionsOnPages array
                            pagesWhichHaveConditionsOnPages.push(_key);
                        } else {
                            // currData
                            //check if the productsData has a categories object
                            if (currData?.categories) {
                                // if it has a categories object then loop through the categories object
                                for (let [key, value] of Object.entries(currData.categories)) {
                                    // if the categories object has a conditions array then push the page name to the pagesWhichHaveConditionOnCategories array
                                    if (value?.conditions?.length > 0) {
                                        pagesWhichHaveConditionOnCategories.push(_key);
                                        categoriesWhichHaveConditions.push(key);
                                    }
                                }
                            }
                        }
                    }
                }

                // now we have an array of pages which have conditions on pages and pages which have conditions on categories
                // we also have an array of categories which have conditions
                // now we need to check if the current product has any of the categories which have conditions
                // if it does then we need to check if the current product has any of the conditions

                // in the pagesWhichHaveCondtionOnCategories array we have the page names. change the page number from productsData1 to addProductsPage1
                // and similarly

                pagesWhichHaveConditionsOnPages.forEach((page, index) => {
                    pagesWhichHaveConditionsOnPages[index] = page.replace("productsData", "addProductsPage");
                })

                gbb.gbbAddProductsPage.state.pagesWhichHaveConditionsOnPages = pagesWhichHaveConditionsOnPages;
                gbb.gbbAddProductsPage.state.categoriesWhichHaveConditions = categoriesWhichHaveConditions;

            },
            setMapForProductsThatHavePersonalization: function (options = {}) {
                try {
                    let map = {};
                    let keyAttribute = gbb.gbbAddProductsPage.state.productPageKey;
                    let currentProductsData = JSON.parse(JSON.stringify(gbb.settings.stepsConfigurationData[keyAttribute]));
                    let categoryProductsData;

                    if (currentProductsData && currentProductsData.pageType == "MULTIPLE_CATEGORY") {
                        // gbb.utility.debugConsole("multiple category page")
                        //create a map for each
                        //object.keys(currentProductsData.categories).forEach((category) => {

                        let categoryIds = Object.keys(currentProductsData.categories);

                        options.categoryId = options.categoryId || currentProductsData?.categories[categoryIds[0]]?.categoryId;
                        categoryProductsData = currentProductsData.categories[options.categoryId];

                        currentProductsData = categoryProductsData;
                    }
                    let productFormData = currentProductsData.productPersonalization;
                    if (productFormData && productFormData.isProductPersonalizationEnabled == true) {
                        if (productFormData?.isEnabledForSelectedProducts == true) {
                            productFormData.selectedProducts.forEach((product) => {
                                map[product.productId] = { formBlocks: productFormData.formBlocks };
                            });
                        } else if (productFormData?.isEnabledForAllProducts == true) {
                            // create a map out of  this data but select only productId
                            currentProductsData.uniqueProductsData.forEach((product) => {
                                map[product.productId] = { formBlocks: productFormData.formBlocks };
                            });
                        } else {
                            // none; no map needed
                        }

                        gbb.gbbAddProductsPage.state.productPersonalizationData = productFormData;
                        gbb.gbbAddProductsPage.state.productPersonalizationMap = map;
                    } else {
                        gbb.gbbAddProductsPage.state.productPersonalizationData = null;
                        gbb.gbbAddProductsPage.state.productPersonalizationMap = null;
                    }
                } catch (error) {
                    gbb.utility.debugConsole("error in setMapForProductsThatHavePersonalization", error);
                }
            },
            updateProductDataWithFirstVariantData: function (productData) {
                try {
                    let firstVariantData = productData.variants[0];
                    // productData.title = firstVariantData.name || productData.title;
                    productData.title = productData.title;
                    productData.variantName = firstVariantData.public_title == "Default Title" ? "" : firstVariantData.public_title;
                    productData.renderChooseOptionsButton_forcefully = false
                    productData.featured_image = firstVariantData.image || productData.featured_image;
                    // push the firstVariantData.image into the product.images. but the firstVariantData.image should be the first element
                    productData.images = [firstVariantData.image, ...productData.images];
                    if (gbb?.settings?.bundleSettings?.removeUnUsedVariantImages) {
                        productData = gbb.utility.removeUnUsedVariantImages(productData)
                    }
                    productData = gbb.utility.shiftFirstVariantMedia_toFirstIndexInMediaObj(productData);
                    //find the "https://cdn.shopify.com/s/files/1/0603/6874/8751/products/Candle_UH_Back.png?v=1639895559"
                    // in the 
                    // productData.media = [... new Set(firstVariantData.featured_image, ...productData.media)]
                    return productData;
                } catch (error) {
                    gbb.utility.debugConsole("error in updateProductDataWithFirstfirstVariantDataData", error)
                }
            },
            handleAutoNextStep: async function (options) {
                try {
                    // return;
                    // let conditionRules = options.condition.conditions;
                    // let condition = options.condition;
                    let currentPageId = gbb.state.currentPageId;
                    // 

                    let activeConditionConfig = gbb.gbbAddProductsPage.f.getConditionConfig_basedOnCurrentPageOrCategory(gbb.state.currentPageId);

                    let validConditionTypesForAutoNext = ["equalTo"]

                    let conditionRules = activeConditionConfig.conditions;

                    if (conditionRules && conditionRules.length > 0 && conditionRules.length == 1
                        && validConditionTypesForAutoNext.includes(conditionRules[0].condition)
                        && activeConditionConfig.autoNextStepOnConditionMet == true) {
                        await gbb.utility.checkConditionsAndProceedToNextPage(currentPageId);
                    }


                } catch (error) {
                    gbb.utility.debugConsole("error in handleAutoNextStep", error)
                }
            },
            getConditionConfig_basedOnCurrentPageOrCategory: function (pageId) {
                try {
                    // from active pageId, get if its a productPageData 
                    let currentPageData = gbb.gbbAddProductsPage.state.productPageData;
                    let result = {
                        conditions: [],
                        autoNextStepOnConditionMet: false
                    }
                    if (!currentPageData) {
                        return result
                    }
                    //give priorty to global config conditions
                    if (currentPageData.conditions && currentPageData.conditions.length > 0) {
                        //if present then return the conditions
                        result.conditions = currentPageData.conditions;
                        result.autoNextStepOnConditionMet = currentPageData.autoNextStepOnConditionMet;
                    }

                    if (currentPageData.pageType == "MULTIPLE_CATEGORY" && gbb.gbbAddProductsPage.state.productPageData.isPageConditionsEnabled != true) {
                        // get active category id
                        let currentCategoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;

                        // get conditions for the currentCategoryId
                        let categoryData = currentPageData.categories[currentCategoryId];
                        if (categoryData.conditions && categoryData.conditions.length > 0) {
                            result.conditions = categoryData.conditions;
                        }

                        result.autoNextStepOnConditionMet = categoryData.autoNextStepOnConditionMet;

                    }

                    return result;
                    //if MULTIPLE_CATEGORY then 
                    // get the currentCategoryId. 
                } catch (error) {
                    gbb.utility.debugConsole("error in getConditionConfig_basedOnCurrentPageOrCategory", error)
                }
            },
            prepareHTMLforProductMetafields: function (productData,origin) {
                try {
                    const metafieldNameSpaceAndKeys = gbb.settings.bundleSettings.metafieldNameSpaceAndKeys || []
                   
                    if (!metafieldNameSpaceAndKeys.length) return ''
                    // filter origin 
                    let metafieldWrapper = gbb.$("<div>").addClass('productsMetafieldWrapper')
                    const validMetafieldTypes = ["single_line_text_field","multi_line_text_field"] //only allow the type whose value we can get root level -- for eg : metafield.value 
                    for (let i = 0; i < metafieldNameSpaceAndKeys.length; i++){
                        let metafieldData = metafieldNameSpaceAndKeys[i]
                        if (metafieldData.hasOwnProperty("showOnProductCard") || metafieldData.hasOwnProperty("showOnModal")) { 
                            if (origin == 'PRODUCT_CARD' && !metafieldData.showOnProductCard) {
                                continue
                            }
                            else if (origin == 'PRODUCT_VARIANTS_MODAL' && !metafieldData.showOnModal) {
                                continue
                            } 
                        }
                        let productMetafieldAccessKey = `metafield_${metafieldData?.namespace}_${metafieldData?.key}`
                        let productMetafieldData = productData[productMetafieldAccessKey] || {}
                        if (validMetafieldTypes.includes(productMetafieldData?.type)) {
                            let divToAppend = gbb.$('<div>').addClass(`product_metafield_${metafieldData?.key}`).attr('metafield-key', metafieldData?.key)
                            divToAppend.text(productMetafieldData?.value)
                            metafieldWrapper.append(divToAppend)
                        }
                    }
                    return metafieldWrapper;
                } catch (error) {   
                    gbb.utility.debugConsole("error in prepareHTMLforProductMetafields", error)
                }
            },
            renderProductDynamicContent: function (productData,origin) {
                try {
                    // the value will be present in 
                    // let content = `<div>
                    //  ${productData?.metafield_gbbNameSpace_test?.value}
                    // </div>`
                    if(gbb.settings.app.dynamicScriptForHTMLContent){
                        return eval(gbb.settings.app.dynamicScriptForHTMLContent)
                    } else {
                        return gbb.gbbAddProductsPage.f.prepareHTMLforProductMetafields(productData,origin)
                    }
                   
                    // prodCard
                    // popup 
                    // dono dikhao
                    
                    // return content;
                    // return eval(gbb.settings.app.dynamicScriptForHTMLContent)

                    // gbb.settings.app.dynamicHTMLContent
                    // retu
                    // return gbb.settings.app.dynamicHTMLContent;

                } catch (e) {
                    gbb.utility.debugConsole("error in renderProductDynamicContent", e)
                }
            },
            getSearchedProductInBundlePage: function (query, productsData) {
                try {
                    // query -> contains the search params eg: {title:'val'} || {tags:'spo-default'}
                    // productsData is the array of products on which we will implement search functionality 
                    let searchKey = Object.keys(query)[0] || 'title';
                    let searchVal = query[searchKey] || '';
                    searchVal = searchVal?.toString()?.trim()?.toLowerCase();
                    let searchType = gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchFieldType || 'String'
                    let searchedProducts = [];

                    switch (searchType) {
                        case 'String': {
                            searchedProducts = productsData?.filter((product) => {
                                return product[searchKey]?.toLowerCase()?.trim()?.includes(searchVal);
                            })
                            break
                        }
                        case 'Array': {
                            for (let i = 0; i < productsData.length; i++) {
                                let product = productsData[i];
                                // product[searchKey] => product[tags] = ['snow','sport'] => array
                                if (product[searchKey] && product[searchKey].length > 0) {
                                    for (let j = 0; j < product[searchKey].length; j++) {
                                        let arrayElement = product[searchKey][j]?.toString()?.toLowerCase()?.trim()
                                        if (arrayElement?.includes(searchVal)) {
                                            searchedProducts.push(product)
                                        }
                                    }
                                }
                            }
                            // searchedProducts = productsData?.filter((product) => {
                            //     if (product[searchKey] && product[searchKey].length > 0) { 
                            //         return product[searchKey]?.some((el) => {
                            //             let arrayElement = el?.toString()?.toLowerCase()?.trim()
                            //             return arrayElement?.includes(searchVal);
                            //         })
                            //     }
                            // })
                            break
                        }
                        default: {
                            searchedProducts = productsData
                        }
                    }
                    return searchedProducts;
                } catch (e) {
                    gbb.utility.debugConsole("error in getSearchedProductInBundlePage", e)

                }
            },
            handleSearchBundleInput: async function (value, noteAttribute) {
                try {
                    let isFilterActive = gbb.utility.getActivatedFilters(noteAttribute).length > 0
                    gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchText = value
                    let pageType = gbb.gbbAddProductsPage.state.productPageData.pageType
                    let categoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId

                    let totalProducts = pageType == 'MULTIPLE_CATEGORY' ? gbb.gbbAddProductsPage.state.productPageData.categories[categoryId].uniqueProductsData : gbb.gbbAddProductsPage.state.uniqueProductsData

                    if (isFilterActive) {
                        totalProducts = await gbb.utility.getFilteredSortedProductsData(noteAttribute, 'searchProductsFlow')
                    }
                    let keyToSearch = gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchField || 'title';
                    let searchQueryParams = {
                        [keyToSearch]: gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchText
                    }
                    // reset load more btn ref if search value is cleared 
                    // to load normal products with load more functionality
                    if (value.trim().length <= 0) {
                        let gbbAddProductsContainerHTML = gbb.$('.gbbAddProductsContainerHTML')
                        gbb.gbbAddProductsPage.f.activateLoadMoreButton(noteAttribute, gbbAddProductsContainerHTML, totalProducts, categoryId, 'resetLoadMoreRef');
                    }

                    let searchedProducts = gbb.gbbAddProductsPage.f.getSearchedProductInBundlePage(searchQueryParams, totalProducts)
                    gbb.state.setInfiniteScrollTrackerForProducts = true;

                    return searchedProducts
                } catch (error) {
                    gbb.utility.debugConsole("error in handleSearchBundleInput", error)
                }
            },
            renderShowBoxProductsToggleHTML: function () {
                try {
                    let gbbShowBoxProductsToggleContainer = gbb.$('<div>').addClass('gbbShowBoxProductsToggleContainer')
                    gbbShowBoxProductsToggleContainer.append(PLAIN_CHEVRON_UP_SVG)
                    if (gbb.gbbAddProductsPage.state.showBoxProductsInFooter) {
                        gbbShowBoxProductsToggleContainer.css('transform', 'rotate(180deg)');
                    }

                    if (gbb.state.giftBoxCartData?.items?.length <= 0) {
                        gbbShowBoxProductsToggleContainer.css('transform', 'rotate(0deg)');
                        gbb.gbbAddProductsPage.state.showBoxProductsInFooter = false;

                    }
                    return gbbShowBoxProductsToggleContainer;
                } catch (error) {
                    gbb.utility.debugConsole("error in renderShowBoxProductsToggleHTML", error)
                }
            },
            renderCartIconWithQuantityHTML: function () {
                try {
                    let _boxData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                    let cartIconWithQuantity = gbb.$('<div>').addClass('gbbCartIconWithQuantityContainer')
                    let cartIconWithQuantityText = gbb.$('<div>').addClass('gbbCartIconWithQuantityText')
                    let cartQuantity = gbb.$('<div>').addClass('gbbCartQuantity')
                    let cartQuantityValue = _boxData?.item_count || 0

                    cartIconWithQuantity.css('background', gbb.settings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonColor || '#000000')
                    cartIconWithQuantity.css("color", gbb.settings?.pageCustomizationData?.cartFooter?.cartFooterNextButtonTextColor || '#ffffff')

                    // cartIconWithQuantity.click(gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)

                    cartQuantity.text(cartQuantityValue)
                    cartIconWithQuantityText.append(cartQuantity)
                    cartIconWithQuantity.append(cartIconWithQuantityText)
                    cartIconWithQuantity.append(CART_SVG)
                    return cartIconWithQuantity;
                } catch (error) {
                    gbb.utility.debugConsole("error in renderCartIconWithQuantityHTML", error)
                }
            },
            toggleBoxProductsDisplayFooter: function () {
                if (gbb.state.giftBoxCartData?.items?.length <= 0) {
                    return
                }
                let isShowProductsActive = gbb.gbbAddProductsPage.state.showBoxProductsInFooter;
                let gbbFooterProductsContainer = gbb.$('.gbbFooterProductsContainer')
                let gbbSlotFooterProductsContainerWrapper = gbb.$(".gbbSlotFooterProductsContainerWrapper")
                // let gbbShowBoxProductsToggleContainer = gbb.$('.gbbShowBoxProductsToggleContainer')
                if (gbbFooterProductsContainer.is(':visible')) {
                    gbbFooterProductsContainer.slideUp(700); // Hide with animation
                    gbb.$("body").removeClass("gbbBodyOverflowHidden")
                    // gbbShowBoxProductsToggleContainer.css('transform', 'rotate(0deg)')
                    gbbSlotFooterProductsContainerWrapper && gbbSlotFooterProductsContainerWrapper.slideDown(700)
                    // gbb.$("body").css("overflow-y", DEFAULT_BODY_OVERFLOW_VALUE);
                } else {
                    gbbFooterProductsContainer.slideDown(700); // Show with animation
                    // gbb.$('body').css('overflow-y', 'hidden');
                    gbb.$("body").addClass("gbbBodyOverflowHidden")
                    gbbSlotFooterProductsContainerWrapper && gbbSlotFooterProductsContainerWrapper.slideUp(700)
                    // gbbShowBoxProductsToggleContainer.css('transform', 'rotate(180deg)');
                }
                gbb.gbbAddProductsPage.state.showBoxProductsInFooter = !isShowProductsActive;
            },
            renderShowBoxProductsInFooterHTML: function () {
                try {
                    let _boxData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                    let showBoxProductsInFooter = gbb.$('<div>').addClass('showBoxProductsInFooter')
                    let showBoxProductsInFooterText = gbb.$('<div>').addClass('showBoxProductsInFooterText')
                    showBoxProductsInFooterText.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.general?.viewCartProductsLabel) || 'View Selected Products')
                    // showBoxProductsInFooterText.append(" ").append(`(${_boxData?.item_count})`)
                    // let toggleForDisplayProducts = gbb.gbbAddProductsPage.f.renderShowBoxProductsToggleHTML()
                    showBoxProductsInFooter.click(gbb.gbbAddProductsPage.f.toggleBoxProductsDisplayFooter)
                    showBoxProductsInFooter.append(showBoxProductsInFooterText)
                    return showBoxProductsInFooter
                } catch (e) {
                    gbb.utility.debugConsole("error in renderShowBoxProductsInFooterHTML", e)
                }

            },
            renderProgressBarHTML: function (configOptions) {
                try {
                    const { filledPercentage, filledColor, emptyColor } = configOptions
                    let progressBarContainer = gbb.$('<div>').addClass('progressBarContainer')
                    let progressBar = gbb.$('<div>').addClass('progressBar')
                    progressBar.css('background', emptyColor)
                    let progressBarFill = gbb.$('<div>').addClass('progressBarFill')
                    progressBarFill.css('background', filledColor)
                    let animationConfig = {
                        start: gbb?.gbbAddProductsPage?.state?.lastClearedDiscountProgressBarValue || 0,
                        end: filledPercentage
                    }
                    progressBarFill.css('width', animationConfig?.start + '%')
                    progressBarFill.animate({ width: animationConfig?.end + '%' }, 500)

                    progressBar.append(progressBarFill)
                    progressBarContainer.append(progressBar)
                    gbb.gbbAddProductsPage.state.lastClearedDiscountProgressBarValue = filledPercentage
                    return progressBarContainer;
                } catch (error) {
                    gbb.utility.debugConsole("error in renderProgressBarHTML", error)
                }
            },
            calculateProductSlotsData: function () {
                try {
                    let totalNoOfSlotsRequired = 0
                    let productSlotsCalculationArray = []
                    let stepsConfigurationData = gbb.settings?.stepsConfigurationData
                    for (let i = 1; i <= 12; i++) {// max page can be 12
                        let currentPageData = stepsConfigurationData[`productsData${i}`]
                        if (gbb.gbbAddProductsPage.state?.isEveryConditionHaveTypeQuantity == false) {
                            break
                        }
                        if (!currentPageData) { // if page 6 is not present then no point checking page 7,8,9....12
                            break
                        }
                        if (!currentPageData?.isProductsEnabled) {
                            continue
                        }
                        let isMultiCategory = currentPageData?.pageType == 'MULTIPLE_CATEGORY' ? true : false
                        if (isMultiCategory && currentPageData?.isPageConditionsEnabled != true) { // if pageLevel condition is false for multicategory then only we will check categories conditions else pagelevel conditions will be considered
                            for (let key in currentPageData?.categories) {
                                let currentCategoryData = currentPageData?.categories[key]
                                if (currentCategoryData?.conditions && currentCategoryData?.conditions?.length > 0) {
                                    let slotsRequiredForThisStep = gbb.gbbAddProductsPage.f.calculateNumberOfSlotsRequired(currentCategoryData?.conditions)
                                    totalNoOfSlotsRequired += slotsRequiredForThisStep
                                    productSlotsCalculationArray.push({
                                        pageId: `addProductsPage${i}`,
                                        categoryId: key,
                                        slotsRequired: slotsRequiredForThisStep
                                    })
                                }
                            }
                        } else {
                            if (currentPageData?.conditions && currentPageData?.conditions?.length > 0) {
                                let slotsRequiredForThisStep = gbb.gbbAddProductsPage.f.calculateNumberOfSlotsRequired(currentPageData?.conditions)
                                totalNoOfSlotsRequired += slotsRequiredForThisStep
                                productSlotsCalculationArray.push({
                                    pageId: `addProductsPage${i}`,
                                    categoryId: null,
                                    slotsRequired: slotsRequiredForThisStep
                                })
                            }
                        }
                        gbb.gbbAddProductsPage.state.productSlotsCalculationData = productSlotsCalculationArray
                        gbb.gbbAddProductsPage.state.totalProductSlotsRequired = totalNoOfSlotsRequired
                        if (gbb.gbbAddProductsPage?.state?.isEveryConditionHaveTypeQuantity == null) { // we change this flag to false if any of the condition does not have type as quantity ---- if this flag is null which means all conditions have type as quantity
                            gbb.gbbAddProductsPage.state.isEveryConditionHaveTypeQuantity = true
                        }
                    }
                } catch (error) {
                    gbb.utility.debugConsole("error in initializeProductSlotsData", error)
                }
            },
            calculateNumberOfSlotsRequired: function (conditionsArray) {
                try {
                    let slotsRequiredForThisStep = 0
                    let calculationRule = "Maximum"
                    let conditionTypesToExclude = []
                    let conditionValues = []
                    for (let i = 0; i < conditionsArray.length; i++) {
                        let currentCondition = conditionsArray[i]
                        if (currentCondition.type != 'quantity') {
                            gbb.gbbAddProductsPage.state.isEveryConditionHaveTypeQuantity = false
                            return 0
                        }
                        if (!conditionTypesToExclude.includes(currentCondition.condition)) {
                            conditionValues.push(+currentCondition.value)
                        }
                    }
                    if (conditionValues.length > 0) {
                        if (calculationRule == "Minimum") {
                            slotsRequiredForThisStep = Math.min(...conditionValues)
                        } else {
                            slotsRequiredForThisStep = Math.max(...conditionValues)
                        }
                    }
                    return slotsRequiredForThisStep
                } catch (error) {
                    gbb.utility.debugConsole("error in calculateNumberOfSlotsRequired", error)
                }
            },
            autoScrollSlotsOnNavigation: function () {
                try {
                    let productsContainer = gbb.$(".gbbSlotFooterProductsContainer")
                    let totalNoOfEmptySlots = productsContainer.find(".gbbSlotFooterProductContainerEmpty").length
                    let totalNoOfFilledSlots = productsContainer.find(".gbbSlotFooterProductContainer").not('.gbbSlotFooterProductContainerEmpty').length
                    // let totalNoOfSlotsToScroll = totalNoOfFilledSlots - 1

                    let minimumSlotsToScroll = -1 * Math.min(totalNoOfFilledSlots, 3)
                    let lastFilledCardToScroll = productsContainer.find(".gbbSlotFooterProductContainer").not(".gbbSlotFooterProductContainerEmpty").eq(minimumSlotsToScroll)
                    lastFilledCardToScroll.length > 0 && lastFilledCardToScroll[0].scrollIntoView({ behavior: "smooth", block: "nearest", inline: "start" });
                    // if (totalNoOfEmptySlots > 0) {
                    // let card = productsContainer.find('.gbbSlotFooterProductContainer');
                    // let cardWidth = card[0].offsetWidth
                    // let distanceToScroll = (totalNoOfSlotsToScroll * cardWidth) + (totalNoOfSlotsToScroll * 10)
                    // productsContainer.animate({
                    //     scrollLeft:distanceToScroll
                    // },300)
                    // } 

                } catch (error) {
                    gbb.utility.debugConsole("error in autoScrollSlotsOnNavigation", error)
                }
            },
            // autoScrollSlotsBasedOnATC: function (flow) {
            //     try {
            //         let gbbSlotFooterProductsContainerWrapper = gbb.$('.gbbSlotFooterProductsContainerWrapper')
            //         let visibleContentWidth = gbbSlotFooterProductsContainerWrapper.width()
            //         let containerLeft = gbbSlotFooterProductsContainerWrapper.scrollLeft();
            //         let distanceToScroll = 0 
            //         let productCardsContainer = gbb.$(".gbbSlotFooterProductsContainer")
            //         let emptyCardFound = false
            //         //  find the last child which has class gbbSlotFooterProductContainer and doesnt contain gbbSlotFooterProductContainerEmpty

            //         if (flow == "addToCart") {
            //             productCardsContainer.find(".gbbSlotFooterProductContainer").each(function (index) {
            //                 let productCard = gbb.$(this)

            //                 let isProductSlotEmpty = productCard.hasClass("gbbSlotFooterProductContainerEmpty")
            //                 if (isProductSlotEmpty) {
            //                     let productCardLeft =  productCard.position().left; 
            //                     let productCardRight = productCardLeft + productCard.width();

            //                     // Check if the card is already visible within the container's width
            //                     if (productCardLeft >= containerLeft && productCardRight <= visibleContentWidth) {
            //                         emptyCardFound = true;
            //                     } else {
            //                         let previousCardLeft = productCard.prev().position().left
            //                         distanceToScroll = previousCardLeft
            //                         // use scrollIntoView to scroll to the card 
            //                         previousCardLeft[0].scrollIntoView({ behavior: "smooth", block: "nearest", inline: "start" });
            //                         // gbb.$(".gbbSlotFooterProductsContainer").animate({
            //                         //     scrollLeft: productCard.prev()
            //                         //     }, 500)
            //                     }
            //                     return false; // Exit the loop once the first empty card is found
            //                 }
            //             })
            //             // Scroll to the first empty card if it is not visible
            //             // if (!emptyCardFound && distanceToScroll > 0) {
            //             //     gbb.$(".gbbSlotFooterProductsContainer").animate({
            //             //         scrollLeft:  distanceToScroll
            //             //     }, 500)
            //             // }
            //         } else if (flow == "removeFromCart") {
            //             let lastFilledCard = productCardsContainer.find(".gbbSlotFooterProductContainer").not(".gbbSlotFooterProductContainerEmpty").last()
            //             let lastFilledCardLeft = lastFilledCard?.position().left;
            //             // last filledCard is inside visbility then dont scroll 
            //             let lastFilledCardRight = lastFilledCardLeft + lastFilledCard.width();
            //             // if (lastFilledCardRight > visibleContentWidth) {
            //             //     distanceToScroll = lastFilledCardLeft - containerLeft;
            //             //     gbb.$(".gbbSlotFooterProductsContainer").animate({
            //             //         scrollLeft: lastFilledCardLeft
            //             //     }, 500)
            //             // }

            //             // lastFilledCard.scrollIntoView({ behavior: "smooth", block: "nearest", inline: "start" });
            //                 gbb.$(".gbbSlotFooterProductsContainer").animate({
            //                     scrollLeft: lastFilledCard
            //                 }, 500)
            //        }

            //     } catch (error) {
            //         gbb.utility.debugConsole("error in autoScrollSlotsBasedOnATC", error)
            //     }
            // },
            autoScrollSlots: function () {
                try {
                    let productsContainer = gbb.$(".gbbSlotFooterProductsContainer")
                    let totalNoOfFilledSlots = productsContainer.find(".gbbSlotFooterProductContainer").not(".gbbSlotFooterProductContainerEmpty").length
                    let productCard = productsContainer.find('.gbbSlotFooterProductContainer').eq(0)

                    let slotsFooterWrapperWidth = gbb.$('.gbbSlotFooterProductsContainerWrapper').width()
                    let gridGap = 10
                    let totalSizeTakenByFilledSlots = (totalNoOfFilledSlots * productCard.width()) + ((totalNoOfFilledSlots - 1) * gridGap)
                    let slideConditionPercentage = 0.6 // calculate 60% of the width of the container
                    let triggerAutoSlide = totalSizeTakenByFilledSlots > (slotsFooterWrapperWidth * slideConditionPercentage)
                    if (triggerAutoSlide) {
                        let thirdLastFilledProductCard = productsContainer.find(".gbbSlotFooterProductContainer").not(".gbbSlotFooterProductContainerEmpty").eq(-3)
                        if (thirdLastFilledProductCard?.length > 0) {
                            thirdLastFilledProductCard[0].scrollIntoView({ behavior: "smooth", block: "nearest", inline: "start" });
                        }
                    }
                } catch (err) {
                    gbb.utility.debugConsole("error in autoScrollSlots", err)
                }
            }
        },
        events: {
            activateInfiniteScrollForProducts: async function () {
                if (gbb.state.setInfiniteScrollTrackerForProducts == false) {
                    return;
                }
                const myElement = gbb.$('[data-load-more-indicator-status]');

                if (gbb.utility.isElementVisible(myElement)) {
                    if (myElement.attr("data-load-more-indicator-status") != "fetching") {
                        myElement.attr("data-load-more-indicator-status", "fetching")
                        let fetchInProgress;
                        if (!fetchInProgress) {
                            fetchInProgress = true;
                            setTimeout(async function () {
                                gbb.utility.debugConsole("fetching..in progress")
                                const noteAttribute = gbb.gbbAddProductsPage.state.dataForInfiniteScroll.noteAttribute
                                const allProductsData = gbb.gbbAddProductsPage.state.dataForInfiniteScroll.allProductsData
                                const categoryId = gbb.gbbAddProductsPage.state.dataForInfiniteScroll.categoryId
                                await gbb.gbbAddProductsPage.f.loadMoreProducts(noteAttribute, allProductsData, categoryId);
                                myElement.removeAttr("data-load-more-indicator-status")
                            }, 400)
                            gbb.utility.debugConsole("queued...in setTimeout");
                        }
                    } else {
                        // gbb.utility.debugConsole("fetching...from else if")
                    }
                } else {
                    // gbb.utility.debugConsole('Element is not visible');
                }
            }

        },
        action: {
            showPage1: async function () {
                //updatePageStatusFn
                // gbb.gbbAddProductsPage.state.updatePageStatusFn(1);
                let pageId = "addProductsPage1";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId);

            },
            showPage2: async function () {

                let pageId = "addProductsPage2";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId);
            },
            showPage3: async function () {
                let pageId = "addProductsPage3";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId);

            },

            showPage4: async function () {
                let pageId = "addProductsPage4";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage5: async function () {
                let pageId = "addProductsPage5";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage6: async function () {
                let pageId = "addProductsPage6";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage7: async function () {
                let pageId = "addProductsPage7";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage8: async function () {
                let pageId = "addProductsPage8";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage9: async function () {
                let pageId = "addProductsPage9";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage10: async function () {
                let pageId = "addProductsPage10";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage11: async function () {
                let pageId = "addProductsPage11";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            showPage12: async function () {
                let pageId = "addProductsPage12";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            }
        },
    },
    gbbSubscriptionProductsPage: {
        state: {
            selectedSellingPlanGroup: null,
            activeSellingPlanId: null,
            activeSellingPlanDetails: null,
            selectedSellingPlanGroupId: null,
            sellingPlansArray: [],
            enableOneTimePurchase: false,
            showDiscountOnProductCards: false,
            purchaseType: null,
            constants: {
                ONE_TIME_PURCHASE: 'ONE_TIME_PURCHASE',
                SUBSCRIPTION_PURCHASE: 'SUBSCRIPTION_PURCHASE'
            },
            languageFields: {
                oneTimePurchaseLabel: "One time Purchase", // get it from multilang
                subscriptionPurchaseLabel: "Subscription Purchase",// get it from multilang
                frequencyLabel: "Frequency1",
                pageTitle: "Page Title1"
            },
        },
        settings: {
            pageCustomizationData: { // change values 
                header: {
                    purchaseOptionActiveColor: "#2B2B2B",
                    purchaseOptionActiveBgColor: "#FFFFFF",
                    purchaseOptionInActiveColor: "#888888",
                    purchaseOptionInActiveBgColor: "#F0F0F0",
                    purchaseOptionStrokeRadius: "8px",
                    purchaseOptionStrokeColor: "#D5D5D5",
                    purchaseOptionStrokeWidth: "2px",
                    sellingPlanNavigationActiveBgColor: "#FFFFFF",
                    sellingPlanNavigationActiveTitleColor: "#333333",
                    sellingPlanNavigationInActiveTitleColor: "#333333",
                    pageTitleColor: "#333333",
                    pageTitleFontWeight: "bold",
                    headerBgColor: "#EDEDED",
                    sellingPlanNavigationNextPrevIconBgColor: "#2B2B2B",
                    sellingPlanNavigationActiveDiscountPillBgColor: "#CAE983",
                    sellingPlanNavigationActiveDiscountPillTextColor: "#000000",
                    sellingPlanNavigationInActiveDiscountPillTextColor: "#000000",
                    sellingPlanNavigationInActiveDiscountPillBgColor: "#9D9D9D",
                    productDiscountRibbonBgColor: "#FF0000",
                    productDiscountRibbonTextColor: "#FFFFFF",
                    subscriptionFrequencyLabelTextColor: "#333333",
                    subscriptionFrequencyLabelFontWeight: "bold",
                    subscriptionPageTitleTextColor: "#000000",
                    subscriptionPageTitleFontWeight: "bold",
                    sellingPlansNavigationStrokeColor: "#B7B7B7",
                    sellingPlansNavigationStrokeWidth: "2px",
                    sellingPlansNavigationStrokeRadius: "10px"
                }
            }
        },
        f: {
            setCssVariablesForSubscriptionProductsPage: function () {
                try {
                    let root = document.documentElement;
                    let pageCustomizationData = gbb.gbbSubscriptionProductsPage.settings.pageCustomizationData || {}
                    const keysToMap = ['header']
                    keysToMap.forEach((key) => {
                        let currentKey = pageCustomizationData[key] || {}
                        Object.keys(currentKey).forEach((key) => {
                            let value = currentKey[key];
                            if (value) {
                                let _key = gbb.f.convertCamelCaseToKebabCase(key);
                                root.style.setProperty(`--gbb-gbbSubscriptionBundle-${_key}`, value);
                            }
                        })
                    })
                } catch (error) {
                    gbb.utility.debugError('error in setCssVariablesForSubscriptionProductsPage', error)
                }
            },
            checkIfPurchaseTypeIsSubscription: function () {
                try {
                    const { SUBSCRIPTION_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants
                    const subscriptionDataFromSessionStorage = gbb.gbbSubscriptionProductsPage.f.getSubscriptionDataFromSessionStorage()
                    if (subscriptionDataFromSessionStorage && subscriptionDataFromSessionStorage.purchaseType) { 
                        return subscriptionDataFromSessionStorage.purchaseType == SUBSCRIPTION_PURCHASE
                    }
                    const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.state.purchaseType == SUBSCRIPTION_PURCHASE
                    return isPurchaseTypeSubscription
                } catch (error) {
                    gbb.utility.debugError('error in checkIfPurchaseTypeIsSubscription', error)
                }
            },
            updateSubscriptionDataInSessionStorage: function (data = {}) {
                try {
                    let { ONE_TIME_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants
                    let dataToSet = {
                        activeSellingPlanId: gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId,
                        activeSellingPlanDetails: gbb.gbbSubscriptionProductsPage.state.activeSellingPlanDetails,
                        purchaseType: gbb.gbbSubscriptionProductsPage.state.purchaseType,
                        selectedSellingPlanGroupId: gbb.gbbSubscriptionProductsPage.state.selectedSellingPlanGroupId,
                        enableOneTimePurchase: gbb.gbbSubscriptionProductsPage.state.enableOneTimePurchase,
                        sellingPlansArray: gbb.gbbSubscriptionProductsPage.state.sellingPlansArray,
                    }
                    dataToSet = { ...dataToSet, ...data }
                    if (dataToSet.purchaseType == ONE_TIME_PURCHASE) {
                        dataToSet['activeSellingPlanId'] = null
                        dataToSet['activeSellingPlanDetails'] = null
                    }
                    sessionStorage.setItem(`gbb-subscription-bundle-${gbb.state.bundleId}`, JSON.stringify(dataToSet));
                } catch (error) {
                    gbb.utility.debugError('error updateSubscriptionDataInsessionStorage', error)
                }
            },
            getSubscriptionDataFromSessionStorage: function () {
                try {
                    return JSON.parse(sessionStorage.getItem(`gbb-subscription-bundle-${gbb.state.bundleId}`))
                } catch (error) {
                    gbb.utility.debugError('error in getSubscriptionDataFromSessionStorage', error)
                }
            },
            checkIfPricingPoliciesChanged: function (sessionArray, settingsArray) {
                try {
                    for (const settingsItem of settingsArray) {
                        const sessionItem = sessionArray.find(item => item.id === settingsItem.id);
                        if (!sessionItem) return true;

                        const sessionPricingPolicies = sessionItem.pricingPolicies;
                        const settingsPricingPolicies = settingsItem.pricingPolicies;

                        if (sessionPricingPolicies.length !== settingsPricingPolicies.length) return true;

                        for (let j = 0; j < sessionPricingPolicies.length; j++) {
                            const sessionPolicy = sessionPricingPolicies[j];
                            const settingsPolicy = settingsPricingPolicies[j];

                            if (sessionPolicy.adjustmentType !== settingsPolicy.adjustmentType) return true;

                            const { adjustmentType } = sessionPolicy.adjustmentType;
                            const adjustmentValueSession = sessionPolicy.adjustmentValue;
                            const adjustmentValueSettings = settingsPolicy.adjustmentValue;

                            if (adjustmentType === 'PERCENTAGE') {
                                if (adjustmentValueSession.percentage !== adjustmentValueSettings.percentage) return true;
                            } else if (adjustmentType === 'PRICE' || adjustmentType === 'FIXED_AMOUNT') {
                                if (adjustmentValueSession.amount !== adjustmentValueSettings.amount) return true;
                            }
                        }
                    }
                    return false;
                } catch (error) {
                    gbb.utility.debugError('error in checkIfPricingPoliciesChanged', error);
                }
            },

            checkIfNameChanged: function (sessionArray, settingsArray) {
                try {
                    for (const settingsItem of settingsArray) {
                        const sessionItem = sessionArray.find(item => item.id === settingsItem.id);
                        if (!sessionItem) return true;

                        const keysToCheck = ['name', 'displayTitle', 'displayDiscountText'];
                        for (const key of keysToCheck) {
                            if (sessionItem[key] !== settingsItem[key]) return true;
                        }
                    }
                    return false;
                } catch (error) {
                    gbb.utility.debugError('error in checkIfNameChanged', error);
                }
            },

            hasSubscriptionDataChanged: function (dataToUpdate) {
                try {
                    const subscriptionDataFromSessionStorage = gbb.gbbSubscriptionProductsPage.f.getSubscriptionDataFromSessionStorage();
                    if (!subscriptionDataFromSessionStorage) return false;

                    const sellingPlanArrayFromSession = subscriptionDataFromSessionStorage.sellingPlansArray;
                    const sellingPlanArrayFromSettings = dataToUpdate.sellingPlansArray;

                    if (sellingPlanArrayFromSession.length !== sellingPlanArrayFromSettings.length) return true;

                    if (this.checkIfNameChanged(sellingPlanArrayFromSession, sellingPlanArrayFromSettings)) return true;
                    if (this.checkIfPricingPoliciesChanged(sellingPlanArrayFromSession, sellingPlanArrayFromSettings)) return true;

                    const keysToCompare = ['enableOneTimePurchase', 'selectedSellingPlanGroupId'];
                    for (const key of keysToCompare) {
                        if (dataToUpdate[key] !== subscriptionDataFromSessionStorage[key]) return true;
                    }

                    return false;
                } catch (error) {
                    gbb.utility.debugError('error in hasSubscriptionDataChanged', error);
                }
            },
            setSubscriptionBundlesLanguageFields: function (options) {
                try {
                    let languageFields = gbb.gbbSubscriptionProductsPage.state.languageFields
                    for (let key in options) {
                        if (key && languageFields.hasOwnProperty(key)) {
                            languageFields[key] = options[key]
                        }
                    }
                    gbb.gbbSubscriptionProductsPage.state.languageFields = languageFields
                } catch (error) {
                    gbb.utility.debugError('error in setSubscriptionBundlesLanguageFields', error)
                }
            },
            setSubscriptionBundlesSettings: async function (dataToSet) {
                try {
                    let { selectedSubscriptionGroup, enableOneTimePurchase, showDiscountOnProductCards, frequencyLabel, pageTitle, isDefaultPurchaseTypeSubscription = false } = dataToSet || {}
                    const { ONE_TIME_PURCHASE, SUBSCRIPTION_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants
                    const purchaseType = (enableOneTimePurchase && isDefaultPurchaseTypeSubscription) || !enableOneTimePurchase ? SUBSCRIPTION_PURCHASE:ONE_TIME_PURCHASE
                    const activeSellingPlanData = selectedSubscriptionGroup?.sellingPlans[0] || {}
                    let groupId = gbb.utility.generateSellingPlanGroupIdByName(selectedSubscriptionGroup.name)
                    const updateStates = {
                        selectedSellingPlanGroup: selectedSubscriptionGroup,
                        selectedSellingPlanGroupId: groupId,
                        activeSellingPlanDetails: activeSellingPlanData,
                        activeSellingPlanId: gbb.utility.extractIdsFromGraphQlId(activeSellingPlanData?.id) || null,
                        sellingPlansArray: selectedSubscriptionGroup?.sellingPlans || [],
                        purchaseType: purchaseType,
                        enableOneTimePurchase: enableOneTimePurchase,
                        showDiscountOnProductCards: showDiscountOnProductCards,
                    }

                    const subscriptionDataFromSessionStorage = gbb.gbbSubscriptionProductsPage.f.getSubscriptionDataFromSessionStorage()

                    let isSessionDataChanged = gbb.gbbSubscriptionProductsPage.f.hasSubscriptionDataChanged(updateStates)

                    if (isSessionDataChanged || !subscriptionDataFromSessionStorage) {
                        let dataToSet = {
                            activeSellingPlanId: gbb.utility.extractIdsFromGraphQlId(activeSellingPlanData?.id),
                            activeSellingPlanDetails: activeSellingPlanData,
                            purchaseType: purchaseType,
                            selectedSellingPlanGroupId: groupId,
                            enableOneTimePurchase: enableOneTimePurchase,
                        }
                        gbb.gbbSubscriptionProductsPage.f.updateSubscriptionDataInSessionStorage(dataToSet)
                    }
                    else if (subscriptionDataFromSessionStorage) {
                        for (let key in subscriptionDataFromSessionStorage) {
                            if (key && updateStates.hasOwnProperty(key)) {
                                updateStates[key] = subscriptionDataFromSessionStorage[key]
                            }
                        }
                    }
                    gbb.gbbSubscriptionProductsPage.state = { ...gbb.gbbSubscriptionProductsPage.state, ...updateStates }
                    gbb.gbbSubscriptionProductsPage.f.setSubscriptionBundlesLanguageFields({ frequencyLabel, pageTitle })
                    if (isSessionDataChanged) {
                        await gbb.gbbSubscriptionProductsPage.f.resetProductsDataBasedOnActiveSellingPlan()
                    }
                } catch (error) {
                    gbb.utility.debugError("error in gbbSubscriptionProductsPage.f.setSubscriptionBundlesSettings", error)
                }
            },
            prepareSubscriptionHeaderHTML: function () {
                try {
                    const enableOneTimePurchase = gbb.gbbSubscriptionProductsPage.state.enableOneTimePurchase || false
                    const purchaseType = gbb.gbbSubscriptionProductsPage.state.purchaseType
                    const { SUBSCRIPTION_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants

                    const gbbSubscriptionBundleWrapper = gbb.$('<div>').addClass('gbbSubscriptionBundleWrapper')
                    if (enableOneTimePurchase) {
                        let purchaseOptionsWrapperHTML = gbb.gbbSubscriptionProductsPage.f.preparePurchaseOptionsUI()
                        gbbSubscriptionBundleWrapper.append(purchaseOptionsWrapperHTML)
                    }
                    if (purchaseType == SUBSCRIPTION_PURCHASE) {
                        let sellingPlansNavigationHTML = gbb.gbbSubscriptionProductsPage.f.prepareSellingPlansNavigationUI()
                        gbbSubscriptionBundleWrapper.append(sellingPlansNavigationHTML)
                    }

                    return gbbSubscriptionBundleWrapper;
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.prepareSubscriptionHeaderHTML', error)
                }
            },
            resetProductsDataBasedOnActiveSellingPlan: async function () {
                try {
                    gbb.gbbSubscriptionProductsPage.f.updateSubscriptionDataInSessionStorage()
                    let cartData = gbb.state.giftBoxCartData
                    gbb.gbbBrowser.setRelevantBoxDataToSessionStorage(cartData)
                    gbb.gbbBrowser.updateTotalPriceInSessionStorage()
                    gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage()
                    await gbb.gbbSubscriptionProductsPage.f.resetProductsCardContainerUI()
                    gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML(gbb.state.currentPageId));
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.resetProductsDataBasedOnActiveSellingPlan', error)
                }
            },
            handleChangeActiveSellingPlan: async function (event) {
                try {
                    let gbbSellingPlanNavigationTab = gbb.$(event.currentTarget)
                    if (gbbSellingPlanNavigationTab.hasClass("active")) {
                        return
                    }
                    let sellingPlanId = gbbSellingPlanNavigationTab.data('selling-plan-id')
                    let sellingPlanIdGid = `gid://shopify/SellingPlan/${sellingPlanId}`
                    let sellingPlansArray = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray
                    let sellingPlan = sellingPlansArray.find((sellingPlan) => sellingPlan.id == sellingPlanIdGid)
                    gbb.$('.gbbSellingPlanNavigationTab').removeClass('active')
                    gbbSellingPlanNavigationTab.addClass('active')
                    gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId = sellingPlanId
                    gbb.gbbSubscriptionProductsPage.state.activeSellingPlanDetails = sellingPlan
                    await gbb.gbbSubscriptionProductsPage.f.resetProductsDataBasedOnActiveSellingPlan()
                    return sellingPlanId
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.handleChangeActiveSellingPlan', error)
                }
            },
            prepareIndividualSellingPlanNavigationTabHTML: function (sellingPlan) {
                try {
                    const activeSellingPlanId = gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId
                    const gbbSellingPlanNavigationTab = gbb.$('<div>').addClass('gbbSellingPlanNavigationTab')
                    const gbbSellingPlanNavigationTabTitle = gbb.$('<div>').addClass('gbbSellingPlanNavigationTabTitle')
                    const gbbSellingPlanNavigationDiscountText = gbb.$('<div>').addClass('gbbSellingPlanNavigationDiscountText')
                    const sellingPlanId = gbb.utility.extractIdsFromGraphQlId(sellingPlan.id)
                    if (sellingPlanId == activeSellingPlanId) {
                        gbbSellingPlanNavigationTab.addClass("active")
                    }
                    gbbSellingPlanNavigationTab.attr('data-selling-plan-id', sellingPlanId)
                    gbbSellingPlanNavigationTabTitle.text(sellingPlan.displayTitle)
                    gbbSellingPlanNavigationDiscountText.text(sellingPlan.displayDiscountText)
                    gbbSellingPlanNavigationTab.append(gbbSellingPlanNavigationTabTitle)
                    gbbSellingPlanNavigationTab.append(gbbSellingPlanNavigationDiscountText)

                    gbbSellingPlanNavigationTab.on("click", gbb.gbbSubscriptionProductsPage.f.handleChangeActiveSellingPlan)
                    return gbbSellingPlanNavigationTab
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.prepareIndividualSellingPlanNavigationTabHTML', error)
                }
            },
            prepareNextPrevNavigationsHTML: function () {
                try {
                    const nextNavigationIconHTML = gbb.$('<div>').addClass("gbbSellingPlanNextNavigationIconWrapper").append(CONSTANT_ARROW_SVG)
                    const prevNavigationIconHTML = gbb.$('<div>').addClass("gbbSellingPlanPrevNavigationIconWrapper").append(CONSTANT_ARROW_SVG)

                    return { nextNavigationIconHTML, prevNavigationIconHTML }
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.prepareNextPrevNavigationsHTML', error)
                }
            },
            renderSellingPlansNavigationTabs: function (options) {
                try {
                    const { sellingPlansArray, gbbSellingPlansNavigationTabsContainer } = options
                    gbbSellingPlansNavigationTabsContainer.empty();  // Clear previous tabs

                    for (let i = 0; i < sellingPlansArray.length; i++) {
                        const sellingPlan = sellingPlansArray[i];
                        const navigationTab = gbb.gbbSubscriptionProductsPage.f.prepareIndividualSellingPlanNavigationTabHTML(sellingPlan);
                        gbbSellingPlansNavigationTabsContainer.append(navigationTab);
                    }
                    return gbbSellingPlansNavigationTabsContainer
                } catch (error) {
                    gbb.utility.debugError('error in renderSellingPlansNavigationTabs', error)
                }
            },
            handleNextPrevNavigationBtnClickV1: function ({ operation }) {
                try {
                    const navigationTabsContainer = gbb.$(".gbbSellingPlansNavigationTabsContainer").first();
                    const totalSellingPlans = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray?.length || 0;
                    let isMobileView = false;

                    // Check if the navigation container exists
                    if (!navigationTabsContainer.length) return;

                    const navigationTabs = gbb.$(".gbbSellingPlanNavigationTab");
                    let slidesPerView = 4; // Default number of visible slides
                    if (window.innerWidth < 550) {
                        isMobileView = true;
                        slidesPerView = 1;  // Only 1 visible slide in mobile view
                    }

                    // Find the active element using the 'active' class
                    const $activeElement = navigationTabs.filter('.active').first();
                    const activeIndex = navigationTabs.index($activeElement);

                    let scrollToElementIndex;

                    // Calculate the new index to scroll to based on the "NEXT" or "PREV" operation
                    if (operation === "NEXT") {
                        scrollToElementIndex = Math.min(activeIndex + slidesPerView, totalSellingPlans - 1);
                    } else if (operation === "PREV") {
                        scrollToElementIndex = Math.max(activeIndex - slidesPerView, 0);
                    }

                    const $nextSlideElement = navigationTabs.eq(scrollToElementIndex).first();

                    // Make sure the next slide element exists
                    if (!$nextSlideElement.length) return;

                    const containerRect = navigationTabsContainer.get(0).getBoundingClientRect();
                    const nextSlideRect = $nextSlideElement.get(0).getBoundingClientRect();

                    // Calculate the scroll offset based on the active element and the next element
                    const offset = nextSlideRect.left - containerRect.left;

                    // Adjust scrolling direction based on operation
                    if (operation === "NEXT") {
                        navigationTabsContainer.animate({
                            scrollLeft: '+=' + offset
                        }, 500);
                    } else if (operation === "PREV") {
                        navigationTabsContainer.animate({
                            scrollLeft: '-=' + Math.abs(offset)
                        }, 500);
                    }

                    if (isMobileView) {
                        gbb.gbbSubscriptionProductsPage.f.handleChangeActiveSellingPlan({ currentTarget: $nextSlideElement });
                    }

                } catch (error) {
                    gbb.utility.debugError('Error in handleNextPrevNavigationBtnClick', error);
                }
            },
            autoScrollToActiveSellingPlanNavigation: function () {
                try {
                    const navigationTabsContainer = gbb.$(".gbbSellingPlansNavigationTabsContainer").first();
                    if (!navigationTabsContainer.length) return;
                    const navigationTabs = gbb.$(".gbbSellingPlanNavigationTab");
                    const totalSellingPlans = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray?.length || 0;
                    const $activeElement = navigationTabs.filter('.active').first();
                    const activeIndex = navigationTabs.index($activeElement);
                    let scrollToElementIndex = Math.min(activeIndex, totalSellingPlans - 1);
                    
                    const $nextSlideElement = navigationTabs.eq(scrollToElementIndex).first();

                    if (!$nextSlideElement.length) return;

                    const containerRect = navigationTabsContainer.get(0).getBoundingClientRect();
                    const nextSlideRect = $nextSlideElement.get(0).getBoundingClientRect();

                    const offset = nextSlideRect.left - containerRect.left;
                        navigationTabsContainer.animate({
                            scrollLeft: '+=' + offset
                        }, 500);

                } catch (error) {
                    gbb.utility.debugError('error in autoScrollToActiveSellingPlanNavigation', error)
                }
            },
            handleNextPrevNavigationBtnClick: function ({ operation }) {
                try {
                    const navigationTabsContainer = gbb.$(".gbbSellingPlansNavigationTabsContainer").first();
                    const totalSellingPlans = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray?.length || 0;
                    let isMobileView = window.innerWidth < 550; // Check if it's mobile view
                    let slidesPerView = isMobileView ? 1 : 4; // Set slides per view depending on screen size

                    // Check if the navigation container exists
                    if (!navigationTabsContainer.length) return;

                    const navigationTabs = gbb.$(".gbbSellingPlanNavigationTab");

                    let scrollToElementIndex;

                    if (isMobileView) {
                        const $activeElement = navigationTabs.filter('.active').first();
                        const activeIndex = navigationTabs.index($activeElement);

                        // Calculate the new index based on the operation
                        if (operation === "NEXT") {
                            scrollToElementIndex = Math.min(activeIndex + slidesPerView, totalSellingPlans - 1);
                        } else if (operation === "PREV") {
                            scrollToElementIndex = Math.max(activeIndex - slidesPerView, 0);
                        }

                    } else {
                        const containerRect = navigationTabsContainer.get(0).getBoundingClientRect();

                        // Find the index of the first visible element
                        let firstVisibleTabIndex = 0;
                        navigationTabs.each(function (index) {
                            const tabRect = gbb.$(this).get(0).getBoundingClientRect();
                            if (tabRect.left >= containerRect.left && tabRect.right <= containerRect.right) {
                                firstVisibleTabIndex = index;
                                return false; // Stop when first visible tab is found
                            }
                        });

                        // Calculate the new index based on the operation
                        if (operation === "NEXT") {
                            scrollToElementIndex = Math.min(firstVisibleTabIndex + slidesPerView, totalSellingPlans - 1);
                        } else if (operation === "PREV") {
                            scrollToElementIndex = Math.max(firstVisibleTabIndex - slidesPerView, 0);
                        }
                    }

                    const $nextSlideElement = navigationTabs.eq(scrollToElementIndex).first();

                    // Make sure the next slide element exists
                    if (!$nextSlideElement.length) return;

                    const containerRect = navigationTabsContainer.get(0).getBoundingClientRect();
                    const nextSlideRect = $nextSlideElement.get(0).getBoundingClientRect();

                    // Calculate the scroll offset
                    const offset = nextSlideRect.left - containerRect.left;

                    // Scroll to the next or previous element
                    if (operation === "NEXT") {
                        navigationTabsContainer.animate({
                            scrollLeft: '+=' + offset
                        }, 500);
                    } else if (operation === "PREV") {
                        navigationTabsContainer.animate({
                            scrollLeft: '-=' + Math.abs(offset)
                        }, 500);
                    }

                    if (isMobileView) {
                        gbb.gbbSubscriptionProductsPage.f.handleChangeActiveSellingPlan({ currentTarget: $nextSlideElement });
                    }

                } catch (error) {
                    gbb.utility.debugError('Error in handleNextPrevNavigationBtnClick', error);
                }
            },
            addPrevNextNavigationButtons: function ({
                gbbSellingPlansNavigationItemsWrapper,
                gbbSellingPlansNavigationTabsContainer,
            }) {
                try {
                    const { nextNavigationIconHTML, prevNavigationIconHTML } = gbb.gbbSubscriptionProductsPage.f.prepareNextPrevNavigationsHTML();

                    gbbSellingPlansNavigationItemsWrapper.append(prevNavigationIconHTML);
                    gbbSellingPlansNavigationItemsWrapper.append(gbbSellingPlansNavigationTabsContainer);
                    gbbSellingPlansNavigationItemsWrapper.append(nextNavigationIconHTML);
                    prevNavigationIconHTML.prop('disabled', true);

                    nextNavigationIconHTML.on('click', () => {
                        gbb.gbbSubscriptionProductsPage.f.handleNextPrevNavigationBtnClick({ operation: "NEXT" })
                    });

                    prevNavigationIconHTML.on('click', () => {
                        gbb.gbbSubscriptionProductsPage.f.handleNextPrevNavigationBtnClick({ operation: "PREV" })
                    });
                    return gbbSellingPlansNavigationItemsWrapper
                } catch (error) {
                    gbb.utility.debugError('error in addPrevNextNavigationButtons', error)
                }
            },
            prepareSellingPlansNavigationUI: function () {
                try {
                    const noOfTabsToRender = 4;//make it dynamic
                    const isMobileView = window.innerWidth < 500
                    const sellingPlansArray = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray;
                    const numberOfSellingPlans = sellingPlansArray?.length;
                    const languageFields = gbb.gbbSubscriptionProductsPage.state.languageFields
                    const gbbSellingPlansNavigationWrapper = gbb.$('<div>').addClass('gbbSellingPlansNavigationWrapper');
                    const gbbSellingPlansNavigationItemsWrapper = gbb.$('<div>').addClass('gbbSellingPlansNavigationItemsWrapper');
                    const gbbSellingPlansNavigationTabsContainer = gbb.$('<div>').addClass('gbbSellingPlansNavigationTabsContainer');
                    gbbSellingPlansNavigationItemsWrapper.attr('data-total-selling-plans', numberOfSellingPlans);
                    const gbbSellingPlansNavigationTitle = gbb.$('<div>').addClass('gbbSellingPlansNavigationTitle');

                    gbbSellingPlansNavigationTitle.text(languageFields.pageTitle);

                    gbb.gbbSubscriptionProductsPage.f.renderSellingPlansNavigationTabs({ sellingPlansArray, gbbSellingPlansNavigationTabsContainer });

                    if (numberOfSellingPlans > noOfTabsToRender || isMobileView) {
                        gbb.gbbSubscriptionProductsPage.f.addPrevNextNavigationButtons({
                            gbbSellingPlansNavigationItemsWrapper,
                            gbbSellingPlansNavigationTabsContainer,
                        })
                    } else {
                        gbbSellingPlansNavigationItemsWrapper.append(gbbSellingPlansNavigationTabsContainer);
                    }

                    gbbSellingPlansNavigationWrapper.append(gbbSellingPlansNavigationTitle);
                    gbbSellingPlansNavigationWrapper.append(gbbSellingPlansNavigationItemsWrapper);

                    return gbbSellingPlansNavigationWrapper;
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.prepareSellingPlansNavigationUI', error);
                }
            },
            resetProductsCardContainerUI: async function () {
                try {
                    let pageType = gbb.gbbAddProductsPage.state.productPageData.pageType
                    let categoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId
                    let totalProducts = pageType == 'MULTIPLE_CATEGORY' ? gbb.gbbAddProductsPage.state.productPageData.categories[categoryId].uniqueProductsData : gbb.gbbAddProductsPage.state.uniqueProductsData
                    let noteAttribute = gbb.state.currentPageId;

                    let updatedProductsCardsContainer = await gbb.gbbAddProductsPage.f.renderProductsCardContainer(totalProducts, noteAttribute, 'resetProductCardsContainer', categoryId)

                    return updatedProductsCardsContainer
                } catch (error) {
                    gbb.utility.debugError("error in resetProductsCardContainerUI", error)
                }
            },
            handlePurchaseOptionClick: async function (event) {
                try {
                    let gbbPurchaseOption = gbb.$(event.currentTarget).first()
                    let optionValue = gbbPurchaseOption.attr('data-purchase-type')
                    const sellingPlansArray = gbb.gbbSubscriptionProductsPage.state.sellingPlansArray || []
                    const { ONE_TIME_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants

                    if (gbbPurchaseOption.hasClass("active")) {
                        return
                    }
                    gbb.$('.gbbPurchaseOption').removeClass('active')
                    gbbPurchaseOption.addClass('active')
                    gbb.gbbSubscriptionProductsPage.state.purchaseType = optionValue
                    if (optionValue == ONE_TIME_PURCHASE) {
                        gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId = null
                        gbb.gbbSubscriptionProductsPage.state.activeSellingPlanDetails = null
                    } else {
                        let sellingPlanToSetActive = sellingPlansArray[0] || {}
                        gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId = gbb.utility.extractIdsFromGraphQlId(sellingPlanToSetActive?.id) || null
                        gbb.gbbSubscriptionProductsPage.state.activeSellingPlanDetails = sellingPlanToSetActive || null
                    }
                    let updatedPageHeader = gbb.gbbSubscriptionProductsPage.f.prepareSubscriptionHeaderHTML()
                    gbb.$(".gbbSubscriptionBundleWrapper").replaceWith(updatedPageHeader);
                    await gbb.gbbSubscriptionProductsPage.f.resetProductsDataBasedOnActiveSellingPlan()
                } catch (error) {
                    gbb.utility.debugError("error in handlePurchaseOptionClick", error)
                }
            },
            preparePurchaseOptionsUI: function () {
                try {
                    const activePurchaseType = gbb.gbbSubscriptionProductsPage.state.purchaseType
                    const languageFields = gbb.gbbSubscriptionProductsPage.state.languageFields
                    const { ONE_TIME_PURCHASE, SUBSCRIPTION_PURCHASE } = gbb.gbbSubscriptionProductsPage.state.constants
                    const options = [
                        {
                            label: languageFields.oneTimePurchaseLabel,
                            value: ONE_TIME_PURCHASE,
                            isActive: activePurchaseType == ONE_TIME_PURCHASE,
                        },
                        {
                            label: languageFields.subscriptionPurchaseLabel,
                            value: SUBSCRIPTION_PURCHASE,
                            isActive: activePurchaseType == SUBSCRIPTION_PURCHASE,
                        }
                    ]
                    let gbbPurchaseOptionsWrapper = gbb.$('<div>').addClass('gbbPurchaseOptionsWrapper')
                    let gbbPurchaseOptionsTitle = gbb.$('<div>').addClass("gbbPurchaseOptionsTitle")
                    let gbbPurchaseOptionsButtonWrapper = gbb.$('<div>').addClass('gbbPurchaseOptionsButtonWrapper')
                    gbbPurchaseOptionsTitle.text(gbb.gbbSubscriptionProductsPage.state.languageFields.frequencyLabel)

                    options.forEach((option) => {
                        let gbbPurchaseOption = gbb.$('<div>').addClass('gbbPurchaseOption')
                        let gbbPurchaseOptionTextContent = gbb.$("<div>").addClass('gbbPurchaseOptionTextContent')
                        gbbPurchaseOptionTextContent.text(option.label)
                        gbbPurchaseOption.attr('data-purchase-type', option.value)
                        if (option.isActive) {
                            gbbPurchaseOption.addClass('active')
                        }
                        gbbPurchaseOption.on("click", gbb.gbbSubscriptionProductsPage.f.handlePurchaseOptionClick)
                        gbbPurchaseOption.append(gbbPurchaseOptionTextContent)
                        gbbPurchaseOptionsButtonWrapper.append(gbbPurchaseOption)
                    })
                    gbbPurchaseOptionsWrapper.append(gbbPurchaseOptionsTitle)
                    gbbPurchaseOptionsWrapper.append(gbbPurchaseOptionsButtonWrapper)
                    return gbbPurchaseOptionsWrapper;
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.preparePurchaseOptionsUI', error)
                }
            },
            subscriptionBundlesInit: function (subscriptionBundlesData) {
                try {
                    gbb.gbbSubscriptionProductsPage.f.setSubscriptionBundlesSettings(subscriptionBundlesData)
                    gbb.gbbSubscriptionProductsPage.f.setCssVariablesForSubscriptionProductsPage()
                } catch (error) {
                    gbb.utility.debugError("error in gbbSubscriptionProductsPage.f.subscriptionBundlesInit", error)
                }
            },
            calculateSubscriptionProductDiscountValue: function (variantInfo) {
                try {
                    const { activeSellingPlanDetails } = gbb.gbbSubscriptionProductsPage.state;
                    const pricingPolicies = activeSellingPlanDetails?.pricingPolicies || [];

                    if (!variantInfo || !activeSellingPlanDetails || pricingPolicies.length === 0) return 0;

                    const activePricingPolicy = pricingPolicies[0];
                    const { adjustmentType: discountType, adjustmentValue } = activePricingPolicy || {};
                    let discountValue = 0;

                    switch (discountType) {
                        case 'FIXED_AMOUNT':
                            discountValue = parseInt(adjustmentValue?.amount) * 100;
                            return discountValue > 0 ? gbb.utility.formatPrice(discountValue) : false;

                        case 'PRICE':
                            discountValue = parseInt(adjustmentValue?.amount);
                            const variantPrice = variantInfo.price / 100;
                            const calculateDiscountOn = variantPrice - discountValue;
                            const percentageDiscount = Math.max((calculateDiscountOn / variantPrice) * 100, 0);
                            return percentageDiscount > 0 ? Math.floor(percentageDiscount) + '%' : false;

                        case 'PERCENTAGE':
                            discountValue = adjustmentValue?.percentage;
                            return discountValue > 0 ? discountValue + '%' : false;

                        default:
                            return discountValue;
                    }
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.calculateSubscriptionProductDiscountValue', error);
                }
            }
            ,
            prepareSubscriptionProductDiscountRibbonUI: function (variantDetails) {
                try {
                    const gbbSubscriptionDiscountRibbon = gbb.$('<div>').addClass('gbbSubscriptionDiscountRibbon')
                    const gbbSubscriptionDiscountContent = gbb.$('<div>').addClass('gbbSubscriptionDiscountContent')
                    const discountValue = gbb.gbbSubscriptionProductsPage.f.calculateSubscriptionProductDiscountValue(variantDetails)
                    if (discountValue) {
                        gbbSubscriptionDiscountContent.text(`-${discountValue}`)
                        gbbSubscriptionDiscountRibbon.append(gbbSubscriptionDiscountContent)
                        return gbbSubscriptionDiscountRibbon
                    }
                } catch (error) {
                    gbb.utility.debugError('error in gbbSubscriptionProductsPage.f.prepareSubscriptionProductDiscountRibbonUI', error)
                }
            },
            getSubscriptionPriceByVariantId: function (variantId) {
                try {
                    const variantData = gbb.utility.getVariantDetailsFromCurrentProductsDataSet(variantId)
                    const { selling_plan_allocations } = variantData
                    const activeSellingPlanId = gbb.gbbSubscriptionProductsPage.state.activeSellingPlanId
                    const groupId = gbb.gbbSubscriptionProductsPage.state.selectedSellingPlanGroupId
                    if (!variantData) return 0

                    if (!activeSellingPlanId || !selling_plan_allocations || selling_plan_allocations.length == 0) {
                        return variantData.price
                    }

                    const activeSellingPlanAllocation = selling_plan_allocations.find((allocation) => {
                        return allocation.selling_plan_id == activeSellingPlanId
                    })

                    if (!activeSellingPlanAllocation) {
                        return variantData.price
                    }

                    return activeSellingPlanAllocation.price

                } catch (error) {
                    gbb.utility.debugError("error in gbbSubscriptionProductsPage.f.getSubscriptionPriceByVariantId", error)
                }
            }
        },

    },
    gbbAddonProducts: {
        f: {
            addonProductsInit: function (tmpCartSettings) {
                try {
                    let addonsData = tmpCartSettings.stepsConfigurationData.personalizationData.addonProducts || {}
                    if (Object.keys(addonsData).length > 0 && addonsData?.isEnabled) {
                        let eligibleTiersData = JSON.parse(gbb.storage.getItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`))
                        let statesToUpdate = {
                            isEnabled: addonsData?.isEnabled,
                            tiers: addonsData?.tiers,
                            isSkippable: addonsData?.isSkippable,
                            title: addonsData?.title,
                            eligibleTierForAddons: eligibleTiersData || null,
                            offerId: addonsData?.offerId || null,
                            addonsMessaging : addonsData?.addonsMessaging,
                            displayVariantsAsIndividualProducts_addons: addonsData?.displayVariantsAsIndividualProducts_addons || false,
                        }
                        gbb.gbbAddonProducts.state = { ...gbb.gbbAddonProducts.state, ...statesToUpdate }
                        // gbb.gbbAddonProducts.f.calculateEligibleAddonProductsTier("personalizationPage") // forcefully calculate
                    }
                    return addonsData
                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.addonProductsInit", error)
                }
            },
            getCartTotalItemsAndTotalPriceForAddons: function () {
                try {
                    let cartDataFromSession = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(gbb.state.activeBoxId)
                    let { items: cartItems } = cartDataFromSession || {}
                    let blackListedBoxProductKeys = ["greetingCard", "addonProduct", "giftMessage"]
                    let total_price = 0
                    let item_count = 0
                    cartItems?.forEach((item) => {
                        if (!blackListedBoxProductKeys.includes(item.properties._boxProduct)) {
                            total_price += item.price * item.quantity
                            item_count += item.quantity
                       }
                    })
                    return { total_price, item_count }
                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.getCartTotalItemsAndTotalPriceForAddons", error)
                }
            },
            calculateEligibleAddonProductsTier: function (origin) {
                try {
                    let isAddonEnabled = gbb.gbbAddonProducts.state.isEnabled 
                    let isCurrentPageTypePersonalization = gbb.state.currentPageId == 'personalizationPage'
                    let qualifiedTierIndex = null
                    let tiers = gbb.gbbAddonProducts.state.tiers 

                    if (!origin && (!isAddonEnabled || isCurrentPageTypePersonalization)) {
                        return null
                    }

                    let { total_price, item_count } = gbb.gbbAddonProducts.f.getCartTotalItemsAndTotalPriceForAddons()
                    for (let idx = 0; idx < tiers.length; idx++) { 
                        let { type, value } = tiers[idx]?.condition
                        value = +value
                        total_price = total_price / 100 

                         if (type == "QUANTITY" && item_count>= value) {
                            qualifiedTierIndex = idx
                         } else if (type == 'AMOUNT' && total_price >= gbb.utility.convertFromStoreCurrencyToCustomer(value)) {
                            qualifiedTierIndex = idx
                        }
                    }

                    if (!qualifiedTierIndex && tiers[0]?.condition?.isValidateEligibilityConditionEnabled == false) {
                        qualifiedTierIndex = 0
                    }
                    let qualifiedTier = qualifiedTierIndex!==null ? tiers[qualifiedTierIndex] : null
                    
                    if (qualifiedTier) {
                        gbb.gbbAddonProducts.f.updateProductAndVariantPricesBasedOnAddonTier(qualifiedTier)
                        qualifiedTier.tierIndex = qualifiedTierIndex
                    } else {
                        gbb.gbbAddonProducts.f.removeAddonProductsFromCart()
                        let productsShopifyData = gbb.gbbAddonProducts?.state?.productsShopifyData || {}
                        gbb.gbbAddonProducts.f.setMapForVariantId_addons(productsShopifyData);
                    }
                    gbb.storage.setItem(`eligible-tiers-for-addons-${gbb.state.bundleId}`, JSON.stringify(qualifiedTier))
                    gbb.gbbAddonProducts.state.eligibleTierForAddons = qualifiedTier

                    return qualifiedTier

                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.calculateEligibleAddonProductsTier", error)
                }
            },
            removeAddonProductsFromCart: async function () {
                try {
                    let { items } = gbb.state.giftBoxCartData || {}
                    let addonProducts = items.filter((item) => {
                        return item.properties._boxProduct == 'addonProduct'
                    })

                    for (let i = 0; i < addonProducts.length; i++){
                        let dataToSend = {
                            qty: 0,
                            variant:addonProducts[i]
                        }
                        await gbb.utility.removeFromCart(dataToSend,"addonProduct")
                    }

                    return addonProducts
                } catch (error) {
                    gbb.utility.debugError('error in removeAddonProductsFromCart', error)
                }
            },
            getAddonProductsToRender: function ({ selectedAddonProducts: qualifiedProducts, displayVariantsAsIndividualProducts_addons=false }){
                try {
                    let prefetchedProductsData = gbb.gbbAddonProducts.state.addonProductsDataByHandle || {}
                    let productsToRender = []
                    for (let product of qualifiedProducts) {
                        let currentProductData = prefetchedProductsData[product.handle]
                        if (displayVariantsAsIndividualProducts_addons) {
                            const { variants, ...productAttrs } = currentProductData;
                            variants.forEach((variant) => {
                                let merged = {
                                    ...productAttrs,
                                    compare_at_price: variant.compare_at_price,
                                    variants: [variant]
                                };
                                merged = gbb.gbbAddProductsPage.f.updateProductDataWithFirstVariantData(merged)
                                productsToRender.push(merged);
                            });
                        } else {
                            productsToRender.push(currentProductData)
                        }
                    } 
                    return productsToRender
                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.getAddonProductsToRender", error)
                }
            },
            setPrefetchedAddonsData: function (addonProductsData) {
                try {
                    let productsDataById = {}
                    let productsDataSet = []
                    let productsDataByHandle ={}
                    for (let [key, value] of Object.entries(addonProductsData)) { 
                        let productData = value
                        productData.customProductAttribute = 'addonProduct'
                        productsDataById[productData.id] = productData
                        productsDataByHandle[productData.handle] = productData
                        productsDataSet.push(productData)
                    }
                    gbb.gbbAddonProducts.state.addonProductsDataByHandle = productsDataByHandle
                    gbb.gbbAddonProducts.state.addonProductsDataById = productsDataById
                    gbb.gbbAddonProducts.state.addonProductsDataSet = productsDataSet
                } catch (error) {
                    gbb.utility.debugError('error in gbbAddonProducts.f.setPrefetchedAddonsData')
                }
            },
            prepareAddonProductsUI: function () {
                try {
                    let gbbAddonProductsWrapper = gbb.$("<div>").addClass("gbbAddonProductsWrapper");
                    let gbbAddonProductsSectionTitle = gbb.$("<div>").addClass("gbbAddonProductsSectionTitle");
                    let gbbAddonProductsContainer = gbb.$("<div>").addClass("gbbProductsContainer");
                    gbbAddonProductsContainer.addClass("gbbProductsItemsContainer")
                    let eligibleTier = gbb.gbbAddonProducts.state.eligibleTierForAddons   
                    if (!eligibleTier) {
                        eligibleTier = gbb.gbbAddonProducts.state.tiers[0] || {}
                        gbbAddonProductsContainer.addClass("notEligibleForAddons")
                    }
                    gbb.gbbAddonProducts.f.updateProductAndVariantPricesBasedOnAddonTier(eligibleTier)
                    // let { selectedAddonProducts = [] } = eligibleTier

                    let productsDataToRender = gbb.gbbAddonProducts.f.getAddonProductsToRender(eligibleTier)
                    let productCardsHTML = gbb.f.renderProductsHTML(productsDataToRender,'personalizePage')
                    gbbAddonProductsSectionTitle.html(gbb.gbbAddonProducts.state.title)

                    gbbAddonProductsContainer.append(productCardsHTML)
                    gbbAddonProductsWrapper.append(gbbAddonProductsSectionTitle)
                    gbbAddonProductsWrapper.append(gbbAddonProductsContainer)
                    return gbbAddonProductsWrapper
                } catch (error) {
                    gbb.utility.debugError('error in prepareAddonProductsUI')
                }
            },
            prepareDiscountRibbonContentForProductAddons: function () {
                try {
                    let eligibleTier = gbb.gbbAddonProducts.state.eligibleTierForAddons

                    if (!eligibleTier) {
                        eligibleTier = gbb.gbbAddonProducts.state.tiers[0] || {} // for disable state
                    }

                    let { type, value} = eligibleTier?.discount || {}
                    let discountText = ''
                    if (value && +value > 0 && type == "PERCENTAGE") {
                        discountText = value == 100 ? "Free" : `${value}% off`
                    }

                    return {
                        type,
                        value,
                        discountText
                    }

                } catch (error) {
                    gbb.utility.debugError('error in prepareDiscountRibbonContentForProductAddons',error)
                }
            },
            checkAddonsConditionsOnNext: function () {
                try {
                    let result = true
                    let isAddonSkippable = gbb.gbbAddonProducts.state.isSkippable
                    let eligibleTierForAddons = gbb.gbbAddonProducts.state.eligibleTierForAddons || {}
                    let isEligibleForAddons = Object.keys(eligibleTierForAddons).length > 0
                    if (isEligibleForAddons && !isAddonSkippable) {
                        let cartDataItems = gbb.state.giftBoxCartData.items || []
                        // check if any of the items.properties._boxProduct - addonProduct
                        let isAddonProductExistInCart = cartDataItems.some((item) => {
                            return item.properties._boxProduct == "addonProduct"
                        })
                        result = isAddonProductExistInCart
                    }
                    return result
                } catch (error) {
                    gbb.utility.debugConsole('error in checkAddonsConditionsOnNext', error)
                }
            },
            checkMaxAddonProductsConditions: function ({productQtyToAdd}) {
                try {
                    let result = {
                        isConditionMet:true
                    }
                    let isAddonsEnabled = gbb.gbbAddonProducts.state.isEnabled 
                    let eligibleTiersData = gbb.gbbAddonProducts.state.eligibleTierForAddons
                    let cartItems = gbb.state.giftBoxCartData.items || []
                    let isEligibleForAddons = Object.keys(eligibleTiersData).length>0
                    if (!isAddonsEnabled || !isEligibleForAddons) return result
                    let maxAddonsAllowed = +eligibleTiersData.configurations.maxAddonProductsAllowed
                    let totalAddonsInCart = 0
                    cartItems.forEach((product, idx) => {
                        if (product.properties._boxProduct == 'addonProduct') {
                            totalAddonsInCart+=product.quantity 
                        }
                    })
                    if ((totalAddonsInCart + productQtyToAdd) > maxAddonsAllowed) {
                        result.isConditionMet = false
                        let message = gbb.settings?.languageData?.addons?.maxAddonProductsAllowed?.value 
                        // let message = `add maximum ##maxAllowedAddons## products to continue`
                        if (message) {
                            message = message.replace(new RegExp('##maxAllowedAddons##', 'g'), maxAddonsAllowed);
                        } else {
                            message = `1Only add upto ${maxAddonsAllowed}`
                        }
                        gbb.f.renderConditionNotificationToast(message)
                    }
                    
                    return result
                } catch (error) {
                    gbb.utility.debugConsole('error in checkMaxAddonProductsConditions',error)
                }
            },
            setMapForVariantId_addons: function (productsObj) {
                try {
                    if(Object.keys(productsObj).length == 0) return
                    let data = gbb.utility.productDetailsWith_VariantId_Or_ProductIdAsKey(productsObj)
                    gbb.gbbAddonProducts.state.currentProductsDataSetForVariants_addons = { ...gbb.gbbAddonProducts.state.currentProductsDataSetForVariants_addons, ...data };
                } catch (error) {
                    gbb.utility.debugError("error in setMapForVariantId_addons", error)
                }
            },
            updateProductAndVariantPricesBasedOnAddonTier: function (qualifiedTier) {
                try {
                    let discountValue = qualifiedTier?.discount?.value || 0
                    let products = JSON.parse(JSON.stringify(gbb.gbbAddonProducts.state.productsShopifyData))
                    const updateProductOrVariantPrice = (data) => {
                        let discountedPrice = data.price - (data.price * discountValue / 100)
                        let updatedCompareAtPrice = data.price
                        data.compare_at_price = updatedCompareAtPrice 
                        data.price = discountedPrice
                        return data
                    }
                    for (let [key, value] of Object.entries(products)) {
                        let currentProductDetails = value 
                        currentProductDetails = updateProductOrVariantPrice(currentProductDetails)
                        for (let variantIdx = 0; variantIdx < currentProductDetails.variants.length; variantIdx++) { 
                            let currentVariant = currentProductDetails.variants[variantIdx]
                            currentProductDetails.variants[variantIdx] = updateProductOrVariantPrice(currentVariant)
                        }
                        products[key] = currentProductDetails
                    }
                    gbb.gbbAddonProducts.f.setPrefetchedAddonsData(products)
                    gbb.gbbAddonProducts.f.setMapForVariantId_addons(products);

                    return products
                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.updateProductAndVariantPricesBasedOnAddonTier",error)
                }
            },
            replaceIneligibleConditionVariables: function (message) {
                try {
                    let firstTierInfo = gbb.gbbAddonProducts.state.tiers[0] || {}
                    let { type, value } = firstTierInfo?.condition || {}
                    let { total_price, item_count } = gbb.gbbAddonProducts.f.getCartTotalItemsAndTotalPriceForAddons()

                    function calculateDiffValue(type, value, item_count, total_price) {
                        let diffValue = null
                        if (type === 'QUANTITY') {
                            diffValue = value - item_count;
                        } else if (type === 'AMOUNT') {
                            total_price = total_price / 100;
                            value = gbb.utility.convertFromStoreCurrencyToCustomer(value);
                            diffValue =  (value - total_price).toFixed(2);
                        }
                        return diffValue;
                    }

                    function replaceMessagePlaceholders(message, diffValue, type) {
                        message = message.replace("##AddonsConditionDiff##", diffValue);
                        if (type === 'AMOUNT') {
                            message = message.replace("##currencyUnit##", gbb.utility.getCurrencySymbol());
                        }
                        return message;
                    }

                    const diffValue = calculateDiffValue(type, value, item_count, total_price);
                    if (diffValue !== null) {
                        message = replaceMessagePlaceholders(message, diffValue, type);
                    }
                    return message
                } catch (error) {
                    gbb.utility.debugError("error in gbbAddonProducts.f.replaceIneligibleConditionVariables", error)
                }
            },
            getAddonsMessageToRender: function () {
                try {
                    let message = ""
                    let eligibleTier = gbb.gbbAddonProducts.state.eligibleTierForAddons
                    let addonsMessaging = gbb.gbbAddonProducts.state.addonsMessaging 
                    
                    if (!eligibleTier) {
                        let ineligibleMessaging = addonsMessaging?.ineligibleState
                        message = gbb.gbbAddonProducts.f.replaceIneligibleConditionVariables(ineligibleMessaging)
                    } else {
                        let activerTierIndex = eligibleTier?.tierIndex
                        if (activerTierIndex == null) return message;
                        message = addonsMessaging[`tier${activerTierIndex + 1}`]?.eligibleState
                    }

                    return message
                } catch (error) {
                    gbb.utility.debugError("error in getAddonsMessageToRender",error)
                }
            },
            checkIfAddonsMessagingNeeded: function () {
                try {
                    let isAddonsEnabled = gbb.gbbAddonProducts.state.isEnabled || false;
                    let isMessagingEnabled = gbb.gbbAddonProducts.state.addonsMessaging?.isEnabled || false;
                    let isCurrentPageTypePersonalization = gbb.state.currentPageId == "personalizationPage"
                    return isAddonsEnabled && isMessagingEnabled && isCurrentPageTypePersonalization
                } catch (error) {
                    gbb.utility.debugError("error in checkIfAddonsMessagingNeeded",error)
                }
            },

        },
        settings:{},
        state: {
            isEnabled: false,
            title: "",  
            isSkippable:true,
            tiers: [],
            activeTier:null,
            addonProductsDataByHandle: {},
            addonProductsDataById: {},
            addonProductsDataSet: [],
            eligibleTierForAddons:null,
            offerId: null,
            addonsMessaging: null
        },
        utility:{}
    },
    gbbMultipleCategoriesPage: {
        state: {
            buildBoxButtonAction: undefined,
            categoryStatus: {},
            currentCategory: undefined,
            currentIndex: undefined,
            currentCategoryId: undefined,
            // giftBoxData: null,
        },
        f: {
            prepareUIV2: async function (productPageData) {
                let gbbMultipleCategoriesPageHTML;
                let noteAttribute = gbb.state.currentPageId;
                let gbbMultipleCategoriesContainerHTML = gbb.$("<div>").addClass("gbbMultipleCategoriesContainerHTML");

                gbbMultipleCategoriesPageHTML = gbb.$("<div>").addClass("gbbMultipleCategoriesPageHTML");
                let categories = gbb.utility.convertObjectToArray(productPageData?.categories)
                for (let i = 0; i < categories.length; i++) {
                    // categories?.forEach(async (category, index) => {
                    let category = categories[i];
                    let index = i;
                    let gbbCategoryContainer = gbb.$("<div>").addClass("gbbCategoryContainer");
                    gbbCategoryContainer.css("background", gbb.settings.pageCustomizationData?.categoryBlock?.categoryBgColor || "#FFFFFF")
                    let gbbCategoryHeaderContainer = gbb.$("<div>").addClass("gbbCategoryHeaderContainer").attr("currentIndex", index).attr("categoryId", category.categoryId);
                    let gbbCategoryBodyContainer = gbb.$("<div>").addClass("gbbCategoryBodyContainer" + category.categoryId);

                    //data attribute to store the category id
                    gbbCategoryContainer.attr("categoryId", category.categoryId);

                    let gbbCategoryToggleButton = gbb.$("<img>").addClass("gbbCategoryToggleButton" + index);
                    gbbCategoryToggleButton.attr("src", CONSTANT_IMAGES_DROPDOWN_BUTTON);
                    gbbCategoryToggleButton.css("transform", "rotate(90deg)");

                    let gbbCategoryImage = gbb.$("<img>").addClass("gbbCategoryImage");
                    gbbCategoryImage.attr("src", category.categoryImg);


                    // let gbbCategoryBannerImage = gbb.$("<img>").addClass("gbbCategoryImage").addClass("gbbCategoryBanner")
                    // gbbCategoryBannerImage.attr("src", category?.categoryBanner);

                    if (category?.categoryBanner) {



                        gbbCategoryContainer.addClass("bannerAttached");

                        gbbCategoryImage.attr("src", category?.categoryBanner)
                        // let insertDynamicStyle = ``;

                        // gbb.$("head").append(`<style>${insertDynamicStyle}</style>`);
                    }

                    let gbbCategoryTitlesContainer = gbb.$("<div>").addClass("gbbCategoryTitlesContainer");
                    let gbbCategoryTitle = gbb.$("<div>").addClass("gbbCategoryTitle");
                    let gbbCategorySubTitle = gbb.$("<div>").addClass("gbbCategorySubTitle");

                    gbbCategoryTitle.text(category.title || "Category");
                    gbbCategorySubTitle.text(category.subTitle || "");

                    gbbCategoryTitlesContainer.append(gbbCategoryTitle)
                    gbbCategoryTitlesContainer.append(gbbCategorySubTitle)

                    gbbCategoryHeaderContainer.append(gbbCategoryToggleButton)
                    gbbCategoryHeaderContainer.append(gbbCategoryImage)
                    gbbCategoryHeaderContainer.append(gbbCategoryTitlesContainer)

                    let gbbProductsContainer = gbb.$("<div>").addClass("gbbProductsContainer");
                    // let gbbProductsItemsContainer = gbb.$("<div>").addClass("gbbProductsItemsContainer");
                    // gbbProductsItemsContainer.append(gbb.f.renderProductsHTML(category.dataFromShopify, noteAttribute, category.categoryId));

                    if (gbb.gbbMultipleCategoriesPage.currentIndex != undefined && gbb.gbbMultipleCategoriesPage.currentIndex == index) {
                        gbb.utility.debugConsole("prepareUiV2 for multipleCategories was called")
                        gbb.state.setInfiniteScrollTrackerForProducts = true;
                        gbb.gbbAddProductsPage.state.dataForInfiniteScroll = {
                            noteAttribute: noteAttribute,
                            categoryId: category.categoryId,
                            allProductsData: category.uniqueProductsData,
                        }
                        let renderData = await gbb.gbbAddProductsPage.f.renderProductsCardContainer(category.uniqueProductsData, noteAttribute, "initFlow", category.categoryId)
                        renderData.find(".gbbFiltersSearchSortHeader").remove()
                        gbbProductsContainer.append(renderData)
                        gbbCategoryToggleButton.css("transform", "rotate(360deg)");
                    } else {
                        gbbCategoryBodyContainer.hide();
                    }

                    // gbbProductsContainer.append(gbbProductsItemsContainer);

                    gbbCategoryBodyContainer.append(gbbProductsContainer);
                    gbbCategoryContainer.append(gbbCategoryHeaderContainer);
                    gbbCategoryContainer.append(gbbCategoryBodyContainer);



                    gbbCategoryHeaderContainer.on("click", async (event) => {
                        if (!event) {
                            return
                        }
                        let gbbMultipleCategoriesPageHTMLEle = gbb.$(".gbbAddGiftBoxPageWrapper").find(".gbbMultipleCategoriesPageHTML");
                        // gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, gbbMultipleCategoriesPageHTMLEle, false, gbbCategoryHeaderContainer);
                        let categoryObjData = {
                            clickedIndex: event.currentTarget.attributes.currentIndex.value,
                            gbbMultipleCategoriesPageHTMLEle: gbbMultipleCategoriesPageHTMLEle,
                            isTabBasedUI: false,
                            clickedCategoryId: gbbCategoryHeaderContainer.attr('categoryId')
                        }
                        gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, categoryObjData);

                        // let clickedIndex = event.currentTarget.attributes.currentIndex.value
                        // let currentIndex = gbb.gbbMultipleCategoriesPage.currentIndex
                        // gbb.$(".gbbAddGiftBoxPageWrapper").find("gbbMultipleCategoriesContainerHTML").css("pointer-events", "none")
                        // if (currentIndex != undefined && currentIndex == clickedIndex) {
                        //     gbb.gbbMultipleCategoriesPage.currentIndex = undefined;
                        //     gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2(gbb.gbbAddProductsPage.state.productPageData))
                        // } else {
                        //     gbb.gbbMultipleCategoriesPage.currentIndex = event.currentTarget.attributes.currentIndex.value
                        //     gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2(gbb.gbbAddProductsPage.state.productPageData))
                        //     let categoryId = gbbCategoryHeaderContainer.attr('categoryId');
                        //     gbb.utility.debugConsole(categoryId);
                        //     let selectedDiv = gbb.$(`div[categoryId='${categoryId}']`)
                        //     gbb.$('html, body').scrollTop(selectedDiv.offset().top-100);
                        //     // window.selectedDiv = selectedDiv;
                        // }
                        // isCategoryPrductsVisible = !isCategoryPrductsVisible
                    })



                    gbbMultipleCategoriesContainerHTML.append(gbbCategoryContainer);
                }
                //no navigation will be available if there is only one step enabled - adjust the positioning
                let navigationItems = gbb.state.navigationItems;


                //navigation icons not present

                //gbbAddProductsPageHTML.append(gbb.f.renderFiltersSideBarHTML(noteAttribute));
                gbbMultipleCategoriesPageHTML.append(gbbMultipleCategoriesContainerHTML);
                return gbbMultipleCategoriesPageHTML;

            },
            prepareUIV2TabUI: async function (productPageData) {
                try {
                    gbb.utility.debugConsole("inside tab ui");
                    let gbbMultipleCategoriesPageHTML;
                    let noteAttribute = gbb.state.currentPageId;
                    let gbbMultipleCategoriesContainerHTML = gbb.$("<div>").addClass("gbbMultipleCategoriesContainerHTMLForTabUI");
                    let categories = gbb.utility.convertObjectToArray(productPageData?.categories);
                    gbb.gbbMultipleCategoriesPage.f.setCurrentCategory(categories);
                    let activeCategory = gbb.gbbMultipleCategoriesPage.state.currentCategory;

                    gbbMultipleCategoriesPageHTML = gbb.$("<div>").addClass("gbbMultipleCategoriesPageHTMLForTabUI");
                    let gbbMultipleCategoriesRibbonContainer = gbb.$("<div>").addClass("gbbMultipleCategoriesRibbonContainer");
                    let gbbMultipleCategoriesDropdownContainer = gbb.$("<div>").addClass("gbbMultipleCategoriesDropdownContainer");
                    let gbbFilterSearchHTML = gbb.f.renderFiltersSearchSortHeaderHTML(noteAttribute)
                    gbb.$(gbbFilterSearchHTML).find('.gbbSearchBarMainWrapper').css('grid-column', 2)
                    // create a dropdown aswell
                    let gbbMutipleCategoriesDropdown = gbb.$("<select>").addClass("gbbMutipleCategoriesDropdown");
                    if (gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveBgColor) {
                        gbbMutipleCategoriesDropdown.css("background", gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveBgColor)
                    }
                    if (gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveTextColor) {
                        gbbMutipleCategoriesDropdown.css('color', gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveTextColor)
                    }
                    // let gbbMultipleCategoriesDropdownArrow = gbb.$("<img>").addClass("gbbMultipleCategoriesDropdownArrow");
                    // gbbMultipleCategoriesDropdownArrow.attr("src", ARROW_DOWN_SVG);
                    let gbbMultipleCategoriesDropdownArrow = gbb.$("<div>").addClass("gbbMultipleCategoriesDropdownArrow");
                    gbbMultipleCategoriesDropdownArrow.append(ARROW_DOWN_SVG);


                    let gbbMultipleCategoriesActiveCategorySubtitle = gbb.$("<div>").addClass("gbbMultipleCategoriesActiveCategorySubtitle");
                    for (let i = 0; i < categories.length; i++) {
                        let category = categories[i];
                        let index = i;
                        let gbbCategoryContainer = gbb.$("<div>").addClass("gbbCategoryContainer");
                        gbbCategoryContainer.addClass("gbbCategoryContainerTabUI")
                        if (gbb.settings.pageCustomizationData?.categoryBlock?.tabInactiveBgColor) {
                            gbbCategoryContainer.css("background", gbb.settings.pageCustomizationData?.categoryBlock?.tabInactiveBgColor)

                        }
                        if (gbb.settings.pageCustomizationData?.categoryBlock?.tabInactiveTextColor) {
                            gbbCategoryContainer.css('color', gbb.settings.pageCustomizationData?.categoryBlock?.tabInactiveTextColor)
                        }
                        // gbbCategoryContainer.css("background",gbb.settings.pageCustomizationData.colors.secondaryColor || "#FFFFFF").css("color",gbb.settings.pageCustomizationData.colors.textColor || "black" );
                        let optionValue = gbb.$("<option>").attr("value", category.categoryId).attr("categoryId", category.categoryId).text(category.title || "Category").attr("currentIndex", index)


                        // give active status to selected category
                        if (activeCategory != undefined && activeCategory.categoryId == category.categoryId) {
                            gbbCategoryContainer.addClass("gbbCategoryContainerTabUIActive");
                            optionValue.attr("selected", "selected")
                            // gbbCategoryContainer.css("background",gbb.settings.pageCustomizationData.colors.primaryColor || "#FFFFFF").css("color",gbb.settings.pageCustomizationData.colors.textColor || "black" );
                        }



                        // give active status to first category if no category is selected
                        if (activeCategory == undefined && index == 0) {
                            gbbCategoryContainer.addClass("gbbCategoryContainerTabUIActive");
                            activeCategory = category;
                            gbb.gbbMultipleCategoriesPage.state.currentCategoryId = category.categoryId;
                            gbb.gbbMultipleCategoriesPage.f.setCurrentCategory(categories);
                        }

                        if (gbbCategoryContainer.hasClass("gbbCategoryContainerTabUIActive")) {
                            if (gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveBgColor) {
                                gbbCategoryContainer.css("background", gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveBgColor)
                            }
                            if (gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveTextColor) {
                                gbbCategoryContainer.css('color', gbb.settings.pageCustomizationData?.categoryBlock?.tabActiveTextColor)
                            }
                        }




                        // gbbCategoryContainer.css("background", gbb.settings.pageCustomizationData?.categoryBlock?.categoryBgColor || "#FFFFFF")
                        let gbbCategoryHeaderContainer = gbb.$("<div>").addClass("gbbCategoryHeaderContainer").attr("currentIndex", index).attr("categoryId", category.categoryId);
                        gbbCategoryHeaderContainer.addClass("gbbCategoryHeaderContainerTabUI")
                        gbbCategoryContainer.attr("categoryId", category.categoryId);

                        let gbbCategoryTitlesContainer = gbb.$("<div>").addClass("gbbCategoryTitlesContainer");
                        gbbCategoryTitlesContainer.addClass("gbbCategoryTitlesContainerForTabUI");
                        let gbbCategoryTitle = gbb.$("<div>").addClass("gbbCategoryTitle");
                        let gbbCategorySubTitle = gbb.$("<div>").addClass("gbbCategorySubTitleForTabUI");

                        gbbCategoryTitle.html(category.title || "Category");
                        gbbCategorySubTitle.html(category.subTitle || "");

                        let gbbCategoryImage = gbb.$("<img>").addClass("gbbCategoryImageForTabUI");
                        gbbCategoryImage.attr("src", category.categoryImg)

                        gbbCategoryTitlesContainer.append(gbbCategoryTitle);
                        // gbbCategoryTitlesContainer.append(gbbCategorySubTitle);



                        gbbMutipleCategoriesDropdown.append(optionValue)
                        gbbCategoryHeaderContainer.append(gbbCategoryTitlesContainer);
                        gbbCategoryHeaderContainer.append(gbbCategoryImage);
                        gbbCategoryContainer.append(gbbCategoryHeaderContainer);
                        gbbMultipleCategoriesRibbonContainer.append(gbbCategoryContainer);




                        // can we have onChange?
                        gbbMutipleCategoriesDropdown.off("change").on("change", async (event) => {
                            if (!event) {
                                return
                            }
                            // gbb.utility.clearAllFilters(noteAttribute);
                            gbb.utility.debugConsole("event", event);
                            // gbb.f
                            let optionValueClicked = gbb.$(event.currentTarget).find("option:selected");
                            gbb.utility.debugConsole("optionValueClicked", optionValueClicked);
                            let gbbMultipleCategoriesPageHTMLEle = gbb.$(".gbbAddGiftBoxPageWrapper").find(".gbbMultipleCategoriesPageHTMLForTabUI")
                            let categoryObjData = {
                                clickedIndex: optionValueClicked.attr("currentIndex"),
                                gbbMultipleCategoriesPageHTMLEle: gbbMultipleCategoriesPageHTMLEle,
                                isTabBasedUI: true,
                                clickedCategoryId: optionValueClicked.attr("categoryId")
                            }
                            // debugger;
                            gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, categoryObjData);

                            // gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, gbbMultipleCategoriesPageHTMLEle, true, optionValueClicked)
                        })



                        gbbCategoryHeaderContainer.on("click", async (event) => {
                            gbb.utility.debugConsole("opton value clicked")
                            if (!event) {
                                return
                            }
                            // gbb.utility.clearAllFilters(noteAttribute);
                            let gbbMultipleCategoriesPageHTMLEle = gbb.$(".gbbAddGiftBoxPageWrapper").find(".gbbMultipleCategoriesPageHTMLForTabUI")
                            let categoryObjData = {
                                clickedIndex: event.currentTarget.attributes.currentIndex.value,
                                gbbMultipleCategoriesPageHTMLEle: gbbMultipleCategoriesPageHTMLEle,
                                isTabBasedUI: true,
                                clickedCategoryId: gbbCategoryHeaderContainer.attr('categoryId')
                            }
                            // debugger;
                            gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, categoryObjData);

                            // gbb.gbbMultipleCategoriesPage.f.eventListenerForPrepareUIV2(event, gbbMultipleCategoriesPageHTMLEle, true, gbbCategoryHeaderContainer)

                        })
                    }
                    //no navigation will be available if there is only one step enabled - adjust the positioning
                    let navigationItems = gbb.state.navigationItems;

                    // populate the body section
                    let gbbMultipleCategoryBodyContainer = gbb.$("<div>").addClass("gbbMultipleCategoryBodyContainer");
                    let gbbMultipleCategoryBody = gbb.$("<div>").addClass("gbbMultipleCategoryBody");
                    // debugger
                    let gbbProductsContainer = gbb.$("<div>").addClass("gbbMultiCategoryProductsContainer");


                    let renderData = await gbb.gbbMultipleCategoriesPage.f.renderProductsInTabUI(activeCategory, noteAttribute);
                    gbbMultipleCategoriesActiveCategorySubtitle.html(activeCategory.subTitle || "");



                    gbbProductsContainer.append(renderData);
                    gbbMultipleCategoryBody.append(gbbProductsContainer);
                    gbbMultipleCategoryBodyContainer.append(gbbMultipleCategoryBody);

                    //navigation icons not present


                    gbbMultipleCategoriesPageHTML.append(gbbFilterSearchHTML)
                    gbbMultipleCategoriesPageHTML.append(gbbMultipleCategoriesRibbonContainer);

                    gbbMultipleCategoriesDropdownContainer.append(gbbMutipleCategoriesDropdown);
                    // gbbMultipleCategoriesDropdownArrow
                    gbbMultipleCategoriesDropdownContainer.append(gbbMultipleCategoriesDropdownArrow);

                    gbbMultipleCategoriesPageHTML.append(gbbMultipleCategoriesDropdownContainer)
                    gbbMultipleCategoriesPageHTML.append(gbbMultipleCategoriesActiveCategorySubtitle);
                    gbbMultipleCategoriesPageHTML.append(gbbMultipleCategoryBodyContainer);


                    gbbMultipleCategoriesContainerHTML.append(gbbMultipleCategoriesPageHTML);




                    return gbbMultipleCategoriesContainerHTML;
                } catch (error) {
                    gbb.utility.debugConsole("error in prepareUIV2TabUI", error)
                }
            },
            renderProductsInTabUI: async function (activeCategory, noteAttribute) {
                gbb.state.setInfiniteScrollTrackerForProducts = true;
                gbb.gbbAddProductsPage.state.dataForInfiniteScroll = {
                    noteAttribute: noteAttribute,
                    categoryId: activeCategory.categoryId,
                    allProductsData: activeCategory.uniqueProductsData,
                }
                let totalProducts = activeCategory.uniqueProductsData

                // check if search or filter is active then change totalProducts data to render specific products
                let isFilterActive = gbb.utility.getActivatedFilters(noteAttribute).length > 0
                let isSearchActive = gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchText.trim().length > 0
                if (isFilterActive) {
                    let filteredProducts = await gbb.utility.getFilteredSortedProductsData(noteAttribute, 'searchProductsFlow')
                    totalProducts = filteredProducts
                }
                if (isSearchActive) {
                    let searchValue = gbb.gbbAddProductsPage.state.filterBySearch.searchQuery.searchText
                    let searchedProducts = await gbb.gbbAddProductsPage.f.handleSearchBundleInput(searchValue, noteAttribute)
                    totalProducts = searchedProducts

                }
                let renderData = await gbb.gbbAddProductsPage.f.renderProductsCardContainer(totalProducts, noteAttribute, "initFlow", activeCategory.categoryId)
                // renderData.find(".gbbFiltersSearchSortHeader").remove() 

                return renderData;
            },
            setCurrentCategory: function (categories) {
                let currentCategoryId = gbb.gbbMultipleCategoriesPage.state.currentCategoryId;
                if (currentCategoryId) {
                    // find category with currentCategoryId
                    let currentCategory = categories.find((category) => {
                        return category.categoryId == currentCategoryId;
                    })
                    gbb.gbbMultipleCategoriesPage.state.currentCategory = currentCategory;
                }
            },
            eventListenerForPrepareUIV2: async function (event, categoryData) {
                // if (!event) {
                //     return
                // }

                let gbbMultipleCategoriesPageHTMLEle = categoryData.gbbMultipleCategoriesPageHTMLEle;
                let isTabBasedUI = categoryData.isTabBasedUI;
                let clickedIndex = categoryData.clickedIndex;
                let clickedCategoryId = categoryData.clickedCategoryId;
                //  gbbCategoryHeaderContainer
                if (clickedCategoryId !== gbb.gbbMultipleCategoriesPage.state.currentCategoryId) {
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: 'gbb-category-change',
                        detail: {
                            activeCategory: clickedCategoryId,
                            prevCategory: gbb.gbbMultipleCategoriesPage.state.currentCategoryId
                        }
                    })
                }
                gbb.utility.debugConsole("inside eventListenerForPrepareUI V2")

                // let clickedIndex = 
                let currentIndex = gbb.gbbMultipleCategoriesPage.currentIndex;
                gbb.$(".gbbAddGiftBoxPageWrapper").find("gbbMultipleCategoriesContainerHTML").css("pointer-events", "none")
                if (currentIndex != undefined && currentIndex == clickedIndex) {
                    gbb.gbbMultipleCategoriesPage.currentIndex = undefined;
                    gbb.gbbMultipleCategoriesPage.state.currentCategoryId = clickedCategoryId;

                    // firing function as per requirement
                    if (isTabBasedUI) {
                        // reset search value 
                        // gbb.gbbAddProductsPage.f.resetSearchTextValue()
                        gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2TabUI(gbb.gbbAddProductsPage.state.productPageData));
                    } else {
                        gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2(gbb.gbbAddProductsPage.state.productPageData))
                    }

                } else {
                    // gbb.gbbMultipleCategoriesPage.currentIndex = event.currentTarget.attributes.currentIndex.value
                    gbb.gbbMultipleCategoriesPage.currentIndex = clickedIndex;
                    // let categoryId = gbbCategoryHeaderContainer.attr('categoryId');
                    let categoryId = clickedCategoryId;
                    gbb.gbbMultipleCategoriesPage.state.currentCategoryId = categoryId;

                    // firing function as per requirement
                    if (isTabBasedUI) {
                        // reset search value 
                        // gbb.gbbAddProductsPage.f.resetSearchTextValue()

                        gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2TabUI(gbb.gbbAddProductsPage.state.productPageData));
                        gbb.utility.debugConsole(categoryId);
                        let selectedDiv = gbb.$(`div[categoryId='${categoryId}']`)
                        // gbb.$('html, body').scrollTop(selectedDiv.offset().top-200);
                    } else {
                        gbbMultipleCategoriesPageHTMLEle.html(await gbb.gbbMultipleCategoriesPage.f.prepareUIV2(gbb.gbbAddProductsPage.state.productPageData))
                        gbb.utility.debugConsole(categoryId);
                        let selectedDiv = gbb.$(`div[categoryId='${categoryId}']`)
                        gbb.$('html, body').scrollTop(selectedDiv.offset().top - 100);
                    }
                    // window.selectedDiv = selectedDiv;
                }
                return;
            },
        },
    },
    gbbPersonalizePage: {
        state: {
            // buildBoxButtonAction: undefined,
            // giftBoxData: null,
            giftMessage: null,
            scheduleDeliveryDate: null,
            showAllGreetingCardImages: false,
            showAllGiftWrapImages: false,
            greetingCardActiveImageSrc: "",
            giftWrapActiveImageSrc: "",
            emailDeliveryOption: null,
            emailDatePicker: "",
            // senderNameIsChange:false,
            senderName: "",
            // recipientNameIsChange:false,
            recipientName: "",
            customerUploadsResponse: null, //this is an Object.
            customerUploadsErrors: {},
            // additionalGiftMessageInfoIsChange:false,
            // additionalGiftMessageInfo:""
        },
        init: async function (settings, parent) {
            if (true || gbb.state.currentPageId !== 'personalizationPage') {
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: 'gbb-page-init',
                    detail: {
                        prevPageId: gbb.state.currentPageId,
                        activePageId: 'peronalizationPage'
                    }
                })
            }
            gbb.state.currentPageId = "personalizationPage"
            gbb.gbbMultipleCategoriesPage.state.currentCategory = undefined;
            gbb.gbbMultipleCategoriesPage.state.currentCategoryId = undefined
            gbb.gbbAddProductsPage.state.dataForInfiniteScroll = {
                noteAttribute: undefined,
                allProductsData: undefined,
                categoryId: undefined,
            }
            if (gbb?.gbbAddProductsPage?.state?.productPageData) {
                gbb.gbbAddProductsPage.state.productPageData = undefined
            }
            let navItem = gbb.utility.getNavItem(gbb.state.currentPageId)
            gbb.f.markPreviousNavigationItemsAsCompleted(navItem)
            await gbb.utility.getGiftBoxProductsFromCart()
            gbb.gbbPersonalizePage.initialize(settings, parent)
            gbb.gbbPersonalizePage.f.registerEvents(settings);
            gbb.utility.renderTemporaryLoadingSpinner("hide")
            //gbb.gbbPersonalizePage.f.insertIntoMainPageWrapper();
            // gbb.gbbModel.init(settings)
        },
        initialize: async function (settings, parent) {

            let gbbPersonalizePageWrapper = gbb.$("<div>").addClass("gbbPersonalizePageWrapper");
            const gbbPersonalizePageHeaderHTML = gbb.gbbPersonalizePage.f.prepareHeader();

            const gbbPersonalizePageSubtextWrapper = gbb.$("<div>").addClass("gbbPersonalizePageSubtextWrapper");
            const gbbDiscountComponent = gbb.$("<div>").addClass("gbbDiscountComponent");

            const gbbPersonalizePageSubtext = gbb.$("<div>").addClass("gbbPersonalizePageSubtext");
            gbbPersonalizePageSubtext.html(gbb.settings?.stepsConfigurationData?.personalizationData?.personalizePageSubtext)
            // gbbPersonalizePageSubtext.html("Hi")

            gbbPersonalizePageSubtextWrapper.append(gbbPersonalizePageSubtext);

            const gbbPersonalizePageBodyHTML = await gbb.gbbPersonalizePage.f.prepareUI();

            const gbbPersonalizePageFooterHTML = gbb.gbbPersonalizePage.f.prepareFooter();

            gbbPersonalizePageFooterHTML.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBgColor)
            gbbPersonalizePageFooterHTML.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterTextColor)

            gbbPersonalizePageWrapper.append(gbbPersonalizePageHeaderHTML);
            gbbPersonalizePageWrapper.append(gbbPersonalizePageSubtextWrapper);
            gbbPersonalizePageWrapper.append(gbbDiscountComponent);
            gbbPersonalizePageWrapper.append(gbbPersonalizePageBodyHTML);
            gbbPersonalizePageWrapper.append(gbbPersonalizePageFooterHTML);

            gbb.state.personalizePageBody = gbbPersonalizePageWrapper;
            gbb.gbbPersonalizePage.f.insertIntoMainPageWrapper();
            gbb.gbbPersonalizePage.action.refreshCustomerUploadsList();


            // if(gbb.settings?.scheduleDelivery?.isScheduleDeliveryEnabled){
            //     gbb.gbbPersonalizePage.f.useDatePickerLibrary();
            // }


        },

        updatePageStatus: async function () {
            if (gbb.state.currentPageId != "personalizationPage") {
                return;
            }

            let isMessageProductExists = gbb.gbbPersonalizePage.f.checkIfMessageProductExistsInShopifyData();
            let qty = gbb.gbbPersonalizePage.f.getMessageProductQuantity();
            let isVirtualProduct = false;
            let virtualProduct;
            let isGiftMessageVirtualProduct = gbb.settings.bundleSettings.isGiftMessageVirtualProduct || false;
            if (isGiftMessageVirtualProduct) {
                isVirtualProduct = true;
                isMessageProductExists = true;


                if (gbb.settings && gbb.settings.shopifyData) {
                    gbb.settings.shopifyData.giftMessageData = gbb.settings.shopifyData.giftMessageData || {}; // Initialize giftMessageData as an empty array if it doesn't exist

                    gbb.settings.shopifyData.giftMessageData.variants = gbb.settings.shopifyData.giftMessageData.variants || []; // Initialize variants as an empty array if it doesn't exist
                    gbb.settings.shopifyData.giftMessageData.properties = gbb.settings.shopifyData.giftMessageData.properties || {};
                    let variantData = {
                        id: "1111",
                    }

                    let gifMesssageDataForVirtualProduct = {
                        "id": 1111,
                        "title": gbb.settings.giftMessage?.messageProduct?.product?.variants[0]?.option1 || "Message Product",
                        "option1": "Write your message to your loved one",
                        "available": true,
                        "name": "Message - Write your message",
                        "public_title": "Write your message",
                        "requires_selling_plan": false,
                        "variant_id": 1111,
                        "price": 0,
                        "weight": 0,
                        "compare_at_price": null,
                        "inventory_management": null,
                        // "image": "https://cdn.shopify.com/s/files/1/0680/3541/2253/files/1713126763137_8487c4ff-5454-41b7-b36e-ceced15ba145.png?v=1715596242",
                        // "image": "https://d3ks0ngva6go34.cloudfront.net/public/message_default.png",
                        "image": gbb.settings?.giftMessage?.messageProduct?.product?.variants[0]?.variantImage || "https://d3ks0ngva6go34.cloudfront.net/public/message_default.png",
                        "product_id": 1111,
                    }

                    gbb.settings.shopifyData.giftMessageData.variants.push(variantData);
                    let dummyMessageObject = JSON.parse(JSON.stringify(gifMesssageDataForVirtualProduct));

                    dummyMessageObject.variants = gbb.settings.shopifyData.giftMessageData.variants;

                    if (!gbb.state.currentProductsDataSetForVariants || Object.keys(gbb.state.currentProductsDataSetForVariants) < 1) {
                        gbb.state.currentProductsDataSetForVariants = {}
                    }

                    gbb.state.currentProductsDataSetForVariants[variantData.id] = dummyMessageObject;
                }
                qty = 1;
                let message = gbb.gbbPersonalizePage.state.giftMessage
                if (!message) {
                    qty = 0;
                    isMessageProductExists = false;
                }
            }
            // only sideeffect of this is that we are skipping gift message add to the cart.
            // but this is because we couldnt find any gift message product
            if (isMessageProductExists) {
                let data = {
                    variant: { id: gbb.settings?.shopifyData?.giftMessageData?.variants[0].id },
                    qty: qty,
                    //qty : 0 videoMessageDataHasBeenChanged || emailDataHasBeenChanged ? 0 : 1,
                }
                if (data.qty == 0) {
                    await gbb.utility.removeFromCart(data, "giftMessage");
                } else {
                    await gbb.utility.addToCart(data, "giftMessage");
                }
            }
            let navItem = gbb.f.getNavItem(gbb.state.currentPageId);
            if (navItem) {
                navItem.isCompleted = true;
                navItem.isActive = false
                //if cart items have the values, then mark complete, else mark incomplete
            }
            //update the navigationItems  by filtering the array gbb.state.navigationItems using id
            gbb.state.navigationItems.forEach(function (item) {
                if (item.id == gbb.state.currentPageId) {
                    item = {
                        ...item,
                        navItem
                    }
                }
            })
            return true;
        },
        f: {

            prepareHeader: function () {
                const gbbPersonalizePageHeaderHTML = gbb.$("<div>").addClass("gbbPersonalizePageHeader");
                let gbbPageHeader = gbb.$("<div>").addClass("gbbPageHeader");
                let navigationItems = gbb.state.navigationItems;
                let stepsCount = 0;
                navigationItems = navigationItems.filter((element) => {
                    if (element.isNavBarItem && element.isNavBarItem == true) {
                        stepsCount++;
                        return element;
                    }
                })
                if (stepsCount == 1) {
                    gbbPageHeader.addClass("gbbPageHeaderWithoutLine");
                }

                let gbbPageHeaderText = gbb.$("<div>").addClass("gbbPageHeaderText");

                const gbbPersonalizePageBannerImage = gbb.$("<img>").addClass("gbbPageBannerImage");
                gbbPersonalizePageBannerImage.attr("src", gbb.settings.pageCustomizationData.banners.pageBannerImageSrc)
                gbbPageHeader.append(gbbPersonalizePageBannerImage)
                //gbbPageHeader.append(gbbPageHeaderText);

                const gbbPersonalizePageNavigationContainer = gbb.$("<div>").addClass("gbbPersonalizePageNavigationContainer");

                gbbPageHeaderText.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.landingPage.bannerText));
                let nextNavigationItems = gbb.f.getNavigationItemsToDisplay(gbb.state.currentPageId);
                gbbPersonalizePageNavigationContainer.append(gbb.f.renderNavigationHTML(gbbPersonalizePageNavigationContainer, "personalizePage", nextNavigationItems));

                gbbPersonalizePageHeaderHTML.append(gbbPersonalizePageNavigationContainer)
                return gbbPersonalizePageHeaderHTML;
            },
            prepareUI: async function () {
                let settings = gbb.settings
                let gbbPersonalizePageHTML;

                gbbPersonalizePageHTML = gbb.$("<div>").addClass("gbbPersonalizePageHTMLContent");
                gbbPersonalizePageHTML = gbb.$("<div>").addClass("gbbPersonalizePageHTML");

                if (gbb.settings?.addonProducts?.isEnabled) {
                    let addonProductsHTML = gbb.gbbAddonProducts.f.prepareAddonProductsUI()
                    gbbPersonalizePageHTML.append(addonProductsHTML)
                }
                if (gbb.settings?.greetingCard?.isGreetingCardEnabled) {
                    let greetingCardHTML = gbb.gbbPersonalizePage.components.greetingCard();
                    gbbPersonalizePageHTML.append(greetingCardHTML);
                }

                if (gbb.settings?.giftMessage?.isGiftMessageEnabled) {
                    gbb.gbbPersonalizePage.state.giftMessage = gbb.utility.getAttributValueFromMessageItem("Message") //read from noteAttributes
                    let giftMessage = await gbb.gbbPersonalizePage.components.giftMessage();
                    gbbPersonalizePageHTML.append(giftMessage);
                }


                if (gbb.settings?.customerUploads?.isCustomerUploadsEnabled) {
                    let customerAttachmentHTML = gbb.gbbPersonalizePage.components.customerUploads();
                    gbbPersonalizePageHTML.append(customerAttachmentHTML);
                }


                if (gbb.settings.videoMessage.isVideoMessageEnabled) {
                    //read email Id and recordedId from noteAttributes
                    gbb.gbbVideoMsg.state.emailId = gbb.utility.getAttributValueFromMessageItem("Recipient Email");
                    gbb.gbbVideoMsg.state.uploadedVideoId = gbb.utility.getAttributValueFromMessageItem("_videoMsgId");
                    let videoMessageHTML = gbb.gbbPersonalizePage.components.videoMessage();
                    gbbPersonalizePageHTML.append(videoMessageHTML);
                }

                // if(gbb.settings?.scheduleDelivery?.isScheduleDeliveryEnabled){
                //     let scheduleDeliveryHTML = await gbb.gbbPersonalizePage.components.scheduleDelivery();
                //     gbbPersonalizePageHTML.append(scheduleDeliveryHTML);
                // }

                if (gbb.settings?.giftMessage?.isEmailEnabled) {
                    let emailAddressHTML = await gbb.gbbPersonalizePage.components.emailAddress();
                    gbbPersonalizePageHTML.append(emailAddressHTML);
                }

                if (gbb.settings?.giftMessage?.isGiftMessageEnabled || gbb.settings.videoMessage.isVideoMessageEnabled) {
                    if (gbb.settings?.giftMessage?.isEmailEnabled) {
                        let scheduleMessageDeliveryHTML = await gbb.gbbPersonalizePage.components.scheduleMessageDelivery();
                        gbbPersonalizePageHTML.append(scheduleMessageDeliveryHTML);
                    }
                }

                return gbbPersonalizePageHTML;

            },
            prepareFooter: function () {
                //this is a footer
                const gbbPersonalizePageFooterHTML = gbb.$("<div>").addClass("gbbPersonalizePageFooterHTML");
                gbbPersonalizePageFooterHTML.append(gbb.f.renderCartProductsFooterHTML("personalizePage"));
                return gbbPersonalizePageFooterHTML;
            },
            insertIntoMainPageWrapper: function () {

                gbb.$(".gbbBodyWrapper").html(gbb.state.personalizePageBody);

                gbb.$(".gbbBodyWrapper").children().first().hide();
                gbb.$(".gbbBodyWrapper").children().first().fadeIn(700);
            },
            calculateDaysFromToday: function (numberOfDays) {
                return new Date(Date.now() + parseInt(numberOfDays) * 24 * 60 * 60 * 1000)
            },
            useDatePickerLibrary: function () {
                try {
                    const minDate = gbb.gbbPersonalizePage.f.calculateDaysFromToday(gbb.settings.scheduleDelivery.leadTime);
                    let maxDate = gbb.gbbPersonalizePage.f.calculateDaysFromToday(gbb.settings.scheduleDelivery.maxDateInDays);
                    const disabledDates = gbb.settings.scheduleDelivery.disabledDates;
                    const disabledDays = gbb.settings.scheduleDelivery.disabledDaysOfWeek;
                    let datePicker = gbb.$(".gbbScheduleDeliveryDatePicker");
                    flatpickr(datePicker, {
                        // inline: true,
                        dateFormat: "d-m-Y",
                        time_24hr: true,
                        minDate: minDate,
                        maxDate: maxDate,
                        disable: [
                            function (date) {
                                // return true to disable
                                // let d = new Date(date+"Z");
                                let d = gbb.utility.getDate(date);

                                // d = (d.toISOString().split('T')[0]);
                                // return (date.getDay() === 0 || date.getDay() === 6);
                                if (disabledDates.includes(d) || disabledDays.includes(new Date(date).toLocaleString("en-us", { weekday: "long" }))) {
                                    return true;
                                }
                            },
                        ],
                        onChange: async function (selectedDates, dateStr, instance) {
                            gbb.utility.debugConsole("date changed");
                            gbb.utility.debugConsole({ dateStr });
                            gbb.gbbPersonalizePage.state.scheduleDeliveryDate = dateStr;
                            if (gbb.gbbPersonalizePage.state.scheduleDeliveryDate) {
                                // await gbb.utility.updateCart({ attributes: { ["gbbScheduleDelivery"]: gbb.gbbPersonalizePage.state.scheduleDeliveryDate } });
                                gbb.gbbBrowser.updateCartAttributes({ gbbScheduleDelivery: gbb.gbbPersonalizePage.state.scheduleDeliveryDate });
                            }

                            //
                        },
                        // appendTo: gbb.$(body)
                    });
                    if (gbb.utility.getAttributValueFromCart("gbbScheduleDelivery") != null) {
                        datePicker.val(gbb.utility.getAttributValueFromCart("gbbScheduleDelivery"));
                    }
                } catch (e) {
                    gbb.utility.debugConsole(e);

                    //gbbScheduleDeliveryHTML
                    //hide this component
                    gbb.$(".gbbScheduleDeliveryHTML").hide();
                }

            },
            activateClearSelectionButton: function (productType) {
                //create a new button
                // productType -> expected params are
                // "giftWrap" or "greetingCard"
                let clearSelectionButton = gbb.$("<div>").addClass("gbbClearSelectionButton");

                //: clear selection language
                clearSelectionButton.text(gbb.utility.renderLanguageValue(gbb.settings.languageData?.personalizePage?.clearSelectionButton) || "Clear Selection");
                clearSelectionButton.click(function () {
                    gbb.gbbPersonalizePage.action.onClearSelectionButtonClick(productType);
                });

                return clearSelectionButton;
            },
            registerEvents: function (settings) {
                gbb.gbbPersonalizePage.state.buildBoxButtonAction = function () {
                    gbb.utility.debugConsole("build box button clicked");
                    // window.alert("build box button clicked");
                };
            },
            renderGreetingCardImages: function (greetingCardData) {
                try {
                    // let imageList = greetingCardData.images;
                    if (true || imageList) {
                        let gbbGreetingCardImageList = [];
                        let greetingCardProducts = Object.values(greetingCardData) || [];
                        for (let i = 0; i < greetingCardProducts?.length; i++) {
                            let greetingCardProduct = greetingCardProducts[i];
                            for (let j = 0; j < greetingCardProduct?.variants?.length; j++) {
                                //: No Image found png
                                let _img = greetingCardProduct?.variants[j]?.featured_image?.src || greetingCardProduct?.featured_image || "No Image found png";
                                let variantId = greetingCardProduct?.variants[j]?.id;
                                // add an input event listener to each image of radio type
                                let variantTitle = gbb.$("<div>").addClass("gbbVariantTitle").append(greetingCardProduct?.variants[j]?.title);
                                let variantPrice = gbb.$("<span>").addClass("gbbVariantPrice").append(gbb.utility.formatPrice(greetingCardProduct?.variants[j]?.price));
                                let variantDetailsWrapper = gbb.$("<div>").addClass("gbbVariantDetailsWrapper");

                                variantDetailsWrapper.append(variantTitle);
                                variantDetailsWrapper.append(variantPrice);

                                imageInput = gbb.$("<input>").attr("type", "radio").attr("name", "greetingCardImage").attr("value", _img)
                                imageInput.addClass("greetingCardImageInput")
                                let imageAndDetailsWrapper = gbb.$("<div>").addClass("greetingCardImageAndDetailsWrapper");
                                let imageLabel = gbb.$("<label>").addClass('gbbGreetingCardImageLabel')
                                let image = gbb.$("<img>").addClass('greetingCardImage')

                                // imageLabel.on("click", gbb.gbbPersonalizePage.action.onGreetingCardImageClick)
                                imageLabel.on("click", gbb.gbbPersonalizePage.action.onGreetingCardImageClick)

                                let argsObj = {
                                    productData: greetingCardProduct,
                                    variantId: variantId.id,
                                }

                                let uniqueItemKey = gbb.utility.getUniqueIdForVariant(argsObj);


                                const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(variantId, { uniqueItemKey });
                                if (isItemInCart) {
                                    gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc = _img;
                                    gbb.gbbPersonalizePage.state.greetingCardTitle = isItemInCart.variant_title;
                                    gbb.gbbPersonalizePage.state.greetingCardPrice = isItemInCart.price;
                                } else {
                                    gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc = null;
                                    gbb.gbbPersonalizePage.state.greetingCardTitle = null;
                                    gbb.gbbPersonalizePage.state.greetingCardPrice = null;
                                    imageInput.attr("checked", false)
                                    imageLabel.removeClass("gbbActiveGreetingCard")
                                    gbb.gbbPersonalizePage.action.removeCheckmarkDivsFromGreetingCards();
                                }

                                //if image is checked then attach gbbActiveGreetingCard css to it
                                if (gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc == _img) {
                                    imageInput.attr("checked", true)
                                    imageLabel.addClass("gbbActiveGreetingCard")
                                    gbb.gbbPersonalizePage.action.addCheckMarkDivs(imageLabel);
                                } else {
                                    imageInput.attr("checked", false)
                                    imageLabel.removeClass("gbbActiveGreetingCard")
                                    gbb.gbbPersonalizePage.action.removeCheckmarkDivsFromGreetingCards();
                                }
                                image.attr("src", _img)

                                imageInput.attr("data-variant-id", variantId)
                                image.attr("data-variant-id", variantId)
                                imageLabel.attr("data-variant-id", variantId)

                                imageLabel.append(imageInput)
                                // imageLabel.append(variantTitle).append(variantPrice)
                                imageLabel.append(image)

                                imageAndDetailsWrapper.append(imageLabel);
                                imageAndDetailsWrapper.append(variantDetailsWrapper);
                                gbbGreetingCardImageList.push(imageAndDetailsWrapper)
                            }
                        }
                        // if gbbGreetingCardImageList has no elements then return that there are no Images to display
                        if (gbbGreetingCardImageList.length == 0) {
                            return gbb.$("<div>").addClass('gbbGreetingCardImageList').html("No products found" || gbb.utility.renderLanguageValue(gbb.settings.languageData.giftcardV2.purchasePageFields.noImagesAvailable))
                        }
                        return gbbGreetingCardImageList;
                    }
                } catch (e) {
                    gbb.utility.debugConsole("error occured in renderGreetingCardImages", e)
                }
            },
            renderGiftWrapImages: function (giftWrapData) {
                // let imageList = giftWrapData.images;
                if (true || imageList) {
                    let giftWrapImageList = [];
                    for (let i = 0; i < giftWrapData.variants?.length; i++) {
                        //: no images png
                        let _img = giftWrapData.variants[i]?.featured_image?.src || "No Image found png";
                        let variantId = giftWrapData.variants[i]?.id;

                        let variantTitle = gbb.$("<div>").addClass("gbbVariantTitle").append(giftWrapData.variants[i]?.title);
                        let variantPrice = gbb.$("<span>").addClass("gbbVariantPrice").append(gbb.utility.formatPrice(giftWrapData.variants[i]?.price));

                        let variantDetailsWrapper = gbb.$("<div>").addClass("gbbVariantDetailsWrapper");

                        variantDetailsWrapper.append(variantTitle);
                        variantDetailsWrapper.append(variantPrice);
                        // add an input event listener to each image of radio type
                        imageInput = gbb.$("<input>").attr("type", "radio").attr("name", "giftWrapImage").attr("value", _img)
                        imageInput.addClass("giftWrapImageInput")
                        let imageAndDetailsWrapper = gbb.$("<div>").addClass("greetingCardImageAndDetailsWrapper");
                        let imageLabel = gbb.$("<label>").addClass('giftWrapImageLabel')
                        let image = gbb.$("<img>").addClass('giftWrapImage')

                        //on click set the current item to the preview image as active image
                        // imageLabel.on("click", gbb.gbbPersonalizePage.action.onGiftWrapImageClick)
                        imageAndDetailsWrapper.on("click", gbb.gbbPersonalizePage.action.onGiftWrapImageClick)

                        const isItemInCart = gbb.utility.checkIfItemPresentInGiftBoxCart(variantId);

                        if (isItemInCart) {
                            gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc = _img;
                            gbb.gbbPersonalizePage.state.giftWrapTitle = isItemInCart.variant_title;
                            gbb.gbbPersonalizePage.state.giftWrapPrice = gbb.utility.formatPrice(isItemInCart.price);
                        }

                        //if image is checked then attach activeGiftWrap css to it
                        if (gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc == _img) {
                            imageInput.attr("checked", true)
                            imageLabel.addClass("activeGiftWrap")
                            gbb.gbbPersonalizePage.action.addCheckMarkDivs(imageLabel);
                        }
                        image.attr("src", _img)

                        imageInput.attr("data-variant-id", variantId)
                        image.attr("data-variant-id", variantId)
                        imageLabel.attr("data-variant-id", variantId)

                        imageLabel.append(imageInput)
                        // imageLabel.append(variantTitle).append(variantPrice)
                        imageLabel.append(image)
                        imageAndDetailsWrapper.append(imageLabel);
                        imageAndDetailsWrapper.append(variantDetailsWrapper);
                        giftWrapImageList.push(imageAndDetailsWrapper)
                    }
                    // if giftWrapImageList has no elements then return that there are no Images to display
                    if (giftWrapImageList.length == 0) {
                        return gbb.$("<div>").addClass('giftWrapImageList').html("No products found" || gbb.utility.renderLanguageValue(gbb.settings.languageData.giftcardV2.purchasePageFields.noImagesAvailable))
                    }
                    return giftWrapImageList;
                }

            },
            verifyEmailFields: function () {
                if (gbb.settings?.giftMessage?.isEmailEnabled) {
                    let email = gbb.gbbVideoMsg.state.emailId;
                    let emailValid;
                    let isEmailWarningMsgPresent = gbb.$(".gbbPageBody").find(".gbbEmailValidationError");
                    let emailValidationError = gbb.$("<div>").addClass("gbbEmailValidationError").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.generalSettings?.emailValidationError) || "Please enter a valid email address");
                    if (email && email.trim().length != 0) {//email is not empty -> it must be valid
                        //check for validation
                        emailValid = gbb.utility.emailValidation(email);
                        if (!emailValid) {
                            if (isEmailWarningMsgPresent.length == 0) {
                                gbb.$(".gbbEmailAddressWrapper").append(emailValidationError);
                            }
                            return false;
                        } else {
                            gbb.$(".gbbEmailValidationError").remove();
                            return true;
                        }
                    }
                    else if (!email || email?.trim().length == 0) {//email is empty -> check if video message exists, if it does -> email cannot be empty
                        if (gbb.gbbVideoMsg.state.uploadedVideoId || gbb.$(".gbbVideoMsgCheckboxField").is(":checked")) {
                            if (isEmailWarningMsgPresent.length == 0) {
                                gbb.$(".gbbEmailAddressWrapper").append(emailValidationError);
                            }
                            return false;
                        } else {
                            //if the video message is not checked then remove the error message
                            gbb.$(".gbbEmailValidationError").remove();
                            return true;
                        }
                    }
                } else {
                    return true;
                }
            },
            getMessageProductQuantity: function () { //if text message or video message is present -> then only quantity will be 1 otherwise 0
                let qty;
                let videoToggle = gbb.$(".gbbVideoMsgCheckboxField").is(":checked")
                if (!videoToggle) {
                    gbb.gbbVideoMsg.state.uploadedVideoId = null
                }
                if ((gbb.gbbPersonalizePage.state?.giftMessage && gbb.gbbPersonalizePage.state?.giftMessage?.trim().length != 0) || gbb.gbbVideoMsg.state.uploadedVideoId) {
                    qty = 1;
                } else if (gbb.gbbPersonalizePage.state.customerUploadsResponse && Object.keys(gbb.gbbPersonalizePage.state.customerUploadsResponse).length > 0) {
                    qty = 1;
                } else {
                    qty = 0;
                }
                return qty;
            },
            checkIfMessageProductExistsInShopifyData: function () { //check if we have a message product at all or not
                if (gbb.settings && gbb.settings.shopifyData && gbb.settings?.shopifyData?.giftMessageData
                    && gbb.settings?.shopifyData?.giftMessageData?.variants[0].id) {
                    return true;
                } else {
                    return false;
                }
            },
            deleteCustomerUploadsError: function (key) {
                if (gbb.gbbPersonalizePage.state.customerUploadsErrors != null && gbb.gbbPersonalizePage.state.customerUploadsErrors[key]) {
                    delete gbb.gbbPersonalizePage.state.customerUploadsErrors[key];
                }
            },
            deleteCustomerUploadsResponse: function (key) {
                if (gbb.gbbPersonalizePage.state.customerUploadsResponse != null && gbb.gbbPersonalizePage.state.customerUploadsResponse[key]) {
                    delete gbb.gbbPersonalizePage.state.customerUploadsResponse[key];
                }
            },
            removeGiftMessageFromSessionStorage: function (cartData) {
                try {
                    let boxes = Object.keys(cartData.boxes);
                    let giftMessageProductInSessionStorage = [];
                    let totalCount = 0;
                    for (let i = 0; i < boxes.length; i++) {
                        let box = cartData.boxes[boxes[i]];
                        let items = box.items;
                        for (let j = 0; j < items.length; j++) {
                            let item = items[j];
                            if (item.properties && item.properties.Message) {
                                giftMessageProductInSessionStorage.push({ "Box ID": item.properties["Box ID"], "Message": item.properties.Message, "To": item.properties["Recipient Name"], "From": item.properties["Sender Name"], "Bundle Name": item.properties.Bundle })

                                // remove this item from the cartData
                                items.splice(j, 1);
                                j--;
                            }
                        }
                    }
                    // update cartData in session storage
                    if (cartData) {
                        let bundleId = gbb.state.bundleId;
                        let sessionStorageKey = `gbb-cart-${bundleId}`;
                        sessionStorage.setItem(sessionStorageKey, JSON.stringify(cartData));
                    }

                    gbb.state.giftMessageProductInActiveSession = giftMessageProductInSessionStorage;
                    gbb.gbbBrowser.updateTotalPriceInSessionStorage();
                    gbb.gbbBrowser.updateTotalofRelevantBoxPriceInSessionStorage();
                } catch (err) {
                    gbb.utility.debugConsole("error inside removeGiftMessageFromSessionStorage", err);
                }
            }
        },
        events: {
            onCustomerUploadsFileChange: async function (event) {
                try {
                    let fileBlob = event.target.files[0];
                    gbb.utility.debugConsole(fileBlob, "file")

                    let fileAllowed = true;
                    if (fileBlob.type) {
                        const allowedExtensions = ['.xlsx', '.xls', '.pdf', '.jpeg', '.png', '.jpg', '.heif', '.heic'];
                        const extension = fileBlob.name.split('.').pop();

                        if (allowedExtensions.includes('.' + extension)) {
                            fileAllowed = true;
                        } else if (fileBlob.type.startsWith('video/')) {
                            fileAllowed = true;
                        } else {
                            fileAllowed = false;
                        }
                    }

                    if (!fileAllowed) {
                        let fieldKey = event.target.getAttribute("data-field-key");
                        gbb.gbbPersonalizePage.state.customerUploadsErrors[fieldKey] = { fileNotSupportedError: true };
                        gbb.gbbPersonalizePage.action.refreshCustomerUploadsErrorMessage()
                        return;
                    }

                    //fileSize limit is 5mbs
                    let fieldKey = event.target.getAttribute("data-field-key");

                    // gbbCustomerUploadsActionButton //disable this button
                    let buttonRef = gbb.$(".gbbCustomerUploadsListItem[data-field-key='" + fieldKey + "']").find(".gbbCustomerUploadsActionButton").children(0);

                    let customerUploadTextFields = gbb.settings.customerUploads.textFields || {};


                    buttonRef.text(customerUploadTextFields.uploadingText.value || "Uploading...")
                    buttonRef.addClass("gbbDisabled");

                    let reader = new FileReader();
                    try {
                        reader.onload = async function (event) {
                            if (fileBlob.size > 5000000) {
                                gbb.gbbPersonalizePage.state.customerUploadsErrors[fieldKey] = { fileSizeError: true };
                                gbb.gbbPersonalizePage.action.refreshCustomerUploadsErrorMessage()
                                buttonRef.removeClass("gbbDisabled");
                                buttonRef.text(customerUploadTextFields.uploadText.value || "Upload")
                                gbb.utility.debugConsole("file size is greater than 5mb")
                                return;
                            };

                            // let fileData = event.target.result;
                            let fileUploadData = await gbb.gbbPersonalizePage.action.uploadCustomerUploadsFile(fileBlob, fieldKey);
                            if (fileUploadData) {
                                const responseDataObject = fileUploadData.data;
                                let fileUrl = responseDataObject.url;
                                let fileName = responseDataObject.originalFileName;
                                let labelName = responseDataObject.fieldKey;
                                const fileDataObject = {
                                    fileUrl: fileUrl,
                                    fileName: fileName,
                                    labelName: labelName
                                }
                                gbb.gbbPersonalizePage.state.customerUploadsResponse = {
                                    ...gbb.gbbPersonalizePage.state.customerUploadsResponse,
                                    [fieldKey]: fileDataObject.fileUrl
                                }

                                gbb.gbbPersonalizePage.f.deleteCustomerUploadsError(fieldKey);

                                // gbb.gbbBrowser.updateCartAttributes(gbb.gbbPersonalizePage.state.customerUploadsResponse);
                                gbb.gbbPersonalizePage.action.refreshCustomerUploadsList();
                                gbb.gbbPersonalizePage.action.refreshCustomerUploadsErrorMessage();
                            } else {
                                gbb.utility.debugConsole("error in uploading file")
                                gbb.gbbPersonalizePage.state.customerUploadsErrors[fieldKey] = { fileUploadError: true };
                                gbb.gbbPersonalizePage.action.refreshCustomerUploadsErrorMessage()
                                buttonRef.removeClass("gbbDisabled");
                                buttonRef.text(customerUploadTextFields.uploadText.value || "Upload")
                            }
                        }
                        reader.readAsDataURL(fileBlob);

                        // we accept 


                    } catch (e) {
                        gbb.utility.debugConsole(e)
                        gbb.gbbPersonalizePage.state.customerUploadsErrors[fieldKey] = { fileUploadError: true };
                        gbb.gbbPersonalizePage.action.refreshCustomerUploadsErrorMessage()
                        buttonRef.removeClass("gbbDisabled");
                        buttonRef.text(customerUploadTextFields.uploadText.value || "Upload")
                        return;
                    }
                } catch (error) {
                    gbb.utility.debugConsole(error);
                    return false;
                }
            }
        },
        components: {
            greetingCard: function (settings) {

                let greetingCardContainer = gbb.$("<div>").addClass("gbbGreetingCardContainer")

                let greetingCardCheckboxLabel = gbb.$("<label>").addClass("gbbGreetingCardCheckboxLabel");
                let greetingCardCheckboxPrice = gbb.$("<label>").addClass("gbbGreetingCardCheckboxPrice");


                let greetingCardImg = gbb.$("<img>").addClass("gbbGreetingCardImg");
                let greetingCardImgWrapper = gbb.$("<div>").addClass("greetingCardImgWrapper");


                // 2.a. img for the greeting card
                let greetingCardWrapper = gbb.$("<div>").addClass("greetingCardWrapper");

                let products = gbb.state.giftBoxCartData.items;

                products.forEach((product) => {
                    //product.properties is an object
                    if (product.properties["_boxProduct"] == "greetingCard") {
                        gbb.gbbPersonalizePage.state.greetingCardTitle = product.variant_title;
                        gbb.gbbPersonalizePage.state.greetingCardPrice = gbb.utility.formatPrice(product.price);
                        gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc = product.image;
                    }
                })
                greetingCardCheckboxLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.selectGreetingCardLabel) || "Greeting Card1");
                //modularize code from here onwards

                // 2. img container for the greeting card
                let greetingCardImageContainer = gbb.$("<div>").addClass("gbbGreetingCardImageContainer");
                let greetingCardDropDownWrapper = gbb.$("<div>").addClass("gbbGreetingCardDropDownWrapper");
                //: Button
                let greetingCardDropDownButton = gbb.$("<img>").addClass("gbbGreetingCardDropDownButton");
                greetingCardDropDownButton.attr("src", CONSTANT_IMAGES_DROPDOWN_BUTTON);
                let _button = gbb.gbbPersonalizePage.f.activateClearSelectionButton("greetingCard");


                // 2.b. container for all the greeting card options
                let greetingCardAllImagesContainer = gbb.$("<div>").addClass("greetingCardAllImagesContainer");
                let greetingCardAllImagesLabel = gbb.$("<div>").addClass("greetingCardAllImagesLabel");

                //: Language support
                greetingCardAllImagesLabel.text("Greeting Card");

                let greetingCardData = gbb.settings?.shopifyData?.greetingCardData;

                //  greetingCardDropDownWrapper.on("click", async function (event) {
                //  gbb.gbbPersonalizePage.action.handleShowAllGreetingCardImagesButtonEvent(event);
                if (true || gbb.gbbPersonalizePage.state.showAllGreetingCardImages == false) {
                    //if greetingCardData.images has only one element add a class to listwrapper that says gbbJustOneProduct
                    let gbbGreetingCardImageList = gbb.$("<div>").addClass("gbbGreetingCardImageList")
                    gbbGreetingCardImageList.html(gbb.gbbPersonalizePage.f.renderGreetingCardImages(greetingCardData));

                    let greetingCardProducts = Object.values(greetingCardData) || [];
                    let greetingCardVariants = greetingCardProducts[0]?.variants || [];
                    if (greetingCardVariants?.length == 1) {
                        gbbGreetingCardImageList.addClass("gbbJustOneProduct")
                    }


                    gbb.gbbPersonalizePage.state.showAllGreetingCardImages = true;

                    // gbb.$(".greetingCardWrapper").html(_button);
                    greetingCardWrapper.append(gbbGreetingCardImageList);
                    // gbb.$(".greetingCardWrapper").append(gbbGreetingCardImageList);

                    // await gbb.$(".greetingCardWrapper").append(gbb.gbbPersonalizePage.f.activateClearSelectionButton("greetingCard"));
                }
                else {
                    // remove the contents of greetingCardWraooer
                    if (gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc) {
                        greetingCardImg.attr("src", gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc);
                        greetingCardImgWrapper.append(greetingCardImg);
                        gbb.$(".greetingCardWrapper").html(greetingCardImgWrapper);
                    }
                    else {
                        greetingCardCheckboxLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.selectGreetingCardLabel) || "Greeting Card1");
                        greetingCardCheckboxPrice.text("");
                        gbb.$(".greetingCardWrapper").html("")
                    }
                    gbb.$(".gbbGreetingCardDropDownButton").css("transform", "rotate(180deg)");
                    gbb.gbbPersonalizePage.state.showAllGreetingCardImages = false;
                }
                //  });

                greetingCardImageContainer.append(greetingCardWrapper);
                //  greetingCardImageContainer.append(greetingCardShowAllImagesButtonWrapper);

                greetingCardDropDownWrapper.append(greetingCardCheckboxLabel);
                greetingCardDropDownWrapper.append(_button);


                if (false) {
                    greetingCardDropDownWrapper.append(greetingCardCheckboxPrice);
                    greetingCardDropDownWrapper.append(greetingCardDropDownButton);
                }


                greetingCardContainer.append(greetingCardDropDownWrapper);
                greetingCardContainer.append(greetingCardImageContainer);

                return greetingCardContainer;
            },
            giftWrap: function (settings) {
                // 1. checkbox for giftWrap
                let giftWrapContainer = gbb.$("<div>").addClass("gbbGiftWrapContainer");
                let giftWrapCheckboxLabel = gbb.$("<label>").addClass("gbbGiftWrapCheckboxLabel")
                let giftWrapCheckboxPrice = gbb.$("<label>").addClass("gbbGiftWrapCheckboxPrice")

                let products = gbb.state.giftBoxCartData.items;

                products.forEach((product) => {
                    //product.properties is an object
                    if (product.properties["_boxProduct"] == "giftWrap") {
                        gbb.gbbPersonalizePage.state.giftWrapTitle = product.variant_title;
                        gbb.gbbPersonalizePage.state.giftWrapPrice = gbb.utility.formatPrice(product.price);
                        gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc = product.image;
                    }
                })

                //: Language support

                //modularize code from here onwards

                // 2. img container for the greeting card
                let giftWrapImageContainer = gbb.$("<div>").addClass("gbbGiftWrapImageContainer");

                let giftWrapDropDownWrapper = gbb.$("<div>").addClass("gbbGiftWrapDropDownWrapper");
                let giftWrapDropDownButton = gbb.$("<img>").addClass("gbbGiftWrapDropDownButton")
                giftWrapDropDownButton.attr("src", CONSTANT_IMAGES_DROPDOWN_BUTTON);
                // 2.a. img for the greeting card
                let giftWrapWrapper = gbb.$("<div>").addClass("giftWrapWrapper");
                let giftWrapImgWrapper = gbb.$("<div>").addClass("giftWrapImgWrapper");
                let giftWrapImg = gbb.$("<img>").addClass("gbbGiftWrapImg");

                // 2.b. container for all the greeting card options
                let giftWrapAllImagesContainer = gbb.$("<div>").addClass("giftWrapAllImagesContainer");

                //render all the images in an image tag in AllImagesContainer
                let giftWrapData = gbb.settings?.shopifyData?.giftWrapData;

                // [button] to show all the images
                //let giftWrapShowAllImagesButtonWrapper = gbb.$("<div>").addClass("gbbGreetingCardShowAllImagesButtonWrapper");

                //  selectGreetingCardLabel
                if (gbb.gbbPersonalizePage.state.giftWrapTitle) {
                    giftWrapCheckboxLabel.text(gbb.gbbPersonalizePage.state.giftWrapTitle)
                    giftWrapCheckboxPrice.text(gbb.gbbPersonalizePage.state.giftWrapPrice)
                    giftWrapImg.attr("src", gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc);
                    giftWrapImgWrapper.append(giftWrapImg);

                    giftWrapWrapper.append(giftWrapImgWrapper);
                } else {
                    giftWrapCheckboxLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.giftWrapLabel) || "Select Wrap 1");
                }


                giftWrapDropDownWrapper.on("click", function (event) {
                    //  gbb.gbbPersonalizePage.action.handleShowAllGreetingCardImagesButtonEvent(event);
                    if (gbb.gbbPersonalizePage.state.showAllGiftWrapImages == false) {

                        gbb.$(".gbbGiftWrapDropDownButton").css("transform", "rotate(360deg)");

                        let giftWrapImageList = gbb.$("<div>").addClass("giftWrapImageList")
                        giftWrapImageList.html(gbb.gbbPersonalizePage.f.renderGiftWrapImages(giftWrapData));

                        if (giftWrapData.variants?.length == 1) {
                            giftWrapImageList.addClass("gbbJustOneProduct")
                        }

                        gbb.gbbPersonalizePage.state.showAllGiftWrapImages = true;

                        gbb.$(".giftWrapWrapper").html(gbb.gbbPersonalizePage.f.activateClearSelectionButton("giftWrap"));
                        gbb.$(".giftWrapWrapper").append(giftWrapImageList);
                    }
                    else {
                        if (gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc) {
                            giftWrapImg.attr("src", gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc);
                            giftWrapImgWrapper.append(giftWrapImg);
                            gbb.$(".giftWrapWrapper").html(giftWrapImgWrapper);
                        }
                        else {
                            giftWrapCheckboxLabel.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.giftWrapLabel) || "Select Wrap 1");
                            giftWrapCheckboxPrice.text("");
                            gbb.$(".giftWrapWrapper").html("")
                        }

                        gbb.$(".gbbGiftWrapDropDownButton").css("transform", "rotate(180deg)");
                        gbb.gbbPersonalizePage.state.showAllGiftWrapImages = false;
                    }
                });

                //  giftWrapCheckboxLabel.text


                //  giftWrapShowAllImagesButtonWrapper.append(giftWrapShowAllImagesButton);

                giftWrapImageContainer.append(giftWrapWrapper);
                //  giftWrapImageContainer.append(giftWrapShowAllImagesButtonWrapper);


                //  giftWrapContainer.append(giftWrapCheckbox);
                giftWrapDropDownWrapper.append(giftWrapCheckboxLabel);
                giftWrapDropDownWrapper.append(giftWrapCheckboxPrice);
                giftWrapDropDownWrapper.append(giftWrapDropDownButton);
                giftWrapContainer.append(giftWrapDropDownWrapper);

                giftWrapContainer.append(giftWrapImageContainer);

                return giftWrapContainer;
            },
            giftMessage: function (settings) {
                let giftMessageV2MainContent = gbb.$("<div>").addClass("gbbGiftMessageV2MainContent");

                let gbbGiftMessageV2HTML = gbb.$("<div>").addClass('gbbGiftMessageV2HTML')


                let gbbGiftMessageV2ToFromContainer;
                if (gbb.settings?.giftMessage.isSenderAndRecipientNameEnabled == true) {
                    gbbGiftMessageV2ToFromContainer = gbb.gbbPersonalizePage.components.gbbGiftMessageV2ToFromUI();
                }
                // a label field
                let giftMessageV2PrepareUI;
                let gbbGiftMessageV2 = gbb.$("<div>").addClass('gbbGiftMessageV2')
                // a label field
                let gbbGiftMessageV2Label = gbb.$("<label>").addClass("gbbGiftMessageV2Label").attr("for", "gbbGiftMessageV2").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.personalizePage?.messageLabel) || "giftnote1 ");
                let gbbGiftMessageV2InputField = gbb.$("<textarea>").addClass("gbbGiftMessageV2InputField").attr("placeholder", gbb.utility.renderLanguageValue(gbb.settings?.languageData?.personalizePage?.messagePlaceholder) || "Placeholder1")
                let gbbGiftMessageV2RequiredWarning = gbb.$("<div>").addClass("gbbGiftMessageV2RequiredWarning").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.personalizePage?.messageIsRequiredError) || "Message is Required!")
                gbbGiftMessageV2RequiredWarning.css("display", "none");

                let gbbGiftMessageCounterEle = gbb.$("<div>").addClass("gbbGiftMessageCounterEle")


                let giftMessageCharacterLimit = gbb.settings.giftMessage.giftMessageCharacterLimit || "";
                giftMessageCharacterLimit = giftMessageCharacterLimit.trim() != "" && giftMessageCharacterLimit.trim() != "0" ? giftMessageCharacterLimit : "";

                if (giftMessageCharacterLimit) {
                    gbbGiftMessageV2InputField.attr("maxlength", giftMessageCharacterLimit)
                }
                // gbbGiftMessageV2MainContent
                ///save the input field values
                if (gbb.utility.getAttributValueFromMessageItem("Message")) {
                    let noteVal = gbb.utility.getAttributValueFromMessageItem("Message");
                    gbbGiftMessageV2InputField.val(noteVal)
                    gbb.gbbPersonalizePage.state.giftMessage = noteVal;
                    if (giftMessageCharacterLimit) {
                        const maxlength = gbbGiftMessageV2InputField.attr("maxlength");
                        const currentLength = gbbGiftMessageV2InputField.val().length;
                        gbbGiftMessageCounterEle.text(currentLength + "/" + maxlength);
                    }
                }

                gbbGiftMessageV2InputField.on("change", function (event) {
                    gbb.gbbPersonalizePage.state.giftMessage = gbbGiftMessageV2InputField.val();
                })

                if (giftMessageCharacterLimit) {
                    gbbGiftMessageV2InputField.on("input", ((e) => {
                        const target = e.target;
                        // Get the `maxlength` attribute
                        const maxLength = target.getAttribute('maxlength');
                        // Count the current number of characters
                        const currentLength = target.value.length;
                        gbbGiftMessageCounterEle.text(`${currentLength}/${maxLength}`);
                    }))
                }
                gbb.f.applyLabelCSS(gbbGiftMessageV2Label)

                // create an empty divider to separate the message and the video message button
                let gbbGiftMessageV2Divider = gbb.$("<div>").addClass("gbbGiftMessageV2Divider")

                let gbbGiftMessageV2InputFieldsDiv = gbb.$("<div>").addClass("gbbGiftMessageV2InputFieldsDiv")
                gbbGiftMessageV2InputFieldsDiv.append(gbbGiftMessageV2InputField).append(gbbGiftMessageV2RequiredWarning)

                if (giftMessageCharacterLimit) {
                    gbbGiftMessageV2InputFieldsDiv.append(gbbGiftMessageCounterEle)
                }

                gbbGiftMessageV2.append(gbbGiftMessageV2InputFieldsDiv)
                gbbGiftMessageV2.append(gbbGiftMessageV2Divider)
                // gbbGiftMessageV2.append(gbbVideoMsgButton)

                gbbGiftMessageV2HTML.append(gbbGiftMessageV2Label);
                if (gbbGiftMessageV2ToFromContainer) {
                    gbbGiftMessageV2HTML.append(gbbGiftMessageV2ToFromContainer);
                }
                gbbGiftMessageV2HTML.append(gbbGiftMessageV2);
                // gbb.$(".gbbModalContent").html(gbbGiftMessageV2HTML);

                giftMessageV2MainContent.append(gbbGiftMessageV2HTML);

                // let giftMessageV2Buttons = await gbb.gbbGiftMessageV2.f.renderButtons();

                return giftMessageV2MainContent;
            },
            gbbGiftMessageV2ToFromUI: function () {
                let gbbGiftMessageV2ToFromContainer = gbb.$("<div>").addClass("gbbGiftMessageV2ToFromContainer")
                let gbbGiftMessageV2ToField = gbb.$("<input>").addClass("gbbGiftMessageV2ToField").attr("placeholder", gbb.utility.renderLanguageValue(gbb.settings?.languageData?.personalizePage.recipientNamePlaceholder) || "To")
                let gbbGiftMessageV2FromField = gbb.$("<input>").addClass("gbbGiftMessageV2FromField").attr("placeholder", gbb.utility.renderLanguageValue(gbb.settings?.languageData?.personalizePage.senderNamePlaceholder) || "From")

                gbbGiftMessageV2ToFromContainer.append(gbbGiftMessageV2FromField);
                gbbGiftMessageV2ToFromContainer.append(gbbGiftMessageV2ToField)

                if (gbb.utility.getAttributValueFromMessageItem("Sender Name")) {
                    let noteVal = gbb.utility.getAttributValueFromMessageItem("Sender Name");
                    gbbGiftMessageV2FromField.val(noteVal);
                    gbb.gbbPersonalizePage.state.senderName = noteVal;
                }


                gbbGiftMessageV2FromField.on("change", function (event) {
                    gbb.gbbPersonalizePage.state.senderName = gbbGiftMessageV2FromField.val();
                })

                if (gbb.utility.getAttributValueFromMessageItem("Recipient Name")) {
                    let noteVal = gbb.utility.getAttributValueFromMessageItem("Recipient Name");
                    gbbGiftMessageV2ToField.val(noteVal);
                    gbb.gbbPersonalizePage.state.recipientName = noteVal;
                }

                gbbGiftMessageV2ToField.on("change", function (event) {
                    gbb.gbbPersonalizePage.state.recipientName = gbbGiftMessageV2ToField.val();
                })

                return gbbGiftMessageV2ToFromContainer;
            },
            customerUploads: function () {
                let gbbCustomerUploadsHTML = gbb.$("<div>").addClass("gbbCustomerUploadsHTML");
                let gbbCustomerUploadsDivider = gbb.$("<div>").addClass("gbbCustomerUploadsDivider")
                let customerUploadTextFields = gbb.settings.customerUploads.textFields || {};

                // customerUploadTextFields.mainText = "Upload your photos here";
                // customerUploadTextFields.subText = "Supported Formats mp4. Max file size 5MB";

                //let gbbCustomerUploadsMainText, subtext and then a list of dialog
                let gbbCustomerUploadsMainText = gbb.$("<div>").addClass("gbbCustomerUploadsMainText").text(customerUploadTextFields.mainText.value);

                gbb.f.applyLabelCSS(gbbCustomerUploadsMainText)


                let gbbCustomerUploadsSubText = gbb.$("<div>").addClass("gbbCustomerUploadsSubText").text(customerUploadTextFields.subText.value);

                let gbbCustomerUploadsList = gbb.$("<div>").addClass("gbbCustomerUploadsList");

                // gbb.settings.customerUploads.attachmentFields = [{
                //     "label": "Photo 1",
                //     "url": "",
                // },
                // {
                //     "label": "Photo 2",
                //     "url": "",
                // },
                // {
                //     "label": "Photo 3",
                //     "url": "",
                // },
                // {
                //     "label": "Photo 4",
                //     "url": "",
                // }];

                let customerUploadsFields = gbb.settings.customerUploads.attachmentFields;
                //each field has a label
                customerUploadsFields.forEach((field, index) => {
                    let labelToDisplay = gbb.utility.removeFirstCharacterIfUnderscore(field.label);
                    let gbbCustomerUploadsListItem = gbb.$("<div>").addClass("gbbCustomerUploadsListItem").attr("data-field-key", field.label);
                    let gbbCustomerUploadsListItemLabel = gbb.$("<div>").addClass("gbbCustomerUploadsListItemLabel").text(labelToDisplay)


                    //.attr("for", `file-upload-${field.label}`);

                    let gbbCustomerUploadsListItemInput = gbb.$("<input>").addClass("gbbCustomerUploadsListItemInput").attr("type", "file").attr("id", `file-upload-${field.label}`)

                    // gbbCustomerUploadsListItemInput accept. excel, pdf, images .jpg .png .jpeg and videos
                    gbbCustomerUploadsListItemInput.attr("accept", ".xlsx,.xls,application/pdf,image/jpeg,image/png,image/jpg,video/*,image/heif,image/heic")

                    let gbbCustomerUploadsActionButton = gbb.$("<div>").addClass("gbbCustomerUploadsActionButton")

                    gbbCustomerUploadsActionButton.text(customerUploadTextFields.uploadText.value)
                    // gbbCustomerUploadsActionButton.addClass("gbbCustomerUploadButton")

                    let gbbCustomerUploadsButton = gbb.$("<label>").addClass("gbbCustomerUploadButton").attr("for", `file-upload-${field.label}`);
                    // gbbCustomerUploadsActionButton

                    // gbbCustomerUploadsButton.on("click", function (event) {
                    //     event.preventDefault();
                    //     gbbCustomerUploadsListItemInput.trigger("click");
                    // })

                    // gbbCustomerUploadsListItemInput.attr("data-field-index",index)
                    gbbCustomerUploadsListItemInput.attr("data-field-key", field.label);
                    gbbCustomerUploadsListItemInput.on("change", gbb.gbbPersonalizePage.events.onCustomerUploadsFileChange)
                    gbbCustomerUploadsListItem.append(gbbCustomerUploadsListItemLabel)
                    gbbCustomerUploadsListItem.append(gbbCustomerUploadsListItemInput)
                    gbbCustomerUploadsActionButton.append(gbbCustomerUploadsButton)
                    gbbCustomerUploadsListItem.append(gbbCustomerUploadsActionButton);
                    gbbCustomerUploadsList.append(gbbCustomerUploadsListItem);
                })

                let gbbCustomerUploadsErrorMsg = gbb.$("<div>").addClass("gbbCustomerUploadsErrorMsg");


                gbbCustomerUploadsHTML.append(gbbCustomerUploadsMainText)
                gbbCustomerUploadsHTML.append(gbbCustomerUploadsSubText)
                gbbCustomerUploadsHTML.append(gbbCustomerUploadsList)
                gbbCustomerUploadsHTML.append(gbbCustomerUploadsErrorMsg)
                gbbCustomerUploadsHTML.append(gbbCustomerUploadsDivider);

                // gbbCustomerUploadsErrorMsg
                return gbbCustomerUploadsHTML;

            },
            videoMessage: function (settings) {
                let gbbVideoMessageHTML = gbb.$("<div>").addClass("gbbVideoMessageHTML");
                let gbbVideoMsgCheckboxWrapper, gbbVideoMsgButtonGroup;
                let gbbVideoMsgCheckboxLabel;
                let videoId = gbb.utility.getAttributValueFromMessageItem("_videoMsgId");
                //TODO: video message entry index
                if (true) {
                    //gbbVideoMsgButton  = gbb.$("<button>").addClass("gbbVideoMsgButton").attr("type", "button").text(gbb.settings.languageData.videoMessage.sendVideoMessageText.value);
                    gbbVideoMsgButton = gbb.$("<button>").addClass("gbbVideoMsgButton").attr("type", "button").text("Video Msg");
                    gbbVideoMsgCheckboxLabel = gbb.$("<label>").addClass("gbbVideoMsgCheckboxLabel").attr("for", "gbbVideoMsgCheckbox").text(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.sendVideoMessageText) || "Record Video 1");
                    // create a label with switch classname

                    gbb.f.applyLabelCSS(gbbVideoMsgCheckboxLabel)

                    gbbVideoMsgCheckboxWrapper = gbb.$("<label>").addClass("gbbVideoMsgCheckboxWrapper").attr("for", "gbbVideoMsg")

                    //input which is type of checkbox
                    let gbbVideoMsgCheckboxField = gbb.$("<input>").addClass("gbbVideoMsgCheckboxField").attr("type", "checkbox").attr("id", "gbbVideoMsg");


                    if (videoId) {
                        gbbVideoMsgCheckboxField.prop("checked", true);
                    } else {
                        gbbVideoMsgCheckboxField.prop("checked", false);
                    }

                    // a span which is round and slider css
                    let gbbVideoMsgSlider = gbb.$("<span>").addClass("gbbVideoMsgSlider").attr("id", "gbbVideoMsgSlider");

                    gbbVideoMsgButtonGroup = gbb.$("<div>").addClass("gbbVideoMsgButtonGroup");

                    //re record button and upload button
                    // reRecordButton
                    let gbbVideoMsgReRecordButton = gbb.$("<button>").addClass("gbbVideoMsgReRecordButton").attr("type", "button").text(gbb.utility.renderLanguageValue(gbb.settings.languageData?.videoMessage?.reRecordText) || "Re-Record");
                    // uploadButton
                    let gbbVideoMsgSaveButton = gbb.$("<button>").addClass("gbbVideoMsgSaveButton").attr("type", "button").text(gbb.utility.renderLanguageValue(gbb.settings.languageData?.videoMessage?.saveVideoText) || "Save");

                    gbbVideoMsgButtonGroup.append(gbbVideoMsgReRecordButton);

                    gbbVideoMsgButtonGroup.append(gbbVideoMsgSaveButton);


                    gbbVideoMsgSaveButton.on("click", function (event) {
                        if (gbb.gbbVideoMsg.state.justNowRecorded) {
                            gbb.gbbVideoMsg.f.clickAccept(event)
                        } else {
                            return;
                        }
                    });

                    gbbVideoMsgReRecordButton.on("click", function (event) {
                        //manipulate the state of gbbVideoMsgCheckboxField
                        if (gbbVideoMsgCheckboxField.prop("checked")) {
                            gbbVideoMsgCheckboxField.prop("checked", false);
                            gbbVideoMsgSlider.removeClass("gbbVideoMsgSliderActive")
                            gbb.gbbVideoMsg.f.clickClose(event);
                        }
                        gbbVideoMsgCheckboxField.prop("checked", true);
                        gbb.gbbVideoMsg.actions.gbbVideoMsgButton(event);
                    });

                    gbbVideoMsgCheckboxField.on("change", function (event) {
                        if (gbbVideoMsgCheckboxField.is(":checked")) {
                            gbb.gbbVideoMsg.actions.gbbVideoMsgButton(event);
                        } else {
                            gbbVideoMsgSlider.removeClass("gbbVideoMsgSliderActive")
                            gbb.gbbVideoMsg.f.clickClose(event);
                        }
                    })
                    gbbVideoMsgCheckboxWrapper.append(gbbVideoMsgCheckboxField)
                    gbbVideoMsgCheckboxWrapper.append(gbbVideoMsgSlider)

                }
                let videoHasAlreadyBeenRecorded = gbb.$("<div>").addClass("gbbVideoHasAlreadyBeenRecorded");
                //007F60
                videoHasAlreadyBeenRecorded.text("You have already recorded a video")
                // gbbGiftMessageV2InputField and gbbGiftMessageV2Label are added to same parent div
                let gbbVideoMessageCheckboxRow = gbb.$("<div>").addClass("gbbVideoMessageCheckboxRow")
                gbb.f.applyLabelCSS(gbbVideoMsgCheckboxLabel)
                gbbVideoMessageCheckboxRow.append(gbbVideoMsgCheckboxLabel).append(gbbVideoMsgCheckboxWrapper)
                if (gbb.utility.getAttributValueFromMessageItem("_videoMsgId") || gbb.gbbVideoMsg.state.uploadedVideoId) {
                    gbbVideoMessageHTML.append(videoHasAlreadyBeenRecorded)
                }
                gbbVideoMessageHTML.append(gbbVideoMessageCheckboxRow)
                gbb.gbbVideoMsg.init(settings, "", gbbVideoMessageCheckboxRow);

                gbbVideoMessageHTML.append(gbbVideoMsgButtonGroup)
                return gbbVideoMessageHTML;
            },
            scheduleDelivery: async function (settings) {
                let gbbScheduleDeliveryHTML = gbb.$("<div>").addClass("gbbScheduleDeliveryHTML");
                let gbbScheduleDeliveryWrapper = gbb.$("<div>").addClass("gbbScheduleDeliveryWrapper");

                //import date-fns
                try {
                    await gbb.importExternalScript("date-flatpickr");
                    gbb.utility.debugConsole("date-flatpickr imported");
                }
                catch (error) {
                    await gbb.importExternalScript("selfHosted-date-flatpickr");
                    gbb.utility.triggerSlackNotification(error)
                    gbb.utility.debugConsole("date-flatpickr not imported");
                }

                const datePicker = gbb.$("<input>").addClass("gbbScheduleDeliveryDatePicker").attr("type", "date")


                datePicker.attr("placeholder", gbb.utility.renderLanguageValue(gbb.settings.languageData?.reviewPage?.deliverySchedulerPlaceholderText) || "Select Date");
                //append a label to the date picker
                // let gbbScheduleDeliveryDateLabel = gbb.$("<div>").addClass("gbbScheduleDeliveryDateLabel").text(gbb.utility.renderLanguageValue(gbb.settings.languageData?.personalizePage?.deliverySchedulerLabel) || "Schedule Delivery1");
                let gbbScheduleDeliveryDateLabel = gbb.$("<div>").addClass("gbbScheduleDeliveryDateLabel").text(gbb.utility.renderLanguageValue(gbb.settings.languageData?.reviewPage?.deliveryDateLabel) || "Schedule Delivery1");
                //gbb.f.applyLabelCSS(gbbScheduleDeliveryDateLabel)

                gbbScheduleDeliveryWrapper.append(gbbScheduleDeliveryDateLabel)

                gbbScheduleDeliveryWrapper.append(datePicker)
                gbbScheduleDeliveryHTML.append(gbbScheduleDeliveryWrapper);

                return gbbScheduleDeliveryHTML;
            },
            emailAddress: function (settings) {
                let emailAddressHTML = gbb.$("<div>").addClass("gbbEmailAddressHTML");
                let emailAddressWrapper = gbb.$("<div>").addClass("gbbEmailAddressWrapper");

                //introduce an input field to enter the email address
                let gbbVideoMsgEmailField = gbb.$("<input>").addClass("gbbVideoMsgEmailField").attr("type", "email").attr("placeholder", gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.emailAddressPlaceholder) || "Enter Recipient Email Address1");

                let gbbEmailAddressLabelField = gbb.$("<label>").addClass("gbbEmailAddressLabelField").attr("for", "gbbVideoMsgEmailField").text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.emailAddressLabel) || "Recipient Email Address1");

                gbb.f.applyLabelCSS(gbbEmailAddressLabelField)

                gbbVideoMsgEmailField.on("change", function (event) {
                    gbb.gbbVideoMsg.state.emailId = gbbVideoMsgEmailField.val();
                })

                if (gbb.utility.getAttributValueFromMessageItem("Recipient Email") != null) {
                    let value = gbb.utility.getAttributValueFromMessageItem("Recipient Email");
                    gbbVideoMsgEmailField.val(value)
                    gbb.gbbVideoMsg.state.emailId = value;
                    // gbbVideoMsgEmailField
                }
                let giftMessageDeliveryInfo = gbb.$("<div>").addClass("giftMessageDeliveryInfo").text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.videoMessage?.giftMessageDeliveryInfo) || "The message will be sent to the recipient via email as soon as the order is placed.");
                //insert the email field below the video message row

                emailAddressWrapper.append(gbbEmailAddressLabelField);
                emailAddressWrapper.append(gbbVideoMsgEmailField).append(giftMessageDeliveryInfo)

                emailAddressHTML.append(emailAddressWrapper);
                return emailAddressHTML;
            },
            scheduleMessageDelivery: function () {
                let gbbScheduleMessageDeliveryHTML = gbb.$("<div>").addClass("gbbScheduleMessageDeliveryHTML").text("Email Delivery Date");
                let gbbScheduleMessageDeliveryWrapper = gbb.$("<div>").addClass("gbbScheduleMessageDeliveryWrapper");

                let gbbScheduleMessageSendNowContainer = gbb.$("<button>").addClass("gbbScheduleMessageSendNowContainer");
                let gbbScheduleMessageSendLaterContainer = gbb.$("<button>").addClass("gbbScheduleMessageSendLaterContainer");

                let gbbScheduleMessageDatePicker = gbb.$("<input>").attr("type", "date").addClass("gbbScheduleMessageDatePicker");
                gbb.gbbPersonalizePage.state.emailDatePicker = gbbScheduleMessageDatePicker;

                let dateValue;
                let cartDateValue = gbb.utility.getAttributValueFromMessageItem("_gbbEmailDeliveryDate");
                let emailDeliveryOption = gbb.utility.getAttributValueFromMessageItem("_gbbEmailDeliveryOption");
                gbb.gbbPersonalizePage.state.emailDeliveryOption = emailDeliveryOption

                let today = new Date().toISOString().slice(0, 10);

                dateValue = cartDateValue || today;

                gbbScheduleMessageDatePicker.attr("value", dateValue);
                gbbScheduleMessageDatePicker.attr("max", new Date(new Date().getTime() + 30 * 24 * 60 * 60 * 1000).toISOString().slice(0, 10));


                if (emailDeliveryOption == "sendLater") {
                    gbbScheduleMessageSendLaterContainer.addClass("gbbActiveMsgDeliveryOptions");
                    gbbScheduleMessageDatePicker.css("display", "block");
                } else {
                    gbbScheduleMessageSendNowContainer.addClass("gbbActiveMsgDeliveryOptions");
                }

                gbbScheduleMessageSendLaterContainer.on("click", (event) => {
                    gbbScheduleMessageDatePicker.css("display", "block");
                    gbbScheduleMessageSendLaterContainer.addClass("gbbActiveMsgDeliveryOptions");
                    gbbScheduleMessageSendNowContainer.removeClass("gbbActiveMsgDeliveryOptions");
                    gbb.gbbPersonalizePage.state.emailDeliveryOption = "sendLater"
                })

                gbbScheduleMessageSendNowContainer.on("click", () => {
                    gbbScheduleMessageDatePicker.css("display", "none");
                    gbbScheduleMessageSendNowContainer.addClass("gbbActiveMsgDeliveryOptions");
                    gbbScheduleMessageSendLaterContainer.removeClass("gbbActiveMsgDeliveryOptions");
                    gbb.gbbPersonalizePage.state.emailDeliveryOption = "sendNow"
                    gbbScheduleMessageDatePicker.attr("value", today);
                })

                gbbScheduleMessageSendNowContainer.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.personalizePage.sendNow) || "Send Now1");
                gbbScheduleMessageSendLaterContainer.text(gbb.utility.renderLanguageValue(gbb.settings.languageData.personalizePage.sendLater) || "Send Later1");

                gbbScheduleMessageDeliveryWrapper.append(gbbScheduleMessageSendNowContainer);
                gbbScheduleMessageDeliveryWrapper.append(gbbScheduleMessageSendLaterContainer);

                gbbScheduleMessageDeliveryHTML.append(gbbScheduleMessageDeliveryWrapper);
                gbbScheduleMessageDeliveryHTML.append(gbbScheduleMessageDatePicker);


                return gbbScheduleMessageDeliveryHTML;
            }
        },
        action: {
            handlegreetingCardCheckboxEvent: function (event) {
                // gbb.$(".gbbGreetingCardImgContainer").addClass("")
                if (event.target.checked == true) {
                    gbb.$(".gbbGreetingCardImageContainer").removeClass("gbbDisabled");
                    //find gbbGreetingCardImageContainer inside of  greetingCardWrapper
                } else {
                    gbb.$(".gbbGreetingCardImageContainer").addClass("gbbDisabled");
                }
            },
            handleShowAllGreetingCardImagesButtonEvent: function (event) {
                // gbb.$(".greetingCardAllImagesContainer").toggleClass(");
                //hide the
                gbb.utility.debugConsole("Event triggered to show all greeting cards")
            },
            handlegiftWrapCheckboxEvent: function (event) {
                // gbb.$(".gbbGreetingCardImgContainer").addClass("")
                if (event.target.checked == true) {
                    gbb.$(".gbbGiftWrapImageContainer").removeClass("gbbDisabled");
                } else {
                    gbb.$(".gbbGiftWrapImageContainer").addClass("gbbDisabled");
                }
            },
            onClearSelectionButtonClick: async function (productType) {
                let products = gbb.state.giftBoxCartData.items;
                let allVariantIdList;
                if (productType == "greetingCard") {
                    allVariantIdList = gbb.settings.shopifyData?.greetingCardData?.variants?.map((variant) => {
                        return variant.id
                    });
                }
                if (productType == "giftWrap") {
                    allVariantIdList = gbb.settings.shopifyData?.giftWrapData?.variants?.map((variant) => {
                        return variant.id
                    });
                }
                let variantIdsToRemoveFromCart;
                //find all the variant ids in the cart whose properties have _boxProduct as the same as productType
                if (products) {
                    variantIdsToRemoveFromCart = products.map((product) => {
                        //product.properties is an object
                        if (product.properties["_boxProduct"] == productType) {
                            return product.variant_id
                        }
                    })
                    // remove null and undefined values

                    // ["123",undefined,undefined,"456"] -> ["123","456"]
                    variantIdsToRemoveFromCart = variantIdsToRemoveFromCart.filter((variantId) => {
                        return variantId != null || variantId != undefined;
                    })
                    await gbb.utility.removeFromCartBulk(variantIdsToRemoveFromCart, productType);
                }
                if (productType == "greetingCard") {
                    gbb.$(".gbbGreetingCardImageList").find(".gbb_checkmark").remove()
                    gbb.$(".gbbGreetingCardImageList").find(".gbbActiveGreetingCard").removeClass("gbbActiveGreetingCard")
                    gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc = "";
                    gbb.gbbPersonalizePage.state.greetingCardTitle = "";
                    gbb.gbbPersonalizePage.state.greetingCardPrice = "";
                    gbb.$(".gbbGreetingCardCheckboxPrice").text(" ");
                    gbb.$(".gbbGreetingCardCheckboxLabel").text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.selectGreetingCardLabel) || "Greeting Card1");
                }
                if (productType == "giftWrap") {
                    gbb.$(".giftWrapImageList").find(".gbb_checkmark").remove()
                    gbb.$(".giftWrapImageList").find(".activeGiftWrap").removeClass("activeGiftWrap")
                    gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc = "";
                    gbb.gbbPersonalizePage.state.giftWrapTitle = "";
                    gbb.gbbPersonalizePage.state.giftWrapPrice = "";

                    gbb.$(".gbbGiftWrapCheckboxPrice").text(" ");
                    gbb.$(".gbbGiftWrapCheckboxLabel").text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.personalizePage?.giftWrapLabel) || "Select Wrap 1");
                }
                await gbb.utility.getGiftBoxProductsFromCart()
                gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML("personalizePage"));
            },
            onGreetingCardImageClick: async function (event) {
                event.preventDefault();
                //disable gbbGreetingCardImageList pointer events
                gbb.$(".gbbGreetingCardImageList").css("pointer-events", "none");
                // Pass either the image or just trigger this as a callback on Onclick
                let imageSrc;
                imageSrc = gbb.$(this).find("img").attr("src")
                gbb.utility.debugConsole("onclick triggered")
                // gbb.$('.greetingCardImagePreview').attr("src", imageSrc)


                // gbb.utility.addToCart
                //get the image attribute of data-variant-id
                let variantId = gbb.$(this).find("img").attr("data-variant-id");

                await gbb.gbbPersonalizePage.action.onClearSelectionButtonClick("greetingCard");
                gbb.gbbPersonalizePage.state.greetingCardActiveImageSrc = imageSrc


                //find the variant_title and price from the variantId by looping over gbb.settings.shopifyData.greetingCardData?.variants
                let variantTitle = "";
                let variantPrice = "";
                gbb.settings.shopifyData?.greetingCardData?.variants?.forEach((variant) => {
                    if (variant.id == variantId) {
                        variantTitle = variant.title;
                        variantPrice = variant.price;
                    }
                })
                if (variantTitle) {
                    gbb.gbbPersonalizePage.state.greetingCardTitle = variantTitle;
                    // gbb.$(".gbbGreetingCardCheckboxLabel").text(gbb.gbbPersonalizePage.state.greetingCardTitle)
                }
                gbb.$(this).find("input").prop("checked", true)
                gbb.$(this).addClass("gbbActiveGreetingCard")
                // add an icon on top of it
                gbb.gbbPersonalizePage.action.addCheckMarkDivs(gbb.$(this))
                gbb.gbbPersonalizePage.action.removeCheckmarkDivsFromSiblings(gbb.$(this))


                await gbb.utility.updateCartV2({ updates: { [variantId]: 1 }, attributes: { [variantId]: "greetingCard" } })
                gbb.$(".gbbGreetingCardImageList").css("pointer-events", "auto");
                await gbb.utility.getGiftBoxProductsFromCart();
                gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML("personalizePage"));
            },
            onGiftWrapImageClick: async function (event) {
                event.preventDefault();
                gbb.$(".giftWrapImageList").css("pointer-events", "none");
                // Pass either the image or just trigger this as a callback on Onclick
                let imageSrc;
                imageSrc = gbb.$(this).find("img").attr("src")

                await gbb.gbbPersonalizePage.action.onClearSelectionButtonClick("giftWrap");
                // gbb.$('.greetingCardImagePreview').attr("src", imageSrc)
                gbb.gbbPersonalizePage.state.giftWrapActiveImageSrc = imageSrc

                gbb.$(this).find("input").prop("checked", true)
                gbb.$(this).addClass("activeGiftWrap")
                // add an icon on top of it
                gbb.gbbPersonalizePage.action.addCheckMarkDivs(gbb.$(this))
                gbb.gbbPersonalizePage.action.removeCheckmarkDivsFromSiblings(gbb.$(this))
                // gbb.utility.addToCart
                //get the image attribute of data-variant-id
                // gbb.gbbPersonalizePage.f.activateClearSelectionButton("giftWrapImageList","giftWrap");

                let variantId = gbb.$(this).find("img").attr("data-variant-id");


                //find the variant_title and price from the variantId by looping over gbb.settings.shopifyData.greetingCardData?.variants
                let variantTitle = "";
                let variantPrice = "";
                gbb.settings?.shopifyData?.giftWrapData?.variants?.forEach((variant) => {
                    if (variant.id == variantId) {
                        variantTitle = variant.title;
                        variantPrice = variant.price;
                    }

                })
                if (variantTitle) {
                    gbb.gbbPersonalizePage.state.giftWrapTitle = variantTitle;
                }
                if (variantPrice) {
                    gbb.gbbPersonalizePage.state.giftWrapPrice = gbb.utility.formatPrice(variantPrice);
                }

                // gbbGiftWrapCheckboxLabel
                gbb.$(".gbbGiftWrapCheckboxLabel").text(gbb.gbbPersonalizePage.state.giftWrapTitle)
                gbb.$(".gbbGiftWrapCheckboxPrice").text(gbb.gbbPersonalizePage.state.giftWrapPrice)


                await gbb.utility.updateCartV2({ updates: { [variantId]: 1 }, attributes: { [variantId]: "giftWrap" } })
                gbb.$(".giftWrapImageList").css("pointer-events", "auto");
                await gbb.utility.getGiftBoxProductsFromCart()
                gbb.$(".gbbPageFooterHTML").replaceWith(gbb.f.renderCartProductsFooterHTML("personalizePage"));
            },
            findSelectedGreetingCardImage: function () {
                let selectedGreetingCardImage = gbb.$(".greetingCardImageContainer").find(".gbbActiveGreetingCard")
                return selectedGreetingCardImage
            },
            removeCheckmarkDivsFromSiblings: function (element) {
                element.siblings().find(".gbb_checkmark").remove()
                element.siblings().removeClass("gbbActiveGreetingCard")
            },
            removeCheckmarkDivsFromGreetingCards: function () {
                gbb.$(".gbbGreetingCardImageList").find(".gbb_checkmark").remove()
                gbb.$(".gbbGreetingCardImageList").find(".gbbActiveGreetingCard").removeClass("gbbActiveGreetingCard")
            },
            removeCheckmarkDivsFromGiftWrap: function () {
                gbb.$(".giftWrapImageList").find(".gbb_checkmark").remove()
                gbb.$(".giftWrapImageList").find(".activeGiftWrap").removeClass("activeGiftWrap")
            },
            addCheckMarkDivs: function (element) {
                let checkMarkDiv = gbb.$("<span>").addClass("gbb_checkmark")
                checkMarkDiv.append(gbb.$("<div>").addClass("gbb_checkmark_circle"))
                checkMarkDiv.append(gbb.$("<div>").addClass("gbb_checkmark_stem"))
                checkMarkDiv.append(gbb.$("<div>").addClass("gbb_checkmark_kick"))
                element.append(checkMarkDiv)
            },

            showPersonalizationPage: async function () {
                //updatePageStatusFn
                // gbb.gbbAddProductsPage.state.updatePageStatusFn(1);
                let pageId = "personalizationPage";
                await gbb.gbbAddProductsPage.f.renderNextPage(pageId)
            },

            uploadCustomerUploadsFile: async function (fileBlob, fieldKey) {
                try {
                    let formData = new FormData();

                    formData.append("shopName", gbb.settings.merchantInfo.shopName);
                    formData.append("upload_data", fileBlob);
                    formData.append("fieldKey", fieldKey);
                    // formData.append("fileExtension", fileExtension);
                    // formData.append("fileType", fileExtension);
                    // formData.append("fieldKey", fieldKey);
                    formData.append("upload_preset", "gbb_customer_uploads");
                    let response = await fetch("/apps/" + gbb.state.gbbUrl + "/upload/fileUploads", {
                        method: "POST",
                        body: formData
                    });
                    let data = await response.json();
                    return data;
                } catch (e) {
                    gbb.utility.debugConsole(e)
                    return false;
                }
            },
            refreshCustomerUploadsErrorMessage: function (buttonRef) {
                // fileSizeError
                // fileUploadError     

                try {
                    let fileSizeErrorText = gbb.settings.customerUploads.textFields.fileSizeError.value;
                    let fileUploadErrorText = gbb.settings.customerUploads.textFields.fileUploadError.value;
                    let fileNotSupportedText = gbb.settings.customerUploads.textFields.fileNotSupportedError.value;

                    let errorMsgField = gbb.$(".gbbCustomerUploadsErrorMsg");

                    if (errorMsgField) {
                        errorMsgField.html(" ");
                        const objectKeys = Object.keys(gbb.gbbPersonalizePage.state.customerUploadsErrors)

                        for (let i = 0; i < objectKeys.length; i++) {
                            let currentKey = objectKeys[i];
                            let currentItem = gbb.gbbPersonalizePage.state.customerUploadsErrors[currentKey];
                            if (currentItem) {
                                let isFileSizeError = currentItem.fileSizeError;
                                let isFileUploadError = currentItem.fileUploadError;
                                let isFileNotSupported = currentItem.fileNotSupportedError;
                                if (isFileSizeError) {
                                    errorMsgField.append(currentKey + " - " + fileSizeErrorText + "<br/>");
                                }
                                if (isFileUploadError) {
                                    errorMsgField.append(currentKey + " - " + fileUploadErrorText + "<br/>");
                                }
                                if (isFileNotSupported) {
                                    errorMsgField.append(currentKey + " - " + fileNotSupportedText + "<br/>");
                                }

                            }
                        }
                    } else {
                        gbb.utility.debugConsole("field not found")
                    }


                } catch (error) {
                    gbb.utility.debugConsole(error)
                    return;
                }

            },

            refreshCustomerUploadsList: function () {
                try {
                    let customerUploadsList = gbb.$(".gbbCustomerUploadsList");
                    //getCartAttributes
                    //filter attributes to get only those keys that are in customerUploads.fields
                    let customerUploadFields = gbb.settings.customerUploads.attachmentFields;

                    let customerUploads = {};
                    if (!customerUploadFields || !customerUploadFields?.length) {
                        return;
                    }
                    for (let i = 0; i < customerUploadFields?.length; i++) {
                        let currentKey = customerUploadFields[i].label;
                        let imageURL = gbb.utility.getAttributValueFromMessageItem(currentKey);
                        if (imageURL) {
                            customerUploads[currentKey] = imageURL;
                        }
                    }

                    // this occurs when the state is empty, often when the page is refreshed
                    if (gbb.gbbPersonalizePage.state.customerUploadsResponse == null) {
                        gbb.gbbPersonalizePage.state.customerUploadsResponse = customerUploads;
                    }

                    let customerUploadsTextFields = gbb.settings.customerUploads.textFields || {};
                    if (customerUploadsList) {
                        for (let i = 0; i < customerUploadFields.length; i++) {
                            let currentKey = customerUploadFields[i].label;
                            let currentItem = gbb.gbbPersonalizePage.state.customerUploadsResponse[currentKey];
                            let currentListItem = gbb.$(".gbbCustomerUploadsListItem[data-field-key='" + currentKey + "']");
                            let gbbCustomerUploadsActionButton = currentListItem.find(".gbbCustomerUploadsActionButton");
                            if (currentItem) {
                                if (currentListItem) {
                                    //currentListItem has a gbbCustomerUploadsActionButton that should be hidden 
                                    let removeButton = currentListItem.find(".gbbCustomerUploadsRemoveButton");
                                    gbbCustomerUploadsActionButton.removeClass("gbbDisabled");
                                    let previewButton = gbb.$("<div>").addClass("gbbCustomerUploadPreviewButton").text(customerUploadsTextFields.previewText.value || "Preview");

                                    //remove all previous on click events from the button

                                    // gbbCustomerUploadsActionButton.addClass("gbbCustomerUploadPreviewButton")
                                    // gbbCustomerUploadsActionButton.removeClass("gbbCustomerUploadButton")

                                    // gbbCustomerUploadsActionButton.off("click");
                                    previewButton.on("click", function () {
                                        gbb.utility.debugConsole("Clicked on preview from current Item");
                                        window.open(currentItem, '_blank')
                                    });

                                    if (removeButton.length > 0 == false) {
                                        removeButton = gbb.$("<div>").addClass("gbbCustomerUploadsRemoveButton")
                                    }

                                    removeButton.html(CONSTANT_CLOSE_ICON_SVG)


                                    //add a remove button
                                    removeButton.on("click", function () {
                                        gbb.utility.debugConsole("remove button clicked")
                                        currentListItem.find(".gbbCustomerUploadsListItemInput").val("");
                                        gbb.gbbPersonalizePage.f.deleteCustomerUploadsError(currentKey);
                                        gbb.gbbPersonalizePage.f.deleteCustomerUploadsResponse(currentKey);

                                        gbb.gbbPersonalizePage.action.refreshCustomerUploadsList();
                                    });
                                    gbbCustomerUploadsActionButton.html(previewButton)
                                    currentListItem.append(removeButton);
                                }
                            } else {
                                gbb.utility.debugConsole("currentListItem not found")
                                gbbCustomerUploadsActionButton.removeClass("gbbDisabled");
                                // gbbCustomerUploadsActionButton.text(customerUploadsTextFields.uploadText.value || "Upload");
                                // gbbCustomerUploadsActionButton.removeClass("")
                                // gbbCustomerUploadsActionButton.addClass("gbbCustomerUploadButton")
                                //remove the previous click event
                                // gbbCustomerUploadsActionButton.off("click");
                                let gbbCustomerUploadButton = gbb.$("<label>").addClass("gbbCustomerUploadButton").text(customerUploadsTextFields.uploadText.value || "Upload").attr("for", `file-upload-${currentKey}`);
                                // gbbCustomerUploadButton.on("click",function(event){
                                //     gbb.utility.debugConsole("Clicked on upload from current Item");
                                //     event.preventDefault();
                                //     currentListItem.find(".gbbCustomerUploadsListItemInput").trigger("click");
                                // });
                                gbbCustomerUploadsActionButton.html(gbbCustomerUploadButton);
                                gbb.$(currentListItem).find(".gbbCustomerUploadsRemoveButton").remove();
                            }
                        }
                    }
                    gbb.utility.debugConsole("list refreshed")
                } catch (error) {
                    gbb.utility.debugConsole(error)
                }
            },
        }
    },
    gbbProductFormStep: {
        state: {
            formSubmissionData: {},
        },
        components: {
            prepareTextHTML: function (formData, productData) {

                gbb.gbbProductFormStep.f.initFormSubmissionData(formData, productData);

                // Container creation
                let container = gbb.$("<div>").addClass("gbbProductFormTextContainer").attr("fieldKey", formData.fieldKey)

                // Label creation
                let label = gbb.$("<div>").addClass("gbbProductFormTextLabel").text(formData.fieldLabel);
                container.append(label);

                // Validation message and character count
                let validationContainer = gbb.$("<div>").addClass("gbbProductFormValidationContainer");
                let validationMessage = gbb.$("<div>").addClass("gbbRequiredFieldMessage").text(formData.validationMessage)

                validationMessage.hide();


                let isRenderMultiLineInput = formData?.allowMultiLineText || false;

                // Input field creation
                let inputField;
                if (isRenderMultiLineInput) {
                    inputField = gbb.$("<textarea>").addClass("gbbProductFormText").attr({
                        placeholder: formData.placeholderText,
                        fieldKey: formData.fieldKey,
                        isMandatory: formData.isMandatory,
                        minCharacterLimit: formData?.minCharacterLimit || 0,
                        maxCharacterLimit: formData?.maxCharacterLimit || 99999
                    });
                } else {
                    inputField = gbb.$("<input>").addClass("gbbProductFormText").attr({
                        placeholder: formData.placeholderText,
                        type: "text",
                        fieldKey: formData.fieldKey,
                        isMandatory: formData.isMandatory,
                        minCharacterLimit: formData?.minCharacterLimit || 0,
                        maxCharacterLimit: formData?.maxCharacterLimit || 99999
                    });
                }
               // Initial value and character count
                let initialValue = gbb.gbbProductFormStep.state.formSubmissionData[formData.fieldKey]?.value || "";
                inputField.val(initialValue);

                // Character count display creation
                let characterCount = gbb.$("<div>").addClass("gbbProductFormTextCharacterCount").text(initialValue.length + "/" + formData.maxCharacterLimit);
                if (!formData?.maxCharacterLimit) {
                    characterCount.hide();
                }

                // On key up event
                inputField.on("keyup", function (e) {
                    gbb.gbbProductFormStep.f.handleInputChange(gbb.$(this), validationMessage, characterCount);
                });

                container.append(inputField);
                validationContainer.append(validationMessage, characterCount);
                container.append(validationContainer);

                return container;
            },

            prepareImageSelectorHTML: function (formData, productData) {
                gbb.gbbProductFormStep.f.initFormSubmissionData(formData, productData);

                // Initialize variables
                let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData;
                let fieldKey = formData.fieldKey;
                let images = formData.images;
                let selectedImage = formSubmissionData[fieldKey]?.value || "";

                // Create main container
                // // let gbbProductFormImageSelectorContainer = createContainer("gbbProductFormImageSelectorContainer", formData.fieldLabel);
                // let gbbProductFormImageSelectorContainer = gbb.$("<div>").addClass("gbbProductFormImageSelectorContainer");


                // // Create image list container
                // let gbbProductFormImageSelectorListContainer = createContainer("gbbProductFormImageSelectorListContainer");

                let gbbProductFormImageSelectorContainer = gbb.$("<div>").addClass("gbbProductFormImageSelectorContainer").attr("fieldKey", fieldKey)
                let gbbProductFormImageSelectorLabel = gbb.$("<div>").addClass("gbbProductFormImageSelectorLabel").text(formData.fieldLabel);
                let gbbProductFormImageSelectorListContainer = gbb.$("<div>").addClass("gbbProductFormImageSelectorListContainer");

                // Create image list
                let gbbProductFormImageSelectorListItems = gbb.$("<div>").addClass("gbbProductFormImageSelectorListItems");


                // Validation message and character count
                let validationContainer = gbb.$("<div>").addClass("gbbProductFormValidationContainer");
                let validationMessage = gbb.$("<div>").addClass("gbbRequiredFieldMessage").text(formData.validationMessage)

                validationMessage.hide();


                // If mandatory, select first image
                if (false && formData.isMandatory && images.length > 0) {
                    selectedImage = images[0].imageCaption;
                }

                // Create image list items
                images.forEach(image => {
                    let currentImageListItem = gbb.gbbProductFormStep.f.createImageListItem(image, fieldKey, selectedImage);
                    gbbProductFormImageSelectorListItems.append(currentImageListItem);
                });

                // Append list items to the list container
                let gbbProductFormImageSelectorList = gbb.$("<div>").addClass("gbbProductFormImageSelectorList");
                gbbProductFormImageSelectorList.append(gbbProductFormImageSelectorListItems);

                // Append list container to the main container
                validationContainer.append(validationMessage);

                gbbProductFormImageSelectorListContainer.append(gbbProductFormImageSelectorList);
                gbbProductFormImageSelectorContainer.append(gbbProductFormImageSelectorLabel);
                gbbProductFormImageSelectorContainer.append(gbbProductFormImageSelectorListContainer);
                gbbProductFormImageSelectorContainer.append(validationContainer);

                return gbbProductFormImageSelectorContainer;


            },
            prepareRadioHTML: function (formData) {

                gbb.gbbProductFormStep.f.initFormSubmissionData(formData);

                // Initialize variables
                let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData;
                let fieldKey = formData.fieldKey;
                let options = formData.options;
                let selectedOption = formSubmissionData[fieldKey]?.value || "";

                // Create main container
                let gbbProductFormRadioContainer = gbb.$("<div>").addClass("gbbProductFormRadioContainer").attr("fieldKey", fieldKey);
                let gbbProductFormRadioLabel = gbb.$("<div>").addClass("gbbProductFormRadioLabel");
                gbbProductFormRadioLabel.text(formData.fieldLabel);
                gbbProductFormRadioContainer.append(gbbProductFormRadioLabel);

                // Create radio list container
                let gbbProductFormRadioListContainer = gbb.$("<div>").addClass("gbbProductFormRadioListContainer");

                // Create radio list
                let gbbProductFormRadioListItems = gbb.$("<div>").addClass("gbbProductFormRadioListItems");

                // If mandatory, select first option
                if (formData.isMandatory && options.length > 0) {
                    selectedOption = options[0].value;
                }

                // Create radio list items
                options.forEach((option) => {
                    let currentRadioListItem = gbb.gbbProductFormStep.f.createRadioListItem(option, fieldKey, selectedOption);
                    gbbProductFormRadioListItems.append(currentRadioListItem);
                });

                // Append list items to the list container
                let gbbProductFormRadioList = gbb.$("<div>").addClass("gbbProductFormRadioList");
                gbbProductFormRadioList.append(gbbProductFormRadioListItems);

                // Append list container to the main container
                gbbProductFormRadioListContainer.append(gbbProductFormRadioList);
                gbbProductFormRadioContainer.append(gbbProductFormRadioListContainer);

                return gbbProductFormRadioContainer;



            },

        },
        f: {
            prepareFormToBeRenderedHTML: function (form, product) {

                gbb.gbbProductFormStep.state.formSubmissionData = {};

                // gbb.gbbAddProductsPage.state.productPersonalizationData has a block known as formblock
                //formBlocks: [
                // {
                //     type: "text",
                //     fieldLabel: "Your Name",
                //     fieldKey: "customerNameKey", // this will be used in SF as product attribute.
                //     placeholderText: "Enter your name",
                //     isMandatory: true,
                //     min and max character limit
                //     minCharacterLimit: 2,
                //     maxCharacterLimit: 10,
                //     validationMessage: "Name field is required"
                // },
                // 
                let gbbProductFormContainer = gbb.$("<div>").addClass("gbbProductFormContainer");
                let formComponentDiv;
                let productPersonalizationDataFormBlocks = gbb.gbbAddProductsPage.state.productPersonalizationData?.formBlocks || [];
                productPersonalizationDataFormBlocks.forEach((formBlock) => {
                    switch (formBlock.type) {
                        case "TEXT":
                            formComponentDiv = gbb.gbbProductFormStep.components.prepareTextHTML(formBlock, product);
                            break;
                        case "IMAGE_SELECTOR":
                            formComponentDiv = gbb.gbbProductFormStep.components.prepareImageSelectorHTML(formBlock, product);
                            break;
                        case "RADIO":
                            formComponentDiv = gbb.gbbProductFormStep.components.prepareRadioHTML(formBlock, product);
                            break;

                        // case "radio":
                        //     formComponentDiv = gbb.f.prepareRadioHTML(formBlock);
                        //     break;
                        // case "checkbox":
                        //     formComponentDiv = gbb.f.prepareCheckboxHTML(formBlock);
                        //     break;
                        // case "imageSelector":
                        //     formComponentDiv = gbb.f.prepareImageSelectorHTML(formBlock);
                        //     break;
                        // case default:
                        //     break;
                    }
                    gbbProductFormContainer.append(formComponentDiv);
                })

                return gbbProductFormContainer;

            },
            // formSubmissionData
            initFormSubmissionData: function (formData, productData) {
                try {
                    let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData;
                    let fieldKey = formData.fieldKey;
                    formSubmissionData[fieldKey] = {
                        ...gbb.gbbProductFormStep.state.formSubmissionData[fieldKey],
                        fieldLabel: formData.fieldLabel,
                        type: formData.type,
                        value: "",
                        isValid: formData.isMandatory ? false : true,
                        isMandatory: formData.isMandatory,
                        showValueOnSummaryPage: formData?.showValueOnSummaryPage || false,
                    }

                    // let retreiveProductFormTextFromCart = gbb.gbbProductFormStep.f.retreiveProductFormTextFromCart(fieldKey,productData);

                    // if(retreiveProductFormTextFromCart){
                    //     formSubmissionData[fieldKey] = {
                    //         value : retreiveProductFormTextFromCart,
                    //         isValid: true,
                    //         isMandatory : formData.isMandatory,
                    //     }
                    // }

                    gbb.gbbProductFormStep.state.formSubmissionData = formSubmissionData;
                } catch (error) {
                    gbb.utility.debugConsole(error)
                }
            },
            handleFormSubmissionData: function (key, data) {
                gbb.utility.debugConsole("Data to be updated is", data);
                let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData;
                formSubmissionData[key] = {
                    // value: value,
                    ...formSubmissionData[key],
                    ...data,
                }
                gbb.gbbProductFormStep.state.formSubmissionData = formSubmissionData;

                // let currentVariantData = JSON.parse(JSON.stringify(gbb.state.variantCustomProperties));
                // currentVariantData[key] = value;
                // gbb.state.variantCustomProperties = currentVariantData;
            },
            checkFormValidationForProduct: function () {
                let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData || {};
                let isFormValid = true;
                let formSubmissionDataKeys = Object.keys(formSubmissionData);
                for (let i = 0; i < formSubmissionDataKeys.length; i++) {
                    let currentKey = formSubmissionDataKeys[i];
                    let currentData = formSubmissionData[currentKey];
                    if (currentData.isValid == false) {
                        isFormValid = false;
                        break;
                    }
                }
                return isFormValid;
            },
            displayRequiredFieldMessage: function () {
                let formSubmissionData = gbb.gbbProductFormStep.state.formSubmissionData || {};
                let formSubmissionDataKeys = Object.keys(formSubmissionData);
                for (let i = 0; i < formSubmissionDataKeys.length; i++) {
                    let currentKey = formSubmissionDataKeys[i];
                    let currentData = formSubmissionData[currentKey];
                    let currentInput = gbb.$(`[fieldKey="${currentKey}"]`);
                    let currentInputRequiredFieldMessage = currentInput.find(".gbbRequiredFieldMessage");
                    if (currentData.isValid == false) {
                        currentInputRequiredFieldMessage.css("display", "block");
                    } else {
                        currentInputRequiredFieldMessage.css("display", "none");
                    }
                }
            },
            retreiveProductFormTextFromCart: function (key, product) {
                // let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
                let cartData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(gbb.state.activeBoxId)
                let productFormText = "";
                if (cartData && cartData.items.length > 0) {
                    // let itemsInTheCart = cartData.boxes[gbb.state.activeBoxId].items;
                    let itemsInTheCart = cartData.items;
                    let productInCart = itemsInTheCart.find((item) => {
                        return item.product_id == product.id;
                    })
                    if (productInCart && productInCart.properties) {
                        let properties = productInCart.properties;
                        if (properties && properties[key]) {
                            productFormText = properties[key];
                        }
                    }
                }
                return productFormText;
            },
            handleInputChange: function (currentInput, validationMessage, characterCount) {
                let currentValue = currentInput.val();
                let minLimit = parseInt(currentInput.attr("minCharacterLimit")) || 1;
                let maxLimit = currentInput.attr("maxCharacterLimit");
                let isMandatory = currentInput.attr("isMandatory") == "true";
                let fieldKey = currentInput.attr("fieldKey");
                let isValidationPassed = true;
                let characterCountText = currentValue.length + "/" + maxLimit;

                if (isMandatory && (currentValue.length < minLimit || currentValue.length > maxLimit)) {
                    isValidationPassed = false;
                    //dont show validation message now, we will show it later
                    //when user clicks on Add TO box
                    // validationMessage.show();
                } else {
                    validationMessage.hide();
                }

                if (currentValue.length > maxLimit) {
                    currentInput.val(currentValue.substring(0, maxLimit));
                    currentValue = currentInput.val();
                    characterCountText = maxLimit + "/" + maxLimit;
                }

                characterCount.text(characterCountText);
                gbb.gbbProductFormStep.f.handleFormSubmissionData(fieldKey, { value: currentValue, isValid: isValidationPassed });
            },
            createImageListItem: function (image, fieldKey, selectedImage) {
                let currentImageListItem = gbb.$("<div>").addClass("gbbProductFormImageSelectorListItem");
                let currentImageLabel = gbb.$("<label>").addClass("gbbPersonalizationImageLabel").attr("fieldKey", fieldKey)
                let captionSpan = gbb.$("<span>").addClass("gbbPersonalizationImageCaption").text(image.imageCaption);
                let currentImageListItemRadio = gbb.$("<input>").addClass("personalizationImageInput").attr("type", "radio").attr("name", fieldKey).attr("value", image.imageCaption).attr("fieldKey", fieldKey);
                let currentImageListItemImage = gbb.$("<img>").addClass("personalizationImage").attr("src", image.url).attr("fieldKey", fieldKey);

                currentImageLabel.append(currentImageListItemRadio, currentImageListItemImage);
                currentImageLabel.append(captionSpan);

                currentImageListItem.append(currentImageLabel);


                currentImageListItemRadio.on("click", function (event) {
                    gbb.gbbProductFormStep.f.handleImageSelection(gbb.$(this), currentImageListItem);
                });

                if (selectedImage == image.imageCaption) {
                    currentImageListItemRadio.trigger("click");
                }

                return currentImageListItem;
            },
            handleImageSelection: function (selectedRadio, currentListItem) {
                let radioValue = selectedRadio.val();
                let radioName = selectedRadio.attr("name");

                gbb.gbbProductFormStep.f.handleFormSubmissionData(radioName, { value: radioValue, isValid: true });

                currentListItem.addClass("gbbActiveImageSelectorListItem");
                currentListItem.siblings().removeClass("gbbActiveImageSelectorListItem");

                currentListItem.find(".gbb_checkmark").remove();
                gbb.gbbPersonalizePage.action.addCheckMarkDivs(currentListItem);
                gbb.gbbPersonalizePage.action.removeCheckmarkDivsFromSiblings(currentListItem);
            },
            createRadioListItem: function (option, fieldKey, selectedOption) {
                let currentRadioListItem = gbb.$("<div>").addClass("gbbProductFormRadioListItem");
                let currentRadioLabel = gbb.$("<label>").addClass("gbbpersonalizationRadioLabel").attr("fieldKey", fieldKey);
                let currentRadioItemRadio = gbb.$("<input>").addClass("personalizationRadioInput").attr("type", "radio").attr("name", fieldKey).attr("value", option.value).attr("fieldKey", fieldKey);
                let currentRadioListItemLabel = gbb.$("<span>").addClass("personalizationRadioLabel").text(option.label).attr("fieldKey", fieldKey);

                currentRadioLabel.append(currentRadioItemRadio, currentRadioListItemLabel);
                currentRadioListItem.append(currentRadioLabel);

                currentRadioItemRadio.on("click", function (event) {
                    gbb.gbbProductFormStep.f.handleRadioSelection(gbb.$(this), currentRadioListItem);
                });

                if (selectedOption == option.value) {
                    currentRadioItemRadio.trigger("click");
                }

                return currentRadioListItem;
            },

            handleRadioSelection: function (selectedRadio, currentListItem) {
                let radioValue = selectedRadio.val();
                let radioName = selectedRadio.attr("name");

                gbb.gbbProductFormStep.f.handleFormSubmissionData(radioName, { value: radioValue, isValid: true });

                currentListItem.addClass("gbbActiveRadioSelectorListItem");
                currentListItem.siblings().removeClass("gbbActiveRadioSelectorListItem");
            }

        }
    },
    gbbReviewPage: {
        state: {
            buildBoxButtonAction: undefined,
            ReviewPageBody: ""
        },
        init: async function (settings, parent) {
            if (true || gbb.state.currentPageId !== 'reviewPage') {
                gbb.gbbBrowser.emitCustomEvent({
                    eventName: 'gbb-page-init',
                    detail: {
                        prevPageId: gbb.state.currentPageId,
                        activePageId: 'reviewPage'
                    }
                })
            }
            gbb.state.currentPageId = "reviewPage"
            if (gbb?.gbbAddProductsPage?.state?.productPageData) {
                gbb.gbbAddProductsPage.state.productPageData = undefined
            }
            let navItem = gbb.utility.getNavItem(gbb.state.currentPageId)
            gbb.f.markPreviousNavigationItemsAsCompleted(navItem)
            let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage();
            if (cartData && Object.keys(cartData.boxes).length > 0 && gbb.gbbBrowser.getProductsFromAllBoxesFromCart()?.length > 0 && !gbb.gbbReviewPage.f.checkIfAllBoxesHaveZeroPrice(cartData)) {
                await gbb.gbbReviewPage.initialize(settings, parent)
                await gbb.utility.getGiftBoxProductsFromCart(); //#TBD
            } else {
                await gbb.gbbReviewPage.renderEmptyState();
            }
            gbb.utility.renderTemporaryLoadingSpinner("hide")

            gbb.gbbReviewPage.f.registerEvents(settings)


            // gbb.gbbModel.init(settings)
        },
        renderEmptyState: async function () {

            let gbbEmptySummaryPageWrapper = gbb.$("<div>").addClass("gbbEmptySummaryPageWrapper");
            let gbbSummaryPageHTML = gbb.$("<div>").addClass("gbbSummaryPageBodyHTML");
            const EmptySummaryPageBanner = gbb.$("<div>").addClass("gbbEmptySummaryPageBanner");
            //all the text and button goes in this div
            const EmptySummaryPageBannerImage = gbb.$("<img>").addClass("gbbEmptySummaryPageBannerImage");
            const EmptySummaryPageBannerTextWrapper = gbb.$("<div>").addClass("gbbEmptySummaryPageBannerTextWrapper")
                .css("color", gbb.settings?.pageCustomizationData?.SummaryPage?.bannerTextColor)
                .css("width", "100%");
            const EmptySummaryPageBannerText = gbb.$("<div>").addClass("gbbEmptySummaryPageBannerText");
            const EmptySummaryPageAction = gbb.$("<div>").addClass("EmptySummaryPageAction");

            EmptySummaryPageAction.text(gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageEmptyStateBannerButtonText || DEFAULT_EMPTY_REVIEWPAGE_BUTTONTEXT);
            EmptySummaryPageAction.on("click", function (event) {
                gbb.gbbBrowser.initializeRelevantBoxQuantity();
                gbb.state.currentPageId = gbb.state.navigationItems[0]['id'];
                let firstPageItem = gbb.f.getNavItem(gbb.state.currentPageId);
                firstPageItem.initFn();
                gbb.f.addParamsToUrl("page", firstPageItem.id)
            })
            //subtext
            const EmptySummaryPageBannerSubText = gbb.$("<div>").addClass("gbbEmptySummaryPageBannerSubText");
            EmptySummaryPageBannerImage.attr("src", gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageEmptyStateBanner || DEFAULT_EMPTY_REVIEWPAGE_BANNER);

            EmptySummaryPageBannerText.text(gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageEmptyStateBannerText);
            EmptySummaryPageBannerSubText.text(gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageEmptyStateBannerSubText);

            EmptySummaryPageBannerTextWrapper.append(EmptySummaryPageBannerText);
            EmptySummaryPageBannerTextWrapper.append(EmptySummaryPageAction);
            EmptySummaryPageBannerTextWrapper.append(EmptySummaryPageBannerSubText);

            EmptySummaryPageBanner.append(EmptySummaryPageBannerImage);

            gbbSummaryPageHTML.append(EmptySummaryPageBanner);
            gbbSummaryPageHTML.append(EmptySummaryPageBannerTextWrapper);
            gbbEmptySummaryPageWrapper.append(gbbSummaryPageHTML);

            gbb.state.ReviewPageBody = gbbEmptySummaryPageWrapper;
            gbb.gbbReviewPage.f.insertIntoMainPageWrapper();
        },
        initialize: async function (settings, parent) {

            // gbb.utility.debugConsole("settings:",settings.giftwrap);
            // let {isEnabledOnProductPage, isEnabledOnCartPage} = gbb.gbbLandingPage.f.checkifGiftWrapEnabled(settings.giftwrap, productHandle, parent)
            // if (isEnabledOnProductPage) {
            const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()
            let gbbSummaryPageWrapper = gbb.$("<div>").addClass("gbbSummaryPageWrapper");
            if (isPurchaseTypeSubscription) { 
                gbbSummaryPageWrapper.addClass('gbbSubscriptionBundle')
            }
            const gbbSummaryPageHeaderHTML = gbb.gbbReviewPage.f.prepareHeader();
            const gbbDiscountComponent = gbb.$("<div>").addClass("gbbDiscountComponent");
            const gbbSummaryPageBodyHTML = await gbb.gbbReviewPage.f.prepareUIV2();
            // const gbbReviewPageFooterHTML = gbb.gbbReviewPage.f.prepareFooter();

            gbbSummaryPageWrapper.append(gbbSummaryPageHeaderHTML);
            gbbSummaryPageWrapper.append(gbbDiscountComponent);
            gbbSummaryPageWrapper.append(gbbSummaryPageBodyHTML);
            // gbbSummaryPageWrapper.append(gbbReviewPageFooterHTML);

            gbb.state.ReviewPageBody = gbbSummaryPageWrapper;
            gbb.gbbReviewPage.f.insertIntoMainPageWrapper();

            gbb.$("body").attr("data-page", gbb.state.currentPageId)

            // const gbbScheduleDeliveryWrapper = gbb.$();
            //find the selector which is in DEFAULT_scheduleDeliveryPickerSelector
            let gbbSummaryPageDeliveryAndOrderDetailsUI = gbb.$(document).find(".gbbSummaryPageDeliverOrderDetailsDiv");
            gbbSummaryPageDeliveryAndOrderDetailsUI.append(await gbb.gbbReviewPage.f.prepareDeliveryAndOrderDetailsUI());
            gbb.gbbReviewPage.f.reRenderDiscountAndSubTotalV2()

        },
        f: {

            prepareHeader: function () {
                //this is a header
                const gbbSummaryPageHeaderHTML = gbb.$("<div>").addClass("gbbSummaryPageHeader");
                // gbbSummaryPageHeaderHTML.append("<div> <h1> Header Gift Box Builder</h1> </div>");
                // return gbbSummaryPageHeaderHTML;
            },
            prepareUIV2: async function () {

                let gbbSummaryPageHTML = gbb.$("<div>").addClass("gbbSummaryPageHTML");

                const SummaryPageBanner = gbb.$("<div>").addClass("gbbSummaryPageBanner");
                //all the text and button goes in this div
                const SummaryPageBannerImage = gbb.$("<img>").addClass("gbbSummaryPageBannerImage");

                const gbbSummaryPageBannerTextWrapper = gbb.$("<div>").addClass("gbbSummaryPageBannerTextWrapper")
                    .css("color", gbb.settings?.pageCustomizationData?.SummaryPage?.bannerTextColor)
                    .css("width", "100%");
                const SummaryPageBannerText = gbb.$("<div>").addClass("gbbSummaryPageBannerText");
                //subtext
                const SummaryPageBannerSubText = gbb.$("<div>").addClass("gbbSummaryPageBannerSubText");

                SummaryPageBannerImage.attr("src", gbb.settings.pageCustomizationData.banners.productReviewImageSrc);
                SummaryPageBannerText.text(gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageBannerText);
                SummaryPageBannerSubText.html(gbb.settings?.stepsConfigurationData?.summaryPageData?.reviewPageBannerSubtext);

                gbbSummaryPageBannerTextWrapper.append(SummaryPageBannerText);
                gbbSummaryPageBannerTextWrapper.append(SummaryPageBannerSubText);

                SummaryPageBanner.append(SummaryPageBannerImage);

                let gbbSummaryPageBodyWrapper = gbb.$("<div>").addClass("gbbSummaryPageBodyWrapper");

                let gbbSummaryPageBundlesContainer = await gbb.gbbReviewPage.f.prepareBundleDetailsContainerUI();
                // if(gbbSummaryPageBundlesContainer.length == 0) {
                //     gbbSummaryPageBundlesContainer = gbb.$("<div>").addClass("gbbSummaryPageBundlesContainer");
                // } else {
                //     gbbSummaryPageBundlesContainer.html("");
                // }

                // let allBoxes = gbb.gbbBrowser.getCartDataFromSessionStorage();
                // allBoxes = allBoxes?.boxes || {}
                // let allBoxesKeys = Object.keys(allBoxes) || [];
                // for(let i=0; i < allBoxesKeys.length; i++) {
                //     let box = allBoxes[allBoxesKeys[i]];
                //     gbbSummaryPageBundlesContainer.append(await gbb.gbbReviewPage.f.prepareBundleDetailsUI(box));
                // }

                let gbbSummaryPageSubsriptionDiv = await gbb.gbbReviewPage.f.prepareSubscriptionUI();
                let gbbSummaryPageDeliverOrderDetailsDiv = gbb.$("<div>").addClass("gbbSummaryPageDeliverOrderDetailsDiv");
                let gbbSummaryPageOrderDetailsUI = gbb.$("<div>").addClass("gbbSummaryPageOrderDetailsUI");

                let gbbCustomHTMLBlock = gbb.gbbReviewPage.f.customHTMLBlock()


                gbbSummaryPageBodyWrapper.append(gbbSummaryPageBundlesContainer);

                if (gbb.settings?.stepsConfigurationData?.isOrderSubscriptionsEnabled) {
                    // gbbSummaryPageBodyWrapper.append(gbbSummaryPageSubsriptionDiv);
                    gbbSummaryPageDeliverOrderDetailsDiv.append(gbbSummaryPageSubsriptionDiv);
                }
                gbbSummaryPageBodyWrapper.append(gbbSummaryPageDeliverOrderDetailsDiv);
                gbbSummaryPageBodyWrapper.append(gbbSummaryPageOrderDetailsUI);

                //gbbSummaryPageHTML.append(SummaryPageBanner);
                gbbSummaryPageHTML.append(gbbSummaryPageBannerTextWrapper);
                gbbSummaryPageHTML.append(gbbSummaryPageBodyWrapper);
                gbbSummaryPageHTML.append(gbbCustomHTMLBlock);
                return gbbSummaryPageHTML;
            },
            prepareSubscriptionUI: async function () {
                //initialize subscriptionValues
                const isOneTimePurchaseEnabled = gbb.settings?.stepsConfigurationData?.isOneTimePurchaseEnabled;

                if (isOneTimePurchaseEnabled == undefined || isOneTimePurchaseEnabled == true) {
                    gbb.gbbBrowser.updateSubscriptionType("oneTimeSubscription");
                } else {
                    gbb.gbbBrowser.updateSubscriptionType("saveSubscription");
                }

                if (gbb.gbbBrowser.getSubscriptionPlan()) {
                    gbb.gbbBrowser.removeSubscriptionPlan();
                }
                let gbbSummaryPageSubscriptionHTML = gbb.$("<div>").addClass("gbbSummaryPageSubscriptionHTML");
                // let gbbSummaryPageSubscriptionContainer = gbb.$("<div>").addClass("gbbSummaryPageSubscriptionContainer");

                let gbbSummaryPageOneTimeSubscriptionDiv = gbb.$("<div>").addClass("gbbSummaryPageOneTimeSubscriptionDiv");
                let gbbSummaryPageOneTimeSubscriptionInput = gbb.$("<input>").attr("id", "oneTimeSubscription").attr("type", "radio").attr("value", "oneTimeSubscription").addClass("gbbSummaryPageOneTimeSubscriptionInput");
                let gbbSummaryPageOneTimeSubscriptionLabel = gbb.$("<label>").attr("for", "oneTimeSubscription").addClass("gbbSummaryPageOneTimeSubscriptionLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.oneTimePurchaseLabel) || "One-Time Purchase");

                let gbbSummaryPageSubscriptionAndSaveDiv = gbb.$("<div>").addClass("gbbSummaryPageSubscriptionAndSaveDiv");
                let gbbSummaryPageSubscriptionAndSaveInputAndLabel = gbb.$("<div>").addClass("gbbSummaryPageSubscriptionAndSaveInputAndLabel");
                let gbbSummaryPageSubscriptionAndSaveInput = gbb.$("<input>").attr("id", "saveSubscription").attr("type", "radio").attr("value", "saveSubscription").addClass("gbbSummaryPageSubscriptionAndSaveInput");
                let gbbSummaryPageSubscriptionAndSaveLabel = gbb.$("<label>").attr("for", "saveSubscription").addClass("gbbSummaryPageSubscriptionAndSaveLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.subscribeAndSaveLabel) || "Subscribe and save");

                if (isOneTimePurchaseEnabled == undefined || isOneTimePurchaseEnabled) {
                    gbbSummaryPageOneTimeSubscriptionInput.prop("checked", gbb.gbbBrowser.getSubscriptionType() == "oneTimeSubscription" ? true : false);
                } else {
                    gbbSummaryPageSubscriptionAndSaveInput.prop("checked", true);
                }



                gbbSummaryPageSubscriptionAndSaveInputAndLabel.append(gbbSummaryPageSubscriptionAndSaveInput);
                gbbSummaryPageSubscriptionAndSaveInputAndLabel.append(gbbSummaryPageSubscriptionAndSaveLabel);
                gbbSummaryPageSubscriptionAndSaveInput.prop("checked", gbb.gbbBrowser.getSubscriptionType() == "saveSubscription" ? true : false);

                gbbSummaryPageOneTimeSubscriptionInput.on("change", () => {
                    gbb.gbbBrowser.updateSubscriptionType("oneTimeSubscription");
                    if (gbb.gbbBrowser.getSubscriptionPlan()) {
                        gbb.gbbBrowser.removeSubscriptionPlan();
                    }
                    gbb.$(".gbbSummaryPageNoSellingPlanFoundContainer").remove();
                    gbb.$(".gbbSummaryPageSubscriptionPlansDropdownContainer").remove();
                    gbb.gbbReviewPage.f.reRenderUiOnSubscriptionChange();
                    gbbSummaryPageSubscriptionAndSaveInput.prop("checked", false);
                })

                gbbSummaryPageSubscriptionAndSaveInput.on("change", async () => {
                    gbb.gbbBrowser.updateSubscriptionType("saveSubscription");
                    gbbSummaryPageOneTimeSubscriptionInput.prop("checked", false);
                    gbbSummaryPageSubscriptionAndSaveDiv.append(await gbb.gbbReviewPage.f.prepareSellingsPlansDropDown());

                    const subscriptionPlanExists = gbb.gbbReviewPage.f.checkIfSubscriptionPlanExists();
                    if (subscriptionPlanExists) {
                        gbb.gbbReviewPage.f.reRenderUiOnSubscriptionChange();
                    }
                })
                gbbSummaryPageOneTimeSubscriptionDiv.append(gbbSummaryPageOneTimeSubscriptionInput);
                gbbSummaryPageOneTimeSubscriptionDiv.append(gbbSummaryPageOneTimeSubscriptionLabel);

                gbbSummaryPageSubscriptionAndSaveDiv.append(gbbSummaryPageSubscriptionAndSaveInputAndLabel);

                if (isOneTimePurchaseEnabled != undefined && isOneTimePurchaseEnabled != true) {
                    gbbSummaryPageSubscriptionAndSaveDiv.append(await gbb.gbbReviewPage.f.prepareSellingsPlansDropDown("initialize"));
                    gbb.gbbBrowser.updateSubscriptionType("saveSubscription");
                    gbbSummaryPageOneTimeSubscriptionInput.prop("checked", false);
                    gbb.gbbReviewPage.f.reRenderUiOnSubscriptionChange();
                }

                if (isOneTimePurchaseEnabled == undefined || isOneTimePurchaseEnabled == true) {
                    gbbSummaryPageSubscriptionHTML.append(gbbSummaryPageOneTimeSubscriptionDiv);
                }

                gbbSummaryPageSubscriptionHTML.append(gbbSummaryPageSubscriptionAndSaveDiv);
                return gbbSummaryPageSubscriptionHTML;
            },
            prepareSellingsPlansDropDown: async function (type) {
                let gbbSummaryPageSubscriptionPlansDropdownContainer = gbb.$("<div>").addClass("gbbSummaryPageSubscriptionPlansDropdownContainer");
                let cartProducts = gbb.gbbBrowser.getProductsFromAllBoxesFromCart();

                for (let i = 0; i < cartProducts.length; i++) {
                    cartProducts[i].sellingPlanDetails = gbb.gbbReviewPage.f.getSellingPlanDetailsForVariant(cartProducts[i]?.selling_plan_groups, cartProducts[i]?.selling_plan_allocations);
                    gbb.gbbBrowser.updateCartItemSellingDetails(cartProducts[i]["variant_id"], cartProducts[i]?.sellingPlanDetails);
                }

                let isAllItemsHaveASellingPlan = gbb.gbbReviewPage.f.checkIfAllItemsHasASellingPlan();
                let allAvailableSubscriptions = gbb.gbbReviewPage.f.getAllSubscriptionPlans();
                allAvailableSubscriptions = Object.values(allAvailableSubscriptions) || [];

                if (!isAllItemsHaveASellingPlan || allAvailableSubscriptions.length == 0) {
                    let gbbSummaryPageNoSellingPlanFoundContainer = gbb.$("<div>").addClass("gbbSummaryPageNoSellingPlanFoundContainer");
                    gbbSummaryPageNoSellingPlanFoundContainer.text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.reviewPage?.noSubscriptionFoundLabel) || "Oops! No Subscription Plans were found");
                    gbbSummaryPageSubscriptionPlansDropdownContainer.append(gbbSummaryPageNoSellingPlanFoundContainer);
                    if (gbb.gbbBrowser.getSubscriptionPlan()) {
                        gbb.gbbBrowser.removeSubscriptionPlan();
                    }
                } else {
                    const gbbSubscriptionDeliveryFrequencyLabel = gbb.$("<div>").addClass("gbbSubscriptionDeliveryFrequencyLabel");
                    gbbSubscriptionDeliveryFrequencyLabel.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.deliveryFrequencyLabel) || "Delivery Frequency");
                    const gbbSubscriptionDropDownSelect = gbb.$("<select>").addClass("gbbSubscriptionDropDownSelect");
                    allAvailableSubscriptions.forEach((plan, index) => {
                        if (plan) {
                            //let planName = plan?.selling_plan_name + " " + "( " + gbb.utility.getCurrencySymbol() + plan?.per_delivery_price + "/" + (gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.deliveryLabel) || "delivery") + " )" || "";
                            let planName = plan?.selling_plan_name;
                            let optionEle = gbb.$("<option>").attr("value", plan?.selling_plan_id)
                                .text(planName);
                            if (index == 0 && (!gbb.gbbBrowser.getSubscriptionPlan() || type == "initialize")) {
                                optionEle.attr("selected", "selected");
                                gbb.gbbBrowser.updateSubscriptionPlan(parseInt(plan?.selling_plan_id))
                            }
                            if (gbb.gbbBrowser.getSubscriptionPlan() == plan?.selling_plan_id) {
                                optionEle.attr("selected", "selected");
                            }
                            gbbSubscriptionDropDownSelect.append(optionEle)
                        }
                    })
                    gbbSubscriptionDropDownSelect.change(async (event) => {
                        gbb.gbbBrowser.updateSubscriptionPlan(parseInt(event.target.value));
                        gbb.gbbReviewPage.f.reRenderUiOnSubscriptionChange();
                    })
                    gbbSummaryPageSubscriptionPlansDropdownContainer.append(gbbSubscriptionDeliveryFrequencyLabel);
                    gbbSummaryPageSubscriptionPlansDropdownContainer.append(gbbSubscriptionDropDownSelect);
                }
                return gbbSummaryPageSubscriptionPlansDropdownContainer;
            },
            getSellingPlanDetailsForVariant: function (selling_plan_groups, selling_plan_allocations) {
                try {
                    // gbb.utility.debugConsole("inside getSellingPlanDetailsForVariant");
                    let result = {};
                    if (selling_plan_groups?.length > 0 && selling_plan_allocations?.length > 0) {
                        //loop through all the selling_plan_allocations
                        for (let i = 0; i < selling_plan_allocations.length; i++) {
                            let sellingPlanId = selling_plan_allocations[i]?.selling_plan_id; //current selling_plan_id from selling_plan_allocations of the variant
                            let sellingPlanName;
                            let perDeliveryPrice = selling_plan_allocations[i]?.per_delivery_price;
                            let price = selling_plan_allocations[i]?.price;
                            let sellingPlanGroup = selling_plan_groups.find(group => group.id == selling_plan_allocations[i]?.selling_plan_group_id); //find the selling plan group to which this plan belongs to get the name of the plan

                            for (let j = 0; j < sellingPlanGroup?.selling_plans.length; j++) { //loop through all the selling_plans of this group

                                let currentSellingPlan = sellingPlanGroup?.selling_plans[j];
                                if (currentSellingPlan && currentSellingPlan.id == sellingPlanId) {
                                    sellingPlanName = currentSellingPlan?.name || "";
                                    break;
                                }
                            }
                            result[sellingPlanId] = {
                                selling_plan_id: sellingPlanId,
                                selling_plan_name: sellingPlanName,
                                per_delivery_price: perDeliveryPrice,
                                price: price
                            }
                            //result.push(obj);
                        }
                    }
                    // gbb.utility.debugConsole("result inside getSellingPlanDetailsForVariant", result);
                    return result;
                } catch (err) {
                    gbb.utility.debugConsole(err);
                }
            },
            getAllSubscriptionPlans: function () {
                try {
                    let items = gbb.gbbBrowser.getProductsFromAllBoxesFromCart();
                    let uniquePlans = {};
                    for (let i = 0; i < items.length; i++) {
                        if (items[i]?.sellingPlanDetails) {
                            let sellingPlanDetails = Object.values(items[i]?.sellingPlanDetails) || [];
                            for (let j = 0; j < sellingPlanDetails?.length; j++) {
                                let currPlan = sellingPlanDetails[j] || "";
                                if (currPlan && !uniquePlans[currPlan.selling_plan_id]) {
                                    uniquePlans[currPlan.selling_plan_id] = {
                                        selling_plan_id: currPlan?.selling_plan_id || "",
                                        selling_plan_name: currPlan?.selling_plan_name || "",
                                        per_delivery_price: currPlan?.per_delivery_price || ""
                                    }
                                }
                            }
                        }
                    }

                    let tempUniquePlans = Object.values(uniquePlans) || [];

                    for (let i = 0; i < tempUniquePlans.length; i++) {
                        for (let j = 0; j < items.length; j++) {
                            let planToTest = items[j].sellingPlanDetails[tempUniquePlans[i]["selling_plan_id"]] || undefined;
                            if (!planToTest) {
                                delete uniquePlans[tempUniquePlans[i]["selling_plan_id"]]
                                break;
                            }
                        }
                    }
                    // gbb.utility.debugConsole("uniquePlans:", uniquePlans);
                    return uniquePlans;
                } catch (err) {
                    gbb.utility.debugConsole(err);
                    return {};
                }
            },
            checkIfAllItemsHasASellingPlan: function () {
                let result = true;
                let products = gbb.gbbBrowser.getProductsFromAllBoxesFromCart();
                // gbb.utility.debugConsole("products inside checkIfAllItemsHasASellingPlan:", products);
                for (let i = 0; i < products?.length; i++) {
                    if (!products[i]?.sellingPlanDetails || Object.values(products[i]?.sellingPlanDetails)?.length == 0) {
                        result = false;
                        break;
                    }
                }
                // gbb.utility.debugConsole("result inside checkIfAllItemsHasASellingPlan", result);
                return result;
            },
            prepareBundleDetailsContainerUI: async function (boxesData) {
                try {
                    let gbbSummaryPageBundlesContainer = gbb.$(".gbbSummaryPageBundlesContainer");
                    if (gbbSummaryPageBundlesContainer.length == 0) {
                        gbbSummaryPageBundlesContainer = gbb.$("<div>").addClass("gbbSummaryPageBundlesContainer");
                    } else {
                        gbbSummaryPageBundlesContainer.html("");
                    }
                    let allBoxes;
                    if (!boxesData) {
                        allBoxes = gbb.gbbBrowser.getCartDataFromSessionStorage();
                        allBoxes = allBoxes?.boxes || {};
                    } else {
                        allBoxes = boxesData?.boxes || {}
                    }

                    let allBoxesKeys = Object.keys(allBoxes) || [];
                    for (let i = 0; i < allBoxesKeys.length; i++) {
                        let box = allBoxes[allBoxesKeys[i]];
                        if (gbb.gbbReviewPage.f.checkIfCurrentBoxPriceIsZero(box)) {
                            continue;
                        }
                        gbbSummaryPageBundlesContainer.append(await gbb.gbbReviewPage.f.prepareBundleDetailsUI(box));
                    }
                    return gbbSummaryPageBundlesContainer;
                } catch (err) {
                    gbb.utility.debugConsole(err + "in prepareBundleDetailsContainerUI");
                }
            },
            prepareBundleDetailsUI: async function (box) {
                //items:
                const isPurchaseTypeSubscription = gbb.gbbSubscriptionProductsPage.f.checkIfPurchaseTypeIsSubscription()
                let gbbSummaryPageBundleDetailsHTML = gbb.$(".gbbSummaryPageBundleDetailsHTML");

                // if(true || gbbSummaryPageBundleDetailsHTML.length == 0) {
                gbbSummaryPageBundleDetailsHTML = gbb.$("<div>").addClass("gbbSummaryPageBundleDetailsHTML");
                // } else {
                //     //empty the div if found, below we will append the new content
                //     gbbSummaryPageBundleDetailsHTML.html("");
                // }

                let gbbSummaryPageBundleDetailsWithProducts = gbb.$("<div>").addClass("gbbSummaryPageBundleDetailsWithProducts");

                let gbbSummaryPageBundleImageTitleContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleImageTitleContainer");
                let gbbSummaryPageBundleImageContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleImageContainer");
                let gbbSummaryPageBundleImage = gbb.$("<img>").addClass("gbbSummaryPageBundleImage")
                    .attr("src", gbb.settings?.stepsConfigurationData?.bundleImg || DEFAULT_BUNDLE_IMAGE);
                gbbSummaryPageBundleImageContainer.append(gbbSummaryPageBundleImage);

                let gbbSummaryPageBundleDetailsContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleDetailsContainer");
                let gbbSummaryPageBundleDetails = gbb.$("<div>").addClass("gbbSummaryPageBundleDetails");

                let gbbSummaryPageBundleActions = gbb.$("<div>").addClass("gbbSummaryPageBundleActions");

                let gbbSummaryPageBundleTitleContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleTitleContainer");
                let gbbSummaryPageBundleTitle = gbb.$("<div>").addClass("gbbSummaryPageBundleTitle");
                gbbSummaryPageBundleTitle.text(gbb?.settings?.stepsConfigurationData?.bundleName || "BundleX");

                //this will be rendered with gbbSummaryPageBundlePriceContainer
                let gbbSummaryPageBundleQuantity = gbb.$("<div>").addClass("gbbSummaryPageBundleQuantity");
                // gbbSummaryPageBundleQuantity.text("x"+gbb.gbbBrowser.getRelevantBoxQuantity(box?.boxId));
                gbbSummaryPageBundleQuantity.text("x" + box?.boxQuantity || 1);

                let noOfItems = 0;
                let cartData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(box?.boxId);
                if (cartData && cartData.items) {
                    noOfItems = cartData.items.length;
                }
                let gbbSummaryPageBundleItemsLabel = gbb.$("<div>").addClass("gbbSummaryPageBundleItemsLabel")
                    .text(noOfItems)
                gbbSummaryPageBundleItemsLabel.append(" ").append(gbb.settings?.languageData?.reviewPage?.itemsLabel?.value || "item(s)")
                gbbSummaryPageBundleTitleContainer.append(gbbSummaryPageBundleTitle);
                gbbSummaryPageBundleTitleContainer.append(gbbSummaryPageBundleItemsLabel);

                let gbbSummaryPageBundleQuantityContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleQuantityContainer");
                let gbbSummaryPageBundleQuantityText = gbb.$("<div>").addClass("gbbSummaryPageBundleQuantityText");
                // gbbSummaryPageBundleQuantityText.text(gbb.gbbBrowser.getRelevantBoxQuantity(box?.boxId));
                gbbSummaryPageBundleQuantityText.text(box?.boxQuantity || 1);

                let gbbSummaryPageBundleQuantityAddButton = gbb.$("<div>").addClass("gbbSummaryPageBundleQuantityAddButton");
                gbbSummaryPageBundleQuantityAddButton.css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                gbbSummaryPageBundleQuantityAddButton.css("color", gbb.settings.pageCustomizationData?.productCard?.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);

                let gbbSummaryPageQuantityAddButtonWrapper = gbb.$("<div>").addClass("gbbSummaryPageQuantityAddButtonWrapper");
                gbbSummaryPageQuantityAddButtonWrapper.html("+");
                gbbSummaryPageBundleQuantityAddButton.append(gbbSummaryPageQuantityAddButtonWrapper);

                let gbbSummaryPageBundleQuantityRemoveButton = gbb.$("<div>").addClass("gbbSummaryPageBundleQuantityRemoveButton");
                gbbSummaryPageBundleQuantityRemoveButton.css("background", gbb.settings.pageCustomizationData?.productCard?.productCardButtonColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                gbbSummaryPageBundleQuantityRemoveButton.css("color", gbb.settings.pageCustomizationData?.productCard?.productCardButtonTextColor || gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor);
                let gbbSummaryPageQuantityRemoveButtonWrapper = gbb.$("<div>").addClass("gbbSummaryPageQuantityRemoveButtonWrapper");
                gbbSummaryPageQuantityRemoveButtonWrapper.html("-");
                gbbSummaryPageBundleQuantityRemoveButton.append(gbbSummaryPageQuantityRemoveButtonWrapper);

                gbbSummaryPageBundleQuantityContainer.append(gbbSummaryPageBundleQuantityRemoveButton);
                gbbSummaryPageBundleQuantityContainer.append(gbbSummaryPageBundleQuantityText);
                gbbSummaryPageBundleQuantityContainer.append(gbbSummaryPageBundleQuantityAddButton);

                gbbSummaryPageBundleQuantityAddButton.on("click", (event) => {
                    setTimeout(function () {
                        //   gbb.utility.debugConsole("after timeeout");
                        gbbSummaryPageBundleQuantityAddButton.prop("disabled", false);
                        gbbSummaryPageBundleQuantityAddButton.removeClass("gbbDisabled");
                    }, 500);
                    let currentBundleQuantity = gbb.gbbBrowser.getRelevantBoxQuantity(box?.boxId);
                    currentBundleQuantity = gbb.gbbBrowser.updateRelevantBoxQuantity(currentBundleQuantity + 1, box?.boxId);
                    gbbSummaryPageBundleQuantityText.text(currentBundleQuantity);
                    gbbSummaryPageBundleQuantity.text("x" + currentBundleQuantity);

                    gbb.gbbReviewPage.f.reRenderDiscountAndSubTotalV2()
                })

                gbbSummaryPageBundleQuantityRemoveButton.on("click", (event) => {
                    setTimeout(function () {
                        // gbb.utility.debugConsole("after timeeout")
                        gbbSummaryPageBundleQuantityRemoveButton.prop('disabled', false);
                        gbbSummaryPageBundleQuantityRemoveButton.removeClass("gbbDisabled");
                    }, 500);
                    let currentBundleQuantity = gbb.gbbBrowser.getRelevantBoxQuantity(box?.boxId);
                    if (currentBundleQuantity > 1) {
                        currentBundleQuantity = gbb.gbbBrowser.updateRelevantBoxQuantity(currentBundleQuantity - 1, box?.boxId);
                        gbbSummaryPageBundleQuantityText.text(currentBundleQuantity);
                        gbbSummaryPageBundleQuantity.text("x" + currentBundleQuantity);
                        gbb.gbbReviewPage.f.reRenderDiscountAndSubTotalV2()
                    }
                })

                gbbSummaryPageBundleDetails.append(gbbSummaryPageBundleTitleContainer);
                if (isPurchaseTypeSubscription) {
                    let gbbSummaryPageBundleSubscriptionDetails = gbb.$("<div>").addClass("gbbSummaryPageBundleSubscriptionDetails");
                    const subscriptionDataFromSessionStorage = gbb.gbbSubscriptionProductsPage.f.getSubscriptionDataFromSessionStorage()
                    let activeSellingPlanDetails = subscriptionDataFromSessionStorage.activeSellingPlanDetails || {}
                    gbbSummaryPageBundleSubscriptionDetails.text(activeSellingPlanDetails?.displayTitle || "");
                    gbbSummaryPageBundleDetails.append(gbbSummaryPageBundleSubscriptionDetails);
                }
                gbbSummaryPageBundleDetails.append(gbbSummaryPageBundleQuantityContainer);
                // gbbSummaryPageBundleDetails.append(gbbSummaryPageBundleProductsContainer);

                let gbbSummaryPageBundlePriceContainer = gbb.$("<div>").addClass("gbbSummaryPageBundlePriceContainer");

                let gbbSummaryPageBundleOriginalPrice = gbb.$("<div>").addClass("gbbSummaryPageBundleOriginalPrice").css("color", "#625f5f");
                gbbSummaryPageBundleOriginalPrice.append(gbb.utility.formatPrice(box.total_price));

                let gbbSummaryPageBundlePriceLabel = gbb.$("<div>").addClass("gbbSummaryPageBundlePriceLabel").text("Price");

                let gbbSummaryPageBundleDiscountedPrice = gbb.$("<div>").addClass("gbbSummaryPageBundleDiscountedPrice");

                if (gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.utility.getGiftBoxProductsDiscountedTotal(box?.boxId) != parseFloat(box.total_price / 100)) {
                    gbbSummaryPageBundlePriceContainer.css("grid-template-columns", "1fr 1fr min-content")
                    gbbSummaryPageBundlePriceContainer.append(gbbSummaryPageBundleOriginalPrice);
                }

                // gbbSummaryPageBundlePriceContainer.append(gbbSummaryPageBundlePriceLabel);

                // gbbSummaryPageBundleDiscountedPrice.append(gbb.gbbBrowser.getRelevantGiftBoxProductsTotalWithCurrency(box?.boxId))
                let formattedDiscountedPrice = gbb.utility.formatPrice(box.total_price);
                let discountedTotal = gbb.utility.getGiftBoxProductsDiscountedTotal(box?.boxId);

                if (gbb.settings?.discountsData?.isDiscountEnabled && gbb.settings?.discountsData?.isShowDiscountsEnabled && gbb.utility.getGiftBoxProductsDiscountedTotal(box?.boxId) != parseFloat(box.total_price / 100)) {
                    discountedTotal = gbb.utility.getGiftBoxProductsDiscountedTotal(box?.boxId);
                    let discountedTotalInShopifyFormat = discountedTotal * 100;
                    formattedDiscountedPrice = gbb.utility.formatPrice(discountedTotalInShopifyFormat);
                }
                gbbSummaryPageBundleDiscountedPrice.append(formattedDiscountedPrice);

                gbbSummaryPageBundlePriceContainer.append(gbbSummaryPageBundleDiscountedPrice);
                gbbSummaryPageBundlePriceContainer.append(gbbSummaryPageBundleQuantity);
                gbbSummaryPageBundleActions.append(gbbSummaryPageBundlePriceContainer);


                let gbbSummaryPageBundleEditRemoveButtons = gbb.$("<div>").addClass("gbbSummaryPageBundleEditRemoveButtons");
                let gbbSummaryPageBundleRemoveButton = gbb.$("<div>").addClass("gbbSummaryPageBundleRemoveButton")
                    .text(gbb.settings?.languageData?.general?.removeButtonText?.value || "Remove");
                let gbbSummaryPageBundleEditButton = gbb.$("<div>").addClass("gbbSummaryPageBundleEditButton")
                    .text(gbb.settings?.languageData?.reviewPage?.editButtonText?.value || "Edit");

                gbbSummaryPageBundleEditButton.on("click", (event) => {
                    gbb.gbbBrowser.activateRelevantBoxInSessionStorage(box?.boxId, { redirectToFirstProductPage: true });
                })

                gbbSummaryPageBundleRemoveButton.on("click", async (event) => {
                    await gbb.gbbBrowser.clearRelevantBoxFromSessionStorage(box?.boxId);
                })

                gbbSummaryPageBundleEditRemoveButtons.append(gbbSummaryPageBundleEditButton);
                gbbSummaryPageBundleEditRemoveButtons.append(gbbSummaryPageBundleRemoveButton);
                gbbSummaryPageBundleActions.append(gbbSummaryPageBundleEditRemoveButtons);

                gbbSummaryPageBundleDetailsContainer.append(gbbSummaryPageBundleDetails);
                gbbSummaryPageBundleDetailsContainer.append(gbbSummaryPageBundleActions);

                // gbbSummaryPageBundleImageTitleContainer.append(gbbSummaryPageBundleImageContainer);
                // gbbSummaryPageBundleImageTitleContainer.append(gbbSummaryPageBundleDetailsContainer);

                let gbbSummaryPageBundleProductsMainContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductsMainContainer");
                //let gbbSummaryPageBundleProductEmptyDiv =  gbb.$("<div>").addClass("gbbSummaryPageBundleProductEmptyDiv");
                let gbbSummaryPageBundleProductsContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductsContainer");
                gbb.gbbReviewPage.f.populateIteminGiftBoxProductListV2(gbbSummaryPageBundleProductsContainer, box);
                //gbbSummaryPageBundleProductsMainContainer.append(gbbSummaryPageBundleProductEmptyDiv);
                gbbSummaryPageBundleProductsMainContainer.append(gbbSummaryPageBundleProductsContainer);

                //gbbSummaryPageBundleDetailsHTML.append(gbbSummaryPageBundleImageTitleContainer);
                gbbSummaryPageBundleDetailsHTML.append(gbbSummaryPageBundleImageContainer);
                gbbSummaryPageBundleDetailsWithProducts.append(gbbSummaryPageBundleDetailsContainer);
                gbbSummaryPageBundleDetailsWithProducts.append(gbbSummaryPageBundleProductsMainContainer);
                gbbSummaryPageBundleDetailsHTML.append(gbbSummaryPageBundleDetailsWithProducts);

                return gbbSummaryPageBundleDetailsHTML;
            },
            prepareBundleProductsUI: async function (products) {

                let gbbSummaryPageBundleProductsHTML = gbb.$("<div>").addClass("gbbSummaryPageBundleProductsContainer");

                let gbbSummaryPageBundleProductsContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductsContainer");
                let gbbSummaryPageBundleProductTitlesContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductTitlesContainer");
                let gbbSummaryPageBundleProductQtysPricesContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductQtysPricesContainer");

                products?.forEach((product) => {
                    let gbbSummaryPageBundleProductTitle = gbb.$("<div>").addClass("gbbSummaryPageBundleProductTitle");

                    let gbbSummaryPageBundleProductQtyPriceContainer = gbb.$("<div>").addClass("gbbSummaryPageBundleProductQtyPriceContainer");
                    let gbbSummaryPageBundleProductPrice = gbb.$("<div>").addClass("gbbSummaryPageBundleProductPrice");
                    let gbbSummaryPageBundleProductQuantity = gbb.$("<div>").addClass("gbbSummaryPageBundleProductQuantity");
                    gbbSummaryPageBundleProductQtyPriceContainer.append(gbbSummaryPageBundleProductPrice);
                    gbbSummaryPageBundleProductQtyPriceContainer.append(gbbSummaryPageBundleProductQuantity);

                    gbbSummaryPageBundleProductTitlesContainer.append(gbbSummaryPageBundleProductTitle);
                    gbbSummaryPageBundleProductQtysPricesContainer.append(gbbSummaryPageBundleProductQtyPriceContainer);
                })
                gbbSummaryPageBundleProductsContainer.append(gbbSummaryPageBundleProductTitlesContainer);
                gbbSummaryPageBundleProductsContainer.append(gbbSummaryPageBundleProductQtysPricesContainer);

                gbbSummaryPageBundleProductsHTML.append(gbbSummaryPageBundleProductsContainer);
                return gbbSummaryPageBundleProductsHTML;
            },
            prepareDeliveryAndOrderDetailsUI: async function () {
                let gbbSummaryPageDeliveryAndOrderDetailsHTML = gbb.$("<div>").addClass("gbbSummaryPageDeliveryAndOrderDetailsHTML");
                let gbbSummaryPageDeliverDetails = await gbb.gbbReviewPage.f.prepareDeliveryDetailsUI();
                let gbbSummaryPageOrderDetails = await gbb.gbbReviewPage.f.prepareOrderDetailsUI();
                gbbSummaryPageDeliverDetails.append(gbbSummaryPageOrderDetails)

                //gbbSummaryPageDeliveryAndOrderDetailsHTML.append(gbbSummaryPageDeliverDetails);
                gbbSummaryPageDeliveryAndOrderDetailsHTML.append(gbbSummaryPageOrderDetails);
                return gbbSummaryPageDeliveryAndOrderDetailsHTML;
            },
            prepareDeliveryDetailsUI: async function () {
                let gbbScheduleDeliveryWrapper = gbb.$(document).find(gbb.selectors.scheduleDeliveryPickerSelector);
                let gbbScheduleDeliveryHeadingLabel = gbb.$("<div>").addClass("gbbScheduleDeliveryHeadingLabel");
                //gbbScheduleDeliveryHeadingLabel.text(gbb.settings?.languageData?.reviewPage?.deliveryDetails || "Delivery Details");

                if (gbb.settings?.scheduleDelivery?.isScheduleDeliveryEnabled) {
                    //gbbScheduleDeliveryWrapper.append(gbbScheduleDeliveryHeadingLabel);
                    let scheduleDeliveryHTML = await gbb.gbbPersonalizePage.components.scheduleDelivery();
                    gbbScheduleDeliveryWrapper.append(scheduleDeliveryHTML);
                }
                if (gbb.settings?.scheduleDelivery?.isScheduleDeliveryEnabled) {
                    gbb.gbbPersonalizePage.f.useDatePickerLibrary();
                }
                return gbbScheduleDeliveryWrapper;
            },
            prepareOrderDetailsUI: async function () {
                let gbbOrderDetailsHTMl = gbb.$("<div>").addClass("gbbOrderDetailsHTMl");
                let gbbOrderDetailsHeading = gbb.$("<div>").addClass("gbbOrderDetailsHeading");
                gbbOrderDetailsHeading.text(gbb.settings.languageData.reviewPage?.orderDetailsLabel?.value || "Order Details");

                let gbbOrderSubtotalTotalContainer = gbb.$("<div>").addClass("gbbOrderSubtotalTotalContainer");
                gbbOrderSubtotalTotalContainer.append(gbb.gbbReviewPage.f.prepareSubtotalContainerV2());

                let gbbDiscountContainer = gbb.$("<div>").addClass("gbbSummaryPageDiscountAppliedWrapper");
                if (gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive) {
                    gbbDiscountContainer.html(gbb.gbbReviewPage.f.prepareDiscountContainerV2())
                }

                let gbbSummaryPageActionButtons = gbb.$("<div>").addClass("gbbSummaryPageActionButtons");
                // let gbbSummaryPageBackButton = gbb.$("<div>").addClass("gbbSummaryPageBackButton").text(gbb.settings?.languageData?.general?.backButtonText?.value || "Back")
                // gbbSummaryPageBackButton.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonColor);
                // gbbSummaryPageBackButton.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonTextColor);

                // gbbSummaryPageBackButton.on("click", function (event) {
                //     gbb.giftboxbuilderPage.action.onPrevNavigationBYOB();
                // })

                let checkoutButtonText = gbb?.settings?.languageData?.general?.checkoutButtonText?.value || "Checkout";

                if (gbb.settings.app.redirectToCartEnabled && !gbb.settings.app.redirectToCheckoutEnabled) {
                    checkoutButtonText = gbb?.settings?.languageData?.general?.addToCartButtonText?.value || "Add to Cart";
                }


                let gbbSummaryPageCheckoutButton = gbb.$("<div>").addClass("gbbSummaryPageCheckoutButton").text(checkoutButtonText);
                gbbSummaryPageCheckoutButton.css("background", gbb.settings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonColor)
                gbbSummaryPageCheckoutButton.css("color", gbb.settings.pageCustomizationData.summaryBlock.summaryBlockAddToCartButtonTextColor)

                gbbSummaryPageCheckoutButton.on("click", async function (event) {
                    event.preventDefault();
                    event.stopPropagation();
                    gbbSummaryPageCheckoutButton.addClass("gbbDisabled")
                    gbbSummaryPageCheckoutButton.text(gbb.settings.languageData.general?.loadingCheckoutButtonText?.value || "Loading ...1")
                    if (gbb.gbbPersonalizePage.state.scheduleDeliveryDate) {
                        // await gbb.utility.updateCart({ attributes: { ["gbbScheduleDelivery"]: gbb.gbbPersonalizePage.state.scheduleDeliveryDate } });
                        gbb.gbbBrowser.updateCartAttributes({ "gbbScheduleDelivery": gbb.gbbPersonalizePage.state.scheduleDeliveryDate })
                    }
                    //if gbb.gbbDiscountComponent.state.currentDiscountRule

                    // let cartData = await gbb.utility.getCart();
                    // gbb.state.giftBoxCartData = cartData; //TBD
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-checkout-button-click",
                        attachEventTo: gbbSummaryPageCheckoutButton[0]
                    })
                    await gbb.utility.handleCheckoutClick()
                    // setTimeout(()=>{
                    //     gbbSummaryPageCheckoutButton.removeClass("gbbDisabled");
                    //     gbbSummaryPageCheckoutButton.text(gbb?.settings?.languageData?.general?.checkoutButtonText?.value || "Checkout");
                    // },4000)
                    // await gbb.shopifyUtility.addToCart();

                    //check if discount is enabled
                })
                let gbbSummaryPageCreateNewBoxButton = gbb.$("<div>").addClass("gbbSummaryPageCreateNewBoxButton")
                    .text(gbb.utility.renderLanguageValue(gbb?.settings?.languageData?.reviewPage?.createNewBoxLabel) || "Create a new Box");

                gbbSummaryPageCreateNewBoxButton.css("background", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonColor);
                gbbSummaryPageCreateNewBoxButton.css("color", gbb.settings.pageCustomizationData.cartFooter.cartFooterBackButtonTextColor);

                gbbSummaryPageCreateNewBoxButton.on("click", () => {
                    setTimeout(function () {
                        gbbSummaryPageCreateNewBoxButton.prop('disabled', false);
                        gbbSummaryPageCreateNewBoxButton.removeClass("gbbDisabled");
                    }, 500);
                    let isRedirectAllowed = true;
                    gbb.gbbBrowser.createNewBoxInSessionStorage(isRedirectAllowed);
                    gbb.gbbBrowser.emitCustomEvent({
                        eventName: "gbb-create-new-box-click",
                        attachEventTo: gbbSummaryPageCreateNewBoxButton[0]
                    })
                })
                //gbbSummaryPageActionButtons.append(gbbSummaryPageBackButton)
                gbbSummaryPageActionButtons.append(gbbSummaryPageCheckoutButton);

                if (gbb?.settings?.merchantInfo?.bundleSettings?.allowMultipleBoxesFromSameBundle) {
                    gbbSummaryPageActionButtons.append(gbbSummaryPageCreateNewBoxButton)
                }

                gbbOrderDetailsHTMl.append(gbbOrderDetailsHeading);
                gbbOrderDetailsHTMl.append(gbbOrderSubtotalTotalContainer);
                gbbOrderDetailsHTMl.append(gbbDiscountContainer);
                gbbOrderDetailsHTMl.append(gbbSummaryPageActionButtons);
                if (gbb.utility.checkIfBrandingShouldBeVisible()) {
                    gbbOrderDetailsHTMl.append(gbb.utility.renderPoweredByLabel());
                }
                return gbbOrderDetailsHTMl;
            },
            prepareDiscountContainerV2: function (cartData) {
                let discountContainerArray = []
                const boxQuantity = gbb.state.giftBoxCartData.boxQuantity
                let cartTotal;
                // if(!cartData){
                //      cartTotal = gbb.utility.calculateCartDiscount().cartTotalAmount;
                // }else{
                //     cartTotal = gbb.utility.calculateCartDiscount(cartData).cartTotalAmount;
                // }
                cartTotal = gbb.utility.calculateCartDiscount(cartData).cartTotalAmount + gbb.utility.calculateCartDiscount(cartData).cartBlacklistedItemsTotal;


                cartTotal = gbb.utility.formatPrice(cartTotal);

                let discountOffered = gbb.utility.calculateCartDiscount(cartData).cartDiscount;
                discountOffered = gbb.utility.formatPrice(discountOffered);

                discountOffered = "-" + discountOffered;

                let gbbSummaryPageDiscountAppliedContainer = gbb.$("<div>").addClass("gbbSummaryPageDiscountAppliedContainer")
                let gbbSummaryPageDiscountAppliedLabel = gbb.$("<div>").addClass("gbbSummaryPageDiscountAppliedLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.discountAppliedLabel) || "Discount")

                let gbbSummaryPageDiscountAppliedValue = gbb.$("<span>").addClass("gbbSummaryPageDiscountAppliedValue")
                gbbSummaryPageDiscountAppliedValue.append(discountOffered)

                gbbSummaryPageDiscountAppliedContainer.append(gbbSummaryPageDiscountAppliedLabel);
                gbbSummaryPageDiscountAppliedContainer.append(gbbSummaryPageDiscountAppliedValue);
                // let gbbSummaryPageDiscountAppliedValue = gbb.$("<span>").addClass("gbbSummaryPageDiscountAppliedValue")
                // gbbSummaryPageDiscountAppliedValue.append("      ").append(gbb.gbbDiscountComponent.state.currentDiscountRule.discountValue)

                let gbbSummaryPageTotalCartValueContainer = gbb.$("<div>").addClass("gbbSummaryPageTotalCartValueContainer")

                let gbbSummaryPageTotalCartValueLabel = gbb.$("<div>").addClass("gbbSummaryPageTotalCartValueLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.totalLabel) || "Total1")
                let gbbSummaryPageTotalCartValue = gbb.$("<div>").addClass("gbbSummaryPageTotalCartValue")
                gbbSummaryPageTotalCartValue.append(cartTotal)

                gbbSummaryPageTotalCartValueContainer.append(gbbSummaryPageTotalCartValueLabel);
                gbbSummaryPageTotalCartValueContainer.append(gbbSummaryPageTotalCartValue);

                discountContainerArray.push(gbbSummaryPageDiscountAppliedContainer)

                discountContainerArray.push(gbbSummaryPageTotalCartValueContainer)
                return discountContainerArray;
            },
            prepareSubtotalContainerV2: function (allBoxesData) {
                let gbbSummaryPageSubTotalCart = gbb.$("<div>").addClass("gbbSummaryPageSubTotalCart")
                //let gbbSummaryPageSubTotalCart = gbb.$("<div>").addClass("gbbSummaryPageSubTotalCart")
                let gbbSummaryPageSubTotalCartLabel = gbb.$("<div>").addClass("gbbSummaryPageSubTotalCartLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.subtotalLabel) || "Sub Total1")
                let gbbSummaryPageSubTotalValue = gbb.$("<div>").addClass("gbbSummaryPageSubTotalValue")
                // gbbSummaryPageSubTotalValue.append(gbb.utility.getGiftBoxProductsTotalWithCurrency())

                let _allBoxesData;
                if (allBoxesData) {
                    _allBoxesData = JSON.parse(JSON.stringify(allBoxesData));
                }
                let subtotalValue = gbb.utility.calculateCartDiscount(_allBoxesData).cartSubTotal + gbb.utility.calculateCartDiscount(_allBoxesData).cartBlacklistedItemsTotal;

                subtotalValue = gbb.utility.formatPrice(subtotalValue);

                gbbSummaryPageSubTotalValue.append(subtotalValue)


                gbbSummaryPageSubTotalCart.append(gbbSummaryPageSubTotalCartLabel)
                gbbSummaryPageSubTotalCart.append(gbbSummaryPageSubTotalValue)

                return gbbSummaryPageSubTotalCart;
            },
            // prepareSubtotalContainer: function () {
            //     let gbbSubTotalCartValue = gbb.$("<div>").addClass("gbbReviewPageSubTotalCart")
            //     let gbbSubTotalLabel = gbb.$("<div>").addClass("gbbReviewPageSubTotalCartLabel").text(gbb.utility.renderLanguageValue(gbb.settings?.languageData?.reviewPage?.subtotalLabel) || "Sub Total1")
            //     gbbSubTotalLabel.append("      ").append(gbb.utility.getGiftBoxProductsTotalWithCurrency())
            //     gbbSubTotalCartValue.append(gbbSubTotalLabel)
            //     return gbbSubTotalCartValue;
            // },
            prepareFooter: function () {
                //this is a footer
                const gbbSummaryPageFooterHTML = gbb.$("<div>").addClass("gbbSummaryPageFooter");
                gbbSummaryPageFooterHTML.append("<div> <h1>Footer Gift Box Builder</h1> </div>");
                return gbbSummaryPageFooterHTML;
            },
            reRenderDiscountAndSubTotalV2: function (allBoxesData) {
                let gbbSummaryPageSubTotalCart = gbb.$(".gbbOrderSubtotalTotalContainer")

                gbbSummaryPageSubTotalCart.html(gbb.gbbReviewPage.f.prepareSubtotalContainerV2(allBoxesData))

                let gbbSummaryPageDiscountAppliedWrapper = gbb.$(".gbbSummaryPageDiscountAppliedWrapper")

                if (!gbbSummaryPageDiscountAppliedWrapper.length > 0) {
                    gbbSummaryPageDiscountAppliedWrapper = gbb.$("<div>").addClass("gbbSummaryPageDiscountAppliedWrapper")
                }
                //if theres an active discount rule
                if (gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive) {
                    if (gbbSummaryPageDiscountAppliedWrapper.length > 0) {
                        // gbb.utility.debugConsole("->gbbreviewPage Code here works");

                        gbbSummaryPageDiscountAppliedWrapper.html(gbb.gbbReviewPage.f.prepareDiscountContainerV2(allBoxesData))
                    } else {
                        // gbb.utility.debugConsole("->came in else block");
                        gbb.$(".gbbSummaryPageDiscountAppliedWrapper").html(gbb.gbbReviewPage.f.prepareDiscountContainerV2(allBoxesData))
                    }
                }

                //if there is no active discount rule. remove the discount container
                else {
                    gbbSummaryPageDiscountAppliedWrapper.remove();
                }
            },
            renderChangeQuantity: async function () {
                // this is the increasedecrease comp
                let variantQuantity = 1;
                let gbbBundleQuantityHTMLContainer = gbb.$("<div>").addClass("gbbBundleQuantityHTMLContainer")

                let gbbBundleQuantityHTML = gbb.$("<div>").addClass("gbbBundleQuantityHTML");

                let gbbBundleQuantityHeading = gbb.$("<div>").addClass("gbbBundleQuantityHeading")
                // let gbbProductQuantityAddButton = gbb.$("<button>").addClass("gbbProductQuantityAddButton")
                let gbbBundleQuantityAddButton = gbb.$("<div>").addClass("gbbBundleChangeButton")
                    .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                    .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor)
                    .html("+")
                // let gbbProductQuantityRemoveButton = gbb.$("<button>").addClass("gbbProductQuantityRemoveButton")
                let gbbBundleQuantityRemoveButton = gbb.$("<div>").addClass("gbbBundleChangeButton")
                    .css("background", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonBgColor)
                    .css("color", gbb.settings.pageCustomizationData?.quickSettings?.colors?.buttonTextColor)
                    .html("-")
                let gbbBundleQuantityLabel = gbb.$("<div>").addClass("gbbBundleQuantityLabel");
                // gbbProductQuantityAddButton.append(gbb.$("<div>").addClass("gbbProductQuantityAddButtonWrapper").html("+"));
                // gbbProductQuantityRemoveButton.append(gbb.$("<div>").addClass("gbbProductQuantityRemoveButtonWrapper").html("-"));

                gbbBundleQuantityAddButton.on("click", async (event) => {
                    variantQuantity += 1;
                    gbbBundleQuantityLabel.text(variantQuantity);
                })

                gbbBundleQuantityRemoveButton.on("click", async (event) => {
                    if (variantQuantity > 0) {
                        variantQuantity -= 1;
                        gbbBundleQuantityLabel.text(variantQuantity);
                    }
                })

                gbbBundleQuantityLabel.text(variantQuantity);

                gbbBundleQuantityHeading.text(gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.quantity) || "Quantity");

                gbbBundleQuantityHTML.append(gbbBundleQuantityRemoveButton)
                gbbBundleQuantityHTML.append(gbbBundleQuantityLabel);
                gbbBundleQuantityHTML.append(gbbBundleQuantityAddButton);
                gbbBundleQuantityHTMLContainer.append(gbbBundleQuantityHTML);

                return gbbBundleQuantityHTMLContainer;
            },
            insertIntoMainPageWrapper: function () {

                gbb.$(".gbbBodyWrapper").html(gbb.state.ReviewPageBody);
                gbb.$(".gbbBodyWrapper").children().first().hide();
                gbb.$(".gbbBodyWrapper").children().first().fadeIn(700);
                return

            },
            registerEvents: function (settings) {
                gbb.gbbLandingPage.state.buildBoxButtonAction = function () {
                    gbb.utility.debugConsole("build box button clicked");
                    // window.alert("build box button clicked");
                };
            },
            populateTotalInTotalBlock: async function (ele) {
                let total = gbb.utility.getGiftBoxProductsTotalWithCurrency()
                ele.text(total)

            },
            populateIteminGiftBoxProductListV2: function (gbbSummaryPageProductListItems, box) {

                try {
                    // let productData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage(boxId);
                    let productData = box;
                    if (productData && productData.items && productData.items.length && productData.items.length > 0) {
                        let products = productData.items
                        for (let i = 0; i < products.length; i++) {
                            let product = products[i]
                            let productProperties = product.properties
                            if (productProperties) {

                                let updateProductTitleOfMessage = gbb.gbbReviewPage.f.getProductTitleModifiedIfMessageOrUpload(product) || "";
                                let updateProductTitleOfProductsThatHavePersonalization = gbb.gbbReviewPage.f.getProductTitleModifiedForPersonalizedProducts(product) || "";

                                if (updateProductTitleOfMessage || updateProductTitleOfProductsThatHavePersonalization) {
                                    product.title = product?.product_title || product?.title || product?.public_title || "";
                                    product.title = product.title + updateProductTitleOfMessage + updateProductTitleOfProductsThatHavePersonalization || "";
                                }



                            }
                            let gbbSummaryPageProductListItem = gbb.$("<div>").addClass("gbbSummaryPageProductListItem")
                            let gbbSummaryPageProductTitleQtyPriceContainer = gbb.$("<div>").addClass("gbbSummaryPageProductTitleQtyPriceContainer");

                            let gbbSummaryPageProductTitleWrapper = gbb.$("<div>").addClass("gbbSummaryPageProductTitleWrapper")
                            let gbbSummaryPageProductQtyPriceContainer = gbb.$("<div>").addClass("gbbSummaryPageProductQtyPriceContainer")

                            let gbbSummaryPageProductListItemName = gbb.$("<div>").addClass("gbbSummaryPageProductListItemName").html(product.title)
                            let qtyHtml1 = gbb.$("<span>").css("font-size", "10px").text("x")
                            let qtyHtml2 = gbb.$("<span>").text("x" + product.quantity)
                            let gbbSummaryPageProductListItemQty = gbb.$("<div>").addClass("gbbSummaryPageProductListItemQty")
                            gbbSummaryPageProductListItemQty.append(qtyHtml2)

                            let gbbSummaryPageProductListItemPrice = gbb.$("<div>").addClass("gbbSummaryPageProductListItemPrice")
                            gbbSummaryPageProductListItemPrice.html(gbb.utility.formatPrice(product.price))
                            let gbbSummaryPageProductListItemRemoveBtn = gbb.$("<span>").addClass("gbbSummaryPageProductListItemRemoveBtn").text(`(${gbb.utility.renderLanguageValue(gbb.settings?.languageData.general.removeButtonText)})`)
                                .attr("data-variant_id", product.variant_id)
                                .attr("data-product_id", product.product_id)

                            gbbSummaryPageProductListItemRemoveBtn.on("click", async function (event) {

                                event.preventDefault();
                                event.stopPropagation();

                                //find the parent element gbbSummaryPageProductListItem and remove it
                                let listItemToBeRemoved = gbb.$(this).parents(".gbbSummaryPageProductListItem")
                                listItemToBeRemoved.remove()

                                gbb.$('.gbbSummaryPageProductListItemRemoveBtn').prop('disabled', true);
                                //add a disabled class
                                // gbb.$('.gbbSummaryPageProductListItemRemoveBtn').addClass('gbbDisabled');
                                setTimeout(function () {
                                    gbb.$('.gbbSummaryPageProductListItemRemoveBtn').prop('disabled', false);
                                    //    gbb.$('.gbbSummaryPageProductListItemRemoveBtn').removeClass('gbbDisabled');
                                }, 500);

                                await gbb.utility.updateCartV2({ updates: { [event.target.dataset.variant_id]: 0 }, attributes: { [event.target.dataset.variant_id]: "reviewPage" } })

                                gbb.gbbReviewPage.f.reRenderDiscountAndSubTotalV2()

                                // gbb.gbbReviewPage.init(gbb.settings, "SUMMARY_PAGE")

                            })

                            // let renderChangeQuantity = await gbb.gbbSummaryPage.f.renderChangeQuantity()

                            //add gbbSummaryPageProductListItemRemoveBtn inside gbbSummaryPageProductListItemName
                            // gbbSummaryPageProductListItemName.append("  ").append(gbbSummaryPageProductListItemRemoveBtn)
                            gbbSummaryPageProductTitleWrapper.append(gbbSummaryPageProductListItemName)
                            // gbbSummaryPageProductTitleWrapper.append(gbbSummaryPageProductListItemRemoveBtn)

                            gbbSummaryPageProductQtyPriceContainer.append(gbbSummaryPageProductListItemPrice)
                            gbbSummaryPageProductQtyPriceContainer.append(gbbSummaryPageProductListItemQty)

                            gbbSummaryPageProductTitleQtyPriceContainer.append(gbbSummaryPageProductTitleWrapper);
                            gbbSummaryPageProductTitleQtyPriceContainer.append(gbbSummaryPageProductQtyPriceContainer);
                            gbbSummaryPageProductListItem.append(gbbSummaryPageProductTitleQtyPriceContainer)


                            gbbSummaryPageProductListItems.append(gbbSummaryPageProductListItem)
                        }
                    }
                } catch (error) {
                    gbb.utility.debugConsole("error", error)
                }
            },
            getProductTitleModifiedIfMessageOrUpload: function (product) {
                try {
                    let titleResult = ""
                    if (product.properties) {
                        //find the value of Message
                        let messageKey = Object.keys(product.properties).find(key => key == "Message");
                        let message = product.properties[messageKey];
                        let recipientEmailKey = Object.keys(product.properties).find(key => key == "Recipient Email");
                        let recipientEmail = product.properties[recipientEmailKey];

                        let attachmentFields = gbb.settings.customerUploads && gbb.settings.customerUploads.attachmentFields && gbb.settings.customerUploads.attachmentFields.map(field => field.label);

                        let customerUploads = attachmentFields && Object.keys(product.properties).filter(key => attachmentFields.includes(key));
                        let videoRecordedKey = Object.keys(product.properties).find(key => key == "Video Recorded");
                        let videoRecordedValue = product.properties[videoRecordedKey];

                        if (message) {
                            titleResult = titleResult + " - " + message;
                        }
                        if (recipientEmail) {
                            titleResult = titleResult + " | Email: " + recipientEmail;
                        }
                        if (videoRecordedValue) {
                            titleResult = titleResult + " | Video Recorded: " + videoRecordedValue;
                        }
                        if (customerUploads) {
                            for (let i = 0; i < customerUploads.length; i++) {
                                let customerUpload = customerUploads[i];
                                customerUpload = gbb.utility.removeFirstCharacterIfUnderscore(customerUpload);
                                titleResult = titleResult + " | " + customerUpload;
                            }
                        }
                    }
                    return titleResult;
                } catch (error) {
                    gbb.utility.debugError("error in getProductTitleModifiedIfMessageOrUpload", error);
                }
            },
            getProductTitleModifiedForPersonalizedProducts: function (product) {
                try {
                    // initialize an empty string to hold the final title result
                    let titleResult = "";

                    // use destructuring to access product properties more directly
                    const productProps = product.properties;

                    if (productProps) {
                        // find the key for "productPersonalizationMetaData" from product properties
                        let personalizationKey = Object.keys(productProps).find(key => key === "productPersonalizationMetaData");

                        // if the key exists
                        if (personalizationKey) {
                            // clone product personalization metadata
                            let metaData = JSON.parse(JSON.stringify(productProps[personalizationKey]));

                            // get the keys of the product personalization metadata
                            let metaDataKeys = Object.keys(metaData);

                            // iterate over each key in product personalization metadata
                            metaDataKeys.forEach(key => {
                                // get the associated value or use empty string if undefined
                                let metaValue = metaData[key] || "";

                                // get field label and value from the metadata value
                                let fieldLabel = metaValue.fieldLabel;
                                let fieldValue = metaValue.value;

                                // create the result to be appended to title using field label and value (if value exists)
                                let appendResult = fieldValue ? `${fieldLabel}: ${fieldValue}` : "";

                                // add the result to the title string with a leading " | "
                                titleResult += ` | ${appendResult}`;
                            });
                        }
                    }

                    // return the final title result
                    return titleResult;
                } catch (error) {
                    // if an error occurs, log it as an error in the console
                    gbb.utility.debugError("error in getProductTitleModifiedForPersonalizedProducts", error);
                }
            },
            reRenderUiOnSubscriptionChange: async function () {
                let allBoxesData = await gbb.utility.getCart(); //TBD
                gbb.gbbReviewPage.f.reRenderDiscountAndSubTotalV2(allBoxesData);
                gbb.gbbReviewPage.f.prepareBundleDetailsContainerUI(allBoxesData);
            },
            checkIfSubscriptionPlanExists: function () {
                const checkIfAllItemsHasASellingPlan = gbb.gbbReviewPage.f.checkIfAllItemsHasASellingPlan()
                const getAllSubscriptionPlans = Object.values(gbb.gbbReviewPage.f.getAllSubscriptionPlans()).length > 0;
                return checkIfAllItemsHasASellingPlan && getAllSubscriptionPlans;
            },
            checkIfAllBoxesHaveZeroPrice: function (cartData) { //this function checks if the items added to cart are only free items
                try {
                    let allBoxesZeroPrice = true;
                    for (const boxId in cartData.boxes) {
                        const box = cartData.boxes[boxId];
                        if (box.total_price != 0) {
                            allBoxesZeroPrice = false;
                            break;
                        }
                    }
                    return allBoxesZeroPrice;
                } catch (err) {
                    gbb.utility.debugConsole(err);
                    return false;
                }
            },
            checkIfCurrentBoxPriceIsZero: function (box) { //this function checks if the items added to cart are only free items
                try {
                    if (box && box?.items?.length > 0 && box?.total_price == 0) {
                        return true;
                    }
                    return false;
                } catch (err) {
                    gbb.utility.debugConsole(err);
                    return false;
                }
            },
            customHTMLBlock: function () {
                let customHTMLBlock = gbb.settings?.stepsConfigurationData?.summaryPageData?.customHTMLBlock || "";
                return customHTMLBlock;
            },
        },
        events: function (settings) {
        },
        action: {
        }
    },


    gbbKite: {
        state: {
            isKiteEnabled: false,
        },
        init: function (settings) {
            gbb.gbbKite.initialize();
        },
        initialize: function () {
            try {
                gbb.gbbKite.f.overWriteDiscountMessaging();
                gbb.gbbKite.f.setMapForDiscountProducts();
            } catch (e) {
                gbb.utility.debugConsole("error in gbbKite initialize", e);
            }
            // gbb.utility.debugConsole("gbbKite initialized");
        },
        f: {
            setMapForDiscountProducts: function () {
                try {
                    if (!gbb.settings.gbbKiteData) {
                        return;
                    }

                    let discounts = gbb.settings.gbbKiteData?.discounts || [];
                    // Initialize a map for discount products
                    let discountMap = {};

                    // Loop through each discount object
                    for (let i = 0; i < discounts.length; i++) {
                        const discountObj = discounts[i];

                        // Check if isEBIntegrationEnabled is false
                        if (!discountObj.isEBIntegrationEnabled) {
                            continue;
                        }

                        // Get the first discount value from the rules
                        const discountValue = discountObj.rules[0].disValue;

                        // Get the discount type
                        const discountType = discountObj.disValueType;

                        // Get the products
                        const products = gbb.gbbKite.f.flattenProductsDataInDesiredFormat(discountObj);

                        // Loop through each product
                        for (let j = 0; j < products.length; j++) {
                            const product = products[j];

                            // Store the discount value and type for this product in the map
                            discountMap[product.productId] = { discountValue, discountType };
                        }
                    }
                    // Return the discount map
                    // return discountMap;
                    gbb.gbbKite.state.mapForDiscountProducts = discountMap;
                } catch (e) {
                    gbb.utility.debugConsole("error in setMapForDiscountProducts", e);
                }
            },
            modifyProductDataWithDiscountedPrice: function (productData) {
                try {
                    // Get the product id
                    const productId = productData.id;

                    //isDiscountToBeAppliedOnThisProduct(productData)

                    // Get the discount map
                    const discountMap = gbb.gbbKite.state.mapForDiscountProducts;



                    // Check if the product id exists in the discount map
                    if (discountMap && discountMap[productId]) {
                        // Get the discount value and type
                        const discountValue = discountMap[productId].discountValue;
                        const discountType = discountMap[productId].discountType;

                        // Get the product price

                        productData.compare_at_price = productData.price;
                        productData.price = gbb.gbbKite.f.modifyPriceBasedOnType(productData.price, { discountValue, discountType });


                        for (let i = 0; i < productData.variants.length; i++) {
                            let variant = productData.variants[i];
                            // variant.price = productPrice;
                            variant.compare_at_price = variant.price;
                            // variant.price = productPrice;
                            variant.price = gbb.gbbKite.f.modifyPriceBasedOnType(variant.price, { discountValue, discountType });
                        }



                    }

                    // Return the modified product data
                    return productData;
                } catch (e) {
                    gbb.utility.debugConsole("error in modifyProductDataWithDiscountedPrice", e);

                    // Return the original product data

                    return productData;
                }
            },
            modifyPriceBasedOnType: function (originalPrice, discountSettings) {
                let { discountValue, discountType } = discountSettings;

                // Apply the discount to the price
                if (discountType === 'PERCENTAGE_DIS') {
                    return originalPrice * (1 - (discountValue / 100));
                } else if (discountType === 'FIXED_DIS') {
                    // multiply by 100 to convert to shopify api original way
                    discountValue = discountValue * 100;
                    return Math.max(originalPrice - discountValue, 0);
                } else {
                    // If the discount type is not recognized, return the original price
                    return originalPrice;
                }
            },

            overWriteDiscountMessaging: function() {
                try {
                    if (gbb.settings.discountsData.isKiteDiscountMessagingEnabled) {
                        gbb.settings.discountsData.rules = gbb.settings.discountsData.kiteDiscountMessaging.rules;
                        gbb.settings.discountsData.discountTextBody = gbb.settings.discountsData.kiteDiscountMessaging.discountTextBody;
                        gbb.settings.discountsData.discountTextForSuccess = gbb.settings.discountsData.kiteDiscountMessaging.discountTextForSuccess;
                    }    
                } catch (error) {
                     gbb.utility.debugConsole("error in overWriteDiscountMessaging", error);
                }
            },
            flattenProductsDataInDesiredFormat: function (discountsObj) {
                try {
                    // Initialize an empty array to hold the normalized products data
                    let flattenedData = [];

                    let productsContainerObj = discountsObj.disProducts;

                    let discountType = productsContainerObj.type;



                    // if the type is "ALL_PRODUCTS", all products are discounted
                    // if (discountType === 'ALL_PRODUCTS') {
                    //     return [];
                    // }

                    // if the type is "COLLECTIONS", check if the product's ID is in the selected collections
                    if (discountType === 'COLLECTIONS') {
                        // Flatten array of product objects in each collection into a single array of product IDs
                        let productsListFromAllCollections = productsContainerObj.collectionsData.map(collection => collection.productList).flat();

                        flattenedData = [...new Set(productsListFromAllCollections)]

                        // Filter products data based on collectionProductIds
                        // flattenedData = productsData.filter(product => collectionProductIds.includes(product.productId));
                    }

                    // if the type is "SELECTED_PRODUCTS", check if the product's ID is in the selected products
                    if (discountType === 'SELECTED_PRODUCTS') {
                        // create an array of product IDs
                        // let selectedProductIds = discountsObj.products.map(product => product.productId);

                        flattenedData = productsContainerObj.products
                        // Filter products data based on selectedProductIds
                        // flattenedData = productsData.filter(product => selectedProductIds.includes(product.productId));
                    }

                    // Return flattened data
                    return flattenedData;
                } catch (error) {
                    gbb.utility.debugError('Error occurred while flattening the products data: ', error);
                    return [];
                }
            },




            isDiscountToBeAppliedOnThisProduct: function (productData, discountObj) {
                try {

                    const discountType = discountObj.type;



                    // return false if none of the above conditions are met
                    return false;
                } catch (e) {
                    gbb.utility.debugConsole("error in isDiscountToBeAppliedOnThisProduct", e);
                }
            }
        }
    },

    gbbDiscountComponent: {
        state: {
            currentDiscountRule: {},
            discountCode: "",
            discountCodePrefix: "",
            isAtleastOneDiscountActive: false,
        },
        init: function (settings) {
            gbb.gbbDiscountComponent.events(settings)
            gbb.gbbDiscountComponent.render(settings)
        },
        render: function (settings) {
            const discountComponentHTML = gbb.gbbDiscountComponent.f.prepareProgressBar()
            //attach all this to the first component of gbbBodyWrapper
            // gbb.$(".gbbBodyWrapper").first().prepend(discountComponentHTML)
            // gbb.elements.cartPageWrapperV2.append(gbbDiscountComponent)
            // return discountComponentHTML;

            //find the gbbDiscountComponent on the page and insert it
            gbb.$(".gbbDiscountComponent").html(discountComponentHTML)
        },
        events: function (settings) {
        },
        f: {
            prepareProgressBar: function (settings) {
                settings = gbb.settings;

                let discountRules = settings.discountsData.rules;
                let isDiscountProgressBarEnabled = settings.discountsData.isDiscountProgressBarEnabled;

                if (isDiscountProgressBarEnabled == false) {
                    return;
                }

                let gbbDiscountComponent = gbb.$("<div>").addClass("gbbDiscountComponent")
                let gbbDiscountComponentTitle = gbb.$("<div>").addClass("gbbDiscountComponentTitle")

                // if(discountD)
                //sort rules by their rule amount in ascending order
                // discountRules = discountRules.sort(function (a, b) {
                //     return a.value - b.value
                // })

                let gbbDiscountComponentProgressBarContainer = gbb.$("<div>").addClass("gbbDiscountComponentProgressBarContainer")

                let gbbDiscountComponentProgressBar = gbb.$("<div>").addClass("gbbDiscountComponentProgressBar")

                let gbbDiscountComponentProgressBarRuleWrapper = gbb.$("<div>").addClass("gbbDiscountComponentProgressBarRuleWrapper")
                let gbbDiscountComponentProgressBarRule = gbb.$("<div>").addClass("gbbDiscountComponentProgressBarRule")
                let gbbDiscountComponentProgressBarRuleText = gbb.$("<span>").addClass("gbbDiscountComponentProgressBarRuleText")


                let maxDiscountValue = discountRules[discountRules.length - 1].amount;
                for (let i = 0; i < discountRules.length; i++) {
                    let rule = discountRules[i]
                    let ruleItemWrapper = gbbDiscountComponentProgressBarRule.clone()
                    let ruleItemText = gbbDiscountComponentProgressBarRuleText.clone()

                    let ruleOffer = gbb.utility.renderLanguageValue(eval(`gbb.settings.languageData.discountRules.rule${i + 1}.text`))
                    let ruleAmount = gbb.utility.renderLanguageValue(eval(`gbb.settings.languageData.discountRules.rule${i + 1}.amount`))
                    ruleItemText.text(ruleOffer + " " + ruleAmount)

                    // let starSvg = gbb.$("<svg>").addClass("gbbDiscountComponentProgressBarRuleStar").attr("src", CONSTANT_SVG_STAR)

                    // let starSvg = gbb.$("<div>").addClass("gbbStarSvgContainer").append(CONSTANT_SVG_STAR)
                    let starSvg = gbb.$("<div>").addClass("gbbStarSvgContainer").append(CONSTANT_SVG_CIRCLE)

                    //add data attribut to this starSvg of discount amount
                    starSvg.attr("data-discount-amount", rule.amount)
                    //.gbbStarSvgContainer polygon.svgStar
                    //the max discount gets the left: 100% and the rest get the left: with a calculated percentage
                    if (rule.amount == maxDiscountValue) {
                        ruleItemText.css("left", "95%")
                        starSvg.css("left", "97%")
                    } else {
                        starSvg.css("left", `${((rule.amount / maxDiscountValue) * 100) - parseInt(2)}%`)
                        ruleItemText.css("left", `${((rule.amount / maxDiscountValue) * 100) - parseInt(5)}%`)
                    }

                    //attach the rule to the progress bar
                    ruleItemWrapper.append(starSvg)
                    ruleItemWrapper.append(ruleItemText)
                    gbbDiscountComponentProgressBarRuleWrapper.append(ruleItemWrapper)

                }
                gbbDiscountComponentProgressBarContainer.append(gbbDiscountComponentProgressBar)
                gbbDiscountComponentProgressBarContainer.append(gbbDiscountComponentProgressBarRuleWrapper)

                gbbDiscountComponent.append(gbbDiscountComponentProgressBarContainer)

                return gbbDiscountComponent;
            },
            updateCurrentDiscountRule: async function () {
                try {

                    if (gbb.settings.discountsData.rules == undefined || gbb.settings.discountsData.isDiscountEnabled == false) {
                        return;
                    }
                    let currentDiscountMode = gbb.settings.discountsData.discountMode;

                    if (gbb.settings.discountsData.isKiteDiscountMessagingEnabled){
                        currentDiscountMode = gbb.settings.discountsData.kiteDiscountMessaging.discountMode
                    }

                    let currentDiscountRuleKeys = [];
                    //get all keys from gbb.gbbDiscountComponent.state.currentDiscountRule = {}
                    if (gbb.gbbDiscountComponent.state.currentDiscountRule) {
                        currentDiscountRuleKeys = Object.keys(gbb.gbbDiscountComponent.state.currentDiscountRule)
                    } else {
                        gbb.gbbDiscountComponent.state.currentDiscountRule = {}
                    }



                    let cartDataFromSessionStorage = gbb.gbbBrowser.getCartDataFromSessionStorage();

                    if (!cartDataFromSessionStorage) {
                        return;
                    }
                    //for loop for each box.  discountEligibleCartData(b)

                    let allBoxes = cartDataFromSessionStorage.boxes

                    let allBoxKeys = Object.keys(allBoxes)

                    for (let i = 0; i < currentDiscountRuleKeys.length; i++) {
                        let boxKey = currentDiscountRuleKeys[i];
                        if (allBoxKeys.includes(boxKey) == false) {
                            delete gbb.gbbDiscountComponent.state.currentDiscountRule[boxKey];
                        }
                    }


                    Object.keys(allBoxes).forEach(function (boxKey) {


                        let box = allBoxes[boxKey];

                        let cartData = gbb.gbbDiscountComponent.f.discountEligibleCartData(box);
                        const cartQuantity = cartData.item_count;

                        // let currentCartValue = gbb.state.giftBoxCartData.total_price / 100
                        let currentCartValue = cartData.total_price / 100;

                        let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();

                        let totalCartValue = currentCartValue / activeCurrencyRate;

                        let applicableRule;
                        let applicableDiscountValue = 0;

                        const rulesArr = JSON.parse(JSON.stringify(gbb.settings.discountsData.rules));
                        // const rulesArr = (gbb.settings.discountsData.rules)
                        if (currentDiscountMode != "FIXED_BUNDLE_PRICE") {
                            for (let i = 0; i < rulesArr.length; i++) {
                                if (rulesArr[i].type == "quantity") {
                                    if (cartQuantity >= rulesArr[i].value) {
                                        let curDiscountValue;
                                        if (currentDiscountMode == "PERCENTAGE") {
                                            curDiscountValue = rulesArr[i].discountValue * (totalCartValue / 100);
                                        } else {
                                            curDiscountValue = rulesArr[i].discountValue;
                                        }
                                        // if (!applicableRule || applicableDiscountValue < curDiscountValue) {
                                        applicableRule = rulesArr[i];
                                        applicableDiscountValue = curDiscountValue;
                                        // }
                                    }
                                } else if (rulesArr[i].type == "amount") {
                                    if (totalCartValue >= rulesArr[i].value) {
                                        let curDiscountValue;
                                        if (currentDiscountMode == "PERCENTAGE") {
                                            curDiscountValue = rulesArr[i].discountValue * (totalCartValue / 100);
                                        } else {
                                            curDiscountValue = rulesArr[i].discountValue;
                                        }
                                        // if (!applicableRule || applicableDiscountValue < curDiscountValue) {
                                        applicableRule = rulesArr[i];
                                        applicableDiscountValue = curDiscountValue;
                                        // }
                                    }
                                }
                            }
                            if (!applicableRule) {
                                applicableRule = null;
                            }
                        } else if (currentDiscountMode == "FIXED_BUNDLE_PRICE") {
                            for (let i = 0; i < rulesArr.length; i++) {
                                //store discount only if cartQuantity is equal to the rule value
                                if (cartQuantity == rulesArr[i].value && totalCartValue >= rulesArr[i].discountValue) {
                                    applicableRule = rulesArr[i];
                                    applicableDiscountValue = rulesArr[i].discountValue;
                                }
                            }
                            if (!applicableRule) {
                                applicableRule = null;
                            }
                        }

                        const cartValue = totalCartValue;

                        //   gbb.utility.debugConsole("cartValue= ", cartValue);

                        //get the last rule from the eligible rules
                        //   gbb.utility.debugConsole("applicable rule: ", applicableRule);
                        if (!applicableRule) {
                            gbb.gbbDiscountComponent.state.currentDiscountRule[box.boxId] = null;
                        } else {
                            gbb.gbbDiscountComponent.state.currentDiscountRule[box.boxId] = applicableRule;
                        }
                    });


                    //check all the objects in the currentDiscountRule object and see if they are all null
                    let isDiscountsExist = false;
                    //use a for loop to check if any of the values are not null
                    for (let key in gbb.gbbDiscountComponent.state.currentDiscountRule) {
                        if (gbb.gbbDiscountComponent.state.currentDiscountRule[key] != null) {
                            gbb.gbbDiscountComponent.state.discountCodePrefix = gbb.gbbDiscountComponent.state.currentDiscountRule[key].discountCodePrefix;
                            isDiscountsExist = true;
                            break;
                        }
                    }

                    gbb.gbbDiscountComponent.state.isAtleastOneDiscountActive = isDiscountsExist;

                } catch (e) {
                    gbb.utility.debugError("error in updateCurrentDiscountRule: ", e)
                    gbb.utility.triggerSlackNotification(e)
                }
            },
            discountEligibleCartData: function (cartData) {
                try {

                    // let gbbPagesWhereDiscountIsDisabled = ["addProductsPage2"];
                    // let gbbPagesWhereDiscountIsDisabled = [];
                    //get the current cart items
                    // let cartData = {...gbb.state.giftBoxCartData};
                    // let cartData = gbb.gbbBrowser.getCartDataFromSessionStorage()
                    // let items = gbb.gbbBrowser.getProductsFromAllBoxesFromCart()

                    // cartData.items = items

                    // cartData  = gbb.utility.multiplyByBundleQuantity(cartData)


                    //blacklist a bunch of products which should be filtered out when calculating the discount

                    const messageProductId = gbb.settings?.giftMessage?.messageProduct?.product?.id || null;

                    // const greetingcardProductId = gbb?.settings?.greetingCard?.greetingCardProducts.length ? gbb?.settings?.greetingCard?.greetingCardProducts[0]?.productId : null;

                    // if the length is more than 1, then there are multiple greeting cards
                    // MAKE A LIST OF ALL THE GREETING CARDS

                    let productIdstoFilterForGreetingCards = [];
                    if (gbb?.settings?.greetingCard?.greetingCardProducts.length > 0) {
                        for (let i = 0; i < gbb?.settings?.greetingCard?.greetingCardProducts.length; i++) {
                            productIdstoFilterForGreetingCards.push(gbb?.settings?.greetingCard?.greetingCardProducts[i]?.productId)
                        }
                    }



                    let quantityToRemove = 0;
                    let blackListedIds = [];
                    let blackListedItemsTotalPrice = 0;

                    for (let i = 0; i < cartData.items.length; i++) {
                        if (cartData.items[i].price == 0) {
                            blackListedIds.push(cartData.items[i].product_id)
                        }
                        // if (gbbPagesWhereDiscountIsDisabled.includes(cartData.items[i].properties._boxProduct)) {
                        //     blackListedIds.push(cartData.items[i].product_id)
                        // }
                    }

                    // push items with value zero to the blacklist

                    if (messageProductId) {
                        blackListedIds.push(messageProductId);
                    }
                    if (productIdstoFilterForGreetingCards.length > 0) {
                        productIdstoFilterForGreetingCards.forEach(id => {
                            blackListedIds.push(id);
                        })
                        // blackListedIds.push(greetingcardProductId);
                    }

                    let newCartValue = 0;

                    // each blackListedId should be a number
                    blackListedIds = blackListedIds.map(id => parseInt(id))

                    let blackListedBoxProductKeys = ['addonProduct']  
                    let applicableProducts = cartData.items.map((item, index) => {
                        item.product_id = parseInt(item.product_id);
                        let isProductIdBlackListed = blackListedIds.includes(item?.product_id)
                        let isProductHavingBlackListedProperty = blackListedBoxProductKeys.includes(item?.properties?._boxProduct)

                        if(isProductIdBlackListed || isProductHavingBlackListedProperty){
                            if (item.price > 0 && item.quantity > 0) {
                                blackListedItemsTotalPrice = blackListedItemsTotalPrice + (item.price * item.quantity)
                            }
                            quantityToRemove = item.quantity + quantityToRemove;
                            return;
                        }
                        else{
                            //new cartValue
                            newCartValue = newCartValue + (item.price * item.quantity)
                            return item;
                        } 
                    })

                    //filter out the undefined values
                    applicableProducts = applicableProducts.filter(item => item != undefined)

                    cartData.blackListedItemsTotalPrice = blackListedItemsTotalPrice;
                    cartData.items = applicableProducts;
                    cartData.total_price = newCartValue
                    cartData.item_count = cartData.item_count - quantityToRemove
                    // gbb.utility.debugConsole("applicableProducts quantity ", cartData.item_count)
                    return cartData

                } catch (e) {
                    gbb.utility.debugError("error in discountEligibleCartData: ", e)
                    return
                }
            },
            calculateNextApplicableDiscountRuleForFixedBundlePrice: function () {
                try {
                    let result = {
                        nextDiscountRuleForFBP: undefined,
                        isFirstDiscountRule: false,
                        nextDiscountRuleIndexForFBP: null
                    }
                    // let allDiscountsData = {...gbb?.settings?.discountsData} || {};
                    let allDiscountsData = JSON.parse(JSON.stringify(gbb?.settings?.discountsData)) || {};

                    // let discountRules = [...gbb?.settings?.discountsData?.rules] || [];
                    let discountRules = JSON.parse(JSON.stringify(gbb?.settings?.discountsData?.rules)) || [];

                    // allDiscountsData?.rules now here go through the rules and convert the discountValue to currency of the customer
                    // allDiscountsData.rules = allDiscountsData.rules.map((rule) => {
                    //     rule.value = gbb.utility.convertFromStoreCurrencyToCustomer(rule.value);
                    //     return rule;
                    // })

                    let boxItemsCount = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                    boxItemsCount = boxItemsCount.item_count || 0;
                    let noOfRulesCleared = 0
                    if (boxItemsCount == 0) {
                        result.nextDiscountRuleForFBP = undefined;
                    } else {
                        for (let i = 0; i < discountRules.length; i++) {
                            let currentDiscountRuleValue = parseInt(discountRules[i].value)
                            if (boxItemsCount >= currentDiscountRuleValue) {
                                noOfRulesCleared += 1
                            }
                            if (currentDiscountRuleValue > boxItemsCount) {
                                result.nextDiscountRuleForFBP = discountRules[i];
                                if (i == 0) {
                                    result.isFirstDiscountRule = true;
                                } else {
                                    result.isFirstDiscountRule = false;
                                }
                                break;
                            }
                        }
                    }
                    if (result.isFirstDiscountRule || !result.nextDiscountRuleForFBP) {
                        result.nextDiscountRuleForFBP = allDiscountsData?.rules[0];
                        result.nextDiscountRuleIndexForFBP = 1
                    } else {
                        for (let i = 0; i < allDiscountsData?.rules?.length; i++) {
                            let currRule = allDiscountsData?.rules[i];
                            if (result.nextDiscountRuleForFBP && result.nextDiscountRuleForFBP.discountValue == currRule.discountValue) {
                                // if(i != allDiscountsData?.rules?.length - 1) {
                                result.nextDiscountRuleForFBP = allDiscountsData?.rules[i] //? allDiscountsData?.rules[i+1] : allDiscountsData?.rules[i];
                                result.nextDiscountRuleIndexForFBP = i; //allDiscountsData?.rules[i+1] ? i+1 : i;
                                // } else {
                                // result.nextDiscountRuleForFBP = undefined;
                                // }
                                break;
                            }
                        }
                        result.nextDiscountRuleIndexForFBP += 1;
                    }
                    if (noOfRulesCleared >= discountRules.length) {
                        result.nextDiscountRuleForFBP = undefined;
                        result.nextDiscountRuleIndexForFBP = discountRules.length;
                        result.isAllRuleSatisfied = true
                    }
                    return result;
                } catch (err) {
                    gbb.utility.debugError(err + "inside calculateCurrentDiscountRuleForFixedBundlePrice");
                }
            },
            calculateDiscountProgressBarValue: function () {
                try {
                    let { item_count: totalQuantity, total_price: totalCartValue } = gbb.state.giftBoxCartData
                    let { rules: discountRules } = JSON.parse(JSON.stringify(gbb.settings.discountsData))
                    totalCartValue = totalCartValue / 100
                    let discountRulesType = discountRules[0].type
                    let calculateDiscountOnValue = discountRulesType == 'amount' ? totalCartValue : totalQuantity
                    if (discountRulesType == 'amount') {
                        discountRules = discountRules.map((rule) => {
                            rule.value = gbb.utility.convertFromStoreCurrencyToCustomer(rule.value)
                            return rule
                        })
                    }
                    let highestDiscountValue = 0
                    discountRules.forEach((rule) => highestDiscountValue = Math.max(highestDiscountValue, parseInt(rule.value)))
                    let progressPercentage = (calculateDiscountOnValue / highestDiscountValue) * 100
                    return progressPercentage
                } catch (error) {
                    gbb.utility.debugError("error in calculateDiscountProgressBarValue", error);
                }
            },
            OldcalculateDiscountProgressBarValue: function () {
                // this function can return value when you have mixed discount type for eg: mix type of discount amount and quantity
                try {
                    let { item_count: totalQuantity, total_price: totalCartValue } = gbb.state.giftBoxCartData
                    let { rules: discountRules } = gbb.settings.discountsData
                    totalCartValue = totalCartValue / 100
                    let lastClearedRuleNo = 0


                    discountRules.forEach((rule, idx) => {
                        let searchDb = rule.type == 'amount' ? totalCartValue : totalQuantity
                        if (searchDb >= Number(rule.value)) {
                            lastClearedRuleNo = idx + 1
                            // LastClearedRuleNo is nothing but the index of the last discount rule that was cleared -> this will help us to calculate the distance between the last cleared rule and the next rule
                        }
                    });

                    let nextRule = discountRules[lastClearedRuleNo]// ? discountRules[lastClearedRuleNo + 1] : undefined
                    let nextRuleProgress = 0

                    if (nextRule) {
                        let nextRuleValue = Number(nextRule.value)
                        let valeOfEachShare = 100 / discountRules.length // valueOfEachShare is the percentage of the progress bar that each rule will take -> for Eg : 5 rules then each rule will take 20% -> 100/5 = 20
                        let searchDb = nextRule.type == 'amount' ? totalCartValue : totalQuantity
                        nextRuleProgress = (searchDb / nextRuleValue) * valeOfEachShare // using this formulate we calculate the progress of the next rule
                    }

                    let progressPercentage = (lastClearedRuleNo * 100) / discountRules.length;
                    // first calculate the progress of the last cleared rule and then add the progress of the next rule for Eg: lastClearedRuleNo 3 and we have 4 discount rules -> 300/4 = 75% -> now we add the progress of the next rule to this 75% -> 75% + 10% = 85%
                    progressPercentage += nextRuleProgress
                    return progressPercentage
                } catch (error) {
                    gbb.utility.debugError("error in calculateDiscountProgressBarValue", error);
                }
            },
            isEveryDiscountRulehaveSameType: function () {
                try {
                    let discountRulesArray = gbb.settings.discountsData.rules || []
                    if (discountRulesArray.length == 0) return false
                    for (let i = 0; i < discountRulesArray.length; i++) {
                        if (discountRulesArray[i].type != discountRulesArray[0].type) {
                            return false
                        }
                    }
                    return true
                } catch (error) {
                    gbb.utility.debugError("error in isEveryDiscountRulehaveSameType", error);
                }
            },
            discountStatusFooterHTML: function () {
                try {
                    let gbbDiscountFooterHTML = gbb.$("<div>").addClass('gbbDiscountFooterHTML');
                    let gbbDiscountMessage = gbb.$("<div>").addClass('gbbDiscountMessage');
                    let renderAddonsMessaging = gbb.gbbAddonProducts.f.checkIfAddonsMessagingNeeded()
                    if (renderAddonsMessaging) {
                        let messageToDisplay = gbb.gbbAddonProducts.f.getAddonsMessageToRender()
                        gbbDiscountMessage.html(messageToDisplay)
                        gbbDiscountFooterHTML.append(gbbDiscountMessage)
                    } else {
                        let currentDiscountRuleObj = JSON.parse(JSON.stringify(gbb.gbbDiscountComponent.state.currentDiscountRule[gbb.state.activeBoxId]));
                        // let allDiscountsData = {...gbb?.settings?.discountsData} || {};
                        let allDiscountsData = JSON.parse(JSON.stringify(gbb?.settings?.discountsData)) || {};
                        let nextDiscountRule;
                        let nextDiscountRuleIndex;
                        let discountMessageToBeShown = "";
                        let isAllRuleSatisfied = false // this variable will keep track if user has cleared all the discount rules or not / based on this we will show the discount success message 

                        let currentDiscountMode = gbb.settings.discountsData.discountMode;


                        if (gbb.settings.discountsData.isKiteDiscountMessagingEnabled) {
                            currentDiscountMode = gbb.settings.discountsData.kiteDiscountMessaging.discountMode
                        }

                        //the goal is to find next applicable discoune
                        //for FBP we need to get the currentDiscountRule that can be applied
                        if (currentDiscountMode == "FIXED_BUNDLE_PRICE") {
                            let result = gbb.gbbDiscountComponent.f.calculateNextApplicableDiscountRuleForFixedBundlePrice();
                            nextDiscountRule = result.nextDiscountRuleForFBP;
                            nextDiscountRuleIndex = result.nextDiscountRuleIndexForFBP;
                            if (result.isAllRuleSatisfied) {
                                isAllRuleSatisfied = true
                            }
                        } else {
                            //the purpose of nextDiscountRuleIndex is to use this to show the respective message on ui

                            if (!currentDiscountRuleObj) {
                                nextDiscountRule = allDiscountsData?.rules[0];
                                nextDiscountRuleIndex = 1
                            } else {
                                //if it's not the first rule then we iterate through all the rules and check for the next applicable discount rule
                                for (let i = 0; i < allDiscountsData?.rules?.length; i++) {
                                    let currRule = allDiscountsData?.rules[i];
                                    //if currentDiscountRuleObj discount value that is applied is equal to the currRule (rule that is currently)
                                    //being iterated then we need to get the rule right after that -> i+1
                                    if (currentDiscountRuleObj && currentDiscountRuleObj.discountValue == currRule.discountValue && i + 1 <= allDiscountsData?.rules?.length) {
                                        //if the currentDiscountRuleObj is the maximum discount rule that's there
                                        //then we don't do anything, otherwise:
                                        if (i != allDiscountsData?.rules?.length - 1) {
                                            nextDiscountRule = allDiscountsData?.rules[i + 1] //? allDiscountsData?.rules[i+1] : allDiscountsData?.rules[i];
                                            nextDiscountRuleIndex = i + 1; //allDiscountsData?.rules[i+1] ? i+1 : i;
                                            break;
                                        } else {
                                            isAllRuleSatisfied = true
                                            nextDiscountRule = undefined;
                                        }
                                        break;
                                    }
                                }
                                nextDiscountRuleIndex = nextDiscountRuleIndex + 1;
                            }
                        }

                        if (nextDiscountRule?.discountValue && currentDiscountMode == "FIXED_BUNDLE_PRICE") {
                            discountMessageToBeShown = gbb.settings.discountsData.discountTextBody.fixedBundlePrice;
                            nextDiscountRule.discountValue = gbb.utility.convertFromStoreCurrencyToCustomer(nextDiscountRule.discountValue);
                            //round off to the ceiling
                            // nextDiscountRule.discountValue = Math.ceil(nextDiscountRule.discountValue);
                        } else {
                            if (nextDiscountRule && nextDiscountRule?.type == "amount") {
                                nextDiscountRule.value = gbb.utility.convertFromStoreCurrencyToCustomer(nextDiscountRule?.value);
                                // nextDiscountRule.value = Math.ceil(nextDiscountRule.value);
                            }

                            if (nextDiscountRule && currentDiscountMode == "FIXED") {
                                nextDiscountRule.discountValue = gbb.utility.convertFromStoreCurrencyToCustomer(nextDiscountRule?.discountValue);
                                // nextDiscountRule.discountValue = Math.ceil(nextDiscountRule.discountValue);
                            }
                            discountMessageToBeShown = gbb.settings.discountsData.discountTextBody.percentageAndFixed;
                        }
                        discountMessageToBeShown = nextDiscountRuleIndex ? discountMessageToBeShown["rule" + nextDiscountRuleIndex]["text"] : '';

                        let message = ''
                        if (nextDiscountRule && discountMessageToBeShown) {
                            message = gbb.gbbDiscountComponent.f.replaceDiscountVariables(discountMessageToBeShown, nextDiscountRule);
                        }
                        // gbbDiscountMessage.text(message);
                        // whenever user exhausts all the discount rules -> we store undefined in the nextDiscountRule variable till now so to show the success message we need to check if the nextDiscountRule is undefined and all the rules are satisfied
                        if (!nextDiscountRule && isAllRuleSatisfied) {
                            message = gbb.settings.discountsData?.discountTextForSuccess?.value;
                        }
                        let doesThisContainNextLineKeyword = true
                        if (message && (doesThisContainNextLineKeyword)) {
                            gbbDiscountMessage.html(message);
                        } else {
                            gbbDiscountMessage.text(message);
                        }

                        gbbDiscountMessage.css("color", gbb.settings?.pageCustomizationData?.cartFooter?.cartFooterDiscountTextColor || "black")


                        let gbbDiscountMessageContainer = gbb.$('<div>').addClass('gbbDiscountMessageContainer')

                        gbbDiscountMessageContainer.append(gbbDiscountMessage)
                        gbbDiscountFooterHTML.append(gbbDiscountMessageContainer)
                        let isEveryDiscountRulehaveSameType = gbb.gbbDiscountComponent.f.isEveryDiscountRulehaveSameType();
                        if (gbb.settings?.discountsData?.isDiscountProgressBarEnabled && isEveryDiscountRulehaveSameType) {
                            let filledPercentage = gbb.gbbDiscountComponent.f.calculateDiscountProgressBarValue();// get the filled percentage value for the progress bar
                            let progressBarConfigOptions = {
                                filledColor: gbb.settings.pageCustomizationData?.cartFooter?.cartFooterDiscountProgressBarFilledColor || '#4caf50',
                                emptyColor: gbb.settings.pageCustomizationData?.cartFooter?.cartFooterDiscountProgressBarEmptyColor || '#C1E7C5',
                                filledPercentage: filledPercentage || 0
                            }
                            let progressBarHTML = gbb.gbbAddProductsPage.f.renderProgressBarHTML(progressBarConfigOptions)
                            gbbDiscountFooterHTML.append(progressBarHTML)
                        }

                    }
                    return gbbDiscountFooterHTML;
                } catch (err) {
                    gbb.utility.debugError(err + "inside discountStatusFooterHTML");
                }
            },
            replaceDiscountVariables: function (message, nextDiscountRule) {
                if (nextDiscountRule) {
                    let boxCartData = gbb.gbbBrowser.getRelevantBoxDataFromSessionStorage();
                    let discountConditionDiff;
                    let discountUnit;
                    let discountValue;
                    let currentCartValue;
                    let discountValueUnit;
                    let currentDiscountMode = gbb.settings.discountsData.discountMode;


                    if (gbb.settings.discountsData.isKiteDiscountMessagingEnabled){
                        currentDiscountMode = gbb.settings.discountsData.kiteDiscountMessaging.discountMode
                    }

                    if (nextDiscountRule.type == "amount") {
                        currentCartValue = parseFloat(boxCartData?.total_price / 100).toFixed(2);
                        currentCartValue = Math.round(currentCartValue);
                        discountUnit = gbb.utility.getCurrencySymbol();
                        // let activeCurrencyRate = gbb.utility.getActiveCurrencyRate();
                        // currentCartValue = currentCartValue / activeCurrencyRate;
                    } else if (nextDiscountRule.type == "quantity") {
                        // currentCartValue = boxCartData.item_count || 0;
                        let cartValue = JSON.parse(JSON.stringify(boxCartData.items));
                        //find cart item only that have more than 0 price
                        cartValue = boxCartData.items.filter(item => item.price > 0);
                        // 
                        // get me cartValue, boxCartData
                        currentCartValue = 0;
                        cartValue.forEach(item => {
                            currentCartValue = currentCartValue + item.quantity;
                        })
                        discountUnit = " product(s)";
                        if (parseInt(currentCartValue) >= parseInt(nextDiscountRule.value)) {
                            return "";
                        }
                    }

                    if (currentDiscountMode == "FIXED_BUNDLE_PRICE") {
                        discountUnit = " product(s)";
                        discountValueUnit = gbb.utility.getCurrencySymbol();
                        // discountValueUnit = gbb.utility.getStoreCurrencySymbol();
                    }

                    let isDiscountFromKiteAndPercentage = false;
                    let isDiscountFromKiteAndFixed = false;

                    if (gbb.settings.discountsData.isKiteIntegrationEnabled) {
                        const discounts = gbb.settings.gbbKiteData?.discounts;
                        if (discounts && discounts.length > 0) {
                            const fixedDiscountsType = ["FIXED_TOTAL", "FIXED_DIS"];
                            const percentageDiscountsType = ["PERCENTAGE_DIS"];
                            if (fixedDiscountsType.includes(discounts[0].disValueType)) {
                                isDiscountFromKiteAndFixed = true;
                            } else if (percentageDiscountsType.includes(discounts[0].disValueType)) {
                                isDiscountFromKiteAndPercentage = true;
                            }
                        }
                    }


                    if (currentDiscountMode == "FIXED" || isDiscountFromKiteAndFixed) {
                        discountValueUnit = gbb.utility.getCurrencySymbol();
                        // discountValueUnit = gbb.utility.getStoreCurrencySymbol();
                    } else if (currentDiscountMode == "PERCENTAGE" || isDiscountFromKiteAndPercentage) {
                        discountValueUnit = "%"
                    }



                    discountConditionDiff = Math.round(nextDiscountRule.value) - Math.round(currentCartValue); //include item that was just added
                    discountValue = nextDiscountRule.discountValue;

                    let variableValues = {
                        discountConditionDiff,
                        discountUnit,
                        discountValue,
                        discountValueUnit
                    }

                    let variables;
                    if (currentDiscountMode == "PERCENTAGE") {
                        variables = ["discountConditionDiff", "discountUnit", "discountValue", "discountValueUnit"]
                    } else {
                        variables = ["discountConditionDiff", "discountUnit", "discountValueUnit", "discountValue"]
                    }

                    for (let i = 0; i < variables.length; i++) {
                        let VariableName = "##" + variables[i] + "##";
                        let value = variableValues[variables[i]];
                        message = message.replace(new RegExp(`${VariableName}`, 'g'), value);
                    }
                } else {
                    message = "";
                }
                return message;
            },

        }
    },
    gbbVideoMsg: {
        init: function (settings, parent, element) {
            gbb.gbbVideoMsg.initialize(settings, parent, element)
        },
        state: {
            elements: {},
            uploadedVideoId: null,
            recordingTimeMS: 60000,
            recordingTime: "1:00",
            recordedBlob: "",
            mediaRecorder: null,
            interval: undefined,
            emailId: null,
            gbbVideoMsgPlayerWrapper: null,
        },
        initialize: function (settings, parent, element) {
            // let productHandle = gbb.f.getProductPageHandle(settings)
            gbb.utility.debugConsole("videoMesageInitialize");
            //todo
            if (true || gbb.settings.videoMessage.isVideoMessageEnabled) {
                gbb.gbbVideoMsg.f.registerEvents()
                gbb.gbbVideoMsg.f.prepareVideoMsgPlayer(element)
                // // let oneClickUpsellProductPageHTML = gbb.gbbOneClickUpsell.f.prepareUI(settings, variantListToBeShownOnProductPage, parent)
                // let giftMessageProductPageHTML = gbb.gbbMessage.f.prepareUI(settings, productHandle, parent)
                // gbb.gbbMessage.f.insertIntoProductPageWrapper(settings, giftMessageProductPageHTML)
                // gbb.utility.overWriteBuyNowBtn()
                // gbb.state.isOverWriteBuyNowBtnTriggered = true
            }

        },
        f: {
            registerEvents: function () {
                gbb.$(document).on("click", ".gbbVideoMsgButton", gbb.gbbVideoMsg.actions.gbbVideoMsgButton)
            },
            prepareVideoMsgPlayer: function (element) {

                let gbbVideoMsgPlayerWrapper = gbb.$("<div>").addClass("gbbVideoMsgPlayerWrapper");

                gbb.gbbVideoMsg.state.gbbVideoMsgPlayerWrapper = gbbVideoMsgPlayerWrapper;
                let gbbRecorder = gbb.$("<div>").addClass("gbbRecorder")
                gbb.utility.debugConsole("prepareVideoMsgPlayer");
                let gbbRecorderCloseBtn = gbb.$("<button>").addClass("gbbRecorderCloseBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickClose(e) })

                //: change s3 url
                let gbbRecorderCloseBtnImg = gbb.$("<img>").attr("src", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/close-video.svg")
                gbbRecorderCloseBtn.append(gbbRecorderCloseBtnImg)

                //: change s3 url
                let gbbRecord = gbb.$("<div>").addClass("gbbRecord")
                let gbbVideoPlayer = gbb.$("<video>").addClass("gbbVideoPlayer")
                    .attr("autoplay", true)
                    .prop("muted", true)
                    .attr("poster", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/free-video.jpg")
                let gbbPermissionDenied = gbb.$("<div>").addClass("gbbPermissionDenied gbbVideoPlayerHide").text(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.permissionDenied))
                let gbbVideoPlayerStatus = gbb.$("<div>").addClass("gbbVideoPlayerStatus").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.pressToRecord))

                //let gbbVideoPlayerEmptyPTag = gbb.$("<p>");

                let gbbVideoPlayerStartBtn = gbb.$("<button>").addClass("gbbVideoPlayerStartBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickStart(e) })
                let gbbVideoPlayerRedDot = gbb.$("<div><p></p></div>").addClass("gbbVideoPlayerRedDot")
                //gbbVideoPlayerRedDot.append(gbbVideoPlayerEmptyPTag);
                gbbVideoPlayerStartBtn.append(gbbVideoPlayerRedDot)

                let gbbVideoPlayerStopBtn = gbb.$("<button>").addClass("gbbVideoPlayerStopBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickStop(e) })
                let gbbVideoPlayerRedSquare = gbb.$("<div><p></p></div>").addClass("gbbVideoPlayerRedSquare")
                //gbbVideoPlayerRedSquare.append(gbbVideoPlayerEmptyPTag);
                gbbVideoPlayerStopBtn.append(gbbVideoPlayerRedSquare)


                let gbbVideoPlayerTimeLeft = gbb.$("<div>").addClass("gbbVideoPlayerTimeLeft gbbVideoPlayerHide")

                gbbRecord.append(gbbVideoPlayer)
                gbbRecord.append(gbbPermissionDenied)
                gbbRecord.append(gbbVideoPlayerStatus)
                gbbRecord.append(gbbVideoPlayerStartBtn)
                gbbRecord.append(gbbVideoPlayerStopBtn)
                gbbRecord.append(gbbVideoPlayerTimeLeft)


                let gbbRecorded = gbb.$("<div>").addClass("gbbRecorded")

                let gbbVideoPlayerRecording = gbb.$("<video>").addClass("gbbVideoPlayerRecording")
                    .attr("preload", "none")
                    .attr("poster", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/free-video.jpg")

                let gbbLoadingHeading = gbb.$("<div>").addClass("gbbLoadingHeading gbbVideoPlayerHide").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.loading))
                let gbbUploadingVideoHeading = gbb.$("<div>").addClass("gbbUploadingVideoHeading gbbVideoPlayerHide").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.uploading))

                let gbbVideoPlayerControls = gbb.$("<div>").addClass("gbbVideoPlayerControls")

                let gbbVideoPlayerControlsAcceptBtnDiv = gbb.$("<div>").addClass("gbbVideoPlayerControlsAcceptBtnDiv");

                let gbbVideoPlayerControlsAcceptBtnDivInfo = gbb.$("<p>").addClass("gbbVideoPlayerControlsBtnDivInfo").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.startUploadText));

                gbbVideoPlayerControlsAcceptBtnDiv.append(gbbVideoPlayerControlsAcceptBtnDivInfo);

                let gbbVideoPlayerControlsAcceptBtn = gbb.$("<button>").addClass("gbbVideoPlayerControlsAcceptBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickAccept(e) })

                //CHORE : change s3 url
                let gbbVideoPlayerControlsAcceptBtnImg = gbb.$("<img>").addClass("gbbVideoPlayerControlsAcceptBtnImg")
                    .attr("src", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/confirm-video.png")
                gbbVideoPlayerControlsAcceptBtn.append(gbbVideoPlayerControlsAcceptBtnImg)
                gbbVideoPlayerControlsAcceptBtnDiv.append(gbbVideoPlayerControlsAcceptBtn);



                let gbbVideoPlayerControlsPlayBtnDiv = gbb.$("<div>").addClass("gbbVideoPlayerControlsPlayBtnDiv");

                let gbbVideoPlayerControlsPlayBtnDivInfo = gbb.$("<p>").addClass("gbbVideoPlayerControlsBtnDivInfo").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.playText));

                gbbVideoPlayerControlsPlayBtnDiv.append(gbbVideoPlayerControlsPlayBtnDivInfo);

                let gbbVideoPlayerControlsPlayBtn = gbb.$("<button>").addClass("gbbVideoPlayerControlsPlayBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickPlay(e) })
                let gbbVideoPlayerControlsPlayBtnImg = gbb.$("<img>").addClass("gbbVideoPlayerControlsPlayBtnImg")
                    .attr("src", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/play-video.png")
                gbbVideoPlayerControlsPlayBtn.append(gbbVideoPlayerControlsPlayBtnImg)
                gbbVideoPlayerControlsPlayBtnDiv.append(gbbVideoPlayerControlsPlayBtn);


                let gbbVideoPlayerControlsReStartBtnDiv = gbb.$("<div>").addClass("gbbVideoPlayerControlsReStartBtnDiv");

                let gbbVideoPlayerControlsReStartBtnDivInfo = gbb.$("<p>").addClass("gbbVideoPlayerControlsBtnDivInfo").html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.reRecordVideoText));

                gbbVideoPlayerControlsReStartBtnDiv.append(gbbVideoPlayerControlsReStartBtnDivInfo);

                let gbbVideoPlayerControlsReStartBtn = gbb.$("<button>").addClass("gbbVideoPlayerControlsReStartBtn").on("click", function (e) { gbb.gbbVideoMsg.f.clickReStart(e) })
                let gbbVideoPlayerControlsReStartBtnImg = gbb.$("<img>").addClass("gbbVideoPlayerControlsReStartBtnImg")
                    .attr("src", "https://db07ji0eqime4.cloudfront.net/public/videoMessage/redo-video.png")
                gbbVideoPlayerControlsReStartBtn.append(gbbVideoPlayerControlsReStartBtnImg)
                gbbVideoPlayerControlsReStartBtnDiv.append(gbbVideoPlayerControlsReStartBtn);

                gbbVideoPlayerControls.append(gbbVideoPlayerControlsReStartBtnDiv)
                gbbVideoPlayerControls.append(gbbVideoPlayerControlsPlayBtnDiv)
                gbbVideoPlayerControls.append(gbbVideoPlayerControlsAcceptBtnDiv)


                gbbRecorded.append(gbbVideoPlayerRecording)
                gbbRecorded.append(gbbLoadingHeading)
                gbbRecorded.append(gbbUploadingVideoHeading)
                gbbRecorded.append(gbbVideoPlayerControls)


                gbbRecorder.append(gbbRecorderCloseBtn)
                gbbRecorder.append(gbbRecord)
                gbbRecorder.append(gbbRecorded)

                gbbVideoMsgPlayerWrapper.append(gbbRecorder)
                element.after(gbbVideoMsgPlayerWrapper);
                //attach it to the body
                // gbb.$("body").append(gbbVideoMsgPlayerWrapper);
                // .after(gbbVideoMsgPlayerWrapper);

                gbb.gbbVideoMsg.state.elements.gbbRecorder = gbbRecorder
                gbb.gbbVideoMsg.state.elements.gbbRecord = gbbRecord
                gbb.gbbVideoMsg.state.elements.gbbRecorded = gbbRecorded
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayer = gbbVideoPlayer
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStartBtn = gbbVideoPlayerStartBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStopBtn = gbbVideoPlayerStopBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControlsReStartBtn = gbbVideoPlayerControlsReStartBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControlsPlayBtn = gbbVideoPlayerControlsPlayBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording = gbbVideoPlayerRecording
                gbb.gbbVideoMsg.state.elements.gbbRecorderCloseBtn = gbbRecorderCloseBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControlsAcceptBtn = gbbVideoPlayerControlsAcceptBtn
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls = gbbVideoPlayerControls
                gbb.gbbVideoMsg.state.elements.gbbLoadingHeading = gbbLoadingHeading
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerTimeLeft = gbbVideoPlayerTimeLeft
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus = gbbVideoPlayerStatus
                gbb.gbbVideoMsg.state.elements.gbbPermissionDenied = gbbPermissionDenied
                gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading = gbbUploadingVideoHeading


            },
            createRecorder: function () {
                gbb.gbbVideoMsg.state.elements.gbbRecorder.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbRecord.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStartBtn.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbPermissionDenied.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbRecorded.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStopBtn.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerTimeLeft.html(gbb.gbbVideoMsg.state.recordingTime);
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.pressToRecord));
                gbb.gbbVideoMsg.state.recordingTime = "1:00";
                gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.uploading));
                navigator.mediaDevices
                    .getUserMedia({
                        audio: true,
                        video: true,
                    })
                    .then((stream) => {
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].srcObject = stream;
                    })
                    .catch((error) => {
                        gbb.utility.debugConsole("navigator", error)
                        gbb.utility.debugConsole(error);
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStartBtn.addClass("gbbVideoPlayerHide");
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus.addClass("gbbVideoPlayerHide");
                        gbb.gbbVideoMsg.state.elements.gbbPermissionDenied.removeClass("gbbVideoPlayerHide");
                    });
            },
            clickClose: function (e) {
                e.preventDefault();
                gbb.gbbVideoMsg.state.gbbVideoMsgPlayerWrapper.css('display', 'none')
                // gbb.gbbVideoMsg.state.elements.gbbRecorder.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.f.stopRecording(gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].srcObject);
                gbb.gbbVideoMsg.f.revokeObjectUrl();
            },
            stopRecording: function (stream) {
                if (gbb.gbbVideoMsg.state.interval) {
                    clearInterval(gbb.gbbVideoMsg.state.interval);
                }
                if (gbb.gbbVideoMsg.state.mediaRecorder && gbb.gbbVideoMsg.state.mediaRecorder.state !== "inactive") {
                    gbb.gbbVideoMsg.state.mediaRecorder.stop();
                }
                stream.getTracks().forEach(function (track) {
                    if (track.readyState == "live") {
                        gbb.utility.debugConsole("hello - stop");
                        track.stop();
                    }
                })
            },

            clearTracks: function (stream) {
                if (stream) {
                    stream.getTracks().forEach(function (track) {
                        if (track.readyState == "live") {
                            gbb.utility.debugConsole("hello - stop");
                            track.stop();
                        }
                    })

                }

            },
            revokeObjectUrl: function () {
                URL.revokeObjectURL(gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording.src);
            },
            clickStart: function async(e) {
                e.preventDefault();
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStartBtn.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbRecorderCloseBtn.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStopBtn.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerTimeLeft.removeClass("gbbVideoPlayerHide");

                // the below field for the text
                //hide the toggle
                //gbbVideoMsgCheckboxWrapper

                gbb.gbbVideoMsg.f.clearTracks(gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].srcObject);

                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.recording));
                navigator.mediaDevices
                    .getUserMedia({
                        video: true,
                        audio: true,
                    })
                    .then((stream) => {
                        gbb.utility.debugConsole("1 - navigator");
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].srcObject = stream;
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].captureStream = gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].captureStream || gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].mozCaptureStream;
                        return new Promise((resolve) => (
                            gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].onplaying = resolve
                        ));
                    })
                    .then(() => {
                        gbb.utility.debugConsole("2 - onplaying");
                        return gbb.gbbVideoMsg.f.startRecording(e, gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].captureStream())
                    })
                    .then((recordedChunks) => {
                        gbb.utility.debugConsole("3 - startRecording");
                        gbb.utility.debugConsole(recordedChunks);
                        gbb.gbbVideoMsg.state.justNowRecorded = true
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.removeClass("gbbVideoPlayerHide");
                        gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.addClass("gbbVideoPlayerHide");
                        gbb.gbbVideoMsg.state.elements.gbbLoadingHeading.addClass("gbbVideoPlayerHide");
                        gbb.gbbVideoMsg.state.recordedBlob = new Blob(recordedChunks, { type: "video/webm" });
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording.attr("src", URL.createObjectURL(gbb.gbbVideoMsg.state.recordedBlob));
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording[0].load();
                    })
                    .catch(
                        (error) =>
                            gbb.utility.debugConsole(error)
                    );
            },
            startRecording: function (e, stream) {
                return new Promise((resolve, reject) => {

                    let mediaRecorder = new MediaRecorder(stream);
                    gbb.gbbVideoMsg.state.mediaRecorder = mediaRecorder;
                    let parts = [];
                    mediaRecorder.ondataavailable = (event) => {
                        parts.push(event.data);
                    };
                    mediaRecorder.start(1000);

                    mediaRecorder.onerror = (event) => reject(event.name);

                    gbb.gbbVideoMsg.f.wait(mediaRecorder);

                    mediaRecorder.onstop = function () {
                        gbb.utility.debugConsole("mediaRecorder.onstop() func called");
                        resolve(parts);
                    }
                })
            },
            clickStop: function (e) {
                e.preventDefault();
                gbb.gbbVideoMsg.state.elements.gbbRecord.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbRecorded.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerTimeLeft.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerStatus.addClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbRecorderCloseBtn.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.state.elements.gbbLoadingHeading.removeClass("gbbVideoPlayerHide");
                gbb.gbbVideoMsg.f.stopRecording(gbb.gbbVideoMsg.state.elements.gbbVideoPlayer[0].srcObject);
            },
            covertBlobToBase64: async function (recordedBlob) {
                const reader = new FileReader();
                reader.readAsDataURL(recordedBlob);

                reader.onloadend = function () {

                    var arrayBuffer = reader.result;

                    gbb.utility.debugConsole(arrayBuffer);

                    var formData = new FormData();

                    formData.append("upload_data", recordedBlob, "video.txt");
                    formData.append("shopName", gbb.settings.merchantInfo.shopName);

                    // fetch("http://"+gbb.settings.SERVER_URL+"/api/proxy/upload/video?shopName="+gbb.settings.merchantInfo.shopName,{
                    // fetch("/apps/gbb/upload/video", {
                    fetch("/apps/" + gbb.state.gbbUrl + "/upload/video", {
                        method: 'POST',
                        body: formData
                    }).then(
                        response => response.json() // if the response is a JSON object
                    ).then(
                        success => {
                            if (success.responseCode == 200) {
                                gbb.gbbVideoMsg.state.uploadedVideoId = success.data.videoMsgId;
                                gbb.utility.debugConsole(success) // Handle the success response object
                                gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage?.uploadConfirmation) || "Successfully uploaded1");
                                //gbb.$('.gbbVideoMsgPlayerWrapper').css('display', 'none')
                                // Show feedback that it got uploaded
                                // gbb.gbbVideoMsg.state.elements.gbbRecorder.addClass("gbbVideoPlayerHide");
                            }
                            /*
                            * @Abhishek, the below if else condition is added to handle the
                            * condition where the api fails in sending over responseCode 200.
                            */
                            else {
                                gbb.utility.debugConsole(success) // Handle the error response object
                                gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.errorMessage));
                            }

                        }
                    ).catch(
                        error => {
                            gbb.utility.debugConsole(error) // Handle the error response object
                            gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.html(gbb.utility.renderLanguageValue(gbb.settings.languageData.videoMessage.errorMessage));
                        }
                    );
                }
            },
            clickAccept: function (e) {
                e.preventDefault();
                gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.addClass("gbbVideoPlayerHide")
                gbb.gbbVideoMsg.state.elements.gbbUploadingVideoHeading.removeClass("gbbVideoPlayerHide")
                gbb.gbbVideoMsg.f.covertBlobToBase64(gbb.gbbVideoMsg.state.recordedBlob);
            },
            wait: function (mediaRecorder) {
                var now = new Date().getTime();
                var deadline = new Date(now + gbb.gbbVideoMsg.state.recordingTimeMS).getTime();
                var interval = setInterval(() => {
                    now = new Date().getTime();
                    var t = deadline - now;
                    gbb.utility.debugConsole(t);
                    var minutes = Math.floor((t % (1000 * 60 * 60)) / (1000 * 60));
                    var seconds = Math.floor((t % (1000 * 60)) / 1000);
                    if (t < 0) {
                        gbb.$('.gbbVideoPlayerStopBtn').click();
                    }
                    gbb.gbbVideoMsg.state.elements.gbbVideoPlayerTimeLeft.html(minutes + " : " + seconds)
                }, 1000);
                gbb.gbbVideoMsg.state.interval = interval;
            },
            clickReStart: function (e) {
                e.preventDefault();
                gbb.gbbVideoMsg.f.revokeObjectUrl()
                gbb.gbbVideoMsg.f.createRecorder();
            },
            clickPlay: async function (e) {
                e.preventDefault();
                try {
                    gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.addClass("gbbVideoPlayerHide");
                    gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording[0].play();
                    let isEnded = new Promise((resolve, reject) => {
                        gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording[0].onended = resolve;
                    });
                    await isEnded;
                    gbb.gbbVideoMsg.state.elements.gbbVideoPlayerRecording[0].load();
                    gbb.gbbVideoMsg.state.elements.gbbVideoPlayerControls.removeClass("gbbVideoPlayerHide");

                } catch (error) {
                    gbb.utility.debugConsole(error)
                }
            },
            scrollToVideoDiv: function () {
                // gbb.$(".gbbPersonalizePageMessageContent").animate({scrollTop: 9999},1000);
                gbb.$(".giftMessageV2MainContent").animate({ scrollTop: 360 }, 2000, 'swing');
            },
        },
        actions: {
            gbbVideoMsgButton: function (e) {
                e.preventDefault()
                gbb.gbbVideoMsg.state.gbbVideoMsgPlayerWrapper.css('display', 'grid')
                gbb.gbbVideoMsg.f.createRecorder()
                gbb.gbbVideoMsg.f.scrollToVideoDiv()
            },
        },
        events: {

        },

    },
    gbbIntegrations: {
        judgeme: {
            state: {
                public_token: null,
                baseURL: null,
                reviewStarsHTMLbyProductIds: null,
            },
            init: async function (productsData) {
                try {
                    let params = {}
                    gbb.gbbIntegrations.judgeme.state.public_token = gbb?.settings?.app?.integrations?.judgeme?.public_token
                    gbb.gbbIntegrations.judgeme.state.baseURL = `https://cache.judge.me/widgets/shopify/${gbb?.settings?.merchantInfo?.shopName}?publictoken=${gbb?.settings?.app?.integrations?.judgeme?.public_token}`
                    let productIdsToSend = productsData?.map((product) => Number(product.productId) || product.id).join(',')
                    if (productIdsToSend && productIdsToSend.length > 0) {
                        params = {
                            preview_badge_product_ids: productIdsToSend
                        }
                    }
                    await gbb.gbbIntegrations?.judgeme?.initialize(params)
                } catch (error) {
                    gbb.utility.debugError("error in judgeme init", error);
                }
            },
            initialize: async function (options) {
                try {
                    let judgemeData = await gbb.gbbIntegrations?.judgeme?.f?.getJudgeMeData(options)
                    let judgemeStyle = judgemeData?.html_miracle;
                    gbb.gbbIntegrations?.judgeme?.f?.appendJudgeMeStyle(judgemeStyle)
                    gbb.gbbIntegrations.judgeme.state.reviewStarsHTMLbyProductIds = judgemeData?.preview_badges || []
                } catch (error) {
                    gbb.utility.debugError('error in judgeme initialize', error)
                }
            },
            f: {
                getJudgeMeData: function (options = {}) {
                    try {
                        let params = ''
                        for (const key in options) {
                            params += `&${key}=${options[key]}`
                        }
                        let fetchUrl = gbb.gbbIntegrations?.judgeme?.state?.baseURL + params;

                        let judgemeData = new Promise((resolve, reject) => {
                            fetch(fetchUrl)
                                .then((response) => {
                                    return response.json()
                                }).then((response) => {
                                    gbb.utility.debugConsole("judgeme-data:", response);
                                    resolve(response)
                                })
                                .catch((error) => {
                                    reject(error)
                                })
                        })
                        return judgemeData
                    } catch (error) {
                        gbb.utility.debugError("error in getJudgeMeData", error);
                    }
                },
                appendJudgeMeStyle: function (style) {
                    try {
                        gbb.$('html > head').append(style);
                        return style;
                    } catch (error) {
                        gbb.utility.debugError("error in appendJudgeMeStyle", error);
                    }
                },
                getStarsHTMLByProductId: function (productId) {
                    try {
                        let judgemeProductData = gbb.gbbIntegrations?.judgeme?.state?.reviewStarsHTMLbyProductIds || {}
                        let starsHTML = judgemeProductData[productId]
                        return starsHTML
                    } catch (error) {
                        gbb.utility.debugError('error in getStarsHTMLByProductId', error)
                    }
                },
                applyJudgemeStyleAndLanguage : function(){
                    try{
                        const starRatingTexts = document.querySelectorAll(".jdgm-prev-badge__text");
                        const starRatingWrappers = document.querySelectorAll(".jdgm-prev-badge");
                        const starIcons = document.querySelectorAll(".jdgm-prev-badge__stars .jdgm-star");

                        if (jdgmSettings.badge_star_color) {
                        starIcons.forEach((icon) => {
                            icon.style.color = jdgmSettings.badge_star_color;
                        });
                        } else {
                        starIcons.forEach((icon) => {
                            icon.style.color = jdgmSettings.widget_primary_color ?? "#339999";
                        });
                        }

                        if (jdgmSettings.badge_n_reviews_text) {
                        const textFormat = jdgmSettings.badge_n_reviews_text;

                        starRatingWrappers.forEach((wrapper, idx) => {
                            const reviewCount = parseInt(wrapper.dataset.numberOfReviews);
                            const avgRatingFull = wrapper.dataset.averageRating;
                            const avgRatingShort = Math.round(
                            (parseFloat(wrapper.dataset.averageRating) * 10) / 10
                            );

                            if (reviewCount > 0) {
                            const qntyRegex = /([a-z]+)\/([a-z]+)/;
                            let newText = textFormat.replace(/\{\{\s?n\s?\}\}/g, reviewCount);
                            const qntyTexts = qntyRegex.exec(textFormat);

                            if (qntyTexts != null) {
                                if (reviewCount == 1) {
                                newText = newText.replace(qntyRegex, qntyTexts[1]);
                                } else {
                                newText = newText.replace(qntyRegex, qntyTexts[2]);
                                }
                            } else {
                                if (reviewCount == 1) {
                                starRatingTexts[idx].textContent = `${reviewCount} review`;
                                } else {
                                starRatingTexts[idx].textContent = `${reviewCount} reviews`;
                                }
                            }

                            newText = newText.replace(
                                /\{\{\s?average_rating\s\}\}/g,
                                avgRatingFull
                            );
                            newText = newText.replace(
                                /\{\{\s?average_rating_1_decimal\s\}\}/g,
                                avgRatingShort
                            );
                            starRatingTexts[idx].textContent = newText;

                            if (!jdgmSettings.badge_hide_text) {
                                starRatingTexts[idx].style.visibility = "visible";
                            }
                            }
                        });
                        } else {
                        starRatingWrappers.forEach((wrapper, idx) => {
                            const reviewCount = parseInt(wrapper.dataset.numberOfReviews);

                            if (reviewCount > 0) {
                            if (reviewCount == 1) {
                                starRatingTexts[idx].textContent = `${reviewCount} review`;
                            } else {
                                starRatingTexts[idx].textContent = `${reviewCount} reviews`;
                            }
                            }

                            if (!jdgmSettings.badge_hide_text) {
                            starRatingTexts[idx].style.visibility = "visible";
                            }
                        });
                        }
                    } catch(e){
                        gbb.utility.debugConsole("error in applyJudgemeStyleAndLanguage", e)
                    }

                }
            }
        }

    }
    // gbb Code start
}
window.gbb = gbb;
/*
* start the program
*/
gbbUtils.f.loadJquery(function (jqueryRefObj) {
    gbb.$ = jqueryRefObj;

    gbb.$(document).ready(function () {
        gbb.utility.debugConsole("document-ready-gbb", gbb.$);
        gbb.f.initialize(gbb.$);
        gbb.utility.debugConsole("gbb-page-load-event")
        let event = new CustomEvent('gbb-page-load', {});
        document.dispatchEvent(event);
    })
})


// comment at the end of line
</script><script> 
 </script><script>
      if (!gbb.state.bundleId){
        gbb.state.bundleId = "1";
      }
    </script><script>
        window.wgsLayer_non_proxy = window.wgsLayer_non_proxy || [];
        function wgtag(){window.wgsLayer_non_proxy?.push(arguments);}
        wgtag('js', new Date());wgtag('config', 'AW-834745793', {'allow_enhanced_conversions': true,});
          wgtag('consent', 'default', {
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'ad_storage': 'denied',
            'analytics_storage': 'denied',
            'wait_for_update': 500,
          });

        wgtag('consent', 'update', {
          ad_user_data: 'granted',
          ad_personalization: 'granted',
          ad_storage: 'granted',
          analytics_storage: 'granted'
        });
      
    </script><iframe allow="join-ad-interest-group" data-tagging-id="AW-11124416233" data-load-time="1739173779493" height="0" width="0" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/11124416233.html" style="display: none; visibility: hidden;"></iframe><iframe allow="join-ad-interest-group" data-tagging-id="AW-834745793" data-load-time="1739173779498" height="0" width="0" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/834745793.html" style="display: none; visibility: hidden;"></iframe><iframe allow="join-ad-interest-group" data-tagging-id="AW-834745793" data-load-time="1739173779510" height="0" width="0" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/834745793(1).html" style="display: none; visibility: hidden;"></iframe><img id="CookiebotSessionPixel" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/1.gif" alt="Cookiebot session tracker icon loaded" data-cookieconsent="ignore" style="display: none;"><script type="text/javascript" defer="defer" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/109748.js.download"></script><div id="batBeacon865482645442" style="width: 0px; height: 0px; display: none; visibility: hidden;"><img id="batBeacon862157565496" width="0" height="0" alt="" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/0" style="width: 0px; height: 0px; display: none; visibility: hidden;"></div><script type="text/javascript" id="_aw_script_0" src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/lantern_global_109748.min.js.download"></script><img src="./ahead Bundle-Builder- BIS ZU 15 mit dem ahead Bundle Builder! – ahead® _ The Better for You Company_files/track.php" border="0" height="0" width="0" style="position: absolute; visibility: hidden;"></body><div id="tella-plugin"><template shadowrootmode="open"><div style="font-size: 16px; font-weight: 400; user-select: none"></div><link rel="stylesheet" type="text/css" href="chrome-extension://enejkfhimljloggnimhebadbjajhgkad/build/index.css"></template></div><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;full&quot;,&quot;isActive&quot;:true,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>